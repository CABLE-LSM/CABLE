<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation for CABLE">
    <meta name="author" content="CABLE community" >
    <link rel="icon" href="../favicon.png">

    <title>cable_mpiworker.F90 &ndash; CABLE</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">CABLE </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>cable_mpiworker.F90
    <small>Source File</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 8.5% of total for source files.">4262 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/cable_mpiworker.F90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li class="active">cable_mpiworker.F90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/cable_mpiworker.html">cable_mpiworker</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/cable_mpiworker.f90.html#src">cable_mpiworker.F90</a>
  </div>
</div>

</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 6.0.2 (20221011.1828)
 -->
<!-- Title: sourcefile~~cable_mpiworker.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilecable_mpiworkerf90EfferentGraph" width="641pt" height="1142pt"
 viewBox="0.00 0.00 641.00 1142.28" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph" class="graph" transform="scale(0.395435 0.395435) rotate(0) translate(4 2884.66)">
<title>sourcefile~~cable_mpiworker.f90~~EfferentGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2884.66 1617,-2884.66 1617,4 -4,4"/>
<!-- sourcefile~cable_mpiworker.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~cable_mpiworker.f90</title>
<polygon fill="none" stroke="black" points="1613,-106 1498,-106 1498,-82 1613,-82 1613,-106"/>
<text text-anchor="middle" x="1555.5" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50">cable_mpiworker.F90</text>
</g>
<!-- sourcefile~casa_cable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~casa_cable.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/casa_cable.f90.html" xlink:title="casa_cable.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1257,-1655 1169,-1655 1169,-1631 1257,-1631 1257,-1655"/>
<text text-anchor="middle" x="1213" y="-1640.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_cable.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_cable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_cable.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1520C1368.07,-1575.53 1306.24,-1609.5 1261.82,-1627.29"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1260.42,-1624.08 1252.35,-1630.95 1262.94,-1630.61 1260.42,-1624.08"/>
</g>
<!-- sourcefile~cbl_soilsnow_init_special.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~cbl_soilsnow_init_special.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/cbl_soilsnow_init_special.f90.html" xlink:title="cbl_soilsnow_init_special.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="752,-174 599,-174 599,-150 752,-150 752,-174"/>
<text text-anchor="middle" x="675.5" y="-159.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_soilsnow_init_special.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cbl_soilsnow_init_special.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cbl_soilsnow_init_special.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1497.87,-94C1430.3,-94 1313.9,-94 1214,-94 1214,-94 1214,-94 1055.5,-94 935.79,-94 798.1,-127.27 726.17,-147.27"/>
<polygon fill="#ff0000" stroke="#ff0000" points="725.14,-143.92 716.46,-150 727.04,-150.66 725.14,-143.92"/>
</g>
<!-- sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~cable_common.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/cable_common.f90.html" xlink:title="cable_common.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="328,-1263 221,-1263 221,-1239 328,-1239 328,-1263"/>
<text text-anchor="middle" x="274.5" y="-1248.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_common.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1044C1028.35,-1027.06 508.33,-1026.1 479.5,-1040"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~cbl_model_driver_offline.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/cbl_model_driver_offline.f90.html" xlink:title="cbl_model_driver_offline.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1462,-892 1311,-892 1311,-868 1462,-868 1462,-892"/>
<text text-anchor="middle" x="1386.5" y="-877.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_model_driver_offline.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cbl_model_driver_offline.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cbl_model_driver_offline.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1551.94,-106.03C1533.2,-194.25 1417.02,-741.05 1392.17,-858"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1388.72,-857.44 1390.06,-867.95 1395.56,-858.89 1388.72,-857.44"/>
</g>
<!-- sourcefile~cable_mpicommon.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~cable_mpicommon.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/cable_mpicommon.f90.html" xlink:title="cable_mpicommon.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="737.5,-2838 613.5,-2838 613.5,-2814 737.5,-2814 737.5,-2838"/>
<text text-anchor="middle" x="675.5" y="-2823.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_mpicommon.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_mpicommon.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_mpicommon.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-2826C832.42,-2821.38 785.6,-2821.16 747.99,-2822.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="747.52,-2818.71 737.64,-2822.52 747.74,-2825.71 747.52,-2818.71"/>
</g>
<!-- sourcefile~casa_inout.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~casa_inout.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/casa_inout.f90.html" xlink:title="casa_inout.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1099.5,-1820 1013.5,-1820 1013.5,-1796 1099.5,-1796 1099.5,-1820"/>
<text text-anchor="middle" x="1056.5" y="-1805.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_inout.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_inout.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_inout.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-1808C1195.08,-1817.56 1147.83,-1816.3 1110,-1813.4"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1109.86,-1809.88 1099.61,-1812.55 1109.29,-1816.86 1109.86,-1809.88"/>
</g>
<!-- sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~casa_parm.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/casa_parm.f90.html" xlink:title="casa_parm.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="719.5,-1860 631.5,-1860 631.5,-1836 719.5,-1836 719.5,-1860"/>
<text text-anchor="middle" x="675.5" y="-1845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_parm.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1520C1340.47,-1662.01 1343.7,-1734.72 1214,-1808"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-1808C1208.89,-1809.75 965.48,-1749.79 962,-1749 923.84,-1740.28 912.42,-1715.64 876,-1730"/>
</g>
<!-- sourcefile~cable_input.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~cable_input.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/cable_input.f90.html" xlink:title="cable_input.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1257.5,-2166 1168.5,-2166 1168.5,-2142 1257.5,-2142 1257.5,-2166"/>
<text text-anchor="middle" x="1213" y="-2151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_input.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_input.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_input.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1520C1323.05,-1718.96 1333.42,-1775.82 1275,-1976 1258.4,-2032.88 1234.7,-2098.51 1222.3,-2131.94"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1218.91,-2131.02 1218.69,-2141.61 1225.46,-2133.46 1218.91,-2131.02"/>
</g>
<!-- sourcefile~cable_plume_mip.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~cable_plume_mip.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/cable_plume_mip.f90.html" xlink:title="cable_plume_mip.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="734.5,-2720 616.5,-2720 616.5,-2696 734.5,-2696 734.5,-2720"/>
<text text-anchor="middle" x="675.5" y="-2705.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_plume_mip.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_plume_mip.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_plume_mip.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-2826C800.75,-2815.4 730.07,-2758.32 696.61,-2727.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="698.62,-2724.69 688.93,-2720.41 693.83,-2729.8 698.62,-2724.69"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-2750C1075.3,-2818.95 1027.53,-2847.94 876,-2826"/>
</g>
<!-- sourcefile~cable_namelist_input.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~cable_namelist_input.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/cable_namelist_input.f90.html" xlink:title="cable_namelist_input.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1454,-66 1319,-66 1319,-42 1454,-42 1454,-66"/>
<text text-anchor="middle" x="1386.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_namelist_input.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_namelist_input.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_namelist_input.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1504.39,-82C1486.56,-77.73 1466.29,-72.87 1447.7,-68.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1448.4,-64.99 1437.86,-66.06 1446.77,-71.8 1448.4,-64.99"/>
</g>
<!-- sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~cable_iovars.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/cable_iovars.f90.html" xlink:title="cable_iovars.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="525.5,-2482 431.5,-2482 431.5,-2458 525.5,-2458 525.5,-2482"/>
<text text-anchor="middle" x="478.5" y="-2467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_iovars.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-2750C1150.47,-2780.47 1125.39,-2760.32 1057.5,-2750"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-2750C1028.89,-2745.95 1020.53,-2745.72 998,-2731 977.98,-2717.92 982.63,-2703.11 962,-2691 947.97,-2682.76 691.98,-2631 676.5,-2626"/>
</g>
<!-- sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~casa_dimension.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/casa_dimension.f90.html" xlink:title="casa_dimension.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="534.5,-1782 422.5,-1782 422.5,-1758 534.5,-1758 534.5,-1782"/>
<text text-anchor="middle" x="478.5" y="-1767.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_dimension.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1520C1342.3,-1656.24 1380.44,-1725.51 1275,-1822 1168.74,-1919.24 1102.54,-1874.48 962,-1906 803.72,-1941.5 738.49,-2026.8 599,-1944 570.27,-1926.94 581.28,-1905.97 563,-1878 542.04,-1845.91 514.24,-1811.27 496.6,-1790.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="499.05,-1787.57 489.94,-1782.16 493.69,-1792.07 499.05,-1787.57"/>
</g>
<!-- sourcefile~pop_mpi.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~pop_mpi.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/pop_mpi.f90.html" xlink:title="pop_mpi.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1424.5,-24 1348.5,-24 1348.5,0 1424.5,0 1424.5,-24"/>
<text text-anchor="middle" x="1386.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pop_mpi.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~pop_mpi.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~pop_mpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1539.33,-81.85C1521.68,-68.25 1491.22,-46.36 1462,-33 1453.38,-29.06 1443.86,-25.7 1434.59,-22.89"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1435.26,-19.44 1424.68,-20.07 1433.34,-26.18 1435.26,-19.44"/>
</g>
<!-- sourcefile~cable_climate.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~cable_climate.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/cable_climate.f90.html" xlink:title="cable_climate.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="725.5,-2678 625.5,-2678 625.5,-2654 725.5,-2654 725.5,-2678"/>
<text text-anchor="middle" x="675.5" y="-2663.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_climate.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_climate.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_climate.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-2750C993.63,-2743.59 823.95,-2702.76 734.09,-2680.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="734.88,-2677.06 724.33,-2678.04 733.19,-2683.85 734.88,-2677.06"/>
</g>
<!-- sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~casa_variable.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/casa_variable.f90.html" xlink:title="casa_variable.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="725.5,-2134 625.5,-2134 625.5,-2110 725.5,-2110 725.5,-2134"/>
<text text-anchor="middle" x="675.5" y="-2119.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_variable.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1520C1302.08,-1783.07 1464.73,-2634.69 1214,-2750"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-2750C1079.68,-2810.85 1191.7,-2560.8 1115,-2437 1065.5,-2357.1 1044.95,-2335.21 962,-2291 927.46,-2272.59 903.72,-2299.64 876,-2272"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-2272C841.23,-2237.42 818.91,-2244.26 788,-2208 765.56,-2181.68 779.42,-2160.09 752,-2139 746.97,-2135.13 741.22,-2132.11 735.2,-2129.76"/>
<polygon fill="#ff0000" stroke="#ff0000" points="736.15,-2126.39 725.56,-2126.58 733.96,-2133.03 736.15,-2126.39"/>
</g>
<!-- sourcefile~cable_carbon.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~cable_carbon.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/cable_carbon.f90.html" xlink:title="cable_carbon.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="924.5,-1016 825.5,-1016 825.5,-992 924.5,-992 924.5,-1016"/>
<text text-anchor="middle" x="875" y="-1001.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_carbon.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_carbon.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_carbon.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1044C1045.33,-1037.22 983.12,-1024.25 934.75,-1014.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="935.14,-1011.42 924.66,-1012.97 933.83,-1018.29 935.14,-1011.42"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1554.78,-106.09C1556.84,-209.45 1564.98,-954.58 1387.5,-1520"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1520C1308.56,-1765.13 1271.31,-1186.45 1057.5,-1044"/>
</g>
<!-- sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~cable_define_types.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/cable_define_types.f90.html" xlink:title="cable_define_types.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="338,-1364 211,-1364 211,-1340 338,-1340 338,-1364"/>
<text text-anchor="middle" x="274.5" y="-1349.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_define_types.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1520C1361.6,-1592.38 1289.71,-1511.15 1214,-1520"/>
</g>
<!-- sourcefile~cable_output.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~cable_output.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/cable_output.f90.html" xlink:title="cable_output.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1104.5,-2722 1008.5,-2722 1008.5,-2698 1104.5,-2698 1104.5,-2722"/>
<text text-anchor="middle" x="1056.5" y="-2707.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_output.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_output.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~cable_output.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-2750C1191.46,-2759.44 1134.34,-2740.6 1095.61,-2725.69"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1096.78,-2722.39 1086.19,-2722 1094.23,-2728.91 1096.78,-2722.39"/>
</g>
<!-- sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~casa_ncdf.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/casa_ncdf.f90.html" xlink:title="casa_ncdf.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="520,-1982 437,-1982 437,-1958 520,-1958 520,-1982"/>
<text text-anchor="middle" x="478.5" y="-1967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_ncdf.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1385.5,-1520C1369.21,-1569.78 1326.56,-1551.74 1275,-1561 1061.94,-1599.25 998.83,-1504.94 788,-1554 696.82,-1575.22 653.84,-1571.12 599,-1647 530.92,-1741.19 621.5,-1805.58 563,-1906 551.41,-1925.89 531,-1941.71 513.25,-1952.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="511.13,-1949.83 504.28,-1957.91 514.68,-1955.87 511.13,-1949.83"/>
</g>
<!-- sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~casa_phenvar.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/casa_phenvar.f90.html" xlink:title="casa_phenvar.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="726,-1902 625,-1902 625,-1878 726,-1878 726,-1902"/>
<text text-anchor="middle" x="675.5" y="-1887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_phenvar.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~cable_mpiworker.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1212,-1808C1207.32,-1810.92 1120.39,-1827.84 1115,-1829 1047.01,-1843.69 1030.73,-1851.25 962,-1862 884.48,-1874.12 794.25,-1881.93 736.31,-1886.14"/>
<polygon fill="#ff0000" stroke="#ff0000" points="735.96,-1882.66 726.23,-1886.86 736.46,-1889.64 735.96,-1882.66"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1199.79,-1630.65C1186.73,-1617.03 1165.88,-1594.11 1151,-1572 1100.24,-1496.55 1120.58,-1455.51 1057.5,-1390"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1390C1020.21,-1353.35 1019.63,-1337.06 998,-1291 978.27,-1249 997.59,-1222.77 962,-1193 889.31,-1132.2 846.41,-1164.25 752,-1156 593.08,-1142.11 545.09,-1130.8 394,-1182 358.81,-1193.92 322.49,-1216.95 299.49,-1233.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="297.45,-1230.27 291.36,-1238.94 301.53,-1235.96 297.45,-1230.27"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_inout.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_inout.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1206.41,-1655.04C1193.67,-1681.35 1160.05,-1744.59 1115,-1782 1110.79,-1785.5 1106.02,-1788.62 1101.09,-1791.39"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1099.42,-1788.31 1092.1,-1795.97 1102.6,-1794.54 1099.42,-1788.31"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M874,-1730C837.58,-1744.36 818.8,-1724.84 788,-1749 759.53,-1771.32 779.15,-1798.09 752,-1822 745.35,-1827.86 737.31,-1832.41 728.99,-1835.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="727.66,-1832.71 719.54,-1839.52 730.13,-1839.26 727.66,-1832.71"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1650C1005.89,-1648.93 1007.74,-1691.78 962,-1711 925.91,-1726.16 912.42,-1715.64 876,-1730"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1650C995.95,-1648.71 1016.25,-1578.58 962,-1554 814.98,-1487.38 727.76,-1445.67 599,-1543 552.2,-1578.38 590.4,-1618.12 563,-1670 546.55,-1701.15 519.21,-1731.41 500.32,-1750.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="497.48,-1748.22 492.79,-1757.72 502.38,-1753.21 497.48,-1748.22"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1168.73,-1645.64C1137.77,-1647.36 1095.09,-1649.39 1057.5,-1650"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1208.03,-1655.08C1197.2,-1686.59 1164.64,-1772.74 1115,-1829 1073.16,-1876.42 1036.24,-1859.62 998,-1910 968.43,-1948.96 998.12,-1981.02 962,-2014 903.17,-2067.71 861.83,-2027.08 788,-2057 756.97,-2069.57 724.18,-2089.61 702.25,-2104.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="700.19,-2101.29 693.84,-2109.77 704.1,-2107.1 700.19,-2101.29"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_carbon.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_carbon.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1208.65,-1630.9C1197.81,-1592.46 1161.61,-1470.14 1115,-1376 1044.66,-1233.94 932.28,-1079.01 891.46,-1024.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="894.13,-1022.14 885.33,-1016.24 888.53,-1026.34 894.13,-1022.14"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1390C983.11,-1316.11 685.28,-1423.95 599,-1481 520.44,-1532.95 566.53,-1691.99 479.5,-1656"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M477.5,-1656C358.18,-1599.93 299.39,-1434.21 281.55,-1374.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="284.81,-1372.8 278.69,-1364.15 278.09,-1374.73 284.81,-1372.8"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1650C847.24,-1653.36 731.18,-1595.02 599,-1756 555.49,-1808.99 600.35,-1848.51 563,-1906 550.29,-1925.56 529.47,-1941.54 511.81,-1952.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="509.68,-1949.83 502.91,-1957.99 513.29,-1955.83 509.68,-1949.83"/>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1768C942.58,-1815.38 895.07,-1774.58 788,-1834 768.49,-1844.83 771.35,-1857.89 752,-1869 746.94,-1871.91 741.45,-1874.43 735.82,-1876.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="734.53,-1873.36 726.27,-1879.99 736.86,-1879.96 734.53,-1873.36"/>
</g>
<!-- sourcefile~casa_cnp.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~casa_cnp.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node39"><a xlink:href=".././sourcefile/casa_cnp.f90.html" xlink:title="casa_cnp.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="915,-1782 835,-1782 835,-1758 915,-1758 915,-1782"/>
<text text-anchor="middle" x="875" y="-1767.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">casa_cnp.F90</text>
</a>
</g>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_cnp.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~casa_cnp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1768C1014.13,-1785.36 962.52,-1783.83 925.27,-1779.16"/>
<polygon fill="#ff0000" stroke="#ff0000" points="925.55,-1775.67 915.17,-1777.77 924.6,-1782.6 925.55,-1775.67"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1201.5,-1655.27C1178.47,-1681.25 1120.49,-1741.57 1057.5,-1768"/>
</g>
<!-- sourcefile~cable_phenology.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~cable_phenology.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node43"><a xlink:href=".././sourcefile/cable_phenology.f90.html" xlink:title="cable_phenology.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="932,-1702 818,-1702 818,-1678 932,-1678 932,-1702"/>
<text text-anchor="middle" x="875" y="-1687.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_phenology.F90</text>
</a>
</g>
</g>
<!-- sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_phenology.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~casa_cable.f90&#45;&gt;sourcefile~cable_phenology.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1055.5,-1650C1031.22,-1649.48 972.39,-1663.7 928.66,-1675.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="927.49,-1672.02 918.74,-1678 929.31,-1678.78 927.49,-1672.02"/>
</g>
<!-- sourcefile~cbl_soilsnow_init_special.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~cbl_soilsnow_init_special.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M477.5,-242C386.6,-320.49 421.99,-382.21 394,-499 376.43,-572.31 296.06,-1112.19 278.78,-1228.83"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="275.31,-1228.36 277.31,-1238.76 282.24,-1229.38 275.31,-1228.36"/>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M620.69,-174.04C578.47,-185.68 520.21,-206.84 479.5,-242"/>
</g>
<!-- sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~cbl_soilsnow_data.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node31"><a xlink:href=".././sourcefile/cbl_soilsnow_data.f90.html" xlink:title="cbl_soilsnow_data.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="539,-532 418,-532 418,-508 539,-508 539,-532"/>
<text text-anchor="middle" x="478.5" y="-517.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_soilsnow_data.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_init_special.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~cbl_soilsnow_init_special.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ff4c00" stroke-dasharray="5,2" d="M653.42,-174.13C636.7,-184.67 613.78,-201.31 599,-221 531.17,-311.37 495.96,-445.43 484.14,-497.85"/>
<polygon fill="#ff4c00" stroke="#ff4c00" points="480.69,-497.24 481.97,-507.75 487.53,-498.74 480.69,-497.24"/>
</g>
<!-- sourcefile~cable_runtime_opts_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~cable_runtime_opts_mod.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node28"><a xlink:href=".././sourcefile/cable_runtime_opts_mod.f90.html" xlink:title="cable_runtime_opts_mod.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="155,-1263 0,-1263 0,-1239 155,-1239 155,-1263"/>
<text text-anchor="middle" x="77.5" y="-1248.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_runtime_opts_mod.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_common.f90&#45;&gt;sourcefile~cable_runtime_opts_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~cable_common.f90&#45;&gt;sourcefile~cable_runtime_opts_mod.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M220.99,-1251C203.87,-1251 184.39,-1251 165.44,-1251"/>
<polygon fill="#ff9900" stroke="#ff9900" points="165.29,-1247.5 155.29,-1251 165.29,-1254.5 165.29,-1247.5"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1385.45,-867.94C1384.43,-776.98 1365.76,-202 1057.5,-202 1057.5,-202 1057.5,-202 874,-202 785.88,-202 546.19,-184.41 479.5,-242"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1385.47,-892.26C1384.98,-974.65 1377.68,-1447.22 1275,-1534 1232.91,-1569.58 1194.08,-1568.37 1151,-1534 1094.7,-1489.08 1171.3,-1420.92 1115,-1376 1053.44,-1326.88 689.13,-1384.42 599,-1481 540.66,-1543.52 599.57,-1592.71 563,-1670 547.87,-1701.98 520.04,-1732.22 500.7,-1750.9"/>
<polygon fill="#ffe500" stroke="#ffe500" points="498.11,-1748.53 493.24,-1757.94 502.91,-1753.63 498.11,-1748.53"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_carbon.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_carbon.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1358.15,-867.98C1289.64,-839.91 1108.26,-778.45 998,-861 954.45,-893.61 1000.57,-939.62 962,-978 954.3,-985.67 944.42,-991.08 934.11,-994.91"/>
<polygon fill="#ffe500" stroke="#ffe500" points="933.02,-991.59 924.59,-998 935.18,-998.25 933.02,-991.59"/>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1384.95,-892.01C1380.63,-979 1348.77,-1509.68 1214,-1520"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1212,-1520C1126.8,-1526.52 1189.06,-1396.62 1115,-1354 1049.57,-1316.35 540.17,-1338.33 348.29,-1348.08"/>
<polygon fill="#ffe500" stroke="#ffe500" points="347.83,-1344.6 338.02,-1348.61 348.19,-1351.59 347.83,-1344.6"/>
</g>
<!-- sourcefile~cable_air.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~cable_air.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/cable_air.f90.html" xlink:title="cable_air.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="517,-1012 440,-1012 440,-988 517,-988 517,-1012"/>
<text text-anchor="middle" x="478.5" y="-997.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_air.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_air.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_air.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M674.5,-964C622.97,-961 564.9,-973.87 525.64,-985.04"/>
<polygon fill="#ffe500" stroke="#ffe500" points="524.44,-981.74 515.83,-987.91 526.41,-988.46 524.44,-981.74"/>
</g>
<!-- sourcefile~cbl_snow_aging.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~cbl_snow_aging.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/cbl_snow_aging.f90.html" xlink:title="cbl_snow_aging.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1268.5,-165 1157.5,-165 1157.5,-141 1268.5,-141 1268.5,-165"/>
<text text-anchor="middle" x="1213" y="-150.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snow_aging.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_snow_aging.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_snow_aging.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1384.97,-867.88C1381.17,-785.28 1355.77,-305.02 1275,-188 1270.06,-180.85 1263.16,-174.97 1255.76,-170.21"/>
<polygon fill="#ffe500" stroke="#ffe500" points="1257.35,-167.08 1246.94,-165.12 1253.86,-173.15 1257.35,-167.08"/>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~cbl_soilsnow_main.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/cbl_soilsnow_main.f90.html" xlink:title="cbl_soilsnow_main.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1275,-532 1151,-532 1151,-508 1275,-508 1275,-532"/>
<text text-anchor="middle" x="1213" y="-517.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_soilsnow_main.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_soilsnow_main.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_soilsnow_main.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1379.6,-867.61C1354.5,-814.92 1256.47,-609.15 1224.29,-541.61"/>
<polygon fill="#ffe500" stroke="#ffe500" points="1227.34,-539.86 1219.88,-532.34 1221.02,-542.87 1227.34,-539.86"/>
</g>
<!-- sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~cable_phys_constants_mod.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node26"><a xlink:href=".././sourcefile/cable_phys_constants_mod.f90.html" xlink:title="cable_phys_constants_mod.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="358,-694 191,-694 191,-670 358,-670 358,-694"/>
<text text-anchor="middle" x="274.5" y="-679.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_phys_constants_mod.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1385.62,-867.9C1386.27,-779.95 1385.64,-239.47 1275,-132 1119.3,19.25 1003.54,-69.28 788,-95 737.37,-101.04 727.31,-117.76 676.5,-122"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M674.5,-122C541.43,-129.32 481.11,-127.14 394,-228 280.28,-359.67 273.83,-587.63 274.82,-659.57"/>
<polygon fill="#ffe500" stroke="#ffe500" points="271.32,-659.82 275.02,-669.74 278.32,-659.67 271.32,-659.82"/>
</g>
<!-- sourcefile~cable_roughness.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~cable_roughness.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node27"><a xlink:href=".././sourcefile/cable_roughness.f90.html" xlink:title="cable_roughness.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="733.5,-936 617.5,-936 617.5,-912 733.5,-912 733.5,-936"/>
<text text-anchor="middle" x="675.5" y="-921.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_roughness.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_roughness.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_roughness.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1212,-1063C1170.49,-1081.72 1158.33,-1044.02 1115,-1030 1010.16,-996.07 984.73,-981.95 876,-964"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M874,-964C830.06,-956.16 780.85,-946.19 742.55,-938.17"/>
<polygon fill="#ffe500" stroke="#ffe500" points="743.06,-934.7 732.55,-936.07 741.62,-941.56 743.06,-934.7"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1378.64,-892.39C1358.66,-927.05 1296.66,-1024.93 1214,-1063"/>
</g>
<!-- sourcefile~cbl_masks.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~cbl_masks.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node29"><a xlink:href=".././sourcefile/cbl_masks.f90.html" xlink:title="cbl_masks.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1255.5,-892 1170.5,-892 1170.5,-868 1255.5,-868 1255.5,-892"/>
<text text-anchor="middle" x="1213" y="-877.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_masks.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_masks.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_masks.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1310.78,-880C1295.52,-880 1279.8,-880 1265.57,-880"/>
<polygon fill="#ffe500" stroke="#ffe500" points="1265.51,-876.5 1255.51,-880 1265.51,-883.5 1265.51,-876.5"/>
</g>
<!-- sourcefile~cbl_init_radiation.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~cbl_init_radiation.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node35"><a xlink:href=".././sourcefile/cbl_init_radiation.f90.html" xlink:title="cbl_init_radiation.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1270.5,-976 1155.5,-976 1155.5,-952 1270.5,-952 1270.5,-976"/>
<text text-anchor="middle" x="1213" y="-961.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_init_radiation.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_init_radiation.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_init_radiation.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1366.9,-892.04C1345.39,-905.62 1308.6,-927.8 1275,-943 1270.87,-944.87 1266.52,-946.67 1262.13,-948.38"/>
<polygon fill="#ffe500" stroke="#ffe500" points="1260.65,-945.2 1252.5,-951.97 1263.09,-951.76 1260.65,-945.2"/>
</g>
<!-- sourcefile~cbl_albedo.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~cbl_albedo.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node40"><a xlink:href=".././sourcefile/cbl_albedo.f90.html" xlink:title="cbl_albedo.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1256,-934 1170,-934 1170,-910 1256,-910 1256,-934"/>
<text text-anchor="middle" x="1213" y="-919.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_albedo.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_albedo.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cbl_albedo.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1336.35,-892.04C1314.38,-897.42 1288.46,-903.76 1266.15,-909.23"/>
<polygon fill="#ffe500" stroke="#ffe500" points="1265.05,-905.89 1256.17,-911.67 1266.72,-912.69 1265.05,-905.89"/>
</g>
<!-- sourcefile~cable_other_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~cable_other_constants_mod.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node41"><a xlink:href=".././sourcefile/cable_other_constants_mod.f90.html" xlink:title="cable_other_constants_mod.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="563,-894 394,-894 394,-870 563,-870 563,-894"/>
<text text-anchor="middle" x="478.5" y="-879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_other_constants_mod.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_other_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_other_constants_mod.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M674.5,-964C639.96,-961.99 628.01,-963.87 599,-945 577.24,-930.85 585.08,-912.65 563,-899 562.91,-898.94 562.82,-898.89 562.73,-898.83"/>
<polygon fill="#ffe500" stroke="#ffe500" points="564.38,-895.75 553.91,-894.17 561.11,-901.94 564.38,-895.75"/>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M874,-964C787.59,-948.57 764.13,-969.1 676.5,-964"/>
</g>
<!-- sourcefile~cable_maths_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~cable_maths_constants_mod.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node42"><a xlink:href=".././sourcefile/cable_maths_constants_mod.f90.html" xlink:title="cable_maths_constants_mod.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="962,-2090 788,-2090 788,-2066 962,-2066 962,-2090"/>
<text text-anchor="middle" x="875" y="-2075.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_maths_constants_mod.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_maths_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_maths_constants_mod.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1384.14,-892.23C1373.67,-985.97 1305.49,-1588.85 1275,-1664 1192.08,-1868.34 1146.98,-1928.95 962,-2049 953.86,-2054.28 944.65,-2058.7 935.37,-2062.37"/>
<polygon fill="#ffe500" stroke="#ffe500" points="933.89,-2059.19 925.71,-2065.92 936.31,-2065.76 933.89,-2059.19"/>
</g>
<!-- sourcefile~cable_sli_main.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~cable_sli_main.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node44"><a xlink:href=".././sourcefile/cable_sli_main.f90.html" xlink:title="cable_sli_main.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="927.5,-1226 822.5,-1226 822.5,-1202 927.5,-1202 927.5,-1226"/>
<text text-anchor="middle" x="875" y="-1211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_sli_main.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_sli_main.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~cbl_model_driver_offline.f90&#45;&gt;sourcefile~cable_sli_main.f90</title>
<path fill="none" stroke="#ffe500" stroke-dasharray="5,2" d="M1212,-1063C1101.57,-1110.47 972.19,-1169.63 911.2,-1197.72"/>
<polygon fill="#ffe500" stroke="#ffe500" points="909.63,-1194.6 902.01,-1201.96 912.56,-1200.95 909.63,-1194.6"/>
</g>
<!-- sourcefile~cable_mpicommon.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~cable_mpicommon.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M663.51,-2813.81C647.86,-2796.05 618.86,-2761.63 599,-2729 592.26,-2717.93 516.6,-2551.7 489.27,-2491.53"/>
<polygon fill="#cbff00" stroke="#cbff00" points="492.36,-2489.86 485.04,-2482.21 485.99,-2492.76 492.36,-2489.86"/>
</g>
<!-- sourcefile~cable_mpicommon.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~cable_mpicommon.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M640.6,-2838.02C597.61,-2850.87 523.79,-2864.58 479.5,-2826"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M874,-1568C738.15,-1474.67 709.33,-1441.86 563,-1366 518.48,-1342.92 386.14,-1292.4 317.64,-1266.69"/>
<polygon fill="#7fff00" stroke="#7fff00" points="318.61,-1263.32 308.02,-1263.09 316.15,-1269.87 318.61,-1263.32"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1016.92,-1795.99C1009.9,-1792.4 1003.17,-1787.81 998,-1782 962.96,-1742.63 987.59,-1715.08 962,-1669 933.38,-1617.46 924.83,-1601.05 876,-1568"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M874,-1848C825.58,-1855.86 769.61,-1854.93 729.64,-1852.59"/>
<polygon fill="#7fff00" stroke="#7fff00" points="729.78,-1849.09 719.58,-1851.95 729.34,-1856.08 729.78,-1849.09"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1013.34,-1818.86C977.13,-1827.83 923.43,-1840.3 876,-1848"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M874,-2000C841.23,-2020.63 825.04,-2002.69 788,-2014 699.56,-2041.01 652.88,-2025.85 599,-2101 509.69,-2225.58 660.19,-2325.47 563,-2444 555.92,-2452.63 546.03,-2458.45 535.52,-2462.36"/>
<polygon fill="#7fff00" stroke="#7fff00" points="534.23,-2459.09 525.75,-2465.44 536.34,-2465.77 534.23,-2459.09"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1013.26,-1815.2C1007.62,-1817.59 1002.31,-1820.78 998,-1825 960.34,-1861.88 992.94,-1895.33 962,-1938 934.34,-1976.15 914.27,-1972.51 876,-2000"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M874,-1568C742.13,-1465.91 550.79,-1681.46 495.19,-1749.99"/>
<polygon fill="#7fff00" stroke="#7fff00" points="492.34,-1747.95 488.82,-1757.94 497.8,-1752.33 492.34,-1747.95"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M874,-2000C840.42,-2021.14 822.89,-2005.09 788,-2024 750.06,-2044.56 714.05,-2080.15 693.68,-2102.31"/>
<polygon fill="#7fff00" stroke="#7fff00" points="691.01,-2100.05 686.9,-2109.82 696.2,-2104.74 691.01,-2100.05"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M674.5,-1930C612.07,-1934.1 440.92,-1947.38 394,-1906 311.95,-1833.64 283.02,-1468.7 276.84,-1374.31"/>
<polygon fill="#7fff00" stroke="#7fff00" points="280.33,-1373.94 276.2,-1364.18 273.34,-1374.38 280.33,-1373.94"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1013.28,-1817.74C1007.95,-1819.75 1002.72,-1822.15 998,-1825 978.36,-1836.86 981.95,-1850.67 962,-1862 848.57,-1926.41 806.76,-1923.09 676.5,-1930"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M674.5,-1930C624.8,-1933.27 569.26,-1945.53 530.2,-1955.63"/>
<polygon fill="#7fff00" stroke="#7fff00" points="528.92,-1952.35 520.14,-1958.28 530.7,-1959.12 528.92,-1952.35"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M874,-1848C827.47,-1855.55 775.32,-1866.76 736.3,-1875.7"/>
<polygon fill="#7fff00" stroke="#7fff00" points="735.12,-1872.38 726.17,-1878.04 736.7,-1879.2 735.12,-1872.38"/>
</g>
<!-- sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_cnp.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~casa_inout.f90&#45;&gt;sourcefile~casa_cnp.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1013.42,-1799.09C986.93,-1793.48 952.64,-1786.22 924.94,-1780.36"/>
<polygon fill="#7fff00" stroke="#7fff00" points="925.57,-1776.92 915.06,-1778.27 924.12,-1783.76 925.57,-1776.92"/>
</g>
<!-- sourcefile~casa_parm.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~casa_parm.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M637.42,-1835.88C625.12,-1831.69 611.4,-1826.83 599,-1822 570.46,-1810.9 538.69,-1797 515.09,-1786.36"/>
<polygon fill="#33ff00" stroke="#33ff00" points="516.38,-1783.11 505.83,-1782.17 513.5,-1789.48 516.38,-1783.11"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M874,-2156C835.28,-2155.19 821.88,-2160.76 788,-2142 766.79,-2130.25 769.65,-2117.63 752,-2101 689.3,-2041.92 664.81,-2037.6 599,-1982 582.42,-1967.99 580.01,-1962.49 563,-1949 527.79,-1921.08 500.6,-1931.67 479.5,-1892"/>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M477.5,-1892C450.08,-1840.62 415.67,-1845.06 394,-1791 352.39,-1687.19 421.65,-1380.97 358,-1289 351.68,-1279.87 342.59,-1272.88 332.74,-1267.56"/>
<polygon fill="#00ff19" stroke="#00ff19" points="334.06,-1264.31 323.53,-1263.12 331.02,-1270.61 334.06,-1264.31"/>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1168.38,-2142.49C1151.8,-2138.66 1132.65,-2134.89 1115,-2133 1063.3,-2127.47 1049.77,-2128.16 998,-2133 943.06,-2138.13 931.16,-2157.34 876,-2156"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_inout.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_inout.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1206.5,-2141.69C1183.69,-2090.61 1096.36,-1895.02 1067.11,-1829.52"/>
<polygon fill="#00ff19" stroke="#00ff19" points="1070.21,-1827.87 1062.93,-1820.17 1063.81,-1830.72 1070.21,-1827.87"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1182.39,-2166.03C1151.71,-2177.45 1102.1,-2193.02 1057.5,-2194"/>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1055.5,-2194C1022.95,-2194.71 830.47,-2150.52 788,-2099 722.19,-2019.16 820.8,-1946.28 752,-1869 745.95,-1862.21 737.92,-1857.53 729.34,-1854.33"/>
<polygon fill="#00ff19" stroke="#00ff19" points="730.1,-1850.9 719.51,-1851.3 728.04,-1857.59 730.1,-1850.9"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M674.5,-2626C641.53,-2615.49 624.01,-2630.91 599,-2607 558.75,-2568.52 604.12,-2524.55 563,-2487 555.3,-2479.97 545.51,-2475.52 535.37,-2472.77"/>
<polygon fill="#00ff19" stroke="#00ff19" points="536.11,-2469.35 525.59,-2470.62 534.61,-2476.18 536.11,-2469.35"/>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1055.5,-2518C953.86,-2584.67 896.47,-2520.13 788,-2575 768.9,-2584.66 770.92,-2596.99 752,-2607 721.41,-2623.18 709.47,-2636.51 676.5,-2626"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M874,-2194C836.62,-2180.69 818.83,-2194.98 788,-2170 761.13,-2148.22 774.16,-2127.56 752,-2101 696.81,-2034.85 649.16,-2052.04 599,-1982 570.52,-1942.23 586.27,-1921.03 563,-1878 544.79,-1844.32 516.31,-1810.14 497.77,-1789.5"/>
<polygon fill="#00ff19" stroke="#00ff19" points="500.29,-1787.06 490.96,-1782.03 495.11,-1791.78 500.29,-1787.06"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M874,-2194C836.62,-2180.69 822.98,-2188.73 788,-2170 769.39,-2160.03 770.86,-2148.49 752,-2139 746.77,-2136.37 741.14,-2134.14 735.38,-2132.26"/>
<polygon fill="#00ff19" stroke="#00ff19" points="736.23,-2128.86 725.64,-2129.39 734.25,-2135.57 736.23,-2128.86"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M477.5,-2826C441.41,-2794.56 416.34,-2800.32 394,-2758 326.54,-2630.22 282.77,-1543.6 276.33,-1374.17"/>
<polygon fill="#00ff19" stroke="#00ff19" points="279.82,-1374.02 275.95,-1364.16 272.83,-1374.29 279.82,-1374.02"/>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1211.83,-2166.09C1210.47,-2241.68 1199.32,-2648.69 1115,-2731 1032.11,-2811.92 713.39,-2786.75 599,-2805 545.75,-2813.5 520.16,-2861.42 479.5,-2826"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M874,-2156C751.69,-2159.58 705.98,-2202.39 599,-2143 538.32,-2109.32 501.86,-2030.24 487.11,-1991.78"/>
<polygon fill="#00ff19" stroke="#00ff19" points="490.28,-1990.24 483.53,-1982.08 483.71,-1992.67 490.28,-1990.24"/>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M874,-2194C836.62,-2180.69 816.99,-2197.1 788,-2170 752.88,-2137.17 769.39,-2112.82 752,-2068 729.88,-2011 701.01,-1944.99 686.2,-1911.66"/>
<polygon fill="#00ff19" stroke="#00ff19" points="689.34,-1910.12 682.08,-1902.41 682.95,-1912.97 689.34,-1910.12"/>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1055.5,-2194C975.74,-2195.75 951.16,-2220.76 876,-2194"/>
</g>
<!-- sourcefile~cable_initialise.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~cable_initialise.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/cable_initialise.f90.html" xlink:title="cable_initialise.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1108,-2470 1005,-2470 1005,-2446 1108,-2446 1108,-2470"/>
<text text-anchor="middle" x="1056.5" y="-2455.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_initialise.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_initialise.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_initialise.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1209.58,-2166.12C1201.5,-2204.48 1172.59,-2325.59 1115,-2408 1106.55,-2420.1 1094.54,-2431.15 1083.68,-2439.76"/>
<polygon fill="#00ff19" stroke="#00ff19" points="1081.52,-2437.01 1075.68,-2445.86 1085.76,-2442.58 1081.52,-2437.01"/>
</g>
<!-- sourcefile~cbl_sinbet.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~cbl_sinbet.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node30"><a xlink:href=".././sourcefile/cbl_sinbet.f90.html" xlink:title="cbl_sinbet.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1097.5,-2086 1015.5,-2086 1015.5,-2062 1097.5,-2062 1097.5,-2086"/>
<text text-anchor="middle" x="1056.5" y="-2071.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_sinbet.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cbl_sinbet.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cbl_sinbet.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1191.45,-2141.91C1172,-2130.61 1141.86,-2113.52 1115,-2100 1108.47,-2096.72 1101.45,-2093.38 1094.62,-2090.24"/>
<polygon fill="#00ff19" stroke="#00ff19" points="1096.06,-2087.05 1085.5,-2086.1 1093.17,-2093.42 1096.06,-2087.05"/>
</g>
<!-- sourcefile~popluc.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~popluc.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node33"><a xlink:href=".././sourcefile/popluc.f90.html" xlink:title="POPLUC.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="913.5,-2366 836.5,-2366 836.5,-2342 913.5,-2342 913.5,-2366"/>
<text text-anchor="middle" x="875" y="-2351.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">POPLUC.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~popluc.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~popluc.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1055.5,-2394C1043.33,-2398.95 972.55,-2380.99 923.6,-2367.53"/>
<polygon fill="#00ff19" stroke="#00ff19" points="924.39,-2364.12 913.82,-2364.83 922.52,-2370.87 924.39,-2364.12"/>
</g>
<!-- sourcefile~cable_parameters.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~cable_parameters.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node34"><a xlink:href=".././sourcefile/cable_parameters.f90.html" xlink:title="cable_parameters.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="935.5,-2324 814.5,-2324 814.5,-2300 935.5,-2300 935.5,-2324"/>
<text text-anchor="middle" x="875" y="-2309.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_parameters.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_parameters.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_parameters.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1209.27,-2166.19C1198.86,-2209.21 1157.11,-2353.49 1057.5,-2394"/>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1055.5,-2394C1009.54,-2412.69 1007.53,-2352.72 962,-2333 956.67,-2330.69 951.04,-2328.61 945.31,-2326.73"/>
<polygon fill="#00ff19" stroke="#00ff19" points="946.21,-2323.34 935.62,-2323.76 944.16,-2330.04 946.21,-2323.34"/>
</g>
<!-- sourcefile~cable_read.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~cable_read.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node36"><a xlink:href=".././sourcefile/cable_read.f90.html" xlink:title="cable_read.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="919,-2490 831,-2490 831,-2466 919,-2466 919,-2490"/>
<text text-anchor="middle" x="875" y="-2475.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_read.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_read.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_read.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1211.26,-2166.2C1207.94,-2211.84 1191.05,-2375.22 1115,-2479 1096.75,-2503.91 1083.32,-2501.06 1057.5,-2518"/>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1055.5,-2518C1044.64,-2525.13 975.01,-2507.02 925.74,-2492.88"/>
<polygon fill="#00ff19" stroke="#00ff19" points="926.46,-2489.45 915.88,-2490.03 924.51,-2496.17 926.46,-2489.45"/>
</g>
<!-- sourcefile~cable_luc_expt.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~cable_luc_expt.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node37"><a xlink:href=".././sourcefile/cable_luc_expt.f90.html" xlink:title="cable_LUC_EXPT.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="734.5,-2366 616.5,-2366 616.5,-2342 734.5,-2342 734.5,-2366"/>
<text text-anchor="middle" x="675.5" y="-2351.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_LUC_EXPT.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_luc_expt.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_luc_expt.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1055.5,-2394C938.43,-2441.61 785.06,-2395.9 714.74,-2369.63"/>
<polygon fill="#00ff19" stroke="#00ff19" points="715.97,-2366.35 705.38,-2366.06 713.47,-2372.89 715.97,-2366.35"/>
</g>
<!-- sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~cable_abort.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node45"><a xlink:href=".././sourcefile/cable_abort.f90.html" xlink:title="cable_abort.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="721,-2598 630,-2598 630,-2574 721,-2574 721,-2598"/>
<text text-anchor="middle" x="675.5" y="-2583.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_abort.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1055.5,-2518C988.79,-2561.76 955.7,-2514.38 876,-2518"/>
</g>
<!-- sourcefile~cable_metutils.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~cable_metutils.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node46"><a xlink:href=".././sourcefile/cable_metutils.f90.html" xlink:title="cable_metutils.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1108,-2166 1005,-2166 1005,-2142 1108,-2142 1108,-2166"/>
<text text-anchor="middle" x="1056.5" y="-2151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_metutils.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_metutils.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~cable_input.f90&#45;&gt;sourcefile~cable_metutils.f90</title>
<path fill="none" stroke="#00ff19" stroke-dasharray="5,2" d="M1168.14,-2154C1152.63,-2154 1134.89,-2154 1118.22,-2154"/>
<polygon fill="#00ff19" stroke="#00ff19" points="1118.02,-2150.5 1108.02,-2154 1118.02,-2157.5 1118.02,-2150.5"/>
</g>
<!-- sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M618.82,-2695.87C611.93,-2693.41 605.16,-2690.48 599,-2687 579.84,-2676.18 580.81,-2665.92 563,-2653 493.78,-2602.78 438.72,-2633.89 394,-2561 320.06,-2440.48 435.93,-1406.98 358,-1289 351.94,-1279.83 343.07,-1272.84 333.37,-1267.52"/>
<polygon fill="#00ff66" stroke="#00ff66" points="334.8,-1264.32 324.28,-1263.09 331.74,-1270.62 334.8,-1264.32"/>
</g>
<!-- sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M616.46,-2697.79C610.12,-2695.01 604.12,-2691.48 599,-2687 568.43,-2660.26 581.86,-2638.98 563,-2603 541.36,-2561.71 511.37,-2516.24 493.85,-2490.59"/>
<polygon fill="#00ff66" stroke="#00ff66" points="496.54,-2488.34 487.99,-2482.09 490.78,-2492.31 496.54,-2488.34"/>
</g>
<!-- sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M616.48,-2696.56C559.93,-2685.29 482.05,-2669.42 479.5,-2667"/>
</g>
<!-- sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M616.42,-2699.98C609.76,-2696.86 603.69,-2692.66 599,-2687 538.52,-2614.02 580.11,-2355.23 563,-2262 544.06,-2158.82 504.13,-2039.65 487.27,-1991.67"/>
<polygon fill="#00ff66" stroke="#00ff66" points="490.5,-1990.3 483.86,-1982.04 483.9,-1992.63 490.5,-1990.3"/>
</g>
<!-- sourcefile~cable_weathergenerator.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~cable_weathergenerator.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node38"><a xlink:href=".././sourcefile/cable_weathergenerator.f90.html" xlink:title="cable_weathergenerator.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="553.5,-2720 403.5,-2720 403.5,-2696 553.5,-2696 553.5,-2720"/>
<text text-anchor="middle" x="478.5" y="-2705.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_weathergenerator.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_weathergenerator.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~cable_plume_mip.f90&#45;&gt;sourcefile~cable_weathergenerator.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M616.26,-2708C599.84,-2708 581.64,-2708 564.02,-2708"/>
<polygon fill="#00ff66" stroke="#00ff66" points="563.72,-2704.5 553.72,-2708 563.72,-2711.5 563.72,-2704.5"/>
</g>
<!-- sourcefile~cable_iovars.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~cable_iovars.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M431.27,-2465.42C417.32,-2461.73 403.26,-2455.26 394,-2444 323.37,-2358.16 283.09,-1522.74 276.47,-1374.45"/>
<polygon fill="#00ffff" stroke="#00ffff" points="279.96,-1374.12 276.02,-1364.28 272.97,-1374.43 279.96,-1374.12"/>
</g>
<!-- sourcefile~casa_dimension.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~casa_dimension.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00b2ff" stroke-dasharray="5,2" d="M464.9,-1757.8C447.06,-1739.95 414.33,-1705.01 394,-1670 333.92,-1566.57 294.61,-1427.2 280.91,-1373.94"/>
<polygon fill="#00b2ff" stroke="#00b2ff" points="284.29,-1373.03 278.44,-1364.19 277.5,-1374.75 284.29,-1373.03"/>
</g>
<!-- sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M628.21,-2653.89C618.16,-2650.23 607.9,-2645.64 599,-2640 579.63,-2627.71 580.66,-2617.64 563,-2603 493.63,-2545.49 437.81,-2569.74 394,-2491 329.04,-2374.24 431.73,-1400.43 358,-1289 351.94,-1279.84 343.06,-1272.85 333.36,-1267.53"/>
<polygon fill="#0019ff" stroke="#0019ff" points="334.79,-1264.33 324.27,-1263.09 331.72,-1270.62 334.79,-1264.33"/>
</g>
<!-- sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M625.28,-2656.79C615.51,-2652.98 606.09,-2647.6 599,-2640 556.93,-2594.91 603.34,-2552.64 563,-2506 555.49,-2497.32 545.51,-2490.67 535.07,-2485.59"/>
<polygon fill="#0019ff" stroke="#0019ff" points="536.39,-2482.34 525.83,-2481.52 533.57,-2488.75 536.39,-2482.34"/>
</g>
<!-- sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~cable_climate.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M477.5,-2667C448.18,-2639.19 417.75,-2663.7 394,-2631 317.06,-2525.05 281.56,-1536.99 276.22,-1374.55"/>
<polygon fill="#0019ff" stroke="#0019ff" points="279.71,-1374.19 275.88,-1364.31 272.71,-1374.41 279.71,-1374.19"/>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M625.32,-2673.64C574.46,-2680.29 499.7,-2686.16 479.5,-2667"/>
</g>
<!-- sourcefile~cable_climate.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~cable_climate.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#0019ff" stroke-dasharray="5,2" d="M650.09,-2653.83C632.73,-2643.78 610.52,-2627.81 599,-2607 561.66,-2539.57 577.65,-2337.68 563,-2262 543.06,-2159.01 503.68,-2039.74 487.12,-1991.7"/>
<polygon fill="#0019ff" stroke="#0019ff" points="490.36,-1990.35 483.77,-1982.05 483.75,-1992.65 490.36,-1990.35"/>
</g>
<!-- sourcefile~casa_variable.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~casa_variable.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M625.49,-2113.6C615.46,-2109.76 605.89,-2104.15 599,-2096 535.63,-2020.98 602.23,-1968.03 563,-1878 547.87,-1843.28 519.1,-1809.83 499.61,-1789.59"/>
<polygon fill="#3200ff" stroke="#3200ff" points="501.9,-1786.92 492.39,-1782.25 496.91,-1791.83 501.9,-1786.92"/>
</g>
<!-- sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M674.5,-1002C663.48,-1001.36 489.44,-1035.21 479.5,-1040"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M477.5,-1040C442.72,-1056.77 424.9,-1040.85 394,-1064 335.27,-1108 298.22,-1190.39 283.19,-1229.43"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="279.91,-1228.21 279.69,-1238.8 286.47,-1230.66 279.91,-1228.21"/>
</g>
<!-- sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M825.21,-1007.4C727.92,-1016.88 509.26,-1052.27 394,-1182 348.75,-1232.93 405.88,-1282.53 358,-1331 354.76,-1334.28 351.08,-1337.08 347.12,-1339.45"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="345.42,-1336.39 338.06,-1344.01 348.57,-1342.64 345.42,-1336.39"/>
</g>
<!-- sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~cable_carbon.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M674.5,-1002C612.27,-998.38 448.26,-950.08 394,-903 329.75,-847.25 294.55,-747.86 281.48,-703.92"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="284.82,-702.88 278.69,-694.24 278.09,-704.82 284.82,-702.88"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M825.29,-1004.19C785.3,-1004.19 727.22,-1003.8 676.5,-1002"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M874,-2636C805.98,-2631.34 816.6,-2707.19 752,-2729 676.63,-2754.45 450.95,-2784.55 394,-2729 336.71,-2673.13 401.99,-1355.85 358,-1289 351.96,-1279.82 343.1,-1272.83 333.39,-1267.5"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="334.83,-1264.31 324.31,-1263.07 331.76,-1270.6 334.83,-1264.31"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M1037.37,-2697.87C1006.03,-2678.01 939.05,-2640.32 876,-2636"/>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M874,-2636C786.32,-2629.99 760.24,-2652.69 676.5,-2626"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M1050.74,-2697.68C1039.85,-2669.04 1012.9,-2595.55 998,-2532 985.64,-2479.28 998.94,-2330.59 962,-2291 935.29,-2262.38 903.72,-2299.64 876,-2272"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M1008.35,-2721.68C952.71,-2736.84 858.82,-2766.83 788,-2812 769.19,-2824 771.49,-2836.13 752,-2847 721.78,-2863.86 709.48,-2855.52 676.5,-2866"/>
</g>
<!-- sourcefile~cable_write.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~cable_write.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node32"><a xlink:href=".././sourcefile/cable_write.f90.html" xlink:title="cable_write.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="919,-2608 831,-2608 831,-2584 919,-2584 919,-2608"/>
<text text-anchor="middle" x="875" y="-2593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_write.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_write.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_write.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M1045.9,-2697.91C1030.27,-2679.01 997.51,-2642.53 962,-2622 951.87,-2616.14 940.29,-2611.48 928.98,-2607.83"/>
<polygon fill="#ff00e5" stroke="#ff00e5" points="929.74,-2604.4 919.16,-2604.86 927.72,-2611.1 929.74,-2604.4"/>
</g>
<!-- sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~cable_output.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#ff00e5" stroke-dasharray="5,2" d="M1051.27,-2697.97C1035.39,-2655.24 975.15,-2513.5 876,-2518"/>
</g>
<!-- sourcefile~casa_ncdf.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~casa_ncdf.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M451.82,-1957.97C432.24,-1947.3 406.58,-1929.72 394,-1906 329.66,-1784.66 435.41,-1402.45 358,-1289 351.74,-1279.82 342.68,-1272.82 332.83,-1267.49"/>
<polygon fill="#ff0098" stroke="#ff0098" points="334.15,-1264.24 323.63,-1263.05 331.11,-1270.55 334.15,-1264.24"/>
</g>
<!-- sourcefile~casa_ncdf.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~casa_ncdf.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M436.62,-1966.1C421.24,-1962.59 404.87,-1956.07 394,-1944 315.72,-1857.1 283.87,-1471.83 276.99,-1374.43"/>
<polygon fill="#ff0098" stroke="#ff0098" points="280.46,-1373.99 276.28,-1364.25 273.48,-1374.47 280.46,-1373.99"/>
</g>
<!-- sourcefile~casa_phenvar.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~casa_phenvar.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#ff004c" stroke-dasharray="5,2" d="M624.62,-1879.34C615.83,-1876.57 606.96,-1873.16 599,-1869 558.85,-1848.01 519.88,-1811.88 497.87,-1789.55"/>
<polygon fill="#ff004c" stroke="#ff004c" points="500.29,-1787.02 490.81,-1782.28 495.26,-1791.89 500.29,-1787.02"/>
</g>
<!-- sourcefile~cable_air.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~cable_air.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M452.7,-1012.07C433.35,-1022.88 407.56,-1040.61 394,-1064 333.94,-1167.59 437.65,-1241.6 358,-1331 354.87,-1334.51 351.25,-1337.47 347.3,-1339.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="345.45,-1336.98 338.21,-1344.72 348.7,-1343.19 345.45,-1336.98"/>
</g>
<!-- sourcefile~cable_air.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~cable_air.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M456.32,-987.84C437.91,-976.39 411.5,-957.79 394,-936 333.79,-861.03 295.92,-750.46 281.78,-703.92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="285.12,-702.84 278.91,-694.25 278.41,-704.83 285.12,-702.84"/>
</g>
<!-- sourcefile~cbl_snow_aging.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~cbl_snow_aging.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#ff3d00" stroke-dasharray="5,2" d="M1157.24,-145.22C1060.28,-132.48 852.08,-109.74 676.5,-122"/>
</g>
<!-- sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M1004.89,-2447.04C968.97,-2440.56 919.58,-2434.28 876,-2438"/>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M874,-2438C749.06,-2448.65 695.98,-2454.48 599,-2375 568.84,-2350.28 593.17,-2319.69 563,-2295 533.55,-2270.9 503.88,-2305.23 479.5,-2276"/>
</g>
<!-- sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M874,-2438C835,-2441.33 819.37,-2433.59 788,-2457 761.54,-2476.75 777.55,-2501.07 752,-2522 724.76,-2544.31 711.7,-2545.17 676.5,-2546"/>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M674.5,-2546C639.3,-2546.83 629.21,-2540.09 599,-2522 579.85,-2510.54 582.73,-2497.42 563,-2487 554.55,-2482.54 545.06,-2479.24 535.58,-2476.82"/>
<polygon fill="#ff7a00" stroke="#ff7a00" points="536.27,-2473.38 525.75,-2474.58 534.72,-2480.21 536.27,-2473.38"/>
</g>
<!-- sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M674.5,-2508C639.37,-2505.69 629.21,-2502.09 599,-2484 579.85,-2472.54 582.61,-2459.65 563,-2449 529.55,-2430.84 509.88,-2452.92 479.5,-2430"/>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M874,-2438C835,-2441.33 823.57,-2440.67 788,-2457 769.82,-2465.35 769.78,-2474.84 752,-2484 720.7,-2500.12 711.63,-2510.31 676.5,-2508"/>
</g>
<!-- sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_read.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_read.f90</title>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M1004.54,-2463.68C981.07,-2466.29 953.21,-2469.4 929.44,-2472.05"/>
<polygon fill="#ff7a00" stroke="#ff7a00" points="928.73,-2468.6 919.18,-2473.19 929.51,-2475.56 928.73,-2468.6"/>
</g>
<!-- sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~cable_initialise.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M1033.05,-2470.02C999.82,-2486.75 935.08,-2515.32 876,-2518"/>
<path fill="none" stroke="#ff7a00" stroke-dasharray="5,2" d="M874,-2518C834.36,-2519.8 825.03,-2527.73 788,-2542 771.31,-2548.43 768.49,-2553.07 752,-2560 743.18,-2563.71 733.62,-2567.3 724.38,-2570.58"/>
<polygon fill="#ff7a00" stroke="#ff7a00" points="723.19,-2567.29 714.89,-2573.87 725.49,-2573.9 723.19,-2567.29"/>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M874,-802C752.98,-821.47 701.33,-890.48 599,-823 565.09,-800.64 594.2,-765.01 563,-739 533.76,-714.63 512.79,-701.55 479.5,-720"/>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M874,-282C751.44,-258.82 702.27,-268.05 599,-338 539.5,-378.3 502.47,-459.13 487.35,-498.05"/>
<polygon fill="#ffb700" stroke="#ffb700" points="483.9,-497.26 483.66,-507.85 490.46,-499.73 483.9,-497.26"/>
</g>
<!-- sourcefile~cbl_snowdensity.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~cbl_snowdensity.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node47"><a xlink:href=".././sourcefile/cbl_snowdensity.f90.html" xlink:title="cbl_snowDensity.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1112.5,-592 1000.5,-592 1000.5,-568 1112.5,-568 1112.5,-592"/>
<text text-anchor="middle" x="1056.5" y="-577.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snowDensity.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowdensity.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowdensity.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M1180.73,-532.14C1156.89,-541.4 1123.85,-554.23 1097.98,-564.28"/>
<polygon fill="#ffb700" stroke="#ffb700" points="1096.51,-561.1 1088.45,-567.98 1099.04,-567.62 1096.51,-561.1"/>
</g>
<!-- sourcefile~cbl_stempv.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~cbl_stempv.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node48"><a xlink:href=".././sourcefile/cbl_stempv.f90.html" xlink:title="cbl_stempv.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="918.5,-452 831.5,-452 831.5,-428 918.5,-428 918.5,-452"/>
<text text-anchor="middle" x="875" y="-437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_stempv.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_stempv.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_stempv.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M1161.33,-507.94C1098.51,-492.98 991.97,-467.61 928.37,-452.47"/>
<polygon fill="#ffb700" stroke="#ffb700" points="929.08,-449.04 918.55,-450.13 927.46,-455.85 929.08,-449.04"/>
</g>
<!-- sourcefile~cbl_hyd_redistrib.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~cbl_hyd_redistrib.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node50"><a xlink:href=".././sourcefile/cbl_hyd_redistrib.f90.html" xlink:title="cbl_hyd_redistrib.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="733,-254 618,-254 618,-230 733,-230 733,-254"/>
<text text-anchor="middle" x="675.5" y="-239.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_hyd_redistrib.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_hyd_redistrib.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_hyd_redistrib.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M874,-282C823.43,-279.47 766.91,-267.02 727.34,-256.67"/>
<polygon fill="#ffb700" stroke="#ffb700" points="728.22,-253.28 717.65,-254.09 726.42,-260.04 728.22,-253.28"/>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M1207.47,-507.83C1196.24,-479.29 1164.4,-407.47 1115,-368 1026.8,-297.53 988.75,-287.64 876,-282"/>
</g>
<!-- sourcefile~cbl_snowaccum.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~cbl_snowaccum.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node51"><a xlink:href=".././sourcefile/cbl_snowaccum.f90.html" xlink:title="cbl_snowAccum.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="731,-894 620,-894 620,-870 731,-870 731,-894"/>
<text text-anchor="middle" x="675.5" y="-879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snowAccum.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowaccum.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowaccum.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M874,-802C815.46,-811.42 807.19,-834.33 752,-856 742.81,-859.61 732.88,-863.22 723.34,-866.56"/>
<polygon fill="#ffb700" stroke="#ffb700" points="721.91,-863.36 713.59,-869.93 724.19,-869.97 721.91,-863.36"/>
</g>
<!-- sourcefile~cbl_snowl_adjust.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~cbl_snowl_adjust.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node53"><a xlink:href=".././sourcefile/cbl_snowl_adjust.f90.html" xlink:title="cbl_snowl_adjust.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1114,-401 999,-401 999,-377 1114,-377 1114,-401"/>
<text text-anchor="middle" x="1056.5" y="-386.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snowl_adjust.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowl_adjust.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowl_adjust.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M1197.74,-507.91C1170.72,-485 1111.9,-435.12 1079.68,-407.81"/>
<polygon fill="#ffb700" stroke="#ffb700" points="1081.61,-404.86 1071.72,-401.06 1077.09,-410.2 1081.61,-404.86"/>
</g>
<!-- sourcefile~cbl_surfbv.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~cbl_surfbv.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node56"><a xlink:href=".././sourcefile/cbl_surfbv.f90.html" xlink:title="cbl_surfbv.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1097.5,-532 1015.5,-532 1015.5,-508 1097.5,-508 1097.5,-532"/>
<text text-anchor="middle" x="1056.5" y="-517.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_surfbv.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_surfbv.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_surfbv.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M1150.94,-520C1136.69,-520 1121.67,-520 1107.94,-520"/>
<polygon fill="#ffb700" stroke="#ffb700" points="1107.73,-516.5 1097.73,-520 1107.73,-523.5 1107.73,-516.5"/>
</g>
<!-- sourcefile~cbl_soilfreeze.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~cbl_soilfreeze.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node59"><a xlink:href=".././sourcefile/cbl_soilfreeze.f90.html" xlink:title="cbl_soilfreeze.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="725.5,-814 625.5,-814 625.5,-790 725.5,-790 725.5,-814"/>
<text text-anchor="middle" x="675.5" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_soilfreeze.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_soilfreeze.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_soilfreeze.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M874,-802C827.91,-809.42 774.98,-808.94 735.53,-806.88"/>
<polygon fill="#ffb700" stroke="#ffb700" points="735.73,-803.38 725.54,-806.3 735.33,-810.37 735.73,-803.38"/>
</g>
<!-- sourcefile~cbl_snowcheck.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node61" class="node">
<title>sourcefile~cbl_snowcheck.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node61"><a xlink:href=".././sourcefile/cbl_snowcheck.f90.html" xlink:title="cbl_snowCheck.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="730,-772 621,-772 621,-748 730,-748 730,-772"/>
<text text-anchor="middle" x="675.5" y="-757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snowCheck.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowcheck.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowcheck.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M874,-802C860.26,-804.21 787.6,-787.52 734.39,-774.53"/>
<polygon fill="#ffb700" stroke="#ffb700" points="734.91,-771.05 724.36,-772.07 733.24,-777.85 734.91,-771.05"/>
</g>
<!-- sourcefile~cbl_snowmelt.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node63" class="node">
<title>sourcefile~cbl_snowmelt.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node63"><a xlink:href=".././sourcefile/cbl_snowmelt.f90.html" xlink:title="cbl_snowMelt.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="725,-730 626,-730 626,-706 725,-706 725,-730"/>
<text text-anchor="middle" x="675.5" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snowMelt.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowmelt.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_snowmelt.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M874,-802C813.75,-811.69 808.81,-761.29 752,-739 746.56,-736.87 740.83,-734.86 735.05,-732.99"/>
<polygon fill="#ffb700" stroke="#ffb700" points="735.9,-729.6 725.32,-729.99 733.84,-736.28 735.9,-729.6"/>
</g>
<!-- sourcefile~cbl_remove_trans.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node66" class="node">
<title>sourcefile~cbl_remove_trans.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node66"><a xlink:href=".././sourcefile/cbl_remove_trans.f90.html" xlink:title="cbl_remove_trans.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="735.5,-688 615.5,-688 615.5,-664 735.5,-664 735.5,-688"/>
<text text-anchor="middle" x="675.5" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_remove_trans.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_remove_trans.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~cbl_soilsnow_main.f90&#45;&gt;sourcefile~cbl_remove_trans.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M1205.74,-532.18C1176.41,-587.44 1046.71,-811.38 876,-802"/>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M874,-802C803.37,-813.36 815.09,-730.73 752,-697 748.46,-695.11 744.73,-693.37 740.9,-691.78"/>
<polygon fill="#ffb700" stroke="#ffb700" points="741.83,-688.39 731.24,-688.12 739.35,-694.93 741.83,-688.39"/>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M617.27,-912.03C610.86,-909.56 604.62,-906.58 599,-903 578.26,-889.8 585.34,-871.27 563,-861 494.76,-829.61 454.34,-816.27 394,-861 332.63,-906.5 290.48,-1152.68 278.79,-1228.66"/>
<polygon fill="#cbff00" stroke="#cbff00" points="275.27,-1228.55 277.23,-1238.96 282.19,-1229.6 275.27,-1228.55"/>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M617.48,-917.18C553.12,-912.98 450.1,-917.5 394,-979 288.01,-1095.18 460.71,-1211.92 358,-1331 354.93,-1334.56 351.35,-1337.56 347.44,-1340.08"/>
<polygon fill="#cbff00" stroke="#cbff00" points="345.59,-1337.1 338.39,-1344.88 348.87,-1343.28 345.59,-1337.1"/>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M617.29,-915.71C610.41,-912.65 604.05,-908.53 599,-903 538.98,-837.28 628.93,-765.8 563,-706 501.46,-650.18 398.97,-656.62 334.43,-668.08"/>
<polygon fill="#cbff00" stroke="#cbff00" points="333.59,-664.67 324.41,-669.95 334.88,-671.55 333.59,-664.67"/>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_other_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cable_other_constants_mod.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M618.62,-911.96C595.77,-907.04 569.17,-901.31 545.39,-896.19"/>
<polygon fill="#cbff00" stroke="#cbff00" points="545.9,-892.72 535.39,-894.04 544.43,-899.56 545.9,-892.72"/>
</g>
<!-- sourcefile~cbl_hgtabove_snow.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~cbl_hgtabove_snow.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node52"><a xlink:href=".././sourcefile/cbl_hgtabove_snow.f90.html" xlink:title="cbl_hgtAbove_snow.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="543.5,-772 413.5,-772 413.5,-748 543.5,-748 543.5,-772"/>
<text text-anchor="middle" x="478.5" y="-757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_hgtAbove_snow.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cbl_hgtabove_snow.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cbl_hgtabove_snow.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M617.44,-915.04C610.62,-912.07 604.24,-908.15 599,-903 558.71,-863.34 603.78,-820.16 563,-781 559.91,-778.03 556.46,-775.46 552.77,-773.24"/>
<polygon fill="#cbff00" stroke="#cbff00" points="554.3,-770.09 543.8,-768.67 551.12,-776.33 554.3,-770.09"/>
</g>
<!-- sourcefile~cbl_lai_eff.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node60" class="node">
<title>sourcefile~cbl_lai_eff.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node60"><a xlink:href=".././sourcefile/cbl_lai_eff.f90.html" xlink:title="cbl_lai_eff.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="519.5,-814 437.5,-814 437.5,-790 519.5,-790 519.5,-814"/>
<text text-anchor="middle" x="478.5" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_lai_eff.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cbl_lai_eff.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~cable_roughness.f90&#45;&gt;sourcefile~cbl_lai_eff.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M617.41,-913.9C610.76,-911.11 604.42,-907.54 599,-903 570.66,-879.26 590.98,-852.17 563,-828 553.58,-819.86 541.62,-814.26 529.72,-810.42"/>
<polygon fill="#cbff00" stroke="#cbff00" points="530.37,-806.97 519.79,-807.59 528.45,-813.7 530.37,-806.97"/>
</g>
<!-- sourcefile~cbl_sinbet.f90&#45;&gt;sourcefile~cable_maths_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~cbl_sinbet.f90&#45;&gt;sourcefile~cable_maths_constants_mod.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1015.22,-2074.9C1002.24,-2075.19 987.27,-2075.52 972.04,-2075.86"/>
<polygon fill="#14ff00" stroke="#14ff00" points="971.95,-2072.36 962.03,-2076.08 972.1,-2079.36 971.95,-2072.36"/>
</g>
<!-- sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M417.83,-529.59C408.8,-533.4 400.39,-538.68 394,-546 370.72,-572.66 294.81,-1111.76 278.58,-1228.73"/>
<polygon fill="#00ff28" stroke="#00ff28" points="275.06,-1228.6 277.16,-1238.98 281.99,-1229.56 275.06,-1228.6"/>
</g>
<!-- sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M471.21,-532.42C454.97,-565.19 411.68,-657.06 394,-739 380.1,-803.42 400.01,-1280.22 358,-1331 354.87,-1334.79 351.16,-1337.94 347.07,-1340.57"/>
<polygon fill="#00ff28" stroke="#00ff28" points="345.43,-1337.48 338.22,-1345.25 348.7,-1343.67 345.43,-1337.48"/>
</g>
<!-- sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~cbl_soilsnow_data.f90&#45;&gt;sourcefile~cable_phys_constants_mod.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M423.41,-532.04C413.18,-535.62 402.9,-540.19 394,-546 346.9,-576.72 307.57,-631.26 288.29,-661.08"/>
<polygon fill="#00ff28" stroke="#00ff28" points="285.14,-659.52 282.74,-669.84 291.05,-663.26 285.14,-659.52"/>
</g>
<!-- sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M830.75,-2607.12C781.55,-2618.98 704.42,-2634.9 676.5,-2626"/>
</g>
<!-- sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M674.5,-2866C590.18,-2892.8 546.21,-2884.11 479.5,-2826"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M830.78,-2599.59C815.18,-2603.07 798.77,-2609.66 788,-2622 721.38,-2698.27 820.4,-2772.31 752,-2847 728.63,-2872.52 709.48,-2855.52 676.5,-2866"/>
</g>
<!-- sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~cable_write.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M830.66,-2593.81C801.48,-2592.33 762.76,-2590.37 731.43,-2588.78"/>
<polygon fill="#00ff66" stroke="#00ff66" points="731.27,-2585.27 721.11,-2588.26 730.92,-2592.26 731.27,-2585.27"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M674.5,-2276C636.82,-2254.6 507.25,-2309.28 479.5,-2276"/>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M477.5,-2276C392.96,-2174.63 416.09,-2121.13 394,-1991 380.93,-1914 401.79,-1353.67 358,-1289 351.77,-1279.8 342.73,-1272.79 332.88,-1267.46"/>
<polygon fill="#00ffa3" stroke="#00ffa3" points="334.21,-1264.21 323.68,-1263.01 331.16,-1270.51 334.21,-1264.21"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M836.21,-2354.32C818.93,-2352.36 799.74,-2346.82 788,-2333 721.03,-2254.19 817.71,-1948.86 752,-1869 746.1,-1861.82 737.97,-1856.98 729.22,-1853.74"/>
<polygon fill="#00ffa3" stroke="#00ffa3" points="730.16,-1850.37 719.57,-1850.82 728.13,-1857.07 730.16,-1850.37"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M674.5,-2470C628.63,-2479.91 575.27,-2479.09 535.97,-2476.25"/>
<polygon fill="#00ffa3" stroke="#00ffa3" points="536.03,-2472.74 525.79,-2475.45 535.48,-2479.72 536.03,-2472.74"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M836.21,-2351.76C819.96,-2349.15 801.61,-2343.79 788,-2333 760.28,-2311.02 768.4,-2293.35 752,-2262 729.89,-2219.72 703.23,-2170.74 688.24,-2143.36"/>
<polygon fill="#00ffa3" stroke="#00ffa3" points="691.15,-2141.39 683.27,-2134.3 685.01,-2144.76 691.15,-2141.39"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M674.5,-2470C669.1,-2471.17 483.91,-2433.33 479.5,-2430"/>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M860.49,-2366.21C830.29,-2392.46 753.85,-2453.29 676.5,-2470"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M674.5,-2276C643.88,-2258.61 625.03,-2275.71 599,-2252 519.37,-2179.45 490.93,-2045.12 482.54,-1992.23"/>
<polygon fill="#00ffa3" stroke="#00ffa3" points="485.98,-1991.6 481.04,-1982.23 479.06,-1992.64 485.98,-1991.6"/>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M836.18,-2346.76C820.97,-2343.34 803.41,-2338.73 788,-2333 735.83,-2313.6 724.89,-2303.49 676.5,-2276"/>
</g>
<!-- sourcefile~popluc.f90&#45;&gt;sourcefile~cable_luc_expt.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~popluc.f90&#45;&gt;sourcefile~cable_luc_expt.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M836.39,-2354C810.54,-2354 775.49,-2354 744.8,-2354"/>
<polygon fill="#00ffa3" stroke="#00ffa3" points="744.57,-2350.5 734.57,-2354 744.57,-2357.5 744.57,-2350.5"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M674.5,-2238C638.02,-2226.71 620.83,-2228.33 599,-2197 535.31,-2105.63 621.97,-2043.48 563,-1949 539.21,-1910.88 500.6,-1931.67 479.5,-1892"/>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M825.3,-2299.99C812.87,-2296.2 799.71,-2291.52 788,-2286 770.61,-2277.8 769.33,-2270.33 752,-2262 720.26,-2246.75 710.13,-2248.41 676.5,-2238"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M859.75,-2299.92C839.83,-2282.1 804.27,-2246.65 788,-2208 758.61,-2138.18 800.96,-1926.81 752,-1869 746.12,-1862.06 738.17,-1857.31 729.62,-1854.09"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="730.38,-1850.66 719.8,-1851.05 728.32,-1857.35 730.38,-1850.66"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M814.23,-2321.45C805.05,-2324.33 795.99,-2328.09 788,-2333 767.05,-2345.87 772.21,-2360.99 752,-2375 678.51,-2425.94 647.71,-2415.37 563,-2444 552.1,-2447.69 540.33,-2451.47 529.17,-2454.97"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="528.06,-2451.65 519.55,-2457.96 530.14,-2458.33 528.06,-2451.65"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M814.2,-2300.34C804.83,-2296.77 795.71,-2292.1 788,-2286 763.01,-2266.23 774.97,-2246.09 752,-2224 696.54,-2170.67 643.04,-2206.09 599,-2143 530.96,-2045.54 608.91,-1987.63 563,-1878 548.37,-1843.07 519.47,-1809.67 499.82,-1789.5"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="502.07,-1786.8 492.53,-1782.19 497.12,-1791.74 502.07,-1786.8"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M814.44,-2302.72C804.59,-2298.9 795.25,-2293.53 788,-2286 744.05,-2240.33 795.07,-2194.5 752,-2148 747.25,-2142.88 741.45,-2138.76 735.19,-2135.46"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="736.31,-2132.12 725.76,-2131.17 733.42,-2138.5 736.31,-2132.12"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M477.5,-2430C442.75,-2403.85 417.42,-2415.64 394,-2379 282.36,-2204.31 275.71,-1508.57 275.48,-1374.44"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="278.98,-1374.17 275.47,-1364.17 271.98,-1374.18 278.98,-1374.17"/>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M814.38,-2303.28C755.95,-2297.67 666.12,-2297.07 599,-2333 576.11,-2345.25 582.39,-2361.74 563,-2379 530.52,-2407.92 514.25,-2456.15 479.5,-2430"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M861.49,-2299.99C843.07,-2281.7 808.62,-2245.06 788,-2208 763.6,-2164.15 768.45,-2148.4 752,-2101 727.98,-2031.79 698.45,-1950.24 684.51,-1911.95"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="687.72,-1910.54 681.01,-1902.34 681.14,-1912.93 687.72,-1910.54"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_luc_expt.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_luc_expt.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M817.4,-2324.04C794.16,-2328.98 767.08,-2334.74 742.91,-2339.88"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="742.16,-2336.46 733.1,-2341.96 743.61,-2343.31 742.16,-2336.46"/>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M814.44,-2316.9C804.47,-2320.23 795.08,-2325.31 788,-2333 718.8,-2408.14 817.67,-2481.75 752,-2560 746.3,-2566.79 738.74,-2571.81 730.6,-2575.52"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="729.28,-2572.28 721.24,-2579.18 731.82,-2578.8 729.28,-2572.28"/>
</g>
<!-- sourcefile~cable_pft_params.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~cable_pft_params.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node49"><a xlink:href=".././sourcefile/cable_pft_params.f90.html" xlink:title="cable_pft_params.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="538.5,-2370 418.5,-2370 418.5,-2346 538.5,-2346 538.5,-2370"/>
<text text-anchor="middle" x="478.5" y="-2355.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_pft_params.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_pft_params.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_pft_params.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M674.5,-2238C640.87,-2227.59 625.57,-2238.9 599,-2262 571.09,-2286.26 591.64,-2313.61 563,-2337 558.48,-2340.69 553.39,-2343.75 548.01,-2346.28"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="546.69,-2343.04 538.74,-2350.05 549.33,-2349.52 546.69,-2343.04"/>
</g>
<!-- sourcefile~cable_soil_params.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node64" class="node">
<title>sourcefile~cable_soil_params.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node64"><a xlink:href=".././sourcefile/cable_soil_params.f90.html" xlink:title="cable_soil_params.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="540.5,-2328 416.5,-2328 416.5,-2304 540.5,-2304 540.5,-2328"/>
<text text-anchor="middle" x="478.5" y="-2313.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_soil_params.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_soil_params.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~cable_parameters.f90&#45;&gt;sourcefile~cable_soil_params.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M674.5,-2238C640.87,-2227.59 630.16,-2245.6 599,-2262 581.06,-2271.44 580.97,-2280.61 563,-2290 555.28,-2294.04 546.82,-2297.57 538.34,-2300.62"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="537.15,-2297.33 528.81,-2303.87 539.4,-2303.96 537.15,-2297.33"/>
</g>
<!-- sourcefile~cbl_rhoch.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~cbl_rhoch.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node57"><a xlink:href=".././sourcefile/cbl_rhoch.f90.html" xlink:title="cbl_rhoch.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1097,-936 1016,-936 1016,-912 1097,-912 1097,-936"/>
<text text-anchor="middle" x="1056.5" y="-921.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_rhoch.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_init_radiation.f90&#45;&gt;sourcefile~cbl_rhoch.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~cbl_init_radiation.f90&#45;&gt;sourcefile~cbl_rhoch.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M1165.64,-952C1147.11,-947.2 1125.73,-941.67 1106.91,-936.79"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="1107.59,-933.35 1097.03,-934.24 1105.84,-940.13 1107.59,-933.35"/>
</g>
<!-- sourcefile~cbl_spitter.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node62" class="node">
<title>sourcefile~cbl_spitter.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node62"><a xlink:href=".././sourcefile/cbl_spitter.f90.html" xlink:title="cbl_spitter.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1097.5,-978 1015.5,-978 1015.5,-954 1097.5,-954 1097.5,-978"/>
<text text-anchor="middle" x="1056.5" y="-963.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_spitter.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_init_radiation.f90&#45;&gt;sourcefile~cbl_spitter.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~cbl_init_radiation.f90&#45;&gt;sourcefile~cbl_spitter.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M1155.35,-964.73C1139.81,-964.93 1123.08,-965.15 1107.92,-965.35"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="1107.67,-961.85 1097.71,-965.48 1107.76,-968.85 1107.67,-961.85"/>
</g>
<!-- sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M830.64,-2489.55C816.84,-2493.64 801.62,-2498.58 788,-2504 771.38,-2510.61 768.57,-2515.27 752,-2522 719.38,-2535.25 711.7,-2545.17 676.5,-2546"/>
</g>
<!-- sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M830.69,-2490.07C790.83,-2499.86 729.97,-2511.52 676.5,-2508"/>
</g>
<!-- sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_abort.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~cable_read.f90&#45;&gt;sourcefile~cable_abort.f90</title>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M830.99,-2484.73C816.3,-2488.58 800.45,-2494.6 788,-2504 764.38,-2521.82 775.27,-2541.73 752,-2560 745.64,-2564.99 738.27,-2569.06 730.66,-2572.36"/>
<polygon fill="#00a3ff" stroke="#00a3ff" points="729.36,-2569.11 721.33,-2576.02 731.92,-2575.63 729.36,-2569.11"/>
</g>
<!-- sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M655.49,-2341.94C633.85,-2328.7 597.09,-2307.64 563,-2295 527.32,-2281.76 503.88,-2305.23 479.5,-2276"/>
</g>
<!-- sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M623.08,-2366.02C614.45,-2369.57 606.03,-2374.14 599,-2380 573.93,-2400.9 588.37,-2423.48 563,-2444 555.03,-2450.45 545.46,-2455.3 535.69,-2458.95"/>
<polygon fill="#0066ff" stroke="#0066ff" points="534.27,-2455.74 525.89,-2462.22 536.49,-2462.37 534.27,-2455.74"/>
</g>
<!-- sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M616.39,-2365.61C610.46,-2367.23 604.57,-2369.03 599,-2371 543.16,-2390.76 526.83,-2465.61 479.5,-2430"/>
</g>
<!-- sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~cable_luc_expt.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M655.34,-2341.93C638.45,-2330.41 614.21,-2311.65 599,-2290 529.46,-2191.04 494.88,-2046.66 483.69,-1992.03"/>
<polygon fill="#0066ff" stroke="#0066ff" points="487.09,-1991.19 481.7,-1982.07 480.22,-1992.56 487.09,-1991.19"/>
</g>
<!-- sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M834.86,-1778.88C819.78,-1783.06 802.68,-1788.74 788,-1796 770.31,-1804.75 769.52,-1812.91 752,-1822 744.48,-1825.9 736.25,-1829.42 728.08,-1832.52"/>
<polygon fill="#1400ff" stroke="#1400ff" points="726.77,-1829.27 718.56,-1835.96 729.15,-1835.85 726.77,-1829.27"/>
</g>
<!-- sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M674.5,-1770C631.76,-1763.94 583.22,-1763.92 545.26,-1765.42"/>
<polygon fill="#1400ff" stroke="#1400ff" points="544.68,-1761.94 534.84,-1765.88 544.99,-1768.94 544.68,-1761.94"/>
</g>
<!-- sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M851.05,-1782.18C831.88,-1793.38 805.01,-1811.63 788,-1834 770.93,-1856.44 706.64,-2036.42 684.25,-2099.92"/>
<polygon fill="#1400ff" stroke="#1400ff" points="680.82,-2099.12 680.8,-2109.71 687.42,-2101.44 680.82,-2099.12"/>
</g>
<!-- sourcefile~casa_cnp.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~casa_cnp.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M674.5,-1770C575.1,-1755.91 572.27,-1694.37 479.5,-1656"/>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M834.8,-1773.22C794.78,-1775.76 730.99,-1777.72 676.5,-1770"/>
</g>
<!-- sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~casa_cnp.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M834.76,-1774.9C818.81,-1778.55 801.09,-1784.91 788,-1796 760.4,-1819.39 779.85,-1845.92 752,-1869 747.12,-1873.04 741.51,-1876.31 735.61,-1878.95"/>
<polygon fill="#1400ff" stroke="#1400ff" points="734.21,-1875.74 726.15,-1882.61 736.74,-1882.27 734.21,-1875.74"/>
</g>
<!-- sourcefile~cbl_snow_albedo.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~cbl_snow_albedo.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node58"><a xlink:href=".././sourcefile/cbl_snow_albedo.f90.html" xlink:title="cbl_snow_albedo.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1115,-894 998,-894 998,-870 1115,-870 1115,-894"/>
<text text-anchor="middle" x="1056.5" y="-879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_snow_albedo.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_albedo.f90&#45;&gt;sourcefile~cbl_snow_albedo.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~cbl_albedo.f90&#45;&gt;sourcefile~cbl_snow_albedo.f90</title>
<path fill="none" stroke="#5100ff" stroke-dasharray="5,2" d="M1169.78,-911.07C1152.51,-906.6 1132.28,-901.36 1113.79,-896.57"/>
<polygon fill="#5100ff" stroke="#5100ff" points="1114.57,-893.16 1104.01,-894.04 1112.82,-899.94 1114.57,-893.16"/>
</g>
<!-- sourcefile~grid_constants_cbl.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~grid_constants_cbl.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node54"><a xlink:href=".././sourcefile/grid_constants_cbl.f90.html" xlink:title="grid_constants_cbl.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="336.5,-1322 212.5,-1322 212.5,-1298 336.5,-1298 336.5,-1322"/>
<text text-anchor="middle" x="274.5" y="-1307.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">grid_constants_cbl.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_other_constants_mod.f90&#45;&gt;sourcefile~grid_constants_cbl.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~cable_other_constants_mod.f90&#45;&gt;sourcefile~grid_constants_cbl.f90</title>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M452.15,-894.21C432.76,-904.98 407.19,-922.61 394,-946 322.4,-1072.98 443.24,-1153.75 358,-1272 351.43,-1281.11 342.14,-1288.09 332.14,-1293.42"/>
<polygon fill="#8e00ff" stroke="#8e00ff" points="330.34,-1290.41 322.82,-1297.87 333.35,-1296.72 330.34,-1290.41"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M846.36,-1677.92C766.3,-1641.7 531.18,-1526.5 394,-1366 369.46,-1337.28 384.79,-1315.64 358,-1289 348.82,-1279.88 337.05,-1272.7 325.29,-1267.15"/>
<polygon fill="#ff00f4" stroke="#ff00f4" points="326.48,-1263.85 315.92,-1263.05 323.68,-1270.27 326.48,-1263.85"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_parm.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_parm.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M817.99,-1698.57C806.99,-1702.42 796.3,-1707.98 788,-1716 752.23,-1750.58 787.11,-1786.74 752,-1822 745.67,-1828.35 737.73,-1833.15 729.38,-1836.78"/>
<polygon fill="#ff00f4" stroke="#ff00f4" points="727.96,-1833.58 719.85,-1840.4 730.45,-1840.12 727.96,-1833.58"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M674.5,-1808C651.13,-1833.52 621.06,-1800.34 599,-1827 511.44,-1932.82 647.6,-2335.8 563,-2444 556.05,-2452.88 546.11,-2458.8 535.49,-2462.72"/>
<polygon fill="#ff00f4" stroke="#ff00f4" points="534.13,-2459.48 525.62,-2465.8 536.21,-2466.17 534.13,-2459.48"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_dimension.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_dimension.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M817.9,-1701.38C745.83,-1715.99 620.97,-1741.31 544.74,-1756.77"/>
<polygon fill="#ff00f4" stroke="#ff00f4" points="543.88,-1753.37 534.77,-1758.79 545.27,-1760.23 543.88,-1753.37"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_variable.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_variable.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M846.59,-1702C827.28,-1711.87 802.39,-1727.69 788,-1749 746.71,-1810.12 772.46,-1840.14 752,-1911 731.67,-1981.38 700.4,-2062.38 685.28,-2100.3"/>
<polygon fill="#ff00f4" stroke="#ff00f4" points="681.94,-2099.22 681.47,-2109.81 688.44,-2101.83 681.94,-2099.22"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M817.96,-1694.61C739.49,-1698.99 593.68,-1699.5 479.5,-1656"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_ncdf.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_ncdf.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M817.57,-1700.08C806.97,-1703.83 796.55,-1708.96 788,-1716 761.6,-1737.73 778.25,-1762.08 752,-1784 724.98,-1806.57 700.28,-1782.03 676.5,-1808"/>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M674.5,-1808C651.13,-1833.52 625.58,-1804.84 599,-1827 569.36,-1851.71 587.03,-1875.81 563,-1906 548.18,-1924.62 526.82,-1940.86 509.41,-1952.33"/>
<polygon fill="#ff00f4" stroke="#ff00f4" points="507.27,-1949.54 500.72,-1957.87 511.04,-1955.44 507.27,-1949.54"/>
</g>
<!-- sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_phenvar.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~cable_phenology.f90&#45;&gt;sourcefile~casa_phenvar.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M847.45,-1702.11C828.31,-1712.13 803.26,-1728.09 788,-1749 755.17,-1793.98 791.77,-1830.03 752,-1869 747.35,-1873.56 741.79,-1877.15 735.83,-1879.97"/>
<polygon fill="#ff00f4" stroke="#ff00f4" points="734.2,-1876.85 726.21,-1883.81 736.79,-1883.36 734.2,-1876.85"/>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M846.55,-1201.91C822.24,-1191.91 785.52,-1178.48 752,-1173 632.05,-1153.38 593.93,-1155.05 479.5,-1196"/>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M477.5,-1196C441.71,-1207.63 430.46,-1200.7 394,-1210 367.36,-1216.79 338.16,-1226.86 315.41,-1235.32"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="313.89,-1232.16 305.76,-1238.96 316.36,-1238.71 313.89,-1232.16"/>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M865.31,-1226.2C825.53,-1282.85 660.11,-1527.13 599,-1756 579.25,-1829.96 609.97,-2383.56 563,-2444 556.08,-2452.9 546.15,-2458.83 535.54,-2462.76"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="534.17,-2459.51 525.66,-2465.83 536.25,-2466.2 534.17,-2459.51"/>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M477.5,-1196C441.71,-1207.63 422.19,-1185.08 394,-1210 351.96,-1247.16 398.46,-1292.13 358,-1331 354.82,-1334.05 351.27,-1336.68 347.46,-1338.94"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="345.58,-1335.96 338.2,-1343.57 348.71,-1342.23 345.58,-1335.96"/>
</g>
<!-- sourcefile~cable_sli_solve.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~cable_sli_solve.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node55"><a xlink:href=".././sourcefile/cable_sli_solve.f90.html" xlink:title="cable_sli_solve.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="728.5,-1286 622.5,-1286 622.5,-1262 728.5,-1262 728.5,-1286"/>
<text text-anchor="middle" x="675.5" y="-1271.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_sli_solve.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_solve.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_solve.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M834.03,-1226.14C802.74,-1235.65 759.07,-1248.91 725.65,-1259.07"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="724.62,-1255.72 716.07,-1261.98 726.66,-1262.42 724.62,-1255.72"/>
</g>
<!-- sourcefile~cable_sli_numbers.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node65" class="node">
<title>sourcefile~cable_sli_numbers.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node65"><a xlink:href=".././sourcefile/cable_sli_numbers.f90.html" xlink:title="cable_sli_numbers.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="540.5,-1286 416.5,-1286 416.5,-1262 540.5,-1262 540.5,-1286"/>
<text text-anchor="middle" x="478.5" y="-1271.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_sli_numbers.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_numbers.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_numbers.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M822.48,-1220.79C767.17,-1228.2 676.75,-1240.66 599,-1253 583.38,-1255.48 566.65,-1258.31 550.8,-1261.07"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="549.78,-1257.7 540.53,-1262.87 550.99,-1264.59 549.78,-1257.7"/>
</g>
<!-- sourcefile~cable_sli_roots.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node67" class="node">
<title>sourcefile~cable_sli_roots.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node67"><a xlink:href=".././sourcefile/cable_sli_roots.f90.html" xlink:title="cable_sli_roots.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="728.5,-1206 622.5,-1206 622.5,-1182 728.5,-1182 728.5,-1206"/>
<text text-anchor="middle" x="675.5" y="-1191.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_sli_roots.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_roots.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~cable_sli_main.f90&#45;&gt;sourcefile~cable_sli_roots.f90</title>
<path fill="none" stroke="#ff00b7" stroke-dasharray="5,2" d="M822.37,-1208.77C796.73,-1206.17 765.55,-1203.02 738.61,-1200.29"/>
<polygon fill="#ff00b7" stroke="#ff00b7" points="738.82,-1196.79 728.52,-1199.27 738.11,-1203.76 738.82,-1196.79"/>
</g>
<!-- sourcefile~cable_abort.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~cable_abort.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M629.75,-2575.92C618.98,-2572.11 608,-2566.94 599,-2560 576.16,-2542.38 585.16,-2524.47 563,-2506 553.15,-2497.78 541.13,-2491.16 529.32,-2485.94"/>
<polygon fill="#ff007a" stroke="#ff007a" points="530.52,-2482.64 519.94,-2482.05 527.84,-2489.11 530.52,-2482.64"/>
</g>
<!-- sourcefile~cable_abort.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~cable_abort.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M629.76,-2584.94C566.33,-2580.8 451.6,-2563.11 394,-2491 321.52,-2400.26 282.63,-1526.26 276.39,-1374.43"/>
<polygon fill="#ff007a" stroke="#ff007a" points="279.88,-1373.91 275.97,-1364.06 272.88,-1374.19 279.88,-1373.91"/>
</g>
<!-- sourcefile~cbl_snowdensity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~cbl_snowdensity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1000.21,-586.46C913.49,-594.99 740.78,-605.52 599,-574 566.24,-566.72 531.58,-549.91 508.07,-536.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="509.76,-533.9 499.33,-532.05 506.33,-540 509.76,-533.9"/>
</g>
<!-- sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M854.94,-427.88C780.43,-380.86 511.44,-214.42 479.5,-242"/>
</g>
<!-- sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M674.5,-480C629.49,-486.81 579.17,-497.2 540.92,-505.69"/>
<polygon fill="#ff4800" stroke="#ff4800" points="539.96,-502.31 530.97,-507.91 541.49,-509.15 539.96,-502.31"/>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M831.45,-449.89C791.6,-458.85 730.29,-471.86 676.5,-480"/>
</g>
<!-- sourcefile~cbl_trimb.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node68" class="node">
<title>sourcefile~cbl_trimb.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node68"><a xlink:href=".././sourcefile/cbl_trimb.f90.html" xlink:title="cbl_trimb.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="714.5,-532 636.5,-532 636.5,-508 714.5,-508 714.5,-532"/>
<text text-anchor="middle" x="675.5" y="-517.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_trimb.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_trimb.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_trimb.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M848.56,-452.02C824.07,-463.41 785.85,-480.71 752,-494 742.81,-497.61 732.88,-501.22 723.34,-504.56"/>
<polygon fill="#ff4800" stroke="#ff4800" points="721.91,-501.36 713.59,-507.93 724.19,-507.97 721.91,-501.36"/>
</g>
<!-- sourcefile~cbl_conductivity.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node70" class="node">
<title>sourcefile~cbl_conductivity.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node70"><a xlink:href=".././sourcefile/cbl_conductivity.f90.html" xlink:title="cbl_conductivity.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="729.5,-452 621.5,-452 621.5,-428 729.5,-428 729.5,-452"/>
<text text-anchor="middle" x="675.5" y="-437.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_conductivity.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_conductivity.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_conductivity.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M831.15,-440C804.56,-440 769.91,-440 740.15,-440"/>
<polygon fill="#ff4800" stroke="#ff4800" points="739.84,-436.5 729.84,-440 739.84,-443.5 739.84,-436.5"/>
</g>
<!-- sourcefile~cbl_oldconductivity.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node71" class="node">
<title>sourcefile~cbl_oldconductivity.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node71"><a xlink:href=".././sourcefile/cbl_oldconductivity.f90.html" xlink:title="cbl_Oldconductivity.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="737.5,-410 613.5,-410 613.5,-386 737.5,-386 737.5,-410"/>
<text text-anchor="middle" x="675.5" y="-395.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_Oldconductivity.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_oldconductivity.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~cbl_stempv.f90&#45;&gt;sourcefile~cbl_oldconductivity.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M831.15,-430.89C805.47,-425.43 772.28,-418.37 743.23,-412.19"/>
<polygon fill="#ff4800" stroke="#ff4800" points="743.66,-408.7 733.15,-410.05 742.2,-415.55 743.66,-408.7"/>
</g>
<!-- sourcefile~cable_pft_params.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~cable_pft_params.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M418.14,-2352.55C408.97,-2349.23 400.42,-2344.29 394,-2337 327.98,-2262.04 284.31,-1514.11 276.69,-1374.41"/>
<polygon fill="#ff9100" stroke="#ff9100" points="280.17,-1373.9 276.13,-1364.1 273.18,-1374.27 280.17,-1373.9"/>
</g>
<!-- sourcefile~cable_pft_params.f90&#45;&gt;sourcefile~grid_constants_cbl.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~cable_pft_params.f90&#45;&gt;sourcefile~grid_constants_cbl.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M418.46,-2353.3C409.02,-2349.94 400.3,-2344.79 394,-2337 323.66,-2250.04 428.21,-1418.07 358,-1331 354.61,-1326.79 350.5,-1323.36 345.95,-1320.57"/>
<polygon fill="#ff9100" stroke="#ff9100" points="347.25,-1317.3 336.74,-1315.94 344.11,-1323.55 347.25,-1317.3"/>
</g>
<!-- sourcefile~cbl_hyd_redistrib.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~cbl_hyd_redistrib.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M640.28,-229.93C597.3,-217.18 523.83,-203.72 479.5,-242"/>
</g>
<!-- sourcefile~cbl_hyd_redistrib.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~cbl_hyd_redistrib.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M621.57,-254.12C613.39,-257.65 605.51,-262.18 599,-268 527.04,-332.38 494.68,-449.37 483.89,-497.95"/>
<polygon fill="#ffda00" stroke="#ffda00" points="480.46,-497.23 481.8,-507.74 487.31,-498.69 480.46,-497.23"/>
</g>
<!-- sourcefile~cbl_snowaccum.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~cbl_snowaccum.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M619.67,-870.13C612,-866.58 604.78,-861.98 599,-856 561.17,-816.9 602.88,-776.01 563,-739 535.1,-713.11 512.84,-701.65 479.5,-720"/>
</g>
<!-- sourcefile~cbl_snowaccum.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~cbl_snowaccum.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#daff00" stroke-dasharray="5,2" d="M651.54,-869.81C634.47,-859.56 611.97,-843.34 599,-823 560.96,-763.38 588.64,-733.91 563,-668 544.26,-619.83 512.07,-568.28 493.61,-540.53"/>
<polygon fill="#daff00" stroke="#daff00" points="496.4,-538.41 487.91,-532.07 490.59,-542.32 496.4,-538.41"/>
</g>
<!-- sourcefile~cbl_snowl_adjust.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~cbl_snowl_adjust.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1016.79,-376.93C935.04,-353.72 740.66,-310.77 599,-377 545.08,-402.21 506.94,-465.04 489.75,-498.39"/>
<polygon fill="#48ff00" stroke="#48ff00" points="486.43,-497.22 485.09,-507.73 492.69,-500.34 486.43,-497.22"/>
</g>
<!-- sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_iovars.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_iovars.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M670.88,-1286.14C658.24,-1329.06 615.98,-1477.9 599,-1604 586.53,-1696.58 619.97,-2369.96 563,-2444 556.12,-2452.94 546.21,-2458.88 535.6,-2462.81"/>
<polygon fill="#00ff48" stroke="#00ff48" points="534.23,-2459.56 525.73,-2465.88 536.31,-2466.25 534.23,-2459.56"/>
</g>
<!-- sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M622.34,-1284.2C551.94,-1297.96 426.25,-1322.53 347.07,-1338.01"/>
<polygon fill="#00ff48" stroke="#00ff48" points="346.31,-1334.59 337.17,-1339.94 347.66,-1341.46 346.31,-1334.59"/>
</g>
<!-- sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_sli_numbers.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~cable_sli_solve.f90&#45;&gt;sourcefile~cable_sli_numbers.f90</title>
<path fill="none" stroke="#00ff48" stroke-dasharray="5,2" d="M622.5,-1274C600.48,-1274 574.48,-1274 550.73,-1274"/>
<polygon fill="#00ff48" stroke="#00ff48" points="550.7,-1270.5 540.7,-1274 550.7,-1277.5 550.7,-1270.5"/>
</g>
<!-- sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M477.5,-720C444.16,-738.35 420.96,-712.14 394,-739 322.56,-810.17 286.14,-1140.16 277.53,-1228.95"/>
<polygon fill="#00ff91" stroke="#00ff91" points="274.04,-1228.69 276.58,-1238.98 281.01,-1229.36 274.04,-1228.69"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1015.45,-528.83C934.82,-547.27 747.88,-593.3 599,-655 543.15,-678.15 532.46,-690.84 479.5,-720"/>
</g>
<!-- sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1015.24,-509.03C945.85,-491.61 799.33,-461.42 676.5,-480"/>
</g>
<!-- sourcefile~cbl_smoisturev.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_node69" class="node">
<title>sourcefile~cbl_smoisturev.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~EfferentGraph_node69"><a xlink:href=".././sourcefile/cbl_smoisturev.f90.html" xlink:title="cbl_smoisturev.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="927,-532 823,-532 823,-508 927,-508 927,-532"/>
<text text-anchor="middle" x="875" y="-517.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cbl_smoisturev.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cbl_smoisturev.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~cbl_surfbv.f90&#45;&gt;sourcefile~cbl_smoisturev.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1015.22,-520C992.22,-520 962.93,-520 937.15,-520"/>
<polygon fill="#00ff91" stroke="#00ff91" points="937.09,-516.5 927.09,-520 937.09,-523.5 937.09,-516.5"/>
</g>
<!-- sourcefile~cbl_soilfreeze.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~cbl_soilfreeze.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M625.18,-792.82C616.06,-789.89 606.92,-786.04 599,-781 578.26,-767.8 584.05,-751.7 563,-739 530.41,-719.34 512.84,-701.65 479.5,-720"/>
</g>
<!-- sourcefile~cbl_soilfreeze.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~cbl_soilfreeze.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M625.27,-795.84C615.62,-792.69 606.25,-787.99 599,-781 561.04,-744.43 584.06,-716.32 563,-668 542.35,-620.62 510.86,-568.77 493.03,-540.77"/>
<polygon fill="#0091ff" stroke="#0091ff" points="495.9,-538.75 487.55,-532.22 490.01,-542.53 495.9,-538.75"/>
</g>
<!-- sourcefile~cbl_snowcheck.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~cbl_snowcheck.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M630.89,-747.96C577.53,-733.71 492.63,-712.77 479.5,-720"/>
</g>
<!-- sourcefile~cbl_snowcheck.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~cbl_snowcheck.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M620.99,-751.16C613.07,-748.21 605.42,-744.26 599,-739 571.63,-716.58 579.7,-699.19 563,-668 538.48,-622.2 508.19,-569.38 491.66,-540.87"/>
<polygon fill="#0000ff" stroke="#0000ff" points="494.66,-539.07 486.61,-532.18 488.61,-542.58 494.66,-539.07"/>
</g>
<!-- sourcefile~cbl_snowmelt.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~cbl_snowmelt.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#9100ff" stroke-dasharray="5,2" d="M625.6,-706.29C584.08,-699.08 524.28,-695.35 479.5,-720"/>
</g>
<!-- sourcefile~cbl_snowmelt.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~cbl_snowmelt.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#9100ff" stroke-dasharray="5,2" d="M625.88,-709.92C616.4,-706.89 606.95,-702.72 599,-697 542.07,-656 504.02,-578.92 488.03,-541.49"/>
<polygon fill="#9100ff" stroke="#9100ff" points="491.18,-539.94 484.11,-532.04 484.71,-542.62 491.18,-539.94"/>
</g>
<!-- sourcefile~cable_soil_params.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~cable_soil_params.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M416.32,-2306.08C407.8,-2302.29 399.95,-2297.1 394,-2290 272.76,-2145.26 273.73,-1503.15 275.17,-1374.49"/>
<polygon fill="#da00ff" stroke="#da00ff" points="278.67,-1374.31 275.3,-1364.27 271.67,-1374.22 278.67,-1374.31"/>
</g>
<!-- sourcefile~cable_soil_params.f90&#45;&gt;sourcefile~grid_constants_cbl.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~cable_soil_params.f90&#45;&gt;sourcefile~grid_constants_cbl.f90</title>
<path fill="none" stroke="#da00ff" stroke-dasharray="5,2" d="M416.18,-2306.72C407.57,-2302.86 399.72,-2297.48 394,-2290 329.19,-2205.32 425.01,-1413.94 358,-1331 354.6,-1326.8 350.5,-1323.37 345.95,-1320.57"/>
<polygon fill="#da00ff" stroke="#da00ff" points="347.24,-1317.3 336.73,-1315.95 344.1,-1323.56 347.24,-1317.3"/>
</g>
<!-- sourcefile~cable_sli_numbers.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~cable_sli_numbers.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M427.11,-1286.04C415.85,-1289.72 404.22,-1294.33 394,-1300 375.54,-1310.24 376.73,-1321.25 358,-1331 354.24,-1332.96 350.29,-1334.74 346.23,-1336.36"/>
<polygon fill="#ff00da" stroke="#ff00da" points="344.82,-1333.15 336.62,-1339.87 347.21,-1339.73 344.82,-1333.15"/>
</g>
<!-- sourcefile~cbl_remove_trans.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~cbl_remove_trans.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M615.14,-680.71C574.84,-685.92 521.46,-696.9 479.5,-720"/>
</g>
<!-- sourcefile~cbl_remove_trans.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~cbl_remove_trans.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M659.2,-663.76C625.17,-636.53 543.04,-570.83 502.68,-538.54"/>
<polygon fill="#ff0091" stroke="#ff0091" points="504.73,-535.7 494.73,-532.18 500.35,-541.16 504.73,-535.7"/>
</g>
<!-- sourcefile~cable_sli_roots.f90&#45;&gt;sourcefile~cable_define_types.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~cable_sli_roots.f90&#45;&gt;sourcefile~cable_define_types.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M622.49,-1202.35C546.38,-1214.96 411.73,-1238.87 394,-1253 364.14,-1276.8 387.35,-1306.58 358,-1331 354.74,-1333.71 351.18,-1336.08 347.41,-1338.15"/>
<polygon fill="#ff0048" stroke="#ff0048" points="345.88,-1335 338.33,-1342.44 348.87,-1341.33 345.88,-1335"/>
</g>
<!-- sourcefile~cable_sli_roots.f90&#45;&gt;sourcefile~cable_sli_numbers.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~cable_sli_roots.f90&#45;&gt;sourcefile~cable_sli_numbers.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M631.52,-1206.07C620.61,-1209.86 609.12,-1214.52 599,-1220 581.18,-1229.65 580.97,-1238.61 563,-1248 555.28,-1252.04 546.82,-1255.57 538.34,-1258.62"/>
<polygon fill="#ff0048" stroke="#ff0048" points="537.15,-1255.33 528.81,-1261.87 539.4,-1261.96 537.15,-1255.33"/>
</g>
<!-- sourcefile~cbl_trimb.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~cbl_trimb.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M636.44,-520C611.75,-520 578.84,-520 549.54,-520"/>
<polygon fill="#ff0000" stroke="#ff0000" points="549.34,-516.5 539.34,-520 549.34,-523.5 549.34,-516.5"/>
</g>
<!-- sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cable_common.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cable_common.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M674.5,-560C534.12,-566.79 479.33,-594.33 394,-706 328.81,-791.3 287.64,-1137.75 277.8,-1228.93"/>
<polygon fill="#7fff00" stroke="#7fff00" points="274.3,-1228.65 276.73,-1238.96 281.27,-1229.39 274.3,-1228.65"/>
</g>
<!-- sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M833.23,-532.03C793.61,-542.81 731.54,-557.34 676.5,-560"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M674.5,-560C647.91,-561.29 582.72,-546.54 535,-534.59"/>
<polygon fill="#7fff00" stroke="#7fff00" points="535.66,-531.15 525.11,-532.09 533.94,-537.94 535.66,-531.15"/>
</g>
<!-- sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cbl_trimb.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~cbl_smoisturev.f90&#45;&gt;sourcefile~cbl_trimb.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M822.88,-520C792.62,-520 754.51,-520 724.76,-520"/>
<polygon fill="#7fff00" stroke="#7fff00" points="724.61,-516.5 714.61,-520 724.61,-523.5 724.61,-516.5"/>
</g>
<!-- sourcefile~cbl_conductivity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~cbl_conductivity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M637.38,-452.02C625.08,-456.2 611.37,-461.09 599,-466 569.8,-477.6 537.36,-492.38 513.66,-503.55"/>
<polygon fill="#00ffff" stroke="#00ffff" points="511.93,-500.49 504.39,-507.94 514.92,-506.82 511.93,-500.49"/>
</g>
<!-- sourcefile~cbl_oldconductivity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~cbl_oldconductivity.f90&#45;&gt;sourcefile~cbl_soilsnow_data.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M620.19,-410.04C612.87,-412.54 605.61,-415.5 599,-419 558.4,-440.47 519.31,-477.63 497.44,-500.4"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="494.77,-498.13 490.45,-507.8 499.86,-502.93 494.77,-498.13"/>
</g>
</g>
</svg>
</div><script>var pansourcefilecable_mpiworkerf90EfferentGraph = svgPanZoom('#sourcefilecable_mpiworkerf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 6.0.2 (20221011.1828)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 6.0.2 (20221011.1828)
 -->
<!-- Title: sourcefile~~cable_mpiworker.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilecable_mpiworkerf90AfferentGraph" width="256pt" height="32pt"
 viewBox="0.00 0.00 256.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~cable_mpiworker.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~cable_mpiworker.f90~~AfferentGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 252,-28 252,4 -4,4"/>
<!-- sourcefile~cable_mpiworker.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~cable_mpiworker.f90</title>
<polygon fill="none" stroke="black" points="115,-24 0,-24 0,0 115,0 115,-24"/>
<text text-anchor="middle" x="57.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">cable_mpiworker.F90</text>
</g>
<!-- sourcefile~cable_mpidrv.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~cable_mpidrv.f90</title>
<g id="a_sourcefile~~cable_mpiworker.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/cable_mpidrv.f90.html" xlink:title="cable_mpidrv.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="248,-24 151,-24 151,0 248,0 248,-24"/>
<text text-anchor="middle" x="199.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cable_mpidrv.F90</text>
</a>
</g>
</g>
<!-- sourcefile~cable_mpidrv.f90&#45;&gt;sourcefile~cable_mpiworker.f90 -->
<g id="sourcefile~~cable_mpiworker.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~cable_mpidrv.f90&#45;&gt;sourcefile~cable_mpiworker.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M150.71,-12C142.51,-12 133.86,-12 125.27,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="125.25,-8.5 115.25,-12 125.25,-15.5 125.25,-8.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 6.0.2 (20221011.1828)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/cable_mpiworker.html">cable_mpiworker</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/cable_mpiworker.f90.html#src">cable_mpiworker.F90</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="c">!==============================================================================</span>
<a id="ln-2" name="ln-2" href="#ln-2"></a><span class="c">! This source code is part of the</span>
<a id="ln-3" name="ln-3" href="#ln-3"></a><span class="c">! Australian Community Atmosphere Biosphere Land Exchange (CABLE) model.</span>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="c">! This work is licensed under the CSIRO Open Source Software License</span>
<a id="ln-5" name="ln-5" href="#ln-5"></a><span class="c">! Agreement (variation of the BSD / MIT License).</span>
<a id="ln-6" name="ln-6" href="#ln-6"></a><span class="c">!</span>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="c">! You may not use this file except in compliance with this License.</span>
<a id="ln-8" name="ln-8" href="#ln-8"></a><span class="c">! A copy of the License (CSIRO_BSD_MIT_License_v2.0_CABLE.txt) is located</span>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="c">! in each directory containing CABLE code.</span>
<a id="ln-10" name="ln-10" href="#ln-10"></a><span class="c">!</span>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="c">! ==============================================================================</span>
<a id="ln-12" name="ln-12" href="#ln-12"></a><span class="c">! Purpose: Offline driver for mpi worker in CABLE global run</span>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="c">!</span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="c">! Contact: Bernard.Pak@csiro.au</span>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="c">!</span>
<a id="ln-16" name="ln-16" href="#ln-16"></a><span class="c">! History: Since 1.4b, capability to run global offline (ncciy = YEAR),</span>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="c">!          inclusion of call to CASA-CNP (icycle&gt;0)</span>
<a id="ln-18" name="ln-18" href="#ln-18"></a><span class="c">!          soil_snow_type now ssnow (instead of ssoil)</span>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="c">!</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a><span class="c">!          MPI wrapper developed by Maciej Golebiewski (2012)</span>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="c">!          Modified from cable_driver.F90 in CABLE-2.0_beta r171 by B Pak</span>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="c">!</span>
<a id="ln-23" name="ln-23" href="#ln-23"></a><span class="c">! ==============================================================================</span>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="c">! Uses:           mpi</span>
<a id="ln-25" name="ln-25" href="#ln-25"></a><span class="c">!                 cable_mpicommon</span>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="c">!                 cable_def_types_mod</span>
<a id="ln-27" name="ln-27" href="#ln-27"></a><span class="c">!                 cable_IO_vars_module</span>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="c">!                 cable_common_module</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="c">!                 cable_data_module</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a><span class="c">!                 cable_input_module</span>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="c">!                 cable_output_module</span>
<a id="ln-32" name="ln-32" href="#ln-32"></a><span class="c">!                 cable_cbm_module</span>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="c">!                 casadimension</span>
<a id="ln-34" name="ln-34" href="#ln-34"></a><span class="c">!                 casavariable</span>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="c">!                 phenvariable</span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="c">!                 casa_cable</span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="c">!                 casa_inout_module</span>
<a id="ln-38" name="ln-38" href="#ln-38"></a><span class="c">!</span>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="c">! CALLs:       </span>
<a id="ln-40" name="ln-40" href="#ln-40"></a><span class="c">!              casa_feedback</span>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="c">!              cbm</span>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="c">!              bgcdriver</span>
<a id="ln-43" name="ln-43" href="#ln-43"></a><span class="c">!              sumcflux</span>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="c">!              find_extents</span>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="c">!              worker_decomp</span>
<a id="ln-46" name="ln-46" href="#ln-46"></a><span class="c">!              worker_cable_params</span>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="c">!              worker_casa_params</span>
<a id="ln-48" name="ln-48" href="#ln-48"></a><span class="c">!              worker_intype</span>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="c">!              worker_outtype</span>
<a id="ln-50" name="ln-50" href="#ln-50"></a><span class="c">!              worker_casa_type</span>
<a id="ln-51" name="ln-51" href="#ln-51"></a><span class="c">!              worker_restart_type</span>
<a id="ln-52" name="ln-52" href="#ln-52"></a><span class="c">!              worker_end</span>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="c">!</span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="c">! input  file: [SiteName].nc</span>
<a id="ln-55" name="ln-55" href="#ln-55"></a><span class="c">!              poolcnpIn[SiteName].csv -- for CASA-CNP only</span>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="c">!              gridinfo_CSIRO_1x1.nc</span>
<a id="ln-57" name="ln-57" href="#ln-57"></a><span class="c">!              def_veg_params.txt</span>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="c">!              def_soil_params.txt -- nearly redundant, can be switched on</span>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="c">!              restart_in.nc -- not strictly required</span>
<a id="ln-60" name="ln-60" href="#ln-60"></a><span class="c">!</span>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="c">! output file: log_cable.txt</span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="c">!              out_cable.nc</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="c">!              restart_out.nc</span>
<a id="ln-64" name="ln-64" href="#ln-64"></a><span class="c">!              poolcnpOut.csv -- from CASA-CNP</span>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="c">!==============================================================================</span>
<a id="ln-66" name="ln-66" href="#ln-66"></a><span class="k">MODULE </span><span class="n">cable_mpiworker</span><span class="w"></span>
<a id="ln-67" name="ln-67" href="#ln-67"></a>
<a id="ln-68" name="ln-68" href="#ln-68"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_mpicommon</span><span class="w"></span>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="w">  </span><span class="k">USE </span><span class="n">cable_common_module</span><span class="p">,</span><span class="w">  </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">cable_user</span><span class="w"></span>
<a id="ln-70" name="ln-70" href="#ln-70"></a><span class="w">  </span><span class="k">USE </span><span class="n">casa_inout_module</span><span class="w"></span>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="w">  </span><span class="k">USE </span><span class="n">casa_cable</span><span class="w"></span>
<a id="ln-72" name="ln-72" href="#ln-72"></a>
<a id="ln-73" name="ln-73" href="#ln-73"></a>
<a id="ln-74" name="ln-74" href="#ln-74"></a><span class="w">  </span><span class="k">IMPLICIT NONE</span>
<a id="ln-75" name="ln-75" href="#ln-75"></a>
<a id="ln-76" name="ln-76" href="#ln-76"></a><span class="k">  SAVE</span>
<a id="ln-77" name="ln-77" href="#ln-77"></a>
<a id="ln-78" name="ln-78" href="#ln-78"></a>
<a id="ln-79" name="ln-79" href="#ln-79"></a>
<a id="ln-80" name="ln-80" href="#ln-80"></a><span class="k">  PRIVATE</span><span class="w"></span>
<a id="ln-81" name="ln-81" href="#ln-81"></a>
<a id="ln-82" name="ln-82" href="#ln-82"></a><span class="w">  </span><span class="c">! MPI: MPI derived datatype for receiving parameters from the master</span>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">param_t</span><span class="w"></span>
<a id="ln-84" name="ln-84" href="#ln-84"></a>
<a id="ln-85" name="ln-85" href="#ln-85"></a><span class="w">  </span><span class="c">! MPI: MPI derived datatype for receiving casa parameters from the master</span>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casaparam_t</span><span class="w"></span>
<a id="ln-87" name="ln-87" href="#ln-87"></a>
<a id="ln-88" name="ln-88" href="#ln-88"></a><span class="w">  </span><span class="c">! MPI: MPI derived datatype for receiving input from the master</span>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inp_t</span><span class="w"></span>
<a id="ln-90" name="ln-90" href="#ln-90"></a>
<a id="ln-91" name="ln-91" href="#ln-91"></a><span class="w">  </span><span class="c">! MPI: MPI derived datatype for sending results back to the master</span>
<a id="ln-92" name="ln-92" href="#ln-92"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">send_t</span><span class="w"></span>
<a id="ln-93" name="ln-93" href="#ln-93"></a>
<a id="ln-94" name="ln-94" href="#ln-94"></a><span class="w">  </span><span class="c">! worker&#39;s struct for sending final casa results to the master</span>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casa_t</span><span class="w"></span>
<a id="ln-96" name="ln-96" href="#ln-96"></a>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="w">  </span><span class="c">! worker&#39;s struct for rec&#39;ing/sending final casa results to/from the master</span>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casa_dump_t</span><span class="w"></span>
<a id="ln-99" name="ln-99" href="#ln-99"></a>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="w">  </span><span class="c">! worker&#39;s struct for rec&#39;ing/sending casa pools to/from the master (for LUC calcs)</span>
<a id="ln-101" name="ln-101" href="#ln-101"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casa_LUC_t</span><span class="w"></span>
<a id="ln-102" name="ln-102" href="#ln-102"></a>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="w">  </span><span class="c">! worker&#39;s struct for rec&#39;ing/sending final casa results to/from the master</span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">climate_t</span><span class="w"></span>
<a id="ln-105" name="ln-105" href="#ln-105"></a>
<a id="ln-106" name="ln-106" href="#ln-106"></a><span class="w">  </span><span class="c">! worker&#39;s struct for rec&#39;ing/sending pop io to/from the master</span>
<a id="ln-107" name="ln-107" href="#ln-107"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pop_t</span><span class="w"></span>
<a id="ln-108" name="ln-108" href="#ln-108"></a>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="w">  </span><span class="c">! worker&#39;s struct for restart data to the master</span>
<a id="ln-110" name="ln-110" href="#ln-110"></a><span class="w">  </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">restart_t</span><span class="w"></span>
<a id="ln-111" name="ln-111" href="#ln-111"></a>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="w">  </span><span class="c">! worker&#39;s logfile unit</span>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="w">  </span><span class="c">!INTEGER :: wlogn</span>
<a id="ln-114" name="ln-114" href="#ln-114"></a><span class="w">  </span><span class="c">!debug moved to iovars -- easy to pass around</span>
<a id="ln-115" name="ln-115" href="#ln-115"></a>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="w">  </span><span class="k">PUBLIC</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mpidrv_worker</span><span class="w"></span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">heat_cap_lower_limit</span><span class="p">(:,:)</span><span class="w"></span>
<a id="ln-118" name="ln-118" href="#ln-118"></a>
<a id="ln-119" name="ln-119" href="#ln-119"></a><span class="k">CONTAINS</span>
<a id="ln-120" name="ln-120" href="#ln-120"></a>
<a id="ln-121" name="ln-121" href="#ln-121"></a><span class="k">  SUBROUTINE </span><span class="n">mpidrv_worker</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">)</span><span class="w"></span>
<a id="ln-122" name="ln-122" href="#ln-122"></a>
<a id="ln-123" name="ln-123" href="#ln-123"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-124" name="ln-124" href="#ln-124"></a>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_IO_vars_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">logn</span><span class="p">,</span><span class="n">gswpfile</span><span class="p">,</span><span class="n">ncciy</span><span class="p">,</span><span class="n">leaps</span><span class="p">,</span><span class="w"> </span><span class="n">globalMetfile</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="w">         </span><span class="n">verbose</span><span class="p">,</span><span class="w"> </span><span class="n">fixedCO2</span><span class="p">,</span><span class="n">output</span><span class="p">,</span><span class="n">check</span><span class="p">,</span><span class="n">patchout</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="w">         </span><span class="n">patch_type</span><span class="p">,</span><span class="n">soilparmnew</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="w">         </span><span class="n">defaultLAI</span><span class="p">,</span><span class="w"> </span><span class="n">wlogn</span><span class="w"></span>
<a id="ln-130" name="ln-130" href="#ln-130"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_common_module</span><span class="p">,</span><span class="w">  </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">ktau_gl</span><span class="p">,</span><span class="w"> </span><span class="n">kend_gl</span><span class="p">,</span><span class="w"> </span><span class="n">knode_gl</span><span class="p">,</span><span class="w"> </span><span class="n">cable_user</span><span class="p">,</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="w">         </span><span class="n">cable_runtime</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">myhome</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">         </span><span class="n">redistrb</span><span class="p">,</span><span class="w"> </span><span class="n">wiltParam</span><span class="p">,</span><span class="w"> </span><span class="n">satuParam</span><span class="p">,</span><span class="w"> </span><span class="n">CurYear</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-133" name="ln-133" href="#ln-133"></a><span class="w">         </span><span class="n">IS_LEAPYEAR</span><span class="p">,</span><span class="w"> </span><span class="n">calcsoilalbedo</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-134" name="ln-134" href="#ln-134"></a><span class="w">         </span><span class="n">kwidth_gl</span><span class="p">,</span><span class="w"> </span><span class="n">gw_params</span><span class="w"></span>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">  </span><span class="k">USE </span><span class="n">casa_ncdf_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">is_casa_time</span><span class="w"></span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_input_module</span><span class="p">,</span><span class="w">   </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">open_met_file</span><span class="p">,</span><span class="n">load_parameters</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-137" name="ln-137" href="#ln-137"></a><span class="w">         </span><span class="n">get_met_data</span><span class="p">,</span><span class="n">close_met_file</span><span class="w"></span>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_output_module</span><span class="p">,</span><span class="w">  </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">create_restart</span><span class="p">,</span><span class="n">open_output_file</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="w">         </span><span class="n">write_output</span><span class="p">,</span><span class="n">close_output_file</span><span class="w"></span>
<a id="ln-140" name="ln-140" href="#ln-140"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_cbm_module</span><span class="w"></span>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_climate_mod</span><span class="w"></span>
<a id="ln-142" name="ln-142" href="#ln-142"></a>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="w">    </span><span class="c">! modules related to CASA-CNP</span>
<a id="ln-144" name="ln-144" href="#ln-144"></a><span class="w">    </span><span class="k">USE </span><span class="n">casadimension</span><span class="p">,</span><span class="w">        </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">icycle</span><span class="w"></span>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="w">    </span><span class="k">USE </span><span class="n">casavariable</span><span class="p">,</span><span class="w">         </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">casafile</span><span class="p">,</span><span class="w"> </span><span class="n">casa_biome</span><span class="p">,</span><span class="w"> </span><span class="n">casa_pool</span><span class="p">,</span><span class="w"> </span><span class="n">casa_flux</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-146" name="ln-146" href="#ln-146"></a><span class="w">         </span><span class="n">casa_met</span><span class="p">,</span><span class="w"> </span><span class="n">casa_balance</span><span class="w"></span>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="w">    </span><span class="k">USE </span><span class="n">phenvariable</span><span class="p">,</span><span class="w">         </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">phen_variable</span><span class="w"></span>
<a id="ln-148" name="ln-148" href="#ln-148"></a>
<a id="ln-149" name="ln-149" href="#ln-149"></a><span class="w">    </span><span class="c">!CLN added</span>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="w">    </span><span class="c">! modules related to POP</span>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="w">    </span><span class="k">USE </span><span class="n">POPmodule</span><span class="p">,</span><span class="w">            </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">POP_INIT</span><span class="w"></span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">    </span><span class="k">USE </span><span class="n">POP_Types</span><span class="p">,</span><span class="w">            </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">POP_TYPE</span><span class="w"></span>
<a id="ln-153" name="ln-153" href="#ln-153"></a><span class="w">    </span><span class="k">USE </span><span class="n">POP_Constants</span><span class="p">,</span><span class="w">        </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">HEIGHT_BINS</span><span class="p">,</span><span class="w"> </span><span class="n">NCOHORT_MAX</span><span class="w"></span>
<a id="ln-154" name="ln-154" href="#ln-154"></a>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">    </span><span class="c">! PLUME-MIP only</span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="w">    </span><span class="k">USE </span><span class="n">CABLE_PLUME_MIP</span><span class="p">,</span><span class="w">      </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">PLUME_MIP_TYPE</span><span class="w"></span>
<a id="ln-157" name="ln-157" href="#ln-157"></a>
<a id="ln-158" name="ln-158" href="#ln-158"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_namelist_util</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">get_namelist_file_name</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-159" name="ln-159" href="#ln-159"></a><span class="w">         </span><span class="n">CABLE_NAMELIST</span><span class="p">,</span><span class="n">arg_not_namelist</span><span class="w"></span>
<a id="ln-160" name="ln-160" href="#ln-160"></a><span class="w">    </span>
<a id="ln-161" name="ln-161" href="#ln-161"></a><span class="k">USE </span><span class="n">cbl_soil_snow_init_special_module</span><span class="w"></span>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<a id="ln-163" name="ln-163" href="#ln-163"></a>
<a id="ln-164" name="ln-164" href="#ln-164"></a><span class="w">    </span><span class="c">! MPI:</span>
<a id="ln-165" name="ln-165" href="#ln-165"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w"> </span><span class="c">! MPI communicator for comms with the workers</span>
<a id="ln-166" name="ln-166" href="#ln-166"></a>
<a id="ln-167" name="ln-167" href="#ln-167"></a><span class="w">    </span><span class="c">! CABLE namelist: model configuration, runtime/user switches</span>
<a id="ln-168" name="ln-168" href="#ln-168"></a><span class="w">    </span><span class="c">!CHARACTER(LEN=200), PARAMETER :: CABLE_NAMELIST=&#39;cable.nml&#39;</span>
<a id="ln-169" name="ln-169" href="#ln-169"></a>
<a id="ln-170" name="ln-170" href="#ln-170"></a><span class="w">    </span><span class="c">! timing variables</span>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">PARAMETER</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">kstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="c">! start of simulation</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">PARAMETER</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">mloop</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="w">   </span><span class="c">! CASA-CNP PreSpinup loops</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w">        </span><span class="kd">::</span><span class="w">                                                           </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-175" name="ln-175" href="#ln-175"></a><span class="w">         </span><span class="n">ktau</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! increment equates to timestep, resets if spinning up</span>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="w">         </span><span class="n">ktau_tot</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! NO reset when spinning up, total timesteps by model</span>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="w">         </span><span class="n">kend</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! no. of time steps in run</span>
<a id="ln-178" name="ln-178" href="#ln-178"></a><span class="w">                                </span><span class="c">!CLN      kstart = 1, &amp;  ! timestep to start at</span>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="w">         </span><span class="n">koffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! timestep to start at</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a><span class="w">         </span><span class="n">ktauday</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! day counter for CASA-CNP</span>
<a id="ln-181" name="ln-181" href="#ln-181"></a><span class="w">         </span><span class="n">idoy</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! day of year (1:365) counter for CASA-CNP</span>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="w">         </span><span class="n">nyear</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! year counter for CASA-CNP</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a><span class="w">         </span><span class="n">casa_it</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! number of calls to CASA-CNP</span>
<a id="ln-184" name="ln-184" href="#ln-184"></a><span class="w">         </span><span class="nb">ctime</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! day count for casacnp</span>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="w">         </span><span class="n">YYYY</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w">  </span><span class="c">!</span>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="w">         </span><span class="n">LOY</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! Length of Year</span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="w">         </span><span class="n">count_sum_casa</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! number of time steps over which casa pools &amp;</span>
<a id="ln-188" name="ln-188" href="#ln-188"></a><span class="w">                                </span><span class="c">!and fluxes are aggregated (for output)</span>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="w">         </span><span class="n">rank</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! Rank of this worker</span>
<a id="ln-190" name="ln-190" href="#ln-190"></a><span class="w">         </span><span class="n">maxdiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">     </span><span class="c">! location of maximum in convergence test</span>
<a id="ln-191" name="ln-191" href="#ln-191"></a>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="w">    </span><span class="kt">REAL</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">dels</span><span class="w">    </span><span class="c">! time step size in seconds</span>
<a id="ln-193" name="ln-193" href="#ln-193"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cRank</span><span class="o">*</span><span class="mi">4</span><span class="w"> </span><span class="c">! for worker-logfiles</span>
<a id="ln-194" name="ln-194" href="#ln-194"></a>
<a id="ln-195" name="ln-195" href="#ln-195"></a><span class="w">    </span><span class="c">! CABLE variables</span>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">met_type</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">met</span><span class="w">     </span><span class="c">! met input variables</span>
<a id="ln-197" name="ln-197" href="#ln-197"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">air_type</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">air</span><span class="w">     </span><span class="c">! air property variables</span>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">canopy_type</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">canopy</span><span class="w">  </span><span class="c">! vegetation variables</span>
<a id="ln-199" name="ln-199" href="#ln-199"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">radiation_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rad</span><span class="w">     </span><span class="c">! radiation variables</span>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">roughness_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rough</span><span class="w">   </span><span class="c">! roughness varibles</span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">balances_type</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">bal</span><span class="w">     </span><span class="c">! energy and water balance variables</span>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">soil_snow_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ssnow</span><span class="w">   </span><span class="c">! soil and snow variables</span>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">climate_type</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">climate</span><span class="w">     </span><span class="c">! climate variables</span>
<a id="ln-204" name="ln-204" href="#ln-204"></a>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="w">    </span><span class="c">! CABLE parameters</span>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">soil_parameter_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">soil</span><span class="w"> </span><span class="c">! soil parameters</span>
<a id="ln-207" name="ln-207" href="#ln-207"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">veg_parameter_type</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">veg</span><span class="w">  </span><span class="c">! vegetation parameters</span>
<a id="ln-208" name="ln-208" href="#ln-208"></a>
<a id="ln-209" name="ln-209" href="#ln-209"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux_type</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">sum_flux</span><span class="w"> </span><span class="c">! cumulative flux variables</span>
<a id="ln-210" name="ln-210" href="#ln-210"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">bgc_pool_type</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">bgc</span><span class="w">  </span><span class="c">! carbon pool variables</span>
<a id="ln-211" name="ln-211" href="#ln-211"></a>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="w">    </span><span class="c">! CASA-CNP variables</span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_biome</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">casabiome</span><span class="w"></span>
<a id="ln-214" name="ln-214" href="#ln-214"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_pool</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">casapool</span><span class="w"></span>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_flux</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">casaflux</span><span class="w"></span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_met</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">casamet</span><span class="w"></span>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_balance</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">casabal</span><span class="w"></span>
<a id="ln-218" name="ln-218" href="#ln-218"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">phen_variable</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">phen</span><span class="w"></span>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">POP_TYPE</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">POP</span><span class="w"></span>
<a id="ln-220" name="ln-220" href="#ln-220"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">PLUME_MIP_TYPE</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">PLUME</span><span class="w"></span>
<a id="ln-221" name="ln-221" href="#ln-221"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">cyear</span><span class="o">*</span><span class="mi">4</span><span class="w"></span>
<a id="ln-222" name="ln-222" href="#ln-222"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">ncfile</span><span class="o">*</span><span class="mi">99</span><span class="w"></span>
<a id="ln-223" name="ln-223" href="#ln-223"></a>
<a id="ln-224" name="ln-224" href="#ln-224"></a><span class="w">    </span><span class="c">! declare vars for switches (default .FALSE.) etc declared thru namelist</span>
<a id="ln-225" name="ln-225" href="#ln-225"></a><span class="w">    </span><span class="kt">LOGICAL</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="w">         </span><span class="n">vegparmnew</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! using new format input file (BP dec 2007)</span>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="w">         </span><span class="n">spinup</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! model spinup to soil state equilibrium?</span>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="w">         </span><span class="n">spinConv</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! has spinup converged?</span>
<a id="ln-229" name="ln-229" href="#ln-229"></a><span class="w">         </span><span class="n">spincasa</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! TRUE: CASA-CNP Will spin mloop times,</span>
<a id="ln-230" name="ln-230" href="#ln-230"></a><span class="w">         </span><span class="n">l_casacnp</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! using CASA-CNP with CABLE</span>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="w">         </span><span class="n">l_landuse</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! using LANDUSE                 </span>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="w">         </span><span class="n">l_laiFeedbk</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! using prognostic LAI</span>
<a id="ln-233" name="ln-233" href="#ln-233"></a><span class="w">         </span><span class="n">l_vcmaxFeedbk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! using prognostic Vcmax</span>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="w">         </span><span class="n">CASAONLY</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! ONLY Run CASA-CNP</span>
<a id="ln-235" name="ln-235" href="#ln-235"></a><span class="w">         </span><span class="n">CALL1</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-236" name="ln-236" href="#ln-236"></a>
<a id="ln-237" name="ln-237" href="#ln-237"></a><span class="w">    </span><span class="kt">REAL</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-238" name="ln-238" href="#ln-238"></a><span class="w">         </span><span class="n">delsoilM</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! allowed variation in soil moisture for spin up</span>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="w">         </span><span class="n">delsoilT</span><span class="w">            </span><span class="c">! allowed variation in soil temperature for spin up</span>
<a id="ln-240" name="ln-240" href="#ln-240"></a>
<a id="ln-241" name="ln-241" href="#ln-241"></a><span class="w">    </span><span class="c">! temporary storage for soil moisture/temp. in spin up mode</span>
<a id="ln-242" name="ln-242" href="#ln-242"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:,:)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-243" name="ln-243" href="#ln-243"></a><span class="w">         </span><span class="n">soilMtemp</span><span class="p">,</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="w">         </span><span class="n">soilTtemp</span><span class="w"></span>
<a id="ln-245" name="ln-245" href="#ln-245"></a>
<a id="ln-246" name="ln-246" href="#ln-246"></a><span class="w">    </span><span class="c">! MPI:</span>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="w">    </span><span class="kt">LOGICAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">loop_exit</span><span class="w">     </span><span class="c">! MPI: exit flag for bcast to workers</span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">stat</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">)</span><span class="w"></span>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icomm</span><span class="w"> </span><span class="c">! separate dupes of MPI communicator for send and recv</span>
<a id="ln-250" name="ln-250" href="#ln-250"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ocomm</span><span class="w"> </span><span class="c">! separate dupes of MPI communicator for send and recv</span>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-252" name="ln-252" href="#ln-252"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="kd">::</span><span class="w"> </span><span class="n">Run</span><span class="w"></span>
<a id="ln-253" name="ln-253" href="#ln-253"></a>
<a id="ln-254" name="ln-254" href="#ln-254"></a><span class="w">    </span><span class="c">! switches etc defined thru namelist (by default cable.nml)</span>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="w">    </span><span class="k">NAMELIST</span><span class="o">/</span><span class="n">CABLE</span><span class="o">/</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-256" name="ln-256" href="#ln-256"></a><span class="w">         </span><span class="n">filename</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! TYPE, containing input filenames</span>
<a id="ln-257" name="ln-257" href="#ln-257"></a><span class="w">         </span><span class="n">vegparmnew</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! use new soil param. method</span>
<a id="ln-258" name="ln-258" href="#ln-258"></a><span class="w">         </span><span class="n">soilparmnew</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! use new soil param. method</span>
<a id="ln-259" name="ln-259" href="#ln-259"></a><span class="w">         </span><span class="n">calcsoilalbedo</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! switch: soil colour albedo - Ticket #27</span>
<a id="ln-260" name="ln-260" href="#ln-260"></a><span class="w">         </span><span class="n">spinup</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"> </span><span class="c">! spinup model (soil) to steady state</span>
<a id="ln-261" name="ln-261" href="#ln-261"></a><span class="w">         </span><span class="n">delsoilM</span><span class="p">,</span><span class="n">delsoilT</span><span class="p">,&amp;</span><span class="w"> </span><span class="c">!</span>
<a id="ln-262" name="ln-262" href="#ln-262"></a><span class="w">         </span><span class="n">output</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="w">         </span><span class="n">patchout</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-264" name="ln-264" href="#ln-264"></a><span class="w">         </span><span class="n">check</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-265" name="ln-265" href="#ln-265"></a><span class="w">         </span><span class="n">verbose</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-266" name="ln-266" href="#ln-266"></a><span class="w">         </span><span class="n">leaps</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">         </span><span class="n">logn</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-268" name="ln-268" href="#ln-268"></a><span class="w">         </span><span class="n">fixedCO2</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-269" name="ln-269" href="#ln-269"></a><span class="w">         </span><span class="n">spincasa</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-270" name="ln-270" href="#ln-270"></a><span class="w">         </span><span class="n">l_casacnp</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-271" name="ln-271" href="#ln-271"></a><span class="w">         </span><span class="n">l_landuse</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-272" name="ln-272" href="#ln-272"></a><span class="w">         </span><span class="n">l_laiFeedbk</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="w">         </span><span class="n">l_vcmaxFeedbk</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="w">         </span><span class="n">icycle</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="w">         </span><span class="n">casafile</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-276" name="ln-276" href="#ln-276"></a><span class="w">         </span><span class="n">ncciy</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="w">         </span><span class="n">gswpfile</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-278" name="ln-278" href="#ln-278"></a><span class="w">         </span><span class="n">globalMetfile</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w">   </span>
<a id="ln-279" name="ln-279" href="#ln-279"></a><span class="w">         </span><span class="n">redistrb</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-280" name="ln-280" href="#ln-280"></a><span class="w">         </span><span class="n">wiltParam</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="w">         </span><span class="n">satuParam</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="w">         </span><span class="n">cable_user</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w">  </span><span class="c">! additional USER switches</span>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="w">         </span><span class="n">gw_params</span><span class="w"></span>
<a id="ln-284" name="ln-284" href="#ln-284"></a>
<a id="ln-285" name="ln-285" href="#ln-285"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">kk</span><span class="w"></span>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">LALLOC</span><span class="p">,</span><span class="w"> </span><span class="n">iu</span><span class="w"></span>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="c">!For consistency w JAC</span>
<a id="ln-288" name="ln-288" href="#ln-288"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">c1</span><span class="p">(:,:)</span><span class="w"></span>
<a id="ln-289" name="ln-289" href="#ln-289"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rhoch</span><span class="p">(:,:)</span><span class="w"></span>
<a id="ln-290" name="ln-290" href="#ln-290"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xk</span><span class="p">(:,:)</span><span class="w"></span>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="w">    </span><span class="c">! END header</span>
<a id="ln-292" name="ln-292" href="#ln-292"></a>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="w">    </span><span class="c">! Maciej: make sure the variable does not go out of scope</span>
<a id="ln-294" name="ln-294" href="#ln-294"></a><span class="w">    </span><span class="n">mp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-295" name="ln-295" href="#ln-295"></a>
<a id="ln-296" name="ln-296" href="#ln-296"></a><span class="w">    </span><span class="c">! Open, read and close the namelist file.</span>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="w">    </span><span class="k">OPEN</span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="k">FILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CABLE_NAMELIST</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="w">    </span><span class="k">READ</span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">NML</span><span class="o">=</span><span class="n">CABLE</span><span class="w"> </span><span class="p">)</span><span class="w">   </span><span class="c">!where NML=CABLE defined above</span>
<a id="ln-299" name="ln-299" href="#ln-299"></a><span class="w">    </span><span class="k">CLOSE</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"></span>
<a id="ln-300" name="ln-300" href="#ln-300"></a>
<a id="ln-301" name="ln-301" href="#ln-301"></a><span class="w">    </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="nb">IARGC</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-302" name="ln-302" href="#ln-302"></a><span class="k">       CALL </span><span class="nb">GETARG</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">%</span><span class="n">met</span><span class="p">)</span><span class="w"></span>
<a id="ln-303" name="ln-303" href="#ln-303"></a><span class="w">       </span><span class="k">CALL </span><span class="nb">GETARG</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">casafile</span><span class="p">%</span><span class="n">cnpipool</span><span class="p">)</span><span class="w"></span>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="w">    </span><span class="k">ENDIF</span>
<a id="ln-305" name="ln-305" href="#ln-305"></a>
<a id="ln-306" name="ln-306" href="#ln-306"></a>
<a id="ln-307" name="ln-307" href="#ln-307"></a><span class="k">    IF</span><span class="w"> </span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC_RunType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;static&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="w">         </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-309" name="ln-309" href="#ln-309"></a>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="w">    </span><span class="c">! Get worker&#39;s rank and determine logfile-unit</span>
<a id="ln-311" name="ln-311" href="#ln-311"></a>
<a id="ln-312" name="ln-312" href="#ln-312"></a><span class="w">    </span><span class="c">! MPI: TODO: find a way to preserve workers log messages somewhere</span>
<a id="ln-313" name="ln-313" href="#ln-313"></a><span class="w">    </span><span class="c">! (either separate files or collated by the master to a single file</span>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="w">    </span><span class="c">! or perhaps use MPI-IO - but probably not gonna work with random length</span>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="w">    </span><span class="c">! text strings)</span>
<a id="ln-316" name="ln-316" href="#ln-316"></a><span class="w">    </span><span class="c">! LN: Done!</span>
<a id="ln-317" name="ln-317" href="#ln-317"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">LogWorker</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="k">       CALL </span><span class="n">MPI_Comm_rank</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="n">cRank</span><span class="p">,</span><span class="n">FMT</span><span class="o">=</span><span class="s1">&#39;(I4.4)&#39;</span><span class="p">)</span><span class="n">rank</span><span class="w"></span>
<a id="ln-320" name="ln-320" href="#ln-320"></a><span class="w">       </span><span class="n">wlogn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="o">+</span><span class="n">rank</span><span class="w"></span>
<a id="ln-321" name="ln-321" href="#ln-321"></a><span class="w">       </span><span class="k">OPEN</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s2">&quot;cable_log_&quot;</span><span class="o">//</span><span class="n">cRank</span><span class="p">,</span><span class="n">STATUS</span><span class="o">=</span><span class="s2">&quot;REPLACE&quot;</span><span class="p">)</span><span class="w"></span>
<a id="ln-322" name="ln-322" href="#ln-322"></a><span class="w">    </span><span class="k">ELSE</span>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="k">       </span><span class="n">wlogn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="w"></span>
<a id="ln-324" name="ln-324" href="#ln-324"></a><span class="w">       </span><span class="k">OPEN</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="w"> </span><span class="k">FILE</span><span class="o">=</span><span class="s2">&quot;/dev/null&quot;</span><span class="p">)</span><span class="w"></span>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">    </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-326" name="ln-326" href="#ln-326"></a>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="w">    </span><span class="c">! INITIALISATION depending on nml settings</span>
<a id="ln-328" name="ln-328" href="#ln-328"></a>
<a id="ln-329" name="ln-329" href="#ln-329"></a><span class="w">    </span><span class="n">CurYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearStart</span><span class="w"></span>
<a id="ln-330" name="ln-330" href="#ln-330"></a>
<a id="ln-331" name="ln-331" href="#ln-331"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="p">.</span><span class="n">GE</span><span class="p">.</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-332" name="ln-332" href="#ln-332"></a><span class="k">       </span><span class="n">icycle</span><span class="w">                     </span><span class="o">=</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="w">       </span><span class="n">CASAONLY</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-334" name="ln-334" href="#ln-334"></a><span class="w">       </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_READ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-335" name="ln-335" href="#ln-335"></a><span class="w">       </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_WRITE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-336" name="ln-336" href="#ln-336"></a><span class="w">    </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-337" name="ln-337" href="#ln-337"></a><span class="k">       </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_READ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="w">       </span><span class="n">spincasa</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-339" name="ln-339" href="#ln-339"></a><span class="w">       </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CALL_POP</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-340" name="ln-340" href="#ln-340"></a><span class="w">    </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-341" name="ln-341" href="#ln-341"></a>
<a id="ln-342" name="ln-342" href="#ln-342"></a><span class="w">    </span><span class="c">!! vh_js !!</span>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-344" name="ln-344" href="#ln-344"></a><span class="k">       </span><span class="n">l_casacnp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="w">    </span><span class="k">ELSE</span>
<a id="ln-346" name="ln-346" href="#ln-346"></a><span class="k">       </span><span class="n">l_casacnp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-347" name="ln-347" href="#ln-347"></a><span class="w">    </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-348" name="ln-348" href="#ln-348"></a>
<a id="ln-349" name="ln-349" href="#ln-349"></a><span class="w">    </span><span class="c">!! vh_js !! suggest LALLOC should ulitmately be a switch in the .nml file</span>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CALL_POP</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-351" name="ln-351" href="#ln-351"></a><span class="k">       </span><span class="n">LALLOC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="c">! for use with POP: makes use of pipe model to partition between stem and leaf</span>
<a id="ln-352" name="ln-352" href="#ln-352"></a><span class="w">    </span><span class="k">ELSE</span>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="k">       </span><span class="n">LALLOC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">! default</span>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="w">    </span><span class="k">ENDIF</span>
<a id="ln-355" name="ln-355" href="#ln-355"></a>
<a id="ln-356" name="ln-356" href="#ln-356"></a><span class="k">    IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;gpgs&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-357" name="ln-357" href="#ln-357"></a><span class="k">       </span><span class="n">leaps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-358" name="ln-358" href="#ln-358"></a><span class="w">       </span><span class="n">cable_user</span><span class="p">%</span><span class="n">MetType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;gswp&#39;</span><span class="w"></span>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="w">    </span><span class="k">ENDIF</span>
<a id="ln-360" name="ln-360" href="#ln-360"></a>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="k">    </span><span class="n">cable_runtime</span><span class="p">%</span><span class="n">offline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-362" name="ln-362" href="#ln-362"></a>
<a id="ln-363" name="ln-363" href="#ln-363"></a><span class="w">    </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="n">l_casacnp</span><span class="w">  </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-364" name="ln-364" href="#ln-364"></a><span class="w">         </span><span class="k">STOP</span><span class="w"> </span><span class="s1">&#39;icycle must be 1 to 3 when using casaCNP&#39;</span><span class="w"></span>
<a id="ln-365" name="ln-365" href="#ln-365"></a><span class="w">    </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">l_laiFeedbk</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">l_vcmaxFeedbk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">l_casacnp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-366" name="ln-366" href="#ln-366"></a><span class="w">         </span><span class="k">STOP</span><span class="w"> </span><span class="s1">&#39;casaCNP required to get prognostic LAI or Vcmax&#39;</span><span class="w"></span>
<a id="ln-367" name="ln-367" href="#ln-367"></a><span class="w">    </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="n">l_vcmaxFeedbk</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w">                                     </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-368" name="ln-368" href="#ln-368"></a><span class="w">         </span><span class="k">STOP</span><span class="w"> </span><span class="s1">&#39;icycle must be 2 to 3 to get prognostic Vcmax&#39;</span><span class="w"></span>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="w">    </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">soilparmnew</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">                             </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-370" name="ln-370" href="#ln-370"></a><span class="w">         </span><span class="k">STOP</span><span class="w"> </span><span class="s1">&#39;casaCNP must use new soil parameters&#39;</span><span class="w"></span>
<a id="ln-371" name="ln-371" href="#ln-371"></a>
<a id="ln-372" name="ln-372" href="#ln-372"></a><span class="w">    </span><span class="c">! Open log file:</span>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="w">    </span><span class="c">! MPI: worker logs go to the black hole</span>
<a id="ln-374" name="ln-374" href="#ln-374"></a><span class="w">    </span><span class="c">! by opening the file we don&#39;t need to touch any of the code that writes</span>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="w">    </span><span class="c">! to it and may be called somewhere by a worker</span>
<a id="ln-376" name="ln-376" href="#ln-376"></a><span class="w">    </span><span class="c">! OPEN(logn,FILE=filename%log)</span>
<a id="ln-377" name="ln-377" href="#ln-377"></a>
<a id="ln-378" name="ln-378" href="#ln-378"></a>
<a id="ln-379" name="ln-379" href="#ln-379"></a><span class="w">    </span><span class="c">!! Check for gswp run</span>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="w">    </span><span class="c">! MPI: done by the master only; if check fails then master MPI_Aborts</span>
<a id="ln-381" name="ln-381" href="#ln-381"></a><span class="w">    </span><span class="c">! everyone</span>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="w">    </span><span class="c">!IF (ncciy /= 0) THEN</span>
<a id="ln-383" name="ln-383" href="#ln-383"></a><span class="w">    </span><span class="c">!</span>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="w">    </span><span class="c">!   PRINT *, &#39;Looking for global offline run info.&#39;</span>
<a id="ln-385" name="ln-385" href="#ln-385"></a><span class="w">    </span><span class="c">!</span>
<a id="ln-386" name="ln-386" href="#ln-386"></a><span class="w">    </span><span class="c">!   IF (ncciy &lt; 1986 .OR. ncciy &gt; 1995) THEN</span>
<a id="ln-387" name="ln-387" href="#ln-387"></a><span class="w">    </span><span class="c">!      PRINT *, &#39;Year &#39;, ncciy, &#39; outside range of dataset!&#39;</span>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="w">    </span><span class="c">!      STOP &#39;Please check input in namelist file.&#39;</span>
<a id="ln-389" name="ln-389" href="#ln-389"></a><span class="w">    </span><span class="c">!   ELSE</span>
<a id="ln-390" name="ln-390" href="#ln-390"></a><span class="w">    </span><span class="c">!</span>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="w">    </span><span class="c">!      CALL prepareFiles(ncciy)</span>
<a id="ln-392" name="ln-392" href="#ln-392"></a><span class="w">    </span><span class="c">!</span>
<a id="ln-393" name="ln-393" href="#ln-393"></a><span class="w">    </span><span class="c">!   ENDIF</span>
<a id="ln-394" name="ln-394" href="#ln-394"></a><span class="w">    </span><span class="c">!</span>
<a id="ln-395" name="ln-395" href="#ln-395"></a><span class="w">    </span><span class="c">!ENDIF</span>
<a id="ln-396" name="ln-396" href="#ln-396"></a>
<a id="ln-397" name="ln-397" href="#ln-397"></a><span class="w">    </span><span class="c">! Open met data and get site information from netcdf file.</span>
<a id="ln-398" name="ln-398" href="#ln-398"></a><span class="w">    </span><span class="c">! This retrieves time step size, number of timesteps, starting date,</span>
<a id="ln-399" name="ln-399" href="#ln-399"></a><span class="w">    </span><span class="c">! latitudes, longitudes, number of sites.</span>
<a id="ln-400" name="ln-400" href="#ln-400"></a><span class="w">    </span><span class="c">! MPI: master only; necessary info will be received by MPI below</span>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="w">    </span><span class="c">!CALL open_met_file( dels, kend, spinup, C%TFRZ )</span>
<a id="ln-402" name="ln-402" href="#ln-402"></a>
<a id="ln-403" name="ln-403" href="#ln-403"></a><span class="w">    </span><span class="c">! Checks where parameters and initialisations should be loaded from.</span>
<a id="ln-404" name="ln-404" href="#ln-404"></a><span class="w">    </span><span class="c">! If they can be found in either the met file or restart file, they will</span>
<a id="ln-405" name="ln-405" href="#ln-405"></a><span class="w">    </span><span class="c">! load from there, with the met file taking precedence. Otherwise, they&#39;ll</span>
<a id="ln-406" name="ln-406" href="#ln-406"></a><span class="w">    </span><span class="c">! be chosen from a coarse global grid of veg and soil types, based on</span>
<a id="ln-407" name="ln-407" href="#ln-407"></a><span class="w">    </span><span class="c">! the lat/lon coordinates. Allocation of CABLE&#39;s main variables also here.</span>
<a id="ln-408" name="ln-408" href="#ln-408"></a><span class="w">    </span><span class="c">! MPI: master only; necessary info will be received by MPI below</span>
<a id="ln-409" name="ln-409" href="#ln-409"></a><span class="w">    </span><span class="c">!CALL load_parameters( met, air, ssnow, veg, bgc,                            &amp;</span>
<a id="ln-410" name="ln-410" href="#ln-410"></a><span class="w">    </span><span class="c">!                      soil, canopy, rough, rad, sum_flux,                   &amp;</span>
<a id="ln-411" name="ln-411" href="#ln-411"></a><span class="w">    </span><span class="c">!                      bal, logn, vegparmnew, casabiome, casapool,           &amp;</span>
<a id="ln-412" name="ln-412" href="#ln-412"></a><span class="w">    </span><span class="c">!                      casaflux, casamet, casabal, phen, C%EMSOIL,        &amp;</span>
<a id="ln-413" name="ln-413" href="#ln-413"></a><span class="w">    </span><span class="c">!                      C%TFRZ )</span>
<a id="ln-414" name="ln-414" href="#ln-414"></a>
<a id="ln-415" name="ln-415" href="#ln-415"></a><span class="w">    </span><span class="c">! Check for leap-year settings</span>
<a id="ln-416" name="ln-416" href="#ln-416"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Bcast</span><span class="w"> </span><span class="p">(</span><span class="n">leaps</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_LOGICAL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-417" name="ln-417" href="#ln-417"></a>
<a id="ln-418" name="ln-418" href="#ln-418"></a><span class="w">    </span><span class="n">ktau_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-419" name="ln-419" href="#ln-419"></a><span class="w">    </span><span class="n">SPINLOOP</span><span class="p">:</span><span class="k">DO</span>
<a id="ln-420" name="ln-420" href="#ln-420"></a><span class="k">       </span><span class="n">YEAR</span><span class="p">:</span><span class="w"> </span><span class="k">DO </span><span class="n">YYYY</span><span class="o">=</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearStart</span><span class="p">,</span><span class="w">  </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YearEnd</span><span class="w"></span>
<a id="ln-421" name="ln-421" href="#ln-421"></a><span class="w">          </span><span class="n">CurYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">YYYY</span><span class="w"></span>
<a id="ln-422" name="ln-422" href="#ln-422"></a>
<a id="ln-423" name="ln-423" href="#ln-423"></a><span class="w">          </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">leaps</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">IS_LEAPYEAR</span><span class="p">(</span><span class="w"> </span><span class="n">YYYY</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-424" name="ln-424" href="#ln-424"></a><span class="k">             </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">366</span><span class="w"></span>
<a id="ln-425" name="ln-425" href="#ln-425"></a><span class="w">          </span><span class="k">ELSE</span>
<a id="ln-426" name="ln-426" href="#ln-426"></a><span class="k">             </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">365</span><span class="w"></span>
<a id="ln-427" name="ln-427" href="#ln-427"></a><span class="w">          </span><span class="k">ENDIF</span>
<a id="ln-428" name="ln-428" href="#ln-428"></a>
<a id="ln-429" name="ln-429" href="#ln-429"></a><span class="k">          IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CALL1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-430" name="ln-430" href="#ln-430"></a>
<a id="ln-431" name="ln-431" href="#ln-431"></a><span class="k">             IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">spinup</span><span class="p">)</span><span class="w">	</span><span class="n">spinConv</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-432" name="ln-432" href="#ln-432"></a>
<a id="ln-433" name="ln-433" href="#ln-433"></a><span class="w">             </span><span class="c">! MPI: bcast to workers so that they don&#39;t need to open the met</span>
<a id="ln-434" name="ln-434" href="#ln-434"></a><span class="w">             </span><span class="c">! file themselves</span>
<a id="ln-435" name="ln-435" href="#ln-435"></a><span class="w">             </span><span class="k">CALL </span><span class="n">MPI_Bcast</span><span class="w"> </span><span class="p">(</span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_REAL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-436" name="ln-436" href="#ln-436"></a><span class="w">          </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-437" name="ln-437" href="#ln-437"></a>
<a id="ln-438" name="ln-438" href="#ln-438"></a><span class="w">          </span><span class="c">! MPI: receive from master ending time fields</span>
<a id="ln-439" name="ln-439" href="#ln-439"></a><span class="w">          </span><span class="k">CALL </span><span class="n">MPI_Bcast</span><span class="w"> </span><span class="p">(</span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-440" name="ln-440" href="#ln-440"></a>
<a id="ln-441" name="ln-441" href="#ln-441"></a>
<a id="ln-442" name="ln-442" href="#ln-442"></a><span class="w">          </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CALL1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-443" name="ln-443" href="#ln-443"></a><span class="w">             </span><span class="c">! MPI: need to know extents before creating datatypes</span>
<a id="ln-444" name="ln-444" href="#ln-444"></a><span class="w">             </span><span class="k">CALL </span><span class="n">find_extents</span><span class="w"></span>
<a id="ln-445" name="ln-445" href="#ln-445"></a>
<a id="ln-446" name="ln-446" href="#ln-446"></a><span class="w">             </span><span class="c">! MPI: receive decomposition info from the master</span>
<a id="ln-447" name="ln-447" href="#ln-447"></a><span class="w">             </span><span class="k">CALL </span><span class="n">worker_decomp</span><span class="p">(</span><span class="n">comm</span><span class="p">)</span><span class="w"></span>
<a id="ln-448" name="ln-448" href="#ln-448"></a>
<a id="ln-449" name="ln-449" href="#ln-449"></a><span class="w">             </span><span class="c">! MPI: in overlap version sends and receives occur on separate comms</span>
<a id="ln-450" name="ln-450" href="#ln-450"></a><span class="w">             </span><span class="k">CALL </span><span class="n">MPI_Comm_dup</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-451" name="ln-451" href="#ln-451"></a><span class="w">             </span><span class="k">CALL </span><span class="n">MPI_Comm_dup</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-452" name="ln-452" href="#ln-452"></a>
<a id="ln-453" name="ln-453" href="#ln-453"></a><span class="w">             </span><span class="c">! MPI: data set in load_parameter is now received from</span>
<a id="ln-454" name="ln-454" href="#ln-454"></a><span class="w">             </span><span class="c">! the master</span>
<a id="ln-455" name="ln-455" href="#ln-455"></a>
<a id="ln-456" name="ln-456" href="#ln-456"></a><span class="w">             </span><span class="k">CALL </span><span class="n">worker_cable_params</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="n">air</span><span class="p">,</span><span class="n">ssnow</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">bgc</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">canopy</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-457" name="ln-457" href="#ln-457"></a><span class="w">                  </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">rough</span><span class="p">,</span><span class="n">rad</span><span class="p">,</span><span class="n">sum_flux</span><span class="p">,</span><span class="n">bal</span><span class="p">)</span><span class="w"></span>
<a id="ln-458" name="ln-458" href="#ln-458"></a>
<a id="ln-459" name="ln-459" href="#ln-459"></a><span class="w">             </span><span class="c">!mrd561 debug</span>
<a id="ln-460" name="ln-460" href="#ln-460"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; ssat_vec min&#39;</span><span class="p">,</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">ssat_vec</span><span class="p">),</span><span class="nb">MINLOC</span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">ssat_vec</span><span class="p">)</span><span class="w"></span>
<a id="ln-461" name="ln-461" href="#ln-461"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; sfc_vec min&#39;</span><span class="p">,</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">sfc_vec</span><span class="p">),</span><span class="nb">MINLOC</span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">sfc_vec</span><span class="p">)</span><span class="w"></span>
<a id="ln-462" name="ln-462" href="#ln-462"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; wb min&#39;</span><span class="p">,</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wb</span><span class="p">),</span><span class="nb">MINLOC</span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wb</span><span class="p">)</span><span class="w"></span>
<a id="ln-463" name="ln-463" href="#ln-463"></a><span class="w">             </span><span class="k">CALL </span><span class="nb">flush</span><span class="p">(</span><span class="n">wlogn</span><span class="p">)</span><span class="w"></span>
<a id="ln-464" name="ln-464" href="#ln-464"></a>
<a id="ln-465" name="ln-465" href="#ln-465"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">call_climate</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-466" name="ln-466" href="#ln-466"></a><span class="k">                CALL </span><span class="n">worker_climate_types</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-467" name="ln-467" href="#ln-467"></a><span class="w">             </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-468" name="ln-468" href="#ln-468"></a>
<a id="ln-469" name="ln-469" href="#ln-469"></a><span class="w">             </span><span class="c">! MPI: mvtype and mstype send out here instead of inside worker_casa_params</span>
<a id="ln-470" name="ln-470" href="#ln-470"></a><span class="w">             </span><span class="c">!      so that old CABLE carbon module can use them. (BP May 2013)</span>
<a id="ln-471" name="ln-471" href="#ln-471"></a><span class="w">             </span><span class="k">CALL </span><span class="n">MPI_Bcast</span><span class="w"> </span><span class="p">(</span><span class="n">mvtype</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-472" name="ln-472" href="#ln-472"></a><span class="w">             </span><span class="k">CALL </span><span class="n">MPI_Bcast</span><span class="w"> </span><span class="p">(</span><span class="n">mstype</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-473" name="ln-473" href="#ln-473"></a>
<a id="ln-474" name="ln-474" href="#ln-474"></a><span class="w">             </span><span class="c">! MPI: casa parameters received only if cnp module is active</span>
<a id="ln-475" name="ln-475" href="#ln-475"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-476" name="ln-476" href="#ln-476"></a>
<a id="ln-477" name="ln-477" href="#ln-477"></a><span class="k">                CALL </span><span class="n">worker_casa_params</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="n">casamet</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-478" name="ln-478" href="#ln-478"></a><span class="w">                     </span><span class="p">&amp;</span><span class="w">                        </span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">)</span><span class="w"></span>
<a id="ln-479" name="ln-479" href="#ln-479"></a>
<a id="ln-480" name="ln-480" href="#ln-480"></a><span class="w">                </span><span class="c">! MPI: POP restart received only if pop module AND casa are active</span>
<a id="ln-481" name="ln-481" href="#ln-481"></a><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CALL_POP</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">worker_pop_types</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">casamet</span><span class="p">,</span><span class="n">pop</span><span class="p">)</span><span class="w"></span>
<a id="ln-482" name="ln-482" href="#ln-482"></a>
<a id="ln-483" name="ln-483" href="#ln-483"></a><span class="w">             </span><span class="k">END IF</span><span class="w"></span>
<a id="ln-484" name="ln-484" href="#ln-484"></a>
<a id="ln-485" name="ln-485" href="#ln-485"></a><span class="w">             </span><span class="c">! MPI: create inp_t type to receive input data from the master</span>
<a id="ln-486" name="ln-486" href="#ln-486"></a><span class="w">             </span><span class="c">! at the start of every timestep</span>
<a id="ln-487" name="ln-487" href="#ln-487"></a><span class="w">             </span><span class="k">CALL </span><span class="n">worker_intype</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="n">met</span><span class="p">,</span><span class="n">veg</span><span class="p">)</span><span class="w"></span>
<a id="ln-488" name="ln-488" href="#ln-488"></a>
<a id="ln-489" name="ln-489" href="#ln-489"></a><span class="w">             </span><span class="c">! MPI: casa parameters received only if cnp module is active</span>
<a id="ln-490" name="ln-490" href="#ln-490"></a><span class="w">             </span><span class="c">! MPI: create send_t type to send the results to the master</span>
<a id="ln-491" name="ln-491" href="#ln-491"></a><span class="w">             </span><span class="c">! at the end of every timestep</span>
<a id="ln-492" name="ln-492" href="#ln-492"></a><span class="w">             </span><span class="k">CALL </span><span class="n">worker_outtype</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="n">met</span><span class="p">,</span><span class="n">canopy</span><span class="p">,</span><span class="n">ssnow</span><span class="p">,</span><span class="n">rad</span><span class="p">,</span><span class="n">bal</span><span class="p">,</span><span class="n">air</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">veg</span><span class="p">)</span><span class="w"></span>
<a id="ln-493" name="ln-493" href="#ln-493"></a>
<a id="ln-494" name="ln-494" href="#ln-494"></a><span class="w">             </span><span class="c">! MPI: casa parameters received only if cnp module is active</span>
<a id="ln-495" name="ln-495" href="#ln-495"></a><span class="w">             </span><span class="c">! MPI: create type to send casa results back to the master</span>
<a id="ln-496" name="ln-496" href="#ln-496"></a><span class="w">             </span><span class="c">! only if cnp module is active</span>
<a id="ln-497" name="ln-497" href="#ln-497"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-498" name="ln-498" href="#ln-498"></a><span class="k">                CALL </span><span class="n">worker_casa_type</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-499" name="ln-499" href="#ln-499"></a><span class="w">                     </span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="w"> </span><span class="n">phen</span><span class="p">)</span><span class="w"></span>
<a id="ln-500" name="ln-500" href="#ln-500"></a>
<a id="ln-501" name="ln-501" href="#ln-501"></a><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_READ</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_DUMP_WRITE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-502" name="ln-502" href="#ln-502"></a><span class="w">                     </span><span class="k">CALL </span><span class="n">worker_casa_dump_types</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">phen</span><span class="p">,</span><span class="w"> </span><span class="n">climate</span><span class="p">)</span><span class="w"></span>
<a id="ln-503" name="ln-503" href="#ln-503"></a><span class="w">                </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;cable_mpiworker, POPLUC: &#39;</span><span class="p">,</span><span class="w">  </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="w"></span>
<a id="ln-504" name="ln-504" href="#ln-504"></a><span class="w">                </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;cable_mpiworker, POPLUC: &#39;</span><span class="p">,</span><span class="w">  </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="w"></span>
<a id="ln-505" name="ln-505" href="#ln-505"></a><span class="w">                </span><span class="k">CALL </span><span class="nb">flush</span><span class="p">(</span><span class="n">wlogn</span><span class="p">)</span><span class="w"></span>
<a id="ln-506" name="ln-506" href="#ln-506"></a><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-507" name="ln-507" href="#ln-507"></a><span class="w">                     </span><span class="k">CALL </span><span class="n">worker_casa_LUC_types</span><span class="p">(</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">)</span><span class="w"></span>
<a id="ln-508" name="ln-508" href="#ln-508"></a>
<a id="ln-509" name="ln-509" href="#ln-509"></a>
<a id="ln-510" name="ln-510" href="#ln-510"></a><span class="w">                </span><span class="c">! MPI: casa parameters received only if cnp module is active</span>
<a id="ln-511" name="ln-511" href="#ln-511"></a><span class="w">             </span><span class="k">END IF</span><span class="w"></span>
<a id="ln-512" name="ln-512" href="#ln-512"></a>
<a id="ln-513" name="ln-513" href="#ln-513"></a><span class="w">             </span><span class="c">! MPI: create type to send restart data back to the master</span>
<a id="ln-514" name="ln-514" href="#ln-514"></a><span class="w">             </span><span class="c">! only if restart file is to be created</span>
<a id="ln-515" name="ln-515" href="#ln-515"></a><span class="w">             </span><span class="k">IF</span><span class="p">(</span><span class="n">output</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-516" name="ln-516" href="#ln-516"></a>
<a id="ln-517" name="ln-517" href="#ln-517"></a><span class="k">                CALL </span><span class="n">worker_restart_type</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="p">)</span><span class="w"></span>
<a id="ln-518" name="ln-518" href="#ln-518"></a>
<a id="ln-519" name="ln-519" href="#ln-519"></a><span class="w">             </span><span class="k">END IF</span><span class="w"></span>
<a id="ln-520" name="ln-520" href="#ln-520"></a>
<a id="ln-521" name="ln-521" href="#ln-521"></a><span class="w">             </span><span class="c">! Open output file:</span>
<a id="ln-522" name="ln-522" href="#ln-522"></a><span class="w">             </span><span class="c">! MPI: only the master writes to the files</span>
<a id="ln-523" name="ln-523" href="#ln-523"></a><span class="w">             </span><span class="c">!CALL open_output_file( dels, soil, veg, bgc, rough )</span>
<a id="ln-524" name="ln-524" href="#ln-524"></a>
<a id="ln-525" name="ln-525" href="#ln-525"></a><span class="w">             </span><span class="n">ssnow</span><span class="p">%</span><span class="n">otss_0</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">tgg</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-526" name="ln-526" href="#ln-526"></a><span class="w">             </span><span class="n">ssnow</span><span class="p">%</span><span class="n">otss</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">tgg</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-527" name="ln-527" href="#ln-527"></a><span class="w">             </span><span class="n">canopy</span><span class="p">%</span><span class="n">fes_cor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-528" name="ln-528" href="#ln-528"></a><span class="w">             </span><span class="n">canopy</span><span class="p">%</span><span class="n">fhs_cor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-529" name="ln-529" href="#ln-529"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">ofsd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w"></span>
<a id="ln-530" name="ln-530" href="#ln-530"></a>
<a id="ln-531" name="ln-531" href="#ln-531"></a><span class="w">             </span><span class="c">! CALL worker_sumcasa_types(comm, sum_casapool, sum_casaflux)</span>
<a id="ln-532" name="ln-532" href="#ln-532"></a>
<a id="ln-533" name="ln-533" href="#ln-533"></a>
<a id="ln-534" name="ln-534" href="#ln-534"></a><span class="w">             </span><span class="c">!count_sum_casa = 0</span>
<a id="ln-535" name="ln-535" href="#ln-535"></a>
<a id="ln-536" name="ln-536" href="#ln-536"></a>
<a id="ln-537" name="ln-537" href="#ln-537"></a><span class="w">             </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="n">icycle</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">spincasa</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-538" name="ln-538" href="#ln-538"></a><span class="k">                WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;EXT spincasacnp enabled with mloop= &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">mloop</span><span class="w"></span>
<a id="ln-539" name="ln-539" href="#ln-539"></a><span class="w">                </span><span class="k">CALL </span><span class="n">worker_spincasacnp</span><span class="p">(</span><span class="n">dels</span><span class="p">,</span><span class="n">kstart</span><span class="p">,</span><span class="n">kend</span><span class="p">,</span><span class="n">mloop</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-540" name="ln-540" href="#ln-540"></a><span class="w">                     </span><span class="n">casaflux</span><span class="p">,</span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="n">LALLOC</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">)</span><span class="w"></span>
<a id="ln-541" name="ln-541" href="#ln-541"></a><span class="w">                </span><span class="n">SPINconv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-542" name="ln-542" href="#ln-542"></a><span class="w">                </span><span class="n">CASAONLY</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<a id="ln-543" name="ln-543" href="#ln-543"></a><span class="w">                </span><span class="n">ktau_gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-544" name="ln-544" href="#ln-544"></a><span class="w">                </span><span class="n">ktau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-545" name="ln-545" href="#ln-545"></a>
<a id="ln-546" name="ln-546" href="#ln-546"></a><span class="w">             </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">casaonly</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">spincasa</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">cable_user</span><span class="p">%</span><span class="n">popluc</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-547" name="ln-547" href="#ln-547"></a><span class="k">                CALL </span><span class="n">worker_CASAONLY_LUC</span><span class="p">(</span><span class="n">dels</span><span class="p">,</span><span class="n">kstart</span><span class="p">,</span><span class="n">kend</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-548" name="ln-548" href="#ln-548"></a><span class="w">                     </span><span class="n">casaflux</span><span class="p">,</span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="n">LALLOC</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-549" name="ln-549" href="#ln-549"></a><span class="w">                     </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">)</span><span class="w"></span>
<a id="ln-550" name="ln-550" href="#ln-550"></a><span class="w">                </span><span class="n">SPINconv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-551" name="ln-551" href="#ln-551"></a><span class="w">                </span><span class="n">ktau_gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-552" name="ln-552" href="#ln-552"></a><span class="w">                </span><span class="n">ktau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-553" name="ln-553" href="#ln-553"></a><span class="w">             </span><span class="k">ENDIF</span>
<a id="ln-554" name="ln-554" href="#ln-554"></a>
<a id="ln-555" name="ln-555" href="#ln-555"></a><span class="k">          ELSE</span>
<a id="ln-556" name="ln-556" href="#ln-556"></a><span class="k">             IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-557" name="ln-557" href="#ln-557"></a><span class="w">                </span><span class="c">! re-initalise annual flux sums</span>
<a id="ln-558" name="ln-558" href="#ln-558"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">FCgppyear</span><span class="w"> </span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-559" name="ln-559" href="#ln-559"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrpyear</span><span class="w">  </span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-560" name="ln-560" href="#ln-560"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">FCnppyear</span><span class="w"> </span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-561" name="ln-561" href="#ln-561"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrsyear</span><span class="w">  </span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-562" name="ln-562" href="#ln-562"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">FCneeyear</span><span class="w"> </span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-563" name="ln-563" href="#ln-563"></a><span class="w">             </span><span class="k">ENDIF</span>
<a id="ln-564" name="ln-564" href="#ln-564"></a>
<a id="ln-565" name="ln-565" href="#ln-565"></a><span class="k">          ENDIF</span><span class="w"> </span><span class="c">!CALL1</span>
<a id="ln-566" name="ln-566" href="#ln-566"></a>
<a id="ln-567" name="ln-567" href="#ln-567"></a>
<a id="ln-568" name="ln-568" href="#ln-568"></a><span class="w">          </span><span class="c">! globally (WRT code) accessible kend through USE cable_common_module</span>
<a id="ln-569" name="ln-569" href="#ln-569"></a><span class="w">          </span><span class="n">ktau_gl</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-570" name="ln-570" href="#ln-570"></a><span class="w">          </span><span class="n">kwidth_gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">dels</span><span class="p">)</span><span class="w"></span>
<a id="ln-571" name="ln-571" href="#ln-571"></a><span class="w">          </span><span class="n">kend_gl</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">kend</span><span class="w"></span>
<a id="ln-572" name="ln-572" href="#ln-572"></a><span class="w">          </span><span class="n">knode_gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-573" name="ln-573" href="#ln-573"></a>
<a id="ln-574" name="ln-574" href="#ln-574"></a><span class="w">          </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">spincasa</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">casaonly</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-575" name="ln-575" href="#ln-575"></a><span class="k">             EXIT</span>
<a id="ln-576" name="ln-576" href="#ln-576"></a><span class="k">          ENDIF</span>
<a id="ln-577" name="ln-577" href="#ln-577"></a>
<a id="ln-578" name="ln-578" href="#ln-578"></a><span class="k">  if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">heat_cap_lower_limit</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-579" name="ln-579" href="#ln-579"></a><span class="k">    allocate</span><span class="p">(</span><span class="w"> </span><span class="n">heat_cap_lower_limit</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="n">ms</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<a id="ln-580" name="ln-580" href="#ln-580"></a><span class="w">    </span><span class="n">heat_cap_lower_limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w"></span>
<a id="ln-581" name="ln-581" href="#ln-581"></a><span class="w">  </span><span class="k">end if</span>
<a id="ln-582" name="ln-582" href="#ln-582"></a>
<a id="ln-583" name="ln-583" href="#ln-583"></a><span class="k">  call </span><span class="n">spec_init_soil_snow</span><span class="p">(</span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">bal</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">heat_cap_lower_limit</span><span class="p">)</span><span class="w"></span>
<a id="ln-584" name="ln-584" href="#ln-584"></a>
<a id="ln-585" name="ln-585" href="#ln-585"></a><span class="w">  </span>
<a id="ln-586" name="ln-586" href="#ln-586"></a><span class="w">          </span><span class="c">! IF (.NOT.spincasa) THEN</span>
<a id="ln-587" name="ln-587" href="#ln-587"></a><span class="w">          </span><span class="c">! time step loop over ktau</span>
<a id="ln-588" name="ln-588" href="#ln-588"></a><span class="w">          </span><span class="n">KTAULOOP</span><span class="p">:</span><span class="k">DO </span><span class="n">ktau</span><span class="o">=</span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="w"></span>
<a id="ln-589" name="ln-589" href="#ln-589"></a>
<a id="ln-590" name="ln-590" href="#ln-590"></a><span class="w">             </span><span class="c">! increment total timstep counter</span>
<a id="ln-591" name="ln-591" href="#ln-591"></a><span class="w">             </span><span class="n">ktau_tot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ktau_tot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-592" name="ln-592" href="#ln-592"></a>
<a id="ln-593" name="ln-593" href="#ln-593"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ktau -&#39;</span><span class="p">,</span><span class="n">ktau_tot</span><span class="w"></span>
<a id="ln-594" name="ln-594" href="#ln-594"></a><span class="w">             </span><span class="k">CALL </span><span class="nb">flush</span><span class="p">(</span><span class="n">wlogn</span><span class="p">)</span><span class="w"></span>
<a id="ln-595" name="ln-595" href="#ln-595"></a>
<a id="ln-596" name="ln-596" href="#ln-596"></a><span class="w">             </span><span class="c">! globally (WRT code) accessible kend through USE cable_common_module</span>
<a id="ln-597" name="ln-597" href="#ln-597"></a><span class="w">             </span><span class="n">ktau_gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ktau_gl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-598" name="ln-598" href="#ln-598"></a>
<a id="ln-599" name="ln-599" href="#ln-599"></a><span class="w">             </span><span class="c">! somethings (e.g. CASA-CNP) only need to be done once per day</span>
<a id="ln-600" name="ln-600" href="#ln-600"></a><span class="w">             </span><span class="n">ktauday</span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="mi">2</span><span class="mf">4.0</span><span class="o">*</span><span class="mi">360</span><span class="mf">0.0</span><span class="o">/</span><span class="n">dels</span><span class="p">)</span><span class="w"></span>
<a id="ln-601" name="ln-601" href="#ln-601"></a><span class="c">!!$             idoy = mod(ktau/ktauday,365)</span>
<a id="ln-602" name="ln-602" href="#ln-602"></a><span class="c">!!$             IF(idoy==0) idoy=365</span>
<a id="ln-603" name="ln-603" href="#ln-603"></a><span class="c">!!$</span>
<a id="ln-604" name="ln-604" href="#ln-604"></a><span class="c">!!$             ! needed for CASA-CNP</span>
<a id="ln-605" name="ln-605" href="#ln-605"></a><span class="c">!!$             nyear =INT((kend-kstart+1)/(365*ktauday))</span>
<a id="ln-606" name="ln-606" href="#ln-606"></a>
<a id="ln-607" name="ln-607" href="#ln-607"></a><span class="w">             </span><span class="c">! some things (e.g. CASA-CNP) only need to be done once per day</span>
<a id="ln-608" name="ln-608" href="#ln-608"></a><span class="w">             </span><span class="n">idoy</span><span class="w"> </span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="w"> </span><span class="nb">MOD</span><span class="p">((</span><span class="kt">REAL</span><span class="p">(</span><span class="n">ktau</span><span class="o">+</span><span class="n">koffset</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">ktauday</span><span class="p">)),</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">)))</span><span class="w"></span>
<a id="ln-609" name="ln-609" href="#ln-609"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idoy</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">idoy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LOY</span><span class="w"></span>
<a id="ln-610" name="ln-610" href="#ln-610"></a>
<a id="ln-611" name="ln-611" href="#ln-611"></a><span class="w">             </span><span class="c">! needed for CASA-CNP</span>
<a id="ln-612" name="ln-612" href="#ln-612"></a><span class="w">             </span><span class="n">nyear</span><span class="w"> </span><span class="o">=</span><span class="nb">INT</span><span class="p">((</span><span class="n">kend</span><span class="o">-</span><span class="n">kstart</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">LOY</span><span class="o">*</span><span class="n">ktauday</span><span class="p">))</span><span class="w"></span>
<a id="ln-613" name="ln-613" href="#ln-613"></a>
<a id="ln-614" name="ln-614" href="#ln-614"></a>
<a id="ln-615" name="ln-615" href="#ln-615"></a>
<a id="ln-616" name="ln-616" href="#ln-616"></a>
<a id="ln-617" name="ln-617" href="#ln-617"></a><span class="w">             </span><span class="n">canopy</span><span class="p">%</span><span class="n">oldcansto</span><span class="o">=</span><span class="n">canopy</span><span class="p">%</span><span class="n">cansto</span><span class="w"></span>
<a id="ln-618" name="ln-618" href="#ln-618"></a>
<a id="ln-619" name="ln-619" href="#ln-619"></a><span class="w">             </span><span class="c">! Get met data and LAI, set time variables.</span>
<a id="ln-620" name="ln-620" href="#ln-620"></a><span class="w">             </span><span class="c">! Rainfall input may be augmented for spinup purposes:</span>
<a id="ln-621" name="ln-621" href="#ln-621"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">ofsd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">fsd</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">fsd</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-622" name="ln-622" href="#ln-622"></a><span class="w">             </span><span class="c">! MPI: input file read on the master only</span>
<a id="ln-623" name="ln-623" href="#ln-623"></a><span class="w">             </span><span class="c">!CALL get_met_data( spinup, spinConv, met, soil,                    &amp;</span>
<a id="ln-624" name="ln-624" href="#ln-624"></a><span class="w">             </span><span class="c">!                   rad, veg, kend, dels, C%TFRZ, ktau )</span>
<a id="ln-625" name="ln-625" href="#ln-625"></a>
<a id="ln-626" name="ln-626" href="#ln-626"></a><span class="w">             </span><span class="c">! MPI: receive input data for this step from the master</span>
<a id="ln-627" name="ln-627" href="#ln-627"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-628" name="ln-628" href="#ln-628"></a>
<a id="ln-629" name="ln-629" href="#ln-629"></a><span class="k">                CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">inp_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ktau_gl</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-630" name="ln-630" href="#ln-630"></a>
<a id="ln-631" name="ln-631" href="#ln-631"></a><span class="w">                </span><span class="c">! MPI: receive casa_dump_data for this step from the master</span>
<a id="ln-632" name="ln-632" href="#ln-632"></a><span class="w">             </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IS_CASA_TIME</span><span class="p">(</span><span class="s2">&quot;dread&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="n">koffset</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-633" name="ln-633" href="#ln-633"></a><span class="w">                  </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="p">,</span><span class="w"> </span><span class="n">wlogn</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-634" name="ln-634" href="#ln-634"></a><span class="k">                CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_dump_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ktau_gl</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-635" name="ln-635" href="#ln-635"></a><span class="w">             </span><span class="k">END IF</span><span class="w"></span>
<a id="ln-636" name="ln-636" href="#ln-636"></a>
<a id="ln-637" name="ln-637" href="#ln-637"></a><span class="w">             </span><span class="c">! MPI: some fields need explicit init, because we don&#39;t transfer</span>
<a id="ln-638" name="ln-638" href="#ln-638"></a><span class="w">             </span><span class="c">! them for better performance</span>
<a id="ln-639" name="ln-639" href="#ln-639"></a><span class="w">             </span><span class="c">! in the serial version this is done in get_met_data</span>
<a id="ln-640" name="ln-640" href="#ln-640"></a><span class="w">             </span><span class="c">! after input has been read from the file</span>
<a id="ln-641" name="ln-641" href="#ln-641"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">tvair</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">tk</span><span class="w"></span>
<a id="ln-642" name="ln-642" href="#ln-642"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">tvrad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">tk</span><span class="w"></span>
<a id="ln-643" name="ln-643" href="#ln-643"></a>
<a id="ln-644" name="ln-644" href="#ln-644"></a><span class="w">             </span><span class="c">! Feedback prognostic vcmax and daily LAI from casaCNP to CABLE</span>
<a id="ln-645" name="ln-645" href="#ln-645"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">l_vcmaxFeedbk</span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">casa_feedback</span><span class="p">(</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">casabiome</span><span class="p">,</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-646" name="ln-646" href="#ln-646"></a><span class="w">                  </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-647" name="ln-647" href="#ln-647"></a>
<a id="ln-648" name="ln-648" href="#ln-648"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">l_laiFeedbk</span><span class="p">)</span><span class="w"> </span><span class="n">veg</span><span class="p">%</span><span class="n">vlai</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">glai</span><span class="p">(:))</span><span class="w"></span>
<a id="ln-649" name="ln-649" href="#ln-649"></a>
<a id="ln-650" name="ln-650" href="#ln-650"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_climate</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-651" name="ln-651" href="#ln-651"></a><span class="w">                  </span><span class="k">CALL </span><span class="n">cable_climate</span><span class="p">(</span><span class="n">ktau_tot</span><span class="p">,</span><span class="n">kstart</span><span class="p">,</span><span class="n">kend</span><span class="p">,</span><span class="n">ktauday</span><span class="p">,</span><span class="n">idoy</span><span class="p">,</span><span class="n">LOY</span><span class="p">,</span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-652" name="ln-652" href="#ln-652"></a><span class="w">                  </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="p">,</span><span class="w"> </span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">)</span><span class="w"></span>
<a id="ln-653" name="ln-653" href="#ln-653"></a>
<a id="ln-654" name="ln-654" href="#ln-654"></a>
<a id="ln-655" name="ln-655" href="#ln-655"></a><span class="w">   </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">c1</span><span class="p">))</span><span class="w"> </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="w"> </span><span class="n">c1</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="n">nrb</span><span class="p">),</span><span class="w"> </span><span class="n">rhoch</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="n">nrb</span><span class="p">),</span><span class="w"> </span><span class="n">xk</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="n">nrb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-656" name="ln-656" href="#ln-656"></a><span class="w">             </span><span class="c">! CALL land surface scheme for this timestep, all grid points:</span>
<a id="ln-657" name="ln-657" href="#ln-657"></a><span class="w">   </span><span class="k">CALL </span><span class="n">cbm</span><span class="p">(</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="p">,</span><span class="w"> </span><span class="n">bgc</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">bal</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-658" name="ln-658" href="#ln-658"></a><span class="w">             </span><span class="n">rad</span><span class="p">,</span><span class="w"> </span><span class="n">rough</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">,</span><span class="w"> </span><span class="n">sum_flux</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">xk</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">rhoch</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-659" name="ln-659" href="#ln-659"></a>
<a id="ln-660" name="ln-660" href="#ln-660"></a><span class="w">             </span><span class="n">ssnow</span><span class="p">%</span><span class="n">smelt</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">smelt</span><span class="o">*</span><span class="n">dels</span><span class="w"></span>
<a id="ln-661" name="ln-661" href="#ln-661"></a><span class="w">             </span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof1</span><span class="o">*</span><span class="n">dels</span><span class="w"></span>
<a id="ln-662" name="ln-662" href="#ln-662"></a><span class="w">             </span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof2</span><span class="o">*</span><span class="n">dels</span><span class="w"></span>
<a id="ln-663" name="ln-663" href="#ln-663"></a><span class="w">             </span><span class="n">ssnow</span><span class="p">%</span><span class="n">runoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssnow</span><span class="p">%</span><span class="n">runoff</span><span class="o">*</span><span class="n">dels</span><span class="w"></span>
<a id="ln-664" name="ln-664" href="#ln-664"></a>
<a id="ln-665" name="ln-665" href="#ln-665"></a>
<a id="ln-666" name="ln-666" href="#ln-666"></a><span class="w">             </span><span class="c">!jhan this is insufficient testing. condition for</span>
<a id="ln-667" name="ln-667" href="#ln-667"></a><span class="w">             </span><span class="c">!spinup=.false. &amp; we want CASA_dump.nc (spinConv=.true.)</span>
<a id="ln-668" name="ln-668" href="#ln-668"></a>
<a id="ln-669" name="ln-669" href="#ln-669"></a><span class="w">             </span><span class="k">IF</span><span class="p">(</span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-670" name="ln-670" href="#ln-670"></a>
<a id="ln-671" name="ln-671" href="#ln-671"></a><span class="k">                CALL </span><span class="n">bgcdriver</span><span class="p">(</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">met</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-672" name="ln-672" href="#ln-672"></a><span class="w">                     </span><span class="n">ssnow</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">casabiome</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-673" name="ln-673" href="#ln-673"></a><span class="w">                     </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-674" name="ln-674" href="#ln-674"></a><span class="w">                     </span><span class="n">phen</span><span class="p">,</span><span class="w"> </span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">spinConv</span><span class="p">,</span><span class="w"> </span><span class="n">spinup</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="p">,</span><span class="w"> </span><span class="n">idoy</span><span class="p">,</span><span class="w"> </span><span class="n">loy</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-675" name="ln-675" href="#ln-675"></a><span class="w">                     </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">LALLOC</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-676" name="ln-676" href="#ln-676"></a>
<a id="ln-677" name="ln-677" href="#ln-677"></a><span class="w">                </span><span class="c">! IF(MOD((ktau-kstart+1),ktauday)==0) THEN</span>
<a id="ln-678" name="ln-678" href="#ln-678"></a><span class="w">                </span><span class="k">CALL </span><span class="n">MPI_Send</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ktau_gl</span><span class="p">,</span><span class="n">ocomm</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-679" name="ln-679" href="#ln-679"></a>
<a id="ln-680" name="ln-680" href="#ln-680"></a><span class="w">                </span><span class="c">!  ENDIF</span>
<a id="ln-681" name="ln-681" href="#ln-681"></a>
<a id="ln-682" name="ln-682" href="#ln-682"></a><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IS_CASA_TIME</span><span class="p">(</span><span class="s2">&quot;write&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-683" name="ln-683" href="#ln-683"></a><span class="w">                     </span><span class="n">koffset</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="p">,</span><span class="w"> </span><span class="n">wlogn</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-684" name="ln-684" href="#ln-684"></a><span class="w">                   </span><span class="c">! write(wlogn,*), &#39;IN IS_CASA&#39;, casapool%cplant(:,1)</span>
<a id="ln-685" name="ln-685" href="#ln-685"></a><span class="w">                   </span><span class="c">!      CALL MPI_Send (MPI_BOTTOM,1, casa_t,0,ktau_gl,ocomm,ierr)</span>
<a id="ln-686" name="ln-686" href="#ln-686"></a><span class="w">                </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-687" name="ln-687" href="#ln-687"></a>
<a id="ln-688" name="ln-688" href="#ln-688"></a>
<a id="ln-689" name="ln-689" href="#ln-689"></a><span class="w">                </span><span class="c">! MPI: send the results back to the master</span>
<a id="ln-690" name="ln-690" href="#ln-690"></a><span class="w">                </span><span class="k">IF</span><span class="p">(</span><span class="w"> </span><span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">spinup</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">spinup</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">spinConv</span><span class="p">))</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-691" name="ln-691" href="#ln-691"></a><span class="w">                     </span><span class="n">IS_CASA_TIME</span><span class="p">(</span><span class="s2">&quot;dwrit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yyyy</span><span class="p">,</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-692" name="ln-692" href="#ln-692"></a><span class="w">                     </span><span class="n">koffset</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="p">,</span><span class="w"> </span><span class="n">logn</span><span class="p">))</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-693" name="ln-693" href="#ln-693"></a><span class="w">                     </span><span class="k">CALL </span><span class="n">MPI_Send</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_dump_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ktau_gl</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-694" name="ln-694" href="#ln-694"></a>
<a id="ln-695" name="ln-695" href="#ln-695"></a><span class="w">             </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-696" name="ln-696" href="#ln-696"></a>
<a id="ln-697" name="ln-697" href="#ln-697"></a><span class="w">             </span><span class="c">! sumcflux is pulled out of subroutine cbm</span>
<a id="ln-698" name="ln-698" href="#ln-698"></a><span class="w">             </span><span class="c">! so that casaCNP can be called before adding the fluxes (Feb 2008, YP)</span>
<a id="ln-699" name="ln-699" href="#ln-699"></a><span class="w">             </span><span class="k">CALL </span><span class="n">sumcflux</span><span class="p">(</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="w"> </span><span class="n">kstart</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="w"> </span><span class="n">bgc</span><span class="p">,</span><span class="w">              </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-700" name="ln-700" href="#ln-700"></a><span class="w">                  </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">soil</span><span class="p">,</span><span class="w"> </span><span class="n">ssnow</span><span class="p">,</span><span class="w"> </span><span class="n">sum_flux</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-701" name="ln-701" href="#ln-701"></a><span class="w">                  </span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">l_vcmaxFeedbk</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-702" name="ln-702" href="#ln-702"></a>
<a id="ln-703" name="ln-703" href="#ln-703"></a><span class="w">             </span><span class="c">! MPI: send the results back to the master</span>
<a id="ln-704" name="ln-704" href="#ln-704"></a><span class="w">             </span><span class="k">CALL </span><span class="n">MPI_Send</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">send_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ktau_gl</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-705" name="ln-705" href="#ln-705"></a>
<a id="ln-706" name="ln-706" href="#ln-706"></a><span class="w">             </span><span class="c">! Write time step&#39;s output to file if either: we&#39;re not spinning up</span>
<a id="ln-707" name="ln-707" href="#ln-707"></a><span class="w">             </span><span class="c">! or we&#39;re spinning up and the spinup has converged:</span>
<a id="ln-708" name="ln-708" href="#ln-708"></a><span class="w">             </span><span class="c">! MPI: writing done only by the master</span>
<a id="ln-709" name="ln-709" href="#ln-709"></a><span class="w">             </span><span class="c">!IF((.NOT.spinup).OR.(spinup.AND.spinConv))                         &amp;</span>
<a id="ln-710" name="ln-710" href="#ln-710"></a><span class="w">             </span><span class="c">!   CALL write_output( dels, ktau, met, canopy, ssnow,                    &amp;</span>
<a id="ln-711" name="ln-711" href="#ln-711"></a><span class="w">             </span><span class="c">!                      rad, bal, air, soil, veg, C%SBOLTZ, &amp;</span>
<a id="ln-712" name="ln-712" href="#ln-712"></a><span class="w">             </span><span class="c">!                      C%EMLEAF, C%EMSOIL )</span>
<a id="ln-713" name="ln-713" href="#ln-713"></a>
<a id="ln-714" name="ln-714" href="#ln-714"></a>
<a id="ln-715" name="ln-715" href="#ln-715"></a><span class="w">             </span><span class="n">CALL1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-716" name="ln-716" href="#ln-716"></a>
<a id="ln-717" name="ln-717" href="#ln-717"></a><span class="w">          </span><span class="k">END DO </span><span class="n">KTAULOOP</span><span class="w"> </span><span class="c">! END Do loop over timestep ktau</span>
<a id="ln-718" name="ln-718" href="#ln-718"></a><span class="w">          </span><span class="c">! ELSE</span>
<a id="ln-719" name="ln-719" href="#ln-719"></a>
<a id="ln-720" name="ln-720" href="#ln-720"></a><span class="w">          </span><span class="n">CALL1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<a id="ln-721" name="ln-721" href="#ln-721"></a><span class="w">          </span><span class="c">! ENDIF</span>
<a id="ln-722" name="ln-722" href="#ln-722"></a>
<a id="ln-723" name="ln-723" href="#ln-723"></a>
<a id="ln-724" name="ln-724" href="#ln-724"></a><span class="w">          </span><span class="k">CALL </span><span class="nb">flush</span><span class="p">(</span><span class="n">wlogn</span><span class="p">)</span><span class="w"></span>
<a id="ln-725" name="ln-725" href="#ln-725"></a><span class="w">          </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w">   </span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_POP</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-726" name="ln-726" href="#ln-726"></a>
<a id="ln-727" name="ln-727" href="#ln-727"></a><span class="k">             IF</span><span class="w"> </span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-728" name="ln-728" href="#ln-728"></a>
<a id="ln-729" name="ln-729" href="#ln-729"></a><span class="k">                WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;before MPI_Send casa_LUC&#39;</span><span class="w"></span>
<a id="ln-730" name="ln-730" href="#ln-730"></a><span class="w">                </span><span class="c">! worker sends casa updates required for LUC calculations here</span>
<a id="ln-731" name="ln-731" href="#ln-731"></a><span class="w">                </span><span class="k">CALL </span><span class="n">MPI_Send</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_LUC_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-732" name="ln-732" href="#ln-732"></a><span class="w">                </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;after MPI_Send casa_LUC&#39;</span><span class="w"></span>
<a id="ln-733" name="ln-733" href="#ln-733"></a><span class="w">                </span><span class="c">! master calls LUCDriver here</span>
<a id="ln-734" name="ln-734" href="#ln-734"></a><span class="w">                </span><span class="c">! worker receives casa and POP updates</span>
<a id="ln-735" name="ln-735" href="#ln-735"></a><span class="w">                </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="p">(</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">pop_grid</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">np</span><span class="p">,</span><span class="w"> </span><span class="n">pop_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-736" name="ln-736" href="#ln-736"></a>
<a id="ln-737" name="ln-737" href="#ln-737"></a><span class="w">             </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-738" name="ln-738" href="#ln-738"></a><span class="w">             </span><span class="c">! one annual time-step of POP</span>
<a id="ln-739" name="ln-739" href="#ln-739"></a><span class="w">             </span><span class="k">CALL </span><span class="n">POPdriver</span><span class="p">(</span><span class="n">casaflux</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">POP</span><span class="p">)</span><span class="w"></span>
<a id="ln-740" name="ln-740" href="#ln-740"></a>
<a id="ln-741" name="ln-741" href="#ln-741"></a><span class="w">             </span><span class="k">CALL </span><span class="n">worker_send_pop</span><span class="w"> </span><span class="p">(</span><span class="n">POP</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">)</span><span class="w"></span>
<a id="ln-742" name="ln-742" href="#ln-742"></a>
<a id="ln-743" name="ln-743" href="#ln-743"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POPLUC</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-744" name="ln-744" href="#ln-744"></a><span class="w">                  </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_LUC_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">nyear</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-745" name="ln-745" href="#ln-745"></a>
<a id="ln-746" name="ln-746" href="#ln-746"></a><span class="w">          </span><span class="k">ENDIF</span>
<a id="ln-747" name="ln-747" href="#ln-747"></a>
<a id="ln-748" name="ln-748" href="#ln-748"></a>
<a id="ln-749" name="ln-749" href="#ln-749"></a>
<a id="ln-750" name="ln-750" href="#ln-750"></a>
<a id="ln-751" name="ln-751" href="#ln-751"></a>
<a id="ln-752" name="ln-752" href="#ln-752"></a>
<a id="ln-753" name="ln-753" href="#ln-753"></a>
<a id="ln-754" name="ln-754" href="#ln-754"></a>
<a id="ln-755" name="ln-755" href="#ln-755"></a>
<a id="ln-756" name="ln-756" href="#ln-756"></a>
<a id="ln-757" name="ln-757" href="#ln-757"></a>
<a id="ln-758" name="ln-758" href="#ln-758"></a>
<a id="ln-759" name="ln-759" href="#ln-759"></a>
<a id="ln-760" name="ln-760" href="#ln-760"></a>
<a id="ln-761" name="ln-761" href="#ln-761"></a>
<a id="ln-762" name="ln-762" href="#ln-762"></a><span class="k">          IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">spinup</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">spinup</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">spinConv</span><span class="p">)).</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-763" name="ln-763" href="#ln-763"></a><span class="w">               </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CALL_POP</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-764" name="ln-764" href="#ln-764"></a>
<a id="ln-765" name="ln-765" href="#ln-765"></a><span class="w">             </span><span class="c">!CALL worker_send_pop (POP, ocomm)</span>
<a id="ln-766" name="ln-766" href="#ln-766"></a>
<a id="ln-767" name="ln-767" href="#ln-767"></a><span class="w">          </span><span class="k">ENDIF</span>
<a id="ln-768" name="ln-768" href="#ln-768"></a>
<a id="ln-769" name="ln-769" href="#ln-769"></a>
<a id="ln-770" name="ln-770" href="#ln-770"></a><span class="k">       END DO </span><span class="n">YEAR</span><span class="w"></span>
<a id="ln-771" name="ln-771" href="#ln-771"></a>
<a id="ln-772" name="ln-772" href="#ln-772"></a>
<a id="ln-773" name="ln-773" href="#ln-773"></a><span class="w">       </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">spincasa</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">casaonly</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-774" name="ln-774" href="#ln-774"></a><span class="k">          EXIT</span>
<a id="ln-775" name="ln-775" href="#ln-775"></a><span class="k">       ENDIF</span><span class="w"></span>
<a id="ln-776" name="ln-776" href="#ln-776"></a><span class="w">       </span><span class="c">!!jhan this is insufficient testing. condition for</span>
<a id="ln-777" name="ln-777" href="#ln-777"></a><span class="w">       </span><span class="c">!!spinup=.false. &amp; we want CASA_dump.nc (spinConv=.true.)</span>
<a id="ln-778" name="ln-778" href="#ln-778"></a><span class="w">       </span><span class="c">!! see if spinup (if conducting one) has converged:</span>
<a id="ln-779" name="ln-779" href="#ln-779"></a><span class="w">       </span><span class="c">!IF(spinup.AND..NOT.spinConv) THEN</span>
<a id="ln-780" name="ln-780" href="#ln-780"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-781" name="ln-781" href="#ln-781"></a><span class="w">       </span><span class="c">!   ! Write to screen and log file:</span>
<a id="ln-782" name="ln-782" href="#ln-782"></a><span class="w">       </span><span class="c">!   WRITE(*,&#39;(A18,I3,A24)&#39;) &#39; Spinning up: run &#39;,INT(ktau_tot/kend),      &amp;</span>
<a id="ln-783" name="ln-783" href="#ln-783"></a><span class="w">       </span><span class="c">!         &#39; of data set complete...&#39;</span>
<a id="ln-784" name="ln-784" href="#ln-784"></a><span class="w">       </span><span class="c">!   WRITE(wlogn,&#39;(A18,I3,A24)&#39;) &#39; Spinning up: run &#39;,INT(ktau_tot/kend),   &amp;</span>
<a id="ln-785" name="ln-785" href="#ln-785"></a><span class="w">       </span><span class="c">!         &#39; of data set complete...&#39;</span>
<a id="ln-786" name="ln-786" href="#ln-786"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-787" name="ln-787" href="#ln-787"></a><span class="w">       </span><span class="c">!   ! IF not 1st run through whole dataset:</span>
<a id="ln-788" name="ln-788" href="#ln-788"></a><span class="w">       </span><span class="c">!   IF( INT( ktau_tot/kend ) &gt; 1 ) THEN</span>
<a id="ln-789" name="ln-789" href="#ln-789"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-790" name="ln-790" href="#ln-790"></a><span class="w">       </span><span class="c">!      ! evaluate spinup</span>
<a id="ln-791" name="ln-791" href="#ln-791"></a><span class="w">       </span><span class="c">!      IF( ANY( ABS(ssnow%wb-soilMtemp)&gt;delsoilM).OR.                     &amp;</span>
<a id="ln-792" name="ln-792" href="#ln-792"></a><span class="w">       </span><span class="c">!          ANY(ABS(ssnow%tgg-soilTtemp)&gt;delsoilT) ) THEN</span>
<a id="ln-793" name="ln-793" href="#ln-793"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-794" name="ln-794" href="#ln-794"></a><span class="w">       </span><span class="c">!         ! No complete convergence yet</span>
<a id="ln-795" name="ln-795" href="#ln-795"></a><span class="w">       </span><span class="c">!         PRINT *, &#39;ssnow%wb : &#39;, ssnow%wb</span>
<a id="ln-796" name="ln-796" href="#ln-796"></a><span class="w">       </span><span class="c">!         PRINT *, &#39;soilMtemp: &#39;, soilMtemp</span>
<a id="ln-797" name="ln-797" href="#ln-797"></a><span class="w">       </span><span class="c">!         PRINT *, &#39;ssnow%tgg: &#39;, ssnow%tgg</span>
<a id="ln-798" name="ln-798" href="#ln-798"></a><span class="w">       </span><span class="c">!         PRINT *, &#39;soilTtemp: &#39;, soilTtemp</span>
<a id="ln-799" name="ln-799" href="#ln-799"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-800" name="ln-800" href="#ln-800"></a><span class="w">       </span><span class="c">!      ELSE ! spinup has converged</span>
<a id="ln-801" name="ln-801" href="#ln-801"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-802" name="ln-802" href="#ln-802"></a><span class="w">       </span><span class="c">!         spinConv = .TRUE.</span>
<a id="ln-803" name="ln-803" href="#ln-803"></a><span class="w">       </span><span class="c">!         ! Write to screen and log file:</span>
<a id="ln-804" name="ln-804" href="#ln-804"></a><span class="w">       </span><span class="c">!         WRITE(*,&#39;(A33)&#39;) &#39; Spinup has converged - final run&#39;</span>
<a id="ln-805" name="ln-805" href="#ln-805"></a><span class="w">       </span><span class="c">!         WRITE(logn,&#39;(A52)&#39;)                                             &amp;</span>
<a id="ln-806" name="ln-806" href="#ln-806"></a><span class="w">       </span><span class="c">!                    &#39; Spinup has converged - final run - writing all data&#39;</span>
<a id="ln-807" name="ln-807" href="#ln-807"></a><span class="w">       </span><span class="c">!         WRITE(logn,&#39;(A37,F8.5,A28)&#39;)                                    &amp;</span>
<a id="ln-808" name="ln-808" href="#ln-808"></a><span class="w">       </span><span class="c">!                    &#39; Criteria: Change in soil moisture &lt; &#39;,             &amp;</span>
<a id="ln-809" name="ln-809" href="#ln-809"></a><span class="w">       </span><span class="c">!                    delsoilM, &#39; in any layer over whole run&#39;</span>
<a id="ln-810" name="ln-810" href="#ln-810"></a><span class="w">       </span><span class="c">!         WRITE(logn,&#39;(A40,F8.5,A28)&#39; )                                   &amp;</span>
<a id="ln-811" name="ln-811" href="#ln-811"></a><span class="w">       </span><span class="c">!                    &#39;           Change in soil temperature &lt; &#39;,          &amp;</span>
<a id="ln-812" name="ln-812" href="#ln-812"></a><span class="w">       </span><span class="c">!                    delsoilT, &#39; in any layer over whole run&#39;</span>
<a id="ln-813" name="ln-813" href="#ln-813"></a><span class="w">       </span><span class="c">!      END IF</span>
<a id="ln-814" name="ln-814" href="#ln-814"></a>
<a id="ln-815" name="ln-815" href="#ln-815"></a><span class="w">       </span><span class="c">!   ELSE ! allocate variables for storage</span>
<a id="ln-816" name="ln-816" href="#ln-816"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-817" name="ln-817" href="#ln-817"></a><span class="w">       </span><span class="c">!     ALLOCATE( soilMtemp(mp,ms), soilTtemp(mp,ms) )</span>
<a id="ln-818" name="ln-818" href="#ln-818"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-819" name="ln-819" href="#ln-819"></a><span class="w">       </span><span class="c">!   END IF</span>
<a id="ln-820" name="ln-820" href="#ln-820"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-821" name="ln-821" href="#ln-821"></a><span class="w">       </span><span class="c">!   ! store soil moisture and temperature</span>
<a id="ln-822" name="ln-822" href="#ln-822"></a><span class="w">       </span><span class="c">!   soilTtemp = ssnow%tgg</span>
<a id="ln-823" name="ln-823" href="#ln-823"></a><span class="w">       </span><span class="c">!   soilMtemp = REAL(ssnow%wb)</span>
<a id="ln-824" name="ln-824" href="#ln-824"></a>
<a id="ln-825" name="ln-825" href="#ln-825"></a><span class="w">       </span><span class="c">!ELSE</span>
<a id="ln-826" name="ln-826" href="#ln-826"></a>
<a id="ln-827" name="ln-827" href="#ln-827"></a><span class="w">       </span><span class="c">!   ! if not spinning up, or spin up has converged, exit:</span>
<a id="ln-828" name="ln-828" href="#ln-828"></a><span class="w">       </span><span class="c">!   EXIT</span>
<a id="ln-829" name="ln-829" href="#ln-829"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-830" name="ln-830" href="#ln-830"></a><span class="w">       </span><span class="c">!END IF</span>
<a id="ln-831" name="ln-831" href="#ln-831"></a>
<a id="ln-832" name="ln-832" href="#ln-832"></a><span class="w">       </span><span class="c">! MPI: learn from the master whether it&#39;s time to quit</span>
<a id="ln-833" name="ln-833" href="#ln-833"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Bcast</span><span class="w"> </span><span class="p">(</span><span class="n">loop_exit</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_LOGICAL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-834" name="ln-834" href="#ln-834"></a>
<a id="ln-835" name="ln-835" href="#ln-835"></a><span class="w">       </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">loop_exit</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-836" name="ln-836" href="#ln-836"></a><span class="k">          EXIT</span>
<a id="ln-837" name="ln-837" href="#ln-837"></a><span class="k">       END IF</span>
<a id="ln-838" name="ln-838" href="#ln-838"></a>
<a id="ln-839" name="ln-839" href="#ln-839"></a><span class="k">    END DO </span><span class="n">SPINLOOP</span><span class="w"></span>
<a id="ln-840" name="ln-840" href="#ln-840"></a>
<a id="ln-841" name="ln-841" href="#ln-841"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">spincasa</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">casaonly</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-842" name="ln-842" href="#ln-842"></a>
<a id="ln-843" name="ln-843" href="#ln-843"></a><span class="w">       </span><span class="c">! MPI: send casa results back to the master</span>
<a id="ln-844" name="ln-844" href="#ln-844"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Send</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ktau_gl</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-845" name="ln-845" href="#ln-845"></a>
<a id="ln-846" name="ln-846" href="#ln-846"></a><span class="w">       </span><span class="c">! MPI: output file written by master only</span>
<a id="ln-847" name="ln-847" href="#ln-847"></a><span class="w">       </span><span class="c">!CALL casa_poolout( ktau, veg, soil, casabiome,                           &amp;</span>
<a id="ln-848" name="ln-848" href="#ln-848"></a><span class="w">       </span><span class="c">!                   casapool, casaflux, casamet, casabal, phen )</span>
<a id="ln-849" name="ln-849" href="#ln-849"></a><span class="w">       </span><span class="c">! MPI: output file written by master only</span>
<a id="ln-850" name="ln-850" href="#ln-850"></a><span class="w">       </span><span class="c">!CALL casa_fluxout( nyear, veg, soil, casabal, casamet)</span>
<a id="ln-851" name="ln-851" href="#ln-851"></a>
<a id="ln-852" name="ln-852" href="#ln-852"></a><span class="w">    </span><span class="k">END IF</span><span class="w"></span>
<a id="ln-853" name="ln-853" href="#ln-853"></a>
<a id="ln-854" name="ln-854" href="#ln-854"></a><span class="w">    </span><span class="c">! Write restart file if requested:</span>
<a id="ln-855" name="ln-855" href="#ln-855"></a><span class="w">    </span><span class="k">IF</span><span class="p">(</span><span class="n">output</span><span class="p">%</span><span class="n">restart</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CASAONLY</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-856" name="ln-856" href="#ln-856"></a><span class="w">       </span><span class="c">! MPI: send variables that are required by create_restart</span>
<a id="ln-857" name="ln-857" href="#ln-857"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Send</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">restart_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ktau_gl</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-858" name="ln-858" href="#ln-858"></a><span class="w">       </span><span class="c">! MPI: output file written by master only</span>
<a id="ln-859" name="ln-859" href="#ln-859"></a>
<a id="ln-860" name="ln-860" href="#ln-860"></a><span class="w">       </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_climate</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-861" name="ln-861" href="#ln-861"></a><span class="w">            </span><span class="k">CALL </span><span class="n">MPI_Send</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">climate_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ktau_gl</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-862" name="ln-862" href="#ln-862"></a><span class="w">    </span><span class="k">END IF</span><span class="w"></span>
<a id="ln-863" name="ln-863" href="#ln-863"></a>
<a id="ln-864" name="ln-864" href="#ln-864"></a><span class="w">    </span><span class="c">! MPI: cleanup</span>
<a id="ln-865" name="ln-865" href="#ln-865"></a><span class="w">    </span><span class="k">CALL </span><span class="n">worker_end</span><span class="p">(</span><span class="n">icycle</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">%</span><span class="n">restart</span><span class="p">)</span><span class="w"></span>
<a id="ln-866" name="ln-866" href="#ln-866"></a><span class="w">    </span><span class="c">! MPI: open and close by master only</span>
<a id="ln-867" name="ln-867" href="#ln-867"></a><span class="w">    </span><span class="c">! Close met data input file:</span>
<a id="ln-868" name="ln-868" href="#ln-868"></a><span class="w">    </span><span class="c">!CALL close_met_file</span>
<a id="ln-869" name="ln-869" href="#ln-869"></a><span class="w">    </span><span class="c">! MPI: open and close by master only</span>
<a id="ln-870" name="ln-870" href="#ln-870"></a><span class="w">    </span><span class="c">! Close output file and deallocate main variables:</span>
<a id="ln-871" name="ln-871" href="#ln-871"></a><span class="w">    </span><span class="c">!CALL close_output_file( bal, air, bgc, canopy, met,                         &amp;</span>
<a id="ln-872" name="ln-872" href="#ln-872"></a><span class="w">    </span><span class="c">!                        rad, rough, soil, ssnow,                            &amp;</span>
<a id="ln-873" name="ln-873" href="#ln-873"></a><span class="w">    </span><span class="c">!                        sum_flux, veg )</span>
<a id="ln-874" name="ln-874" href="#ln-874"></a>
<a id="ln-875" name="ln-875" href="#ln-875"></a><span class="w">    </span><span class="c">!WRITE(logn,*) bal%wbal_tot, bal%ebal_tot, bal%ebal_tot_cncheck</span>
<a id="ln-876" name="ln-876" href="#ln-876"></a>
<a id="ln-877" name="ln-877" href="#ln-877"></a><span class="w">    </span><span class="c">! Close log file</span>
<a id="ln-878" name="ln-878" href="#ln-878"></a><span class="w">    </span><span class="c">! MPI: closes handle to /dev/null in workers</span>
<a id="ln-879" name="ln-879" href="#ln-879"></a><span class="w">    </span><span class="k">CLOSE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">)</span><span class="w"></span>
<a id="ln-880" name="ln-880" href="#ln-880"></a>
<a id="ln-881" name="ln-881" href="#ln-881"></a>
<a id="ln-882" name="ln-882" href="#ln-882"></a><span class="w">    </span><span class="k">RETURN</span>
<a id="ln-883" name="ln-883" href="#ln-883"></a>
<a id="ln-884" name="ln-884" href="#ln-884"></a><span class="k">  END SUBROUTINE </span><span class="n">mpidrv_worker</span><span class="w"></span>
<a id="ln-885" name="ln-885" href="#ln-885"></a>
<a id="ln-886" name="ln-886" href="#ln-886"></a>
<a id="ln-887" name="ln-887" href="#ln-887"></a>
<a id="ln-888" name="ln-888" href="#ln-888"></a><span class="w">  </span><span class="c">! ============== PRIVATE SUBROUTINES USED ONLY BY THE MPI WORKERS ===============</span>
<a id="ln-889" name="ln-889" href="#ln-889"></a>
<a id="ln-890" name="ln-890" href="#ln-890"></a>
<a id="ln-891" name="ln-891" href="#ln-891"></a><span class="w">  </span><span class="c">! MPI: receives grid decomposition info from the master</span>
<a id="ln-892" name="ln-892" href="#ln-892"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_decomp</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">)</span><span class="w"></span>
<a id="ln-893" name="ln-893" href="#ln-893"></a>
<a id="ln-894" name="ln-894" href="#ln-894"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-895" name="ln-895" href="#ln-895"></a>
<a id="ln-896" name="ln-896" href="#ln-896"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">mland</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="w"></span>
<a id="ln-897" name="ln-897" href="#ln-897"></a>
<a id="ln-898" name="ln-898" href="#ln-898"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span>
<a id="ln-899" name="ln-899" href="#ln-899"></a>
<a id="ln-900" name="ln-900" href="#ln-900"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w"> </span><span class="c">! MPI communicator to talk to the workers</span>
<a id="ln-901" name="ln-901" href="#ln-901"></a>
<a id="ln-902" name="ln-902" href="#ln-902"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">stat</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-903" name="ln-903" href="#ln-903"></a>
<a id="ln-904" name="ln-904" href="#ln-904"></a><span class="w">    </span><span class="c">! receive number of landpoints assigned to this worker</span>
<a id="ln-905" name="ln-905" href="#ln-905"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">mland</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-906" name="ln-906" href="#ln-906"></a>
<a id="ln-907" name="ln-907" href="#ln-907"></a><span class="w">    </span><span class="c">! receive number of land patches assigned to this worker</span>
<a id="ln-908" name="ln-908" href="#ln-908"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-909" name="ln-909" href="#ln-909"></a>
<a id="ln-910" name="ln-910" href="#ln-910"></a><span class="w">    </span><span class="k">RETURN</span>
<a id="ln-911" name="ln-911" href="#ln-911"></a>
<a id="ln-912" name="ln-912" href="#ln-912"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_decomp</span><span class="w"></span>
<a id="ln-913" name="ln-913" href="#ln-913"></a>
<a id="ln-914" name="ln-914" href="#ln-914"></a>
<a id="ln-915" name="ln-915" href="#ln-915"></a><span class="w">  </span><span class="c">! MPI: creates param_t type for the worker to receive the default parameters</span>
<a id="ln-916" name="ln-916" href="#ln-916"></a><span class="w">  </span><span class="c">! from the master process</span>
<a id="ln-917" name="ln-917" href="#ln-917"></a><span class="w">  </span><span class="c">! then receives the parameters</span>
<a id="ln-918" name="ln-918" href="#ln-918"></a><span class="w">  </span><span class="c">! and finally frees the MPI type</span>
<a id="ln-919" name="ln-919" href="#ln-919"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_cable_params</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="n">met</span><span class="p">,</span><span class="n">air</span><span class="p">,</span><span class="n">ssnow</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">bgc</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">canopy</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-920" name="ln-920" href="#ln-920"></a><span class="w">       </span><span class="n">rough</span><span class="p">,</span><span class="n">rad</span><span class="p">,</span><span class="n">sum_flux</span><span class="p">,</span><span class="n">bal</span><span class="p">)</span><span class="w"></span>
<a id="ln-921" name="ln-921" href="#ln-921"></a>
<a id="ln-922" name="ln-922" href="#ln-922"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-923" name="ln-923" href="#ln-923"></a>
<a id="ln-924" name="ln-924" href="#ln-924"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-925" name="ln-925" href="#ln-925"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_IO_vars_module</span><span class="w"></span>
<a id="ln-926" name="ln-926" href="#ln-926"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_input_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">allocate_cable_vars</span><span class="w"></span>
<a id="ln-927" name="ln-927" href="#ln-927"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_common_module</span><span class="p">,</span><span class="w">  </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">calcsoilalbedo</span><span class="w"></span>
<a id="ln-928" name="ln-928" href="#ln-928"></a>
<a id="ln-929" name="ln-929" href="#ln-929"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<a id="ln-930" name="ln-930" href="#ln-930"></a>
<a id="ln-931" name="ln-931" href="#ln-931"></a><span class="w">    </span><span class="c">! subroutine arguments</span>
<a id="ln-932" name="ln-932" href="#ln-932"></a>
<a id="ln-933" name="ln-933" href="#ln-933"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w"> </span><span class="c">! MPI communicator</span>
<a id="ln-934" name="ln-934" href="#ln-934"></a>
<a id="ln-935" name="ln-935" href="#ln-935"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">met_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">met</span><span class="w"></span>
<a id="ln-936" name="ln-936" href="#ln-936"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">air_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">air</span><span class="w"></span>
<a id="ln-937" name="ln-937" href="#ln-937"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">soil_snow_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ssnow</span><span class="w"></span>
<a id="ln-938" name="ln-938" href="#ln-938"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">veg_parameter_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">veg</span><span class="w"></span>
<a id="ln-939" name="ln-939" href="#ln-939"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">bgc_pool_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">bgc</span><span class="w"></span>
<a id="ln-940" name="ln-940" href="#ln-940"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">soil_parameter_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">soil</span><span class="w"></span>
<a id="ln-941" name="ln-941" href="#ln-941"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">canopy_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">canopy</span><span class="w"></span>
<a id="ln-942" name="ln-942" href="#ln-942"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">roughness_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rough</span><span class="w"></span>
<a id="ln-943" name="ln-943" href="#ln-943"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">radiation_type</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">rad</span><span class="w"></span>
<a id="ln-944" name="ln-944" href="#ln-944"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">sum_flux</span><span class="w"></span>
<a id="ln-945" name="ln-945" href="#ln-945"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">balances_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">bal</span><span class="w"></span>
<a id="ln-946" name="ln-946" href="#ln-946"></a>
<a id="ln-947" name="ln-947" href="#ln-947"></a>
<a id="ln-948" name="ln-948" href="#ln-948"></a><span class="w">    </span><span class="c">! local vars</span>
<a id="ln-949" name="ln-949" href="#ln-949"></a>
<a id="ln-950" name="ln-950" href="#ln-950"></a><span class="w">    </span><span class="c">! temp arrays for marshalling all fields into a single struct</span>
<a id="ln-951" name="ln-951" href="#ln-951"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blen</span><span class="w"></span>
<a id="ln-952" name="ln-952" href="#ln-952"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">displs</span><span class="w"></span>
<a id="ln-953" name="ln-953" href="#ln-953"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<a id="ln-954" name="ln-954" href="#ln-954"></a>
<a id="ln-955" name="ln-955" href="#ln-955"></a><span class="w">    </span><span class="c">! temp vars for verifying block number and total length of inp_t</span>
<a id="ln-956" name="ln-956" href="#ln-956"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-957" name="ln-957" href="#ln-957"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tsize</span><span class="w"></span>
<a id="ln-958" name="ln-958" href="#ln-958"></a>
<a id="ln-959" name="ln-959" href="#ln-959"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">stat</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-960" name="ln-960" href="#ln-960"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">landp_t</span><span class="p">,</span><span class="w"> </span><span class="n">patch_t</span><span class="p">,</span><span class="w"> </span><span class="n">param_t</span><span class="w"></span>
<a id="ln-961" name="ln-961" href="#ln-961"></a>
<a id="ln-962" name="ln-962" href="#ln-962"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r1len</span><span class="p">,</span><span class="w"> </span><span class="n">r2len</span><span class="p">,</span><span class="w"> </span><span class="n">i1len</span><span class="p">,</span><span class="w"> </span><span class="n">llen</span><span class="w"> </span><span class="c">! block lengths</span>
<a id="ln-963" name="ln-963" href="#ln-963"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="c">! block index</span>
<a id="ln-964" name="ln-964" href="#ln-964"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntyp</span><span class="w"> </span><span class="c">! total number of blocks</span>
<a id="ln-965" name="ln-965" href="#ln-965"></a>
<a id="ln-966" name="ln-966" href="#ln-966"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w">  </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">ierr2</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<a id="ln-967" name="ln-967" href="#ln-967"></a>
<a id="ln-968" name="ln-968" href="#ln-968"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rbuf</span><span class="w"></span>
<a id="ln-969" name="ln-969" href="#ln-969"></a>
<a id="ln-970" name="ln-970" href="#ln-970"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Comm_rank</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-971" name="ln-971" href="#ln-971"></a>
<a id="ln-972" name="ln-972" href="#ln-972"></a><span class="w">    </span><span class="c">! mp and mland should have been received previously by</span>
<a id="ln-973" name="ln-973" href="#ln-973"></a><span class="w">    </span><span class="c">! worker_decomp</span>
<a id="ln-974" name="ln-974" href="#ln-974"></a>
<a id="ln-975" name="ln-975" href="#ln-975"></a><span class="w">    </span><span class="c">! creates types to receive slices of landpt and patch arrays from the master</span>
<a id="ln-976" name="ln-976" href="#ln-976"></a><span class="w">    </span><span class="k">CALL </span><span class="n">decomp_types</span><span class="w"> </span><span class="p">(</span><span class="n">landp_t</span><span class="p">,</span><span class="w"> </span><span class="n">patch_t</span><span class="p">)</span><span class="w"></span>
<a id="ln-977" name="ln-977" href="#ln-977"></a>
<a id="ln-978" name="ln-978" href="#ln-978"></a><span class="w">    </span><span class="c">! Allocate spatial heterogeneity variables:</span>
<a id="ln-979" name="ln-979" href="#ln-979"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">mland</span><span class="p">))</span><span class="w"></span>
<a id="ln-980" name="ln-980" href="#ln-980"></a>
<a id="ln-981" name="ln-981" href="#ln-981"></a><span class="w">    </span><span class="c">! and receive own slice from the master</span>
<a id="ln-982" name="ln-982" href="#ln-982"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">landpt</span><span class="p">,</span><span class="w"> </span><span class="n">mland</span><span class="p">,</span><span class="w"> </span><span class="n">landp_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-983" name="ln-983" href="#ln-983"></a>
<a id="ln-984" name="ln-984" href="#ln-984"></a><span class="w">    </span><span class="k">CALL </span><span class="n">allocate_cable_vars</span><span class="p">(</span><span class="n">air</span><span class="p">,</span><span class="n">bgc</span><span class="p">,</span><span class="n">canopy</span><span class="p">,</span><span class="n">met</span><span class="p">,</span><span class="n">bal</span><span class="p">,</span><span class="n">rad</span><span class="p">,</span><span class="n">rough</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">ssnow</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-985" name="ln-985" href="#ln-985"></a><span class="w">         </span><span class="n">sum_flux</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">mp</span><span class="p">)</span><span class="w"></span>
<a id="ln-986" name="ln-986" href="#ln-986"></a>
<a id="ln-987" name="ln-987" href="#ln-987"></a><span class="w">    </span><span class="c">! receive slice of patch array that was allocated above inside</span>
<a id="ln-988" name="ln-988" href="#ln-988"></a><span class="w">    </span><span class="c">! allocate_cable_vars</span>
<a id="ln-989" name="ln-989" href="#ln-989"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">patch</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">,</span><span class="w"> </span><span class="n">patch_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-990" name="ln-990" href="#ln-990"></a>
<a id="ln-991" name="ln-991" href="#ln-991"></a><span class="w">    </span><span class="c">! MPI: TODO: probably not a bad idea to free landp_t and patch_t types</span>
<a id="ln-992" name="ln-992" href="#ln-992"></a>
<a id="ln-993" name="ln-993" href="#ln-993"></a><span class="w">    </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nparam</span><span class="w"></span>
<a id="ln-994" name="ln-994" href="#ln-994"></a>
<a id="ln-995" name="ln-995" href="#ln-995"></a><span class="w">    </span><span class="c">! ntyp increases if include ... Ticket #27</span>
<a id="ln-996" name="ln-996" href="#ln-996"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">calcsoilalbedo</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-997" name="ln-997" href="#ln-997"></a><span class="k">       </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nparam</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-998" name="ln-998" href="#ln-998"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-999" name="ln-999" href="#ln-999"></a>
<a id="ln-1000" name="ln-1000" href="#ln-1000"></a><span class="k">    ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">blen</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-1001" name="ln-1001" href="#ln-1001"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">displs</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-1002" name="ln-1002" href="#ln-1002"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-1003" name="ln-1003" href="#ln-1003"></a>
<a id="ln-1004" name="ln-1004" href="#ln-1004"></a><span class="w">    </span><span class="c">! default type is byte, to be overriden for multi-D types</span>
<a id="ln-1005" name="ln-1005" href="#ln-1005"></a><span class="w">    </span><span class="n">types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-1006" name="ln-1006" href="#ln-1006"></a>
<a id="ln-1007" name="ln-1007" href="#ln-1007"></a><span class="w">    </span><span class="n">r1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-1008" name="ln-1008" href="#ln-1008"></a><span class="w">    </span><span class="n">r2len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-1009" name="ln-1009" href="#ln-1009"></a><span class="w">    </span><span class="n">i1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-1010" name="ln-1010" href="#ln-1010"></a><span class="w">    </span><span class="n">llen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extl</span><span class="w"></span>
<a id="ln-1011" name="ln-1011" href="#ln-1011"></a>
<a id="ln-1012" name="ln-1012" href="#ln-1012"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-1013" name="ln-1013" href="#ln-1013"></a>
<a id="ln-1014" name="ln-1014" href="#ln-1014"></a><span class="w">    </span><span class="c">! the order of variables follows argument list</span>
<a id="ln-1015" name="ln-1015" href="#ln-1015"></a><span class="w">    </span><span class="c">! the order of fields within follows alloc_*_type subroutines</span>
<a id="ln-1016" name="ln-1016" href="#ln-1016"></a>
<a id="ln-1017" name="ln-1017" href="#ln-1017"></a><span class="w">    </span><span class="c">! ----------- met --------------</span>
<a id="ln-1018" name="ln-1018" href="#ln-1018"></a>
<a id="ln-1019" name="ln-1019" href="#ln-1019"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1020" name="ln-1020" href="#ln-1020"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">ca</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1021" name="ln-1021" href="#ln-1021"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1022" name="ln-1022" href="#ln-1022"></a>
<a id="ln-1023" name="ln-1023" href="#ln-1023"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1024" name="ln-1024" href="#ln-1024"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1025" name="ln-1025" href="#ln-1025"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-1026" name="ln-1026" href="#ln-1026"></a>
<a id="ln-1027" name="ln-1027" href="#ln-1027"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1028" name="ln-1028" href="#ln-1028"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1029" name="ln-1029" href="#ln-1029"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-1030" name="ln-1030" href="#ln-1030"></a>
<a id="ln-1031" name="ln-1031" href="#ln-1031"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1032" name="ln-1032" href="#ln-1032"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1033" name="ln-1033" href="#ln-1033"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1034" name="ln-1034" href="#ln-1034"></a>
<a id="ln-1035" name="ln-1035" href="#ln-1035"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1036" name="ln-1036" href="#ln-1036"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1037" name="ln-1037" href="#ln-1037"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1038" name="ln-1038" href="#ln-1038"></a>
<a id="ln-1039" name="ln-1039" href="#ln-1039"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1040" name="ln-1040" href="#ln-1040"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">fsd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1041" name="ln-1041" href="#ln-1041"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">swb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1042" name="ln-1042" href="#ln-1042"></a>
<a id="ln-1043" name="ln-1043" href="#ln-1043"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1044" name="ln-1044" href="#ln-1044"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">fld</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1045" name="ln-1045" href="#ln-1045"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1046" name="ln-1046" href="#ln-1046"></a>
<a id="ln-1047" name="ln-1047" href="#ln-1047"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1048" name="ln-1048" href="#ln-1048"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">precip</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1049" name="ln-1049" href="#ln-1049"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1050" name="ln-1050" href="#ln-1050"></a>
<a id="ln-1051" name="ln-1051" href="#ln-1051"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1052" name="ln-1052" href="#ln-1052"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">precip_sn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1053" name="ln-1053" href="#ln-1053"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1054" name="ln-1054" href="#ln-1054"></a>
<a id="ln-1055" name="ln-1055" href="#ln-1055"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1056" name="ln-1056" href="#ln-1056"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">tk</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1057" name="ln-1057" href="#ln-1057"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1058" name="ln-1058" href="#ln-1058"></a>
<a id="ln-1059" name="ln-1059" href="#ln-1059"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1060" name="ln-1060" href="#ln-1060"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">tvair</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1061" name="ln-1061" href="#ln-1061"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1062" name="ln-1062" href="#ln-1062"></a>
<a id="ln-1063" name="ln-1063" href="#ln-1063"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1064" name="ln-1064" href="#ln-1064"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">tvrad</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1065" name="ln-1065" href="#ln-1065"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1066" name="ln-1066" href="#ln-1066"></a>
<a id="ln-1067" name="ln-1067" href="#ln-1067"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1068" name="ln-1068" href="#ln-1068"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">pmb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1069" name="ln-1069" href="#ln-1069"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1070" name="ln-1070" href="#ln-1070"></a>
<a id="ln-1071" name="ln-1071" href="#ln-1071"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1072" name="ln-1072" href="#ln-1072"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">ua</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1073" name="ln-1073" href="#ln-1073"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1074" name="ln-1074" href="#ln-1074"></a>
<a id="ln-1075" name="ln-1075" href="#ln-1075"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1076" name="ln-1076" href="#ln-1076"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">qv</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1077" name="ln-1077" href="#ln-1077"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1078" name="ln-1078" href="#ln-1078"></a>
<a id="ln-1079" name="ln-1079" href="#ln-1079"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1080" name="ln-1080" href="#ln-1080"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">qvair</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1081" name="ln-1081" href="#ln-1081"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1082" name="ln-1082" href="#ln-1082"></a>
<a id="ln-1083" name="ln-1083" href="#ln-1083"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1084" name="ln-1084" href="#ln-1084"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">da</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1085" name="ln-1085" href="#ln-1085"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1086" name="ln-1086" href="#ln-1086"></a>
<a id="ln-1087" name="ln-1087" href="#ln-1087"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1088" name="ln-1088" href="#ln-1088"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">dva</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1089" name="ln-1089" href="#ln-1089"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1090" name="ln-1090" href="#ln-1090"></a>
<a id="ln-1091" name="ln-1091" href="#ln-1091"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1092" name="ln-1092" href="#ln-1092"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">coszen</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1093" name="ln-1093" href="#ln-1093"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1094" name="ln-1094" href="#ln-1094"></a>
<a id="ln-1095" name="ln-1095" href="#ln-1095"></a>
<a id="ln-1096" name="ln-1096" href="#ln-1096"></a><span class="w">    </span><span class="c">! ----------- air --------------</span>
<a id="ln-1097" name="ln-1097" href="#ln-1097"></a>
<a id="ln-1098" name="ln-1098" href="#ln-1098"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1099" name="ln-1099" href="#ln-1099"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1100" name="ln-1100" href="#ln-1100"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1101" name="ln-1101" href="#ln-1101"></a>
<a id="ln-1102" name="ln-1102" href="#ln-1102"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1103" name="ln-1103" href="#ln-1103"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">volm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1104" name="ln-1104" href="#ln-1104"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1105" name="ln-1105" href="#ln-1105"></a>
<a id="ln-1106" name="ln-1106" href="#ln-1106"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1107" name="ln-1107" href="#ln-1107"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">rlam</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1108" name="ln-1108" href="#ln-1108"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1109" name="ln-1109" href="#ln-1109"></a>
<a id="ln-1110" name="ln-1110" href="#ln-1110"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1111" name="ln-1111" href="#ln-1111"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">qsat</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1112" name="ln-1112" href="#ln-1112"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1113" name="ln-1113" href="#ln-1113"></a>
<a id="ln-1114" name="ln-1114" href="#ln-1114"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1115" name="ln-1115" href="#ln-1115"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">epsi</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1116" name="ln-1116" href="#ln-1116"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1117" name="ln-1117" href="#ln-1117"></a>
<a id="ln-1118" name="ln-1118" href="#ln-1118"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1119" name="ln-1119" href="#ln-1119"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">visc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1120" name="ln-1120" href="#ln-1120"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1121" name="ln-1121" href="#ln-1121"></a>
<a id="ln-1122" name="ln-1122" href="#ln-1122"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1123" name="ln-1123" href="#ln-1123"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">psyc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1124" name="ln-1124" href="#ln-1124"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1125" name="ln-1125" href="#ln-1125"></a>
<a id="ln-1126" name="ln-1126" href="#ln-1126"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1127" name="ln-1127" href="#ln-1127"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">dsatdk</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1128" name="ln-1128" href="#ln-1128"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1129" name="ln-1129" href="#ln-1129"></a>
<a id="ln-1130" name="ln-1130" href="#ln-1130"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1131" name="ln-1131" href="#ln-1131"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">cmolar</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1132" name="ln-1132" href="#ln-1132"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1133" name="ln-1133" href="#ln-1133"></a>
<a id="ln-1134" name="ln-1134" href="#ln-1134"></a>
<a id="ln-1135" name="ln-1135" href="#ln-1135"></a><span class="w">    </span><span class="c">! ----------- ssnow --------------</span>
<a id="ln-1136" name="ln-1136" href="#ln-1136"></a>
<a id="ln-1137" name="ln-1137" href="#ln-1137"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1138" name="ln-1138" href="#ln-1138"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">dtmlt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1139" name="ln-1139" href="#ln-1139"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1140" name="ln-1140" href="#ln-1140"></a>
<a id="ln-1141" name="ln-1141" href="#ln-1141"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1142" name="ln-1142" href="#ln-1142"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">pudsto</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1143" name="ln-1143" href="#ln-1143"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1144" name="ln-1144" href="#ln-1144"></a>
<a id="ln-1145" name="ln-1145" href="#ln-1145"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1146" name="ln-1146" href="#ln-1146"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">pudsmx</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1147" name="ln-1147" href="#ln-1147"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1148" name="ln-1148" href="#ln-1148"></a>
<a id="ln-1149" name="ln-1149" href="#ln-1149"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1150" name="ln-1150" href="#ln-1150"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">albsoilsn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1151" name="ln-1151" href="#ln-1151"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1152" name="ln-1152" href="#ln-1152"></a>
<a id="ln-1153" name="ln-1153" href="#ln-1153"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1154" name="ln-1154" href="#ln-1154"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1155" name="ln-1155" href="#ln-1155"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1156" name="ln-1156" href="#ln-1156"></a>
<a id="ln-1157" name="ln-1157" href="#ln-1157"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1158" name="ln-1158" href="#ln-1158"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">dfn_dtg</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1159" name="ln-1159" href="#ln-1159"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1160" name="ln-1160" href="#ln-1160"></a>
<a id="ln-1161" name="ln-1161" href="#ln-1161"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1162" name="ln-1162" href="#ln-1162"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">dfh_dtg</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1163" name="ln-1163" href="#ln-1163"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1164" name="ln-1164" href="#ln-1164"></a>
<a id="ln-1165" name="ln-1165" href="#ln-1165"></a><span class="w">    </span><span class="c">!INH - REV_CORR</span>
<a id="ln-1166" name="ln-1166" href="#ln-1166"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1167" name="ln-1167" href="#ln-1167"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">dfe_dtg</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1168" name="ln-1168" href="#ln-1168"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1169" name="ln-1169" href="#ln-1169"></a>
<a id="ln-1170" name="ln-1170" href="#ln-1170"></a><span class="w">    </span><span class="c">!INH - REV_CORR - no longer needed</span>
<a id="ln-1171" name="ln-1171" href="#ln-1171"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1172" name="ln-1172" href="#ln-1172"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">dfe_ddq</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1173" name="ln-1173" href="#ln-1173"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1174" name="ln-1174" href="#ln-1174"></a>
<a id="ln-1175" name="ln-1175" href="#ln-1175"></a><span class="w">    </span><span class="c">!INH - REV_CORR - no longer needed</span>
<a id="ln-1176" name="ln-1176" href="#ln-1176"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1177" name="ln-1177" href="#ln-1177"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">ddq_dtg</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1178" name="ln-1178" href="#ln-1178"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1179" name="ln-1179" href="#ln-1179"></a>
<a id="ln-1180" name="ln-1180" href="#ln-1180"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1181" name="ln-1181" href="#ln-1181"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">evapsn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1182" name="ln-1182" href="#ln-1182"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1183" name="ln-1183" href="#ln-1183"></a>
<a id="ln-1184" name="ln-1184" href="#ln-1184"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1185" name="ln-1185" href="#ln-1185"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">fwtop</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1186" name="ln-1186" href="#ln-1186"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1187" name="ln-1187" href="#ln-1187"></a>
<a id="ln-1188" name="ln-1188" href="#ln-1188"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1189" name="ln-1189" href="#ln-1189"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">fwtop1</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1190" name="ln-1190" href="#ln-1190"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1191" name="ln-1191" href="#ln-1191"></a>
<a id="ln-1192" name="ln-1192" href="#ln-1192"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1193" name="ln-1193" href="#ln-1193"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">fwtop2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1194" name="ln-1194" href="#ln-1194"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1195" name="ln-1195" href="#ln-1195"></a>
<a id="ln-1196" name="ln-1196" href="#ln-1196"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1197" name="ln-1197" href="#ln-1197"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">fwtop3</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1198" name="ln-1198" href="#ln-1198"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1199" name="ln-1199" href="#ln-1199"></a>
<a id="ln-1200" name="ln-1200" href="#ln-1200"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1201" name="ln-1201" href="#ln-1201"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">gammzz</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1202" name="ln-1202" href="#ln-1202"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1203" name="ln-1203" href="#ln-1203"></a>
<a id="ln-1204" name="ln-1204" href="#ln-1204"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1205" name="ln-1205" href="#ln-1205"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">isflag</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1206" name="ln-1206" href="#ln-1206"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-1207" name="ln-1207" href="#ln-1207"></a>
<a id="ln-1208" name="ln-1208" href="#ln-1208"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1209" name="ln-1209" href="#ln-1209"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">osnowd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1210" name="ln-1210" href="#ln-1210"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1211" name="ln-1211" href="#ln-1211"></a>
<a id="ln-1212" name="ln-1212" href="#ln-1212"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1213" name="ln-1213" href="#ln-1213"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">potev</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1214" name="ln-1214" href="#ln-1214"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1215" name="ln-1215" href="#ln-1215"></a>
<a id="ln-1216" name="ln-1216" href="#ln-1216"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1217" name="ln-1217" href="#ln-1217"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">pwb_min</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1218" name="ln-1218" href="#ln-1218"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1219" name="ln-1219" href="#ln-1219"></a>
<a id="ln-1220" name="ln-1220" href="#ln-1220"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1221" name="ln-1221" href="#ln-1221"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">runoff</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1222" name="ln-1222" href="#ln-1222"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1223" name="ln-1223" href="#ln-1223"></a>
<a id="ln-1224" name="ln-1224" href="#ln-1224"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1225" name="ln-1225" href="#ln-1225"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof1</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1226" name="ln-1226" href="#ln-1226"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1227" name="ln-1227" href="#ln-1227"></a>
<a id="ln-1228" name="ln-1228" href="#ln-1228"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1229" name="ln-1229" href="#ln-1229"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1230" name="ln-1230" href="#ln-1230"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1231" name="ln-1231" href="#ln-1231"></a>
<a id="ln-1232" name="ln-1232" href="#ln-1232"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1233" name="ln-1233" href="#ln-1233"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">rtsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1234" name="ln-1234" href="#ln-1234"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1235" name="ln-1235" href="#ln-1235"></a>
<a id="ln-1236" name="ln-1236" href="#ln-1236"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1237" name="ln-1237" href="#ln-1237"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">sconds</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1238" name="ln-1238" href="#ln-1238"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1239" name="ln-1239" href="#ln-1239"></a>
<a id="ln-1240" name="ln-1240" href="#ln-1240"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1241" name="ln-1241" href="#ln-1241"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">sdepth</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1242" name="ln-1242" href="#ln-1242"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1243" name="ln-1243" href="#ln-1243"></a>
<a id="ln-1244" name="ln-1244" href="#ln-1244"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1245" name="ln-1245" href="#ln-1245"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">smass</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1246" name="ln-1246" href="#ln-1246"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1247" name="ln-1247" href="#ln-1247"></a>
<a id="ln-1248" name="ln-1248" href="#ln-1248"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1249" name="ln-1249" href="#ln-1249"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">snage</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1250" name="ln-1250" href="#ln-1250"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1251" name="ln-1251" href="#ln-1251"></a>
<a id="ln-1252" name="ln-1252" href="#ln-1252"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1253" name="ln-1253" href="#ln-1253"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">snowd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1254" name="ln-1254" href="#ln-1254"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1255" name="ln-1255" href="#ln-1255"></a>
<a id="ln-1256" name="ln-1256" href="#ln-1256"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1257" name="ln-1257" href="#ln-1257"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">smelt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1258" name="ln-1258" href="#ln-1258"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1259" name="ln-1259" href="#ln-1259"></a>
<a id="ln-1260" name="ln-1260" href="#ln-1260"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1261" name="ln-1261" href="#ln-1261"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">ssdn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1262" name="ln-1262" href="#ln-1262"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1263" name="ln-1263" href="#ln-1263"></a>
<a id="ln-1264" name="ln-1264" href="#ln-1264"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1265" name="ln-1265" href="#ln-1265"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">ssdnn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1266" name="ln-1266" href="#ln-1266"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1267" name="ln-1267" href="#ln-1267"></a>
<a id="ln-1268" name="ln-1268" href="#ln-1268"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1269" name="ln-1269" href="#ln-1269"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tgg</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1270" name="ln-1270" href="#ln-1270"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1271" name="ln-1271" href="#ln-1271"></a>
<a id="ln-1272" name="ln-1272" href="#ln-1272"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1273" name="ln-1273" href="#ln-1273"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tggsn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1274" name="ln-1274" href="#ln-1274"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msn</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1275" name="ln-1275" href="#ln-1275"></a>
<a id="ln-1276" name="ln-1276" href="#ln-1276"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1277" name="ln-1277" href="#ln-1277"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tss</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1278" name="ln-1278" href="#ln-1278"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1279" name="ln-1279" href="#ln-1279"></a>
<a id="ln-1280" name="ln-1280" href="#ln-1280"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1281" name="ln-1281" href="#ln-1281"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1282" name="ln-1282" href="#ln-1282"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1283" name="ln-1283" href="#ln-1283"></a>
<a id="ln-1284" name="ln-1284" href="#ln-1284"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1285" name="ln-1285" href="#ln-1285"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wbfice</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1286" name="ln-1286" href="#ln-1286"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1287" name="ln-1287" href="#ln-1287"></a>
<a id="ln-1288" name="ln-1288" href="#ln-1288"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1289" name="ln-1289" href="#ln-1289"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wbice</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1290" name="ln-1290" href="#ln-1290"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1291" name="ln-1291" href="#ln-1291"></a>
<a id="ln-1292" name="ln-1292" href="#ln-1292"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1293" name="ln-1293" href="#ln-1293"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wblf</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1294" name="ln-1294" href="#ln-1294"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1295" name="ln-1295" href="#ln-1295"></a>
<a id="ln-1296" name="ln-1296" href="#ln-1296"></a><span class="w">    </span><span class="c">! additional  for sli</span>
<a id="ln-1297" name="ln-1297" href="#ln-1297"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1298" name="ln-1298" href="#ln-1298"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1299" name="ln-1299" href="#ln-1299"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1300" name="ln-1300" href="#ln-1300"></a>
<a id="ln-1301" name="ln-1301" href="#ln-1301"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1302" name="ln-1302" href="#ln-1302"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">Tsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1303" name="ln-1303" href="#ln-1303"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1304" name="ln-1304" href="#ln-1304"></a><span class="c">!!$</span>
<a id="ln-1305" name="ln-1305" href="#ln-1305"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1306" name="ln-1306" href="#ln-1306"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">thetai</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1307" name="ln-1307" href="#ln-1307"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1308" name="ln-1308" href="#ln-1308"></a>
<a id="ln-1309" name="ln-1309" href="#ln-1309"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1310" name="ln-1310" href="#ln-1310"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">snowliq</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1311" name="ln-1311" href="#ln-1311"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1312" name="ln-1312" href="#ln-1312"></a>
<a id="ln-1313" name="ln-1313" href="#ln-1313"></a>
<a id="ln-1314" name="ln-1314" href="#ln-1314"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1315" name="ln-1315" href="#ln-1315"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">Tsurface</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1316" name="ln-1316" href="#ln-1316"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1317" name="ln-1317" href="#ln-1317"></a>
<a id="ln-1318" name="ln-1318" href="#ln-1318"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1319" name="ln-1319" href="#ln-1319"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">h0</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1320" name="ln-1320" href="#ln-1320"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1321" name="ln-1321" href="#ln-1321"></a>
<a id="ln-1322" name="ln-1322" href="#ln-1322"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1323" name="ln-1323" href="#ln-1323"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">nsnow</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1324" name="ln-1324" href="#ln-1324"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1len</span><span class="w"></span>
<a id="ln-1325" name="ln-1325" href="#ln-1325"></a><span class="w">    </span><span class="c">! end additional for sli</span>
<a id="ln-1326" name="ln-1326" href="#ln-1326"></a>
<a id="ln-1327" name="ln-1327" href="#ln-1327"></a>
<a id="ln-1328" name="ln-1328" href="#ln-1328"></a>
<a id="ln-1329" name="ln-1329" href="#ln-1329"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1330" name="ln-1330" href="#ln-1330"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wbtot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1331" name="ln-1331" href="#ln-1331"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1332" name="ln-1332" href="#ln-1332"></a>
<a id="ln-1333" name="ln-1333" href="#ln-1333"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1334" name="ln-1334" href="#ln-1334"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wb_lake</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1335" name="ln-1335" href="#ln-1335"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1336" name="ln-1336" href="#ln-1336"></a>
<a id="ln-1337" name="ln-1337" href="#ln-1337"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1338" name="ln-1338" href="#ln-1338"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">sinfil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1339" name="ln-1339" href="#ln-1339"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1340" name="ln-1340" href="#ln-1340"></a>
<a id="ln-1341" name="ln-1341" href="#ln-1341"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1342" name="ln-1342" href="#ln-1342"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">evapfbl</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1343" name="ln-1343" href="#ln-1343"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1344" name="ln-1344" href="#ln-1344"></a>
<a id="ln-1345" name="ln-1345" href="#ln-1345"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1346" name="ln-1346" href="#ln-1346"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">qstss</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1347" name="ln-1347" href="#ln-1347"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1348" name="ln-1348" href="#ln-1348"></a>
<a id="ln-1349" name="ln-1349" href="#ln-1349"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1350" name="ln-1350" href="#ln-1350"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wetfac</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1351" name="ln-1351" href="#ln-1351"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1352" name="ln-1352" href="#ln-1352"></a>
<a id="ln-1353" name="ln-1353" href="#ln-1353"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1354" name="ln-1354" href="#ln-1354"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">owetfac</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1355" name="ln-1355" href="#ln-1355"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1356" name="ln-1356" href="#ln-1356"></a>
<a id="ln-1357" name="ln-1357" href="#ln-1357"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1358" name="ln-1358" href="#ln-1358"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">t_snwlr</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1359" name="ln-1359" href="#ln-1359"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1360" name="ln-1360" href="#ln-1360"></a>
<a id="ln-1361" name="ln-1361" href="#ln-1361"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1362" name="ln-1362" href="#ln-1362"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tggav</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1363" name="ln-1363" href="#ln-1363"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1364" name="ln-1364" href="#ln-1364"></a>
<a id="ln-1365" name="ln-1365" href="#ln-1365"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1366" name="ln-1366" href="#ln-1366"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">otss</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1367" name="ln-1367" href="#ln-1367"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1368" name="ln-1368" href="#ln-1368"></a>
<a id="ln-1369" name="ln-1369" href="#ln-1369"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1370" name="ln-1370" href="#ln-1370"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">otss_0</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1371" name="ln-1371" href="#ln-1371"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1372" name="ln-1372" href="#ln-1372"></a>
<a id="ln-1373" name="ln-1373" href="#ln-1373"></a><span class="w">    </span><span class="c">! ----------- veg --------------</span>
<a id="ln-1374" name="ln-1374" href="#ln-1374"></a>
<a id="ln-1375" name="ln-1375" href="#ln-1375"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1376" name="ln-1376" href="#ln-1376"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">canst1</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1377" name="ln-1377" href="#ln-1377"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1378" name="ln-1378" href="#ln-1378"></a>
<a id="ln-1379" name="ln-1379" href="#ln-1379"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1380" name="ln-1380" href="#ln-1380"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">dleaf</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1381" name="ln-1381" href="#ln-1381"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1382" name="ln-1382" href="#ln-1382"></a>
<a id="ln-1383" name="ln-1383" href="#ln-1383"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1384" name="ln-1384" href="#ln-1384"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">ejmax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1385" name="ln-1385" href="#ln-1385"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1386" name="ln-1386" href="#ln-1386"></a>
<a id="ln-1387" name="ln-1387" href="#ln-1387"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1388" name="ln-1388" href="#ln-1388"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">frac4</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1389" name="ln-1389" href="#ln-1389"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1390" name="ln-1390" href="#ln-1390"></a>
<a id="ln-1391" name="ln-1391" href="#ln-1391"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1392" name="ln-1392" href="#ln-1392"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">froot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1393" name="ln-1393" href="#ln-1393"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1394" name="ln-1394" href="#ln-1394"></a>
<a id="ln-1395" name="ln-1395" href="#ln-1395"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1396" name="ln-1396" href="#ln-1396"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">hc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1397" name="ln-1397" href="#ln-1397"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1398" name="ln-1398" href="#ln-1398"></a>
<a id="ln-1399" name="ln-1399" href="#ln-1399"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1400" name="ln-1400" href="#ln-1400"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">iveg</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1401" name="ln-1401" href="#ln-1401"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-1402" name="ln-1402" href="#ln-1402"></a>
<a id="ln-1403" name="ln-1403" href="#ln-1403"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1404" name="ln-1404" href="#ln-1404"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">meth</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1405" name="ln-1405" href="#ln-1405"></a><span class="w">    </span><span class="c">! Maciej: veg%meth is REAL</span>
<a id="ln-1406" name="ln-1406" href="#ln-1406"></a><span class="w">    </span><span class="c">!    blen(bidx) = i1len</span>
<a id="ln-1407" name="ln-1407" href="#ln-1407"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1408" name="ln-1408" href="#ln-1408"></a>
<a id="ln-1409" name="ln-1409" href="#ln-1409"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1410" name="ln-1410" href="#ln-1410"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">rp20</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1411" name="ln-1411" href="#ln-1411"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1412" name="ln-1412" href="#ln-1412"></a>
<a id="ln-1413" name="ln-1413" href="#ln-1413"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1414" name="ln-1414" href="#ln-1414"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">rpcoef</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1415" name="ln-1415" href="#ln-1415"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1416" name="ln-1416" href="#ln-1416"></a>
<a id="ln-1417" name="ln-1417" href="#ln-1417"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1418" name="ln-1418" href="#ln-1418"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">shelrb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1419" name="ln-1419" href="#ln-1419"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1420" name="ln-1420" href="#ln-1420"></a>
<a id="ln-1421" name="ln-1421" href="#ln-1421"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1422" name="ln-1422" href="#ln-1422"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">wai</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1423" name="ln-1423" href="#ln-1423"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1424" name="ln-1424" href="#ln-1424"></a>
<a id="ln-1425" name="ln-1425" href="#ln-1425"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1426" name="ln-1426" href="#ln-1426"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">vegcf</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1427" name="ln-1427" href="#ln-1427"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1428" name="ln-1428" href="#ln-1428"></a>
<a id="ln-1429" name="ln-1429" href="#ln-1429"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1430" name="ln-1430" href="#ln-1430"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">tminvj</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1431" name="ln-1431" href="#ln-1431"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1432" name="ln-1432" href="#ln-1432"></a>
<a id="ln-1433" name="ln-1433" href="#ln-1433"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1434" name="ln-1434" href="#ln-1434"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">tmaxvj</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1435" name="ln-1435" href="#ln-1435"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1436" name="ln-1436" href="#ln-1436"></a>
<a id="ln-1437" name="ln-1437" href="#ln-1437"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1438" name="ln-1438" href="#ln-1438"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">vbeta</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1439" name="ln-1439" href="#ln-1439"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1440" name="ln-1440" href="#ln-1440"></a>
<a id="ln-1441" name="ln-1441" href="#ln-1441"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1442" name="ln-1442" href="#ln-1442"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">xalbnir</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1443" name="ln-1443" href="#ln-1443"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1444" name="ln-1444" href="#ln-1444"></a>
<a id="ln-1445" name="ln-1445" href="#ln-1445"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1446" name="ln-1446" href="#ln-1446"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">vcmax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1447" name="ln-1447" href="#ln-1447"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1448" name="ln-1448" href="#ln-1448"></a>
<a id="ln-1449" name="ln-1449" href="#ln-1449"></a><span class="w">    </span><span class="c">!  bidx = bidx + 1</span>
<a id="ln-1450" name="ln-1450" href="#ln-1450"></a><span class="w">    </span><span class="c">!  CALL MPI_Get_address (veg%vlai, displs(bidx), ierr)</span>
<a id="ln-1451" name="ln-1451" href="#ln-1451"></a><span class="w">    </span><span class="c">!  blen(bidx) = r1len</span>
<a id="ln-1452" name="ln-1452" href="#ln-1452"></a>
<a id="ln-1453" name="ln-1453" href="#ln-1453"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1454" name="ln-1454" href="#ln-1454"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">xfang</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1455" name="ln-1455" href="#ln-1455"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1456" name="ln-1456" href="#ln-1456"></a>
<a id="ln-1457" name="ln-1457" href="#ln-1457"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1458" name="ln-1458" href="#ln-1458"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">extkn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1459" name="ln-1459" href="#ln-1459"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1460" name="ln-1460" href="#ln-1460"></a>
<a id="ln-1461" name="ln-1461" href="#ln-1461"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1462" name="ln-1462" href="#ln-1462"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">deciduous</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1463" name="ln-1463" href="#ln-1463"></a><span class="w">    </span><span class="c">! Maciej: deciduous is logical</span>
<a id="ln-1464" name="ln-1464" href="#ln-1464"></a><span class="w">    </span><span class="c">!    blen(bidx) = r1len</span>
<a id="ln-1465" name="ln-1465" href="#ln-1465"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">llen</span><span class="w"></span>
<a id="ln-1466" name="ln-1466" href="#ln-1466"></a>
<a id="ln-1467" name="ln-1467" href="#ln-1467"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1468" name="ln-1468" href="#ln-1468"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">a1gs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1469" name="ln-1469" href="#ln-1469"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1470" name="ln-1470" href="#ln-1470"></a>
<a id="ln-1471" name="ln-1471" href="#ln-1471"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1472" name="ln-1472" href="#ln-1472"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">d0gs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1473" name="ln-1473" href="#ln-1473"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1474" name="ln-1474" href="#ln-1474"></a>
<a id="ln-1475" name="ln-1475" href="#ln-1475"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1476" name="ln-1476" href="#ln-1476"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1477" name="ln-1477" href="#ln-1477"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1478" name="ln-1478" href="#ln-1478"></a>
<a id="ln-1479" name="ln-1479" href="#ln-1479"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1480" name="ln-1480" href="#ln-1480"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">convex</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1481" name="ln-1481" href="#ln-1481"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1482" name="ln-1482" href="#ln-1482"></a>
<a id="ln-1483" name="ln-1483" href="#ln-1483"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1484" name="ln-1484" href="#ln-1484"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">cfrd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1485" name="ln-1485" href="#ln-1485"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1486" name="ln-1486" href="#ln-1486"></a>
<a id="ln-1487" name="ln-1487" href="#ln-1487"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1488" name="ln-1488" href="#ln-1488"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">gswmin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1489" name="ln-1489" href="#ln-1489"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1490" name="ln-1490" href="#ln-1490"></a>
<a id="ln-1491" name="ln-1491" href="#ln-1491"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1492" name="ln-1492" href="#ln-1492"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">conkc0</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1493" name="ln-1493" href="#ln-1493"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1494" name="ln-1494" href="#ln-1494"></a>
<a id="ln-1495" name="ln-1495" href="#ln-1495"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1496" name="ln-1496" href="#ln-1496"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">conko0</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1497" name="ln-1497" href="#ln-1497"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1498" name="ln-1498" href="#ln-1498"></a>
<a id="ln-1499" name="ln-1499" href="#ln-1499"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1500" name="ln-1500" href="#ln-1500"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">ekc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1501" name="ln-1501" href="#ln-1501"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1502" name="ln-1502" href="#ln-1502"></a>
<a id="ln-1503" name="ln-1503" href="#ln-1503"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1504" name="ln-1504" href="#ln-1504"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">eko</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1505" name="ln-1505" href="#ln-1505"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1506" name="ln-1506" href="#ln-1506"></a>
<a id="ln-1507" name="ln-1507" href="#ln-1507"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1508" name="ln-1508" href="#ln-1508"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">clitt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1509" name="ln-1509" href="#ln-1509"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1510" name="ln-1510" href="#ln-1510"></a>
<a id="ln-1511" name="ln-1511" href="#ln-1511"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1512" name="ln-1512" href="#ln-1512"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">zr</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1513" name="ln-1513" href="#ln-1513"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1514" name="ln-1514" href="#ln-1514"></a>
<a id="ln-1515" name="ln-1515" href="#ln-1515"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1516" name="ln-1516" href="#ln-1516"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="nb">gamma</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1517" name="ln-1517" href="#ln-1517"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1518" name="ln-1518" href="#ln-1518"></a>
<a id="ln-1519" name="ln-1519" href="#ln-1519"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1520" name="ln-1520" href="#ln-1520"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">refl</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1521" name="ln-1521" href="#ln-1521"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1522" name="ln-1522" href="#ln-1522"></a>
<a id="ln-1523" name="ln-1523" href="#ln-1523"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1524" name="ln-1524" href="#ln-1524"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">taul</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1525" name="ln-1525" href="#ln-1525"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1526" name="ln-1526" href="#ln-1526"></a>
<a id="ln-1527" name="ln-1527" href="#ln-1527"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1528" name="ln-1528" href="#ln-1528"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">disturbance_interval</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1529" name="ln-1529" href="#ln-1529"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-1530" name="ln-1530" href="#ln-1530"></a>
<a id="ln-1531" name="ln-1531" href="#ln-1531"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1532" name="ln-1532" href="#ln-1532"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">disturbance_intensity</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1533" name="ln-1533" href="#ln-1533"></a><span class="w">    </span><span class="c">! Maciej: disturbance_intensity is REAL(r_2)</span>
<a id="ln-1534" name="ln-1534" href="#ln-1534"></a><span class="w">    </span><span class="c">!    blen(bidx) = 2 * r1len</span>
<a id="ln-1535" name="ln-1535" href="#ln-1535"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1536" name="ln-1536" href="#ln-1536"></a>
<a id="ln-1537" name="ln-1537" href="#ln-1537"></a><span class="w">    </span><span class="c">! Ticket #56, adding new veg parms</span>
<a id="ln-1538" name="ln-1538" href="#ln-1538"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1539" name="ln-1539" href="#ln-1539"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">g0</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1540" name="ln-1540" href="#ln-1540"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1541" name="ln-1541" href="#ln-1541"></a>
<a id="ln-1542" name="ln-1542" href="#ln-1542"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1543" name="ln-1543" href="#ln-1543"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1544" name="ln-1544" href="#ln-1544"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1545" name="ln-1545" href="#ln-1545"></a><span class="w">    </span><span class="c">! Ticket #56, finish adding new veg parms</span>
<a id="ln-1546" name="ln-1546" href="#ln-1546"></a>
<a id="ln-1547" name="ln-1547" href="#ln-1547"></a><span class="w">    </span><span class="c">! ----------- bgc --------------</span>
<a id="ln-1548" name="ln-1548" href="#ln-1548"></a>
<a id="ln-1549" name="ln-1549" href="#ln-1549"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1550" name="ln-1550" href="#ln-1550"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bgc</span><span class="p">%</span><span class="n">cplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1551" name="ln-1551" href="#ln-1551"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1552" name="ln-1552" href="#ln-1552"></a>
<a id="ln-1553" name="ln-1553" href="#ln-1553"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1554" name="ln-1554" href="#ln-1554"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bgc</span><span class="p">%</span><span class="n">csoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1555" name="ln-1555" href="#ln-1555"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1556" name="ln-1556" href="#ln-1556"></a>
<a id="ln-1557" name="ln-1557" href="#ln-1557"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1558" name="ln-1558" href="#ln-1558"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bgc</span><span class="p">%</span><span class="n">ratecp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1559" name="ln-1559" href="#ln-1559"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-1560" name="ln-1560" href="#ln-1560"></a>
<a id="ln-1561" name="ln-1561" href="#ln-1561"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1562" name="ln-1562" href="#ln-1562"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bgc</span><span class="p">%</span><span class="n">ratecs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1563" name="ln-1563" href="#ln-1563"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-1564" name="ln-1564" href="#ln-1564"></a>
<a id="ln-1565" name="ln-1565" href="#ln-1565"></a><span class="w">    </span><span class="c">! ----------- soil --------------</span>
<a id="ln-1566" name="ln-1566" href="#ln-1566"></a>
<a id="ln-1567" name="ln-1567" href="#ln-1567"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1568" name="ln-1568" href="#ln-1568"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">albsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1569" name="ln-1569" href="#ln-1569"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1570" name="ln-1570" href="#ln-1570"></a>
<a id="ln-1571" name="ln-1571" href="#ln-1571"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1572" name="ln-1572" href="#ln-1572"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">bch</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1573" name="ln-1573" href="#ln-1573"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1574" name="ln-1574" href="#ln-1574"></a>
<a id="ln-1575" name="ln-1575" href="#ln-1575"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1576" name="ln-1576" href="#ln-1576"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">c3</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1577" name="ln-1577" href="#ln-1577"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1578" name="ln-1578" href="#ln-1578"></a>
<a id="ln-1579" name="ln-1579" href="#ln-1579"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1580" name="ln-1580" href="#ln-1580"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">clay</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1581" name="ln-1581" href="#ln-1581"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1582" name="ln-1582" href="#ln-1582"></a>
<a id="ln-1583" name="ln-1583" href="#ln-1583"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1584" name="ln-1584" href="#ln-1584"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">cnsd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1585" name="ln-1585" href="#ln-1585"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1586" name="ln-1586" href="#ln-1586"></a>
<a id="ln-1587" name="ln-1587" href="#ln-1587"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1588" name="ln-1588" href="#ln-1588"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">css</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1589" name="ln-1589" href="#ln-1589"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1590" name="ln-1590" href="#ln-1590"></a>
<a id="ln-1591" name="ln-1591" href="#ln-1591"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1592" name="ln-1592" href="#ln-1592"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">hsbh</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1593" name="ln-1593" href="#ln-1593"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1594" name="ln-1594" href="#ln-1594"></a>
<a id="ln-1595" name="ln-1595" href="#ln-1595"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1596" name="ln-1596" href="#ln-1596"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">hyds</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1597" name="ln-1597" href="#ln-1597"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1598" name="ln-1598" href="#ln-1598"></a>
<a id="ln-1599" name="ln-1599" href="#ln-1599"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1600" name="ln-1600" href="#ln-1600"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">i2bp3</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1601" name="ln-1601" href="#ln-1601"></a><span class="w">    </span><span class="c">! Maciej: i2bp3 is REAL</span>
<a id="ln-1602" name="ln-1602" href="#ln-1602"></a><span class="w">    </span><span class="c">!    blen(bidx) = i1len</span>
<a id="ln-1603" name="ln-1603" href="#ln-1603"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1604" name="ln-1604" href="#ln-1604"></a>
<a id="ln-1605" name="ln-1605" href="#ln-1605"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1606" name="ln-1606" href="#ln-1606"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">ibp2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1607" name="ln-1607" href="#ln-1607"></a><span class="w">    </span><span class="c">! Maciej: ibp2 is REAL</span>
<a id="ln-1608" name="ln-1608" href="#ln-1608"></a><span class="w">    </span><span class="c">!    blen(bidx) = i1len</span>
<a id="ln-1609" name="ln-1609" href="#ln-1609"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1610" name="ln-1610" href="#ln-1610"></a>
<a id="ln-1611" name="ln-1611" href="#ln-1611"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1612" name="ln-1612" href="#ln-1612"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">isoilm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1613" name="ln-1613" href="#ln-1613"></a><span class="w">    </span><span class="c">! Maciej isoilm is INTEGER</span>
<a id="ln-1614" name="ln-1614" href="#ln-1614"></a><span class="w">    </span><span class="c">!    blen(bidx) = r1len</span>
<a id="ln-1615" name="ln-1615" href="#ln-1615"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-1616" name="ln-1616" href="#ln-1616"></a>
<a id="ln-1617" name="ln-1617" href="#ln-1617"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1618" name="ln-1618" href="#ln-1618"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">rhosoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1619" name="ln-1619" href="#ln-1619"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1620" name="ln-1620" href="#ln-1620"></a>
<a id="ln-1621" name="ln-1621" href="#ln-1621"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1622" name="ln-1622" href="#ln-1622"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">rs20</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1623" name="ln-1623" href="#ln-1623"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1624" name="ln-1624" href="#ln-1624"></a>
<a id="ln-1625" name="ln-1625" href="#ln-1625"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1626" name="ln-1626" href="#ln-1626"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">sand</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1627" name="ln-1627" href="#ln-1627"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1628" name="ln-1628" href="#ln-1628"></a>
<a id="ln-1629" name="ln-1629" href="#ln-1629"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1630" name="ln-1630" href="#ln-1630"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">sfc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1631" name="ln-1631" href="#ln-1631"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1632" name="ln-1632" href="#ln-1632"></a>
<a id="ln-1633" name="ln-1633" href="#ln-1633"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1634" name="ln-1634" href="#ln-1634"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">silt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1635" name="ln-1635" href="#ln-1635"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1636" name="ln-1636" href="#ln-1636"></a>
<a id="ln-1637" name="ln-1637" href="#ln-1637"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1638" name="ln-1638" href="#ln-1638"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">ssat</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1639" name="ln-1639" href="#ln-1639"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1640" name="ln-1640" href="#ln-1640"></a>
<a id="ln-1641" name="ln-1641" href="#ln-1641"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1642" name="ln-1642" href="#ln-1642"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">sucs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1643" name="ln-1643" href="#ln-1643"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1644" name="ln-1644" href="#ln-1644"></a>
<a id="ln-1645" name="ln-1645" href="#ln-1645"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1646" name="ln-1646" href="#ln-1646"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">swilt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1647" name="ln-1647" href="#ln-1647"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1648" name="ln-1648" href="#ln-1648"></a>
<a id="ln-1649" name="ln-1649" href="#ln-1649"></a><span class="w">    </span><span class="c">! extra for sli</span>
<a id="ln-1650" name="ln-1650" href="#ln-1650"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1651" name="ln-1651" href="#ln-1651"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">zeta</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1652" name="ln-1652" href="#ln-1652"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1653" name="ln-1653" href="#ln-1653"></a>
<a id="ln-1654" name="ln-1654" href="#ln-1654"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1655" name="ln-1655" href="#ln-1655"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">fsatmax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1656" name="ln-1656" href="#ln-1656"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1657" name="ln-1657" href="#ln-1657"></a><span class="w">    </span><span class="c">! end extra for sil</span>
<a id="ln-1658" name="ln-1658" href="#ln-1658"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1659" name="ln-1659" href="#ln-1659"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">zse</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1660" name="ln-1660" href="#ln-1660"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-1661" name="ln-1661" href="#ln-1661"></a>
<a id="ln-1662" name="ln-1662" href="#ln-1662"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1663" name="ln-1663" href="#ln-1663"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">zshh</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1664" name="ln-1664" href="#ln-1664"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ms</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-1665" name="ln-1665" href="#ln-1665"></a>
<a id="ln-1666" name="ln-1666" href="#ln-1666"></a><span class="w">    </span><span class="c">! pass soilcolour albedo as well if including Ticket #27</span>
<a id="ln-1667" name="ln-1667" href="#ln-1667"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">calcsoilalbedo</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-1668" name="ln-1668" href="#ln-1668"></a><span class="k">       </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1669" name="ln-1669" href="#ln-1669"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">soilcol</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1670" name="ln-1670" href="#ln-1670"></a><span class="w">       </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1671" name="ln-1671" href="#ln-1671"></a><span class="w">    </span><span class="k">END IF</span><span class="w"></span>
<a id="ln-1672" name="ln-1672" href="#ln-1672"></a>
<a id="ln-1673" name="ln-1673" href="#ln-1673"></a><span class="w">    </span><span class="c">! ----------- canopy --------------</span>
<a id="ln-1674" name="ln-1674" href="#ln-1674"></a>
<a id="ln-1675" name="ln-1675" href="#ln-1675"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1676" name="ln-1676" href="#ln-1676"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fess</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1677" name="ln-1677" href="#ln-1677"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1678" name="ln-1678" href="#ln-1678"></a>
<a id="ln-1679" name="ln-1679" href="#ln-1679"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1680" name="ln-1680" href="#ln-1680"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fesp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1681" name="ln-1681" href="#ln-1681"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1682" name="ln-1682" href="#ln-1682"></a>
<a id="ln-1683" name="ln-1683" href="#ln-1683"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1684" name="ln-1684" href="#ln-1684"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">cansto</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1685" name="ln-1685" href="#ln-1685"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1686" name="ln-1686" href="#ln-1686"></a>
<a id="ln-1687" name="ln-1687" href="#ln-1687"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1688" name="ln-1688" href="#ln-1688"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">oldcansto</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1689" name="ln-1689" href="#ln-1689"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1690" name="ln-1690" href="#ln-1690"></a>
<a id="ln-1691" name="ln-1691" href="#ln-1691"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1692" name="ln-1692" href="#ln-1692"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">cduv</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1693" name="ln-1693" href="#ln-1693"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1694" name="ln-1694" href="#ln-1694"></a>
<a id="ln-1695" name="ln-1695" href="#ln-1695"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1696" name="ln-1696" href="#ln-1696"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">delwc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1697" name="ln-1697" href="#ln-1697"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1698" name="ln-1698" href="#ln-1698"></a>
<a id="ln-1699" name="ln-1699" href="#ln-1699"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1700" name="ln-1700" href="#ln-1700"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">dewmm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1701" name="ln-1701" href="#ln-1701"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1702" name="ln-1702" href="#ln-1702"></a>
<a id="ln-1703" name="ln-1703" href="#ln-1703"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1704" name="ln-1704" href="#ln-1704"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">dgdtg</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1705" name="ln-1705" href="#ln-1705"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1706" name="ln-1706" href="#ln-1706"></a>
<a id="ln-1707" name="ln-1707" href="#ln-1707"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1708" name="ln-1708" href="#ln-1708"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fe</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1709" name="ln-1709" href="#ln-1709"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1710" name="ln-1710" href="#ln-1710"></a>
<a id="ln-1711" name="ln-1711" href="#ln-1711"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1712" name="ln-1712" href="#ln-1712"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fh</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1713" name="ln-1713" href="#ln-1713"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1714" name="ln-1714" href="#ln-1714"></a>
<a id="ln-1715" name="ln-1715" href="#ln-1715"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1716" name="ln-1716" href="#ln-1716"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fpn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1717" name="ln-1717" href="#ln-1717"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1718" name="ln-1718" href="#ln-1718"></a>
<a id="ln-1719" name="ln-1719" href="#ln-1719"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1720" name="ln-1720" href="#ln-1720"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1721" name="ln-1721" href="#ln-1721"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1722" name="ln-1722" href="#ln-1722"></a>
<a id="ln-1723" name="ln-1723" href="#ln-1723"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1724" name="ln-1724" href="#ln-1724"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frpw</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1725" name="ln-1725" href="#ln-1725"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1726" name="ln-1726" href="#ln-1726"></a>
<a id="ln-1727" name="ln-1727" href="#ln-1727"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1728" name="ln-1728" href="#ln-1728"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frpr</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1729" name="ln-1729" href="#ln-1729"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1730" name="ln-1730" href="#ln-1730"></a>
<a id="ln-1731" name="ln-1731" href="#ln-1731"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1732" name="ln-1732" href="#ln-1732"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1733" name="ln-1733" href="#ln-1733"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1734" name="ln-1734" href="#ln-1734"></a>
<a id="ln-1735" name="ln-1735" href="#ln-1735"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1736" name="ln-1736" href="#ln-1736"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fnee</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1737" name="ln-1737" href="#ln-1737"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1738" name="ln-1738" href="#ln-1738"></a>
<a id="ln-1739" name="ln-1739" href="#ln-1739"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1740" name="ln-1740" href="#ln-1740"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frday</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1741" name="ln-1741" href="#ln-1741"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1742" name="ln-1742" href="#ln-1742"></a>
<a id="ln-1743" name="ln-1743" href="#ln-1743"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1744" name="ln-1744" href="#ln-1744"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fnv</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1745" name="ln-1745" href="#ln-1745"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1746" name="ln-1746" href="#ln-1746"></a>
<a id="ln-1747" name="ln-1747" href="#ln-1747"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1748" name="ln-1748" href="#ln-1748"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fev</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1749" name="ln-1749" href="#ln-1749"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1750" name="ln-1750" href="#ln-1750"></a>
<a id="ln-1751" name="ln-1751" href="#ln-1751"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1752" name="ln-1752" href="#ln-1752"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fevc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1753" name="ln-1753" href="#ln-1753"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1754" name="ln-1754" href="#ln-1754"></a>
<a id="ln-1755" name="ln-1755" href="#ln-1755"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1756" name="ln-1756" href="#ln-1756"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fevw</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1757" name="ln-1757" href="#ln-1757"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1758" name="ln-1758" href="#ln-1758"></a>
<a id="ln-1759" name="ln-1759" href="#ln-1759"></a><span class="w">    </span><span class="c">!  bidx = bidx + 1</span>
<a id="ln-1760" name="ln-1760" href="#ln-1760"></a><span class="w">    </span><span class="c">!  CALL MPI_Get_address (canopy%potev_c, displs(bidx), ierr)</span>
<a id="ln-1761" name="ln-1761" href="#ln-1761"></a><span class="w">    </span><span class="c">!  blen(bidx) = r2len</span>
<a id="ln-1762" name="ln-1762" href="#ln-1762"></a>
<a id="ln-1763" name="ln-1763" href="#ln-1763"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1764" name="ln-1764" href="#ln-1764"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fhv</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1765" name="ln-1765" href="#ln-1765"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1766" name="ln-1766" href="#ln-1766"></a>
<a id="ln-1767" name="ln-1767" href="#ln-1767"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1768" name="ln-1768" href="#ln-1768"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fhvw</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1769" name="ln-1769" href="#ln-1769"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1770" name="ln-1770" href="#ln-1770"></a>
<a id="ln-1771" name="ln-1771" href="#ln-1771"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1772" name="ln-1772" href="#ln-1772"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fns</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1773" name="ln-1773" href="#ln-1773"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1774" name="ln-1774" href="#ln-1774"></a>
<a id="ln-1775" name="ln-1775" href="#ln-1775"></a><span class="w">    </span><span class="c">!INH - REV_CORR - temporary?</span>
<a id="ln-1776" name="ln-1776" href="#ln-1776"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1777" name="ln-1777" href="#ln-1777"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fns_cor</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1778" name="ln-1778" href="#ln-1778"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1779" name="ln-1779" href="#ln-1779"></a>
<a id="ln-1780" name="ln-1780" href="#ln-1780"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1781" name="ln-1781" href="#ln-1781"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fes</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1782" name="ln-1782" href="#ln-1782"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1783" name="ln-1783" href="#ln-1783"></a>
<a id="ln-1784" name="ln-1784" href="#ln-1784"></a><span class="w">    </span><span class="c">!INH - REV_CORR - temporary?</span>
<a id="ln-1785" name="ln-1785" href="#ln-1785"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1786" name="ln-1786" href="#ln-1786"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fes_cor</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1787" name="ln-1787" href="#ln-1787"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1788" name="ln-1788" href="#ln-1788"></a>
<a id="ln-1789" name="ln-1789" href="#ln-1789"></a><span class="w">    </span><span class="c">!INH - SSEB - temporary?</span>
<a id="ln-1790" name="ln-1790" href="#ln-1790"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-1791" name="ln-1791" href="#ln-1791"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fescor_upp, displs(bidx), ierr)</span>
<a id="ln-1792" name="ln-1792" href="#ln-1792"></a><span class="w">    </span><span class="c">!blen(bidx) = r2len</span>
<a id="ln-1793" name="ln-1793" href="#ln-1793"></a>
<a id="ln-1794" name="ln-1794" href="#ln-1794"></a><span class="w">    </span><span class="c">!INH - SSEB - temporary?</span>
<a id="ln-1795" name="ln-1795" href="#ln-1795"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-1796" name="ln-1796" href="#ln-1796"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fescor_low, displs(bidx), ierr)</span>
<a id="ln-1797" name="ln-1797" href="#ln-1797"></a><span class="w">    </span><span class="c">!blen(bidx) = r2len</span>
<a id="ln-1798" name="ln-1798" href="#ln-1798"></a>
<a id="ln-1799" name="ln-1799" href="#ln-1799"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1800" name="ln-1800" href="#ln-1800"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fhs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1801" name="ln-1801" href="#ln-1801"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1802" name="ln-1802" href="#ln-1802"></a>
<a id="ln-1803" name="ln-1803" href="#ln-1803"></a><span class="w">    </span><span class="c">!INH - REV_CORR - temporary?</span>
<a id="ln-1804" name="ln-1804" href="#ln-1804"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1805" name="ln-1805" href="#ln-1805"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fhs_cor</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1806" name="ln-1806" href="#ln-1806"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1807" name="ln-1807" href="#ln-1807"></a>
<a id="ln-1808" name="ln-1808" href="#ln-1808"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1809" name="ln-1809" href="#ln-1809"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fwet</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1810" name="ln-1810" href="#ln-1810"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1811" name="ln-1811" href="#ln-1811"></a>
<a id="ln-1812" name="ln-1812" href="#ln-1812"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1813" name="ln-1813" href="#ln-1813"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">ga</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1814" name="ln-1814" href="#ln-1814"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1815" name="ln-1815" href="#ln-1815"></a>
<a id="ln-1816" name="ln-1816" href="#ln-1816"></a><span class="w">    </span><span class="c">!INH - REV_CORR - temporary?</span>
<a id="ln-1817" name="ln-1817" href="#ln-1817"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1818" name="ln-1818" href="#ln-1818"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">ga_cor</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1819" name="ln-1819" href="#ln-1819"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1820" name="ln-1820" href="#ln-1820"></a>
<a id="ln-1821" name="ln-1821" href="#ln-1821"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1822" name="ln-1822" href="#ln-1822"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">ghflux</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1823" name="ln-1823" href="#ln-1823"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1824" name="ln-1824" href="#ln-1824"></a>
<a id="ln-1825" name="ln-1825" href="#ln-1825"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1826" name="ln-1826" href="#ln-1826"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">precis</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1827" name="ln-1827" href="#ln-1827"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1828" name="ln-1828" href="#ln-1828"></a>
<a id="ln-1829" name="ln-1829" href="#ln-1829"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1830" name="ln-1830" href="#ln-1830"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">qscrn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1831" name="ln-1831" href="#ln-1831"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1832" name="ln-1832" href="#ln-1832"></a>
<a id="ln-1833" name="ln-1833" href="#ln-1833"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1834" name="ln-1834" href="#ln-1834"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">rnet</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1835" name="ln-1835" href="#ln-1835"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1836" name="ln-1836" href="#ln-1836"></a>
<a id="ln-1837" name="ln-1837" href="#ln-1837"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1838" name="ln-1838" href="#ln-1838"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">segg</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1839" name="ln-1839" href="#ln-1839"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1840" name="ln-1840" href="#ln-1840"></a>
<a id="ln-1841" name="ln-1841" href="#ln-1841"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1842" name="ln-1842" href="#ln-1842"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">sghflux</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1843" name="ln-1843" href="#ln-1843"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1844" name="ln-1844" href="#ln-1844"></a>
<a id="ln-1845" name="ln-1845" href="#ln-1845"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1846" name="ln-1846" href="#ln-1846"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">spill</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1847" name="ln-1847" href="#ln-1847"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1848" name="ln-1848" href="#ln-1848"></a>
<a id="ln-1849" name="ln-1849" href="#ln-1849"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1850" name="ln-1850" href="#ln-1850"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">through</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1851" name="ln-1851" href="#ln-1851"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1852" name="ln-1852" href="#ln-1852"></a>
<a id="ln-1853" name="ln-1853" href="#ln-1853"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1854" name="ln-1854" href="#ln-1854"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">tscrn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1855" name="ln-1855" href="#ln-1855"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1856" name="ln-1856" href="#ln-1856"></a>
<a id="ln-1857" name="ln-1857" href="#ln-1857"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1858" name="ln-1858" href="#ln-1858"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">tv</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1859" name="ln-1859" href="#ln-1859"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1860" name="ln-1860" href="#ln-1860"></a>
<a id="ln-1861" name="ln-1861" href="#ln-1861"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1862" name="ln-1862" href="#ln-1862"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1863" name="ln-1863" href="#ln-1863"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1864" name="ln-1864" href="#ln-1864"></a>
<a id="ln-1865" name="ln-1865" href="#ln-1865"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1866" name="ln-1866" href="#ln-1866"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">uscrn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1867" name="ln-1867" href="#ln-1867"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1868" name="ln-1868" href="#ln-1868"></a>
<a id="ln-1869" name="ln-1869" href="#ln-1869"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1870" name="ln-1870" href="#ln-1870"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">vlaiw</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1871" name="ln-1871" href="#ln-1871"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1872" name="ln-1872" href="#ln-1872"></a>
<a id="ln-1873" name="ln-1873" href="#ln-1873"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1874" name="ln-1874" href="#ln-1874"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">rghlai</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1875" name="ln-1875" href="#ln-1875"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1876" name="ln-1876" href="#ln-1876"></a>
<a id="ln-1877" name="ln-1877" href="#ln-1877"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1878" name="ln-1878" href="#ln-1878"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">wcint</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1879" name="ln-1879" href="#ln-1879"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1880" name="ln-1880" href="#ln-1880"></a>
<a id="ln-1881" name="ln-1881" href="#ln-1881"></a>
<a id="ln-1882" name="ln-1882" href="#ln-1882"></a>
<a id="ln-1883" name="ln-1883" href="#ln-1883"></a><span class="w">    </span><span class="c">!  bidx = bidx + 1</span>
<a id="ln-1884" name="ln-1884" href="#ln-1884"></a><span class="w">    </span><span class="c">!  CALL MPI_Get_address (canopy%rwater, displs(bidx), ierr)</span>
<a id="ln-1885" name="ln-1885" href="#ln-1885"></a><span class="w">    </span><span class="c">!  blen(bidx) = ms * r1len</span>
<a id="ln-1886" name="ln-1886" href="#ln-1886"></a>
<a id="ln-1887" name="ln-1887" href="#ln-1887"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1888" name="ln-1888" href="#ln-1888"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">evapfbl</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1889" name="ln-1889" href="#ln-1889"></a><span class="w">    </span><span class="c">! MPI: gol124: changed to r1 when Bernard ported to CABLE_r491</span>
<a id="ln-1890" name="ln-1890" href="#ln-1890"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1891" name="ln-1891" href="#ln-1891"></a>
<a id="ln-1892" name="ln-1892" href="#ln-1892"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1893" name="ln-1893" href="#ln-1893"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">epot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1894" name="ln-1894" href="#ln-1894"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1895" name="ln-1895" href="#ln-1895"></a>
<a id="ln-1896" name="ln-1896" href="#ln-1896"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1897" name="ln-1897" href="#ln-1897"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fnpp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1898" name="ln-1898" href="#ln-1898"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1899" name="ln-1899" href="#ln-1899"></a>
<a id="ln-1900" name="ln-1900" href="#ln-1900"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1901" name="ln-1901" href="#ln-1901"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fevw_pot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1902" name="ln-1902" href="#ln-1902"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1903" name="ln-1903" href="#ln-1903"></a>
<a id="ln-1904" name="ln-1904" href="#ln-1904"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1905" name="ln-1905" href="#ln-1905"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">gswx_T</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1906" name="ln-1906" href="#ln-1906"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1907" name="ln-1907" href="#ln-1907"></a>
<a id="ln-1908" name="ln-1908" href="#ln-1908"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1909" name="ln-1909" href="#ln-1909"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">cdtq</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1910" name="ln-1910" href="#ln-1910"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1911" name="ln-1911" href="#ln-1911"></a>
<a id="ln-1912" name="ln-1912" href="#ln-1912"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1913" name="ln-1913" href="#ln-1913"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">wetfac_cs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1914" name="ln-1914" href="#ln-1914"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1915" name="ln-1915" href="#ln-1915"></a>
<a id="ln-1916" name="ln-1916" href="#ln-1916"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1917" name="ln-1917" href="#ln-1917"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fwsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1918" name="ln-1918" href="#ln-1918"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-1919" name="ln-1919" href="#ln-1919"></a>
<a id="ln-1920" name="ln-1920" href="#ln-1920"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1921" name="ln-1921" href="#ln-1921"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">gswx</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1922" name="ln-1922" href="#ln-1922"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mf</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1923" name="ln-1923" href="#ln-1923"></a>
<a id="ln-1924" name="ln-1924" href="#ln-1924"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1925" name="ln-1925" href="#ln-1925"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">zetar</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1926" name="ln-1926" href="#ln-1926"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">niter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1927" name="ln-1927" href="#ln-1927"></a>
<a id="ln-1928" name="ln-1928" href="#ln-1928"></a><span class="w">    </span><span class="c">! ------- rough -------</span>
<a id="ln-1929" name="ln-1929" href="#ln-1929"></a>
<a id="ln-1930" name="ln-1930" href="#ln-1930"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1931" name="ln-1931" href="#ln-1931"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">coexp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1932" name="ln-1932" href="#ln-1932"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1933" name="ln-1933" href="#ln-1933"></a>
<a id="ln-1934" name="ln-1934" href="#ln-1934"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1935" name="ln-1935" href="#ln-1935"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">disp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1936" name="ln-1936" href="#ln-1936"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1937" name="ln-1937" href="#ln-1937"></a>
<a id="ln-1938" name="ln-1938" href="#ln-1938"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1939" name="ln-1939" href="#ln-1939"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">hruff</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1940" name="ln-1940" href="#ln-1940"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1941" name="ln-1941" href="#ln-1941"></a>
<a id="ln-1942" name="ln-1942" href="#ln-1942"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1943" name="ln-1943" href="#ln-1943"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">hruff_grmx</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1944" name="ln-1944" href="#ln-1944"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1945" name="ln-1945" href="#ln-1945"></a>
<a id="ln-1946" name="ln-1946" href="#ln-1946"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1947" name="ln-1947" href="#ln-1947"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">rt0us</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1948" name="ln-1948" href="#ln-1948"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1949" name="ln-1949" href="#ln-1949"></a>
<a id="ln-1950" name="ln-1950" href="#ln-1950"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1951" name="ln-1951" href="#ln-1951"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">rt1usa</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1952" name="ln-1952" href="#ln-1952"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1953" name="ln-1953" href="#ln-1953"></a>
<a id="ln-1954" name="ln-1954" href="#ln-1954"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1955" name="ln-1955" href="#ln-1955"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">rt1usb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1956" name="ln-1956" href="#ln-1956"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1957" name="ln-1957" href="#ln-1957"></a>
<a id="ln-1958" name="ln-1958" href="#ln-1958"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1959" name="ln-1959" href="#ln-1959"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">rt1</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1960" name="ln-1960" href="#ln-1960"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1961" name="ln-1961" href="#ln-1961"></a>
<a id="ln-1962" name="ln-1962" href="#ln-1962"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1963" name="ln-1963" href="#ln-1963"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">term2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1964" name="ln-1964" href="#ln-1964"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1965" name="ln-1965" href="#ln-1965"></a>
<a id="ln-1966" name="ln-1966" href="#ln-1966"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1967" name="ln-1967" href="#ln-1967"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">term3</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1968" name="ln-1968" href="#ln-1968"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1969" name="ln-1969" href="#ln-1969"></a>
<a id="ln-1970" name="ln-1970" href="#ln-1970"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1971" name="ln-1971" href="#ln-1971"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">term5</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1972" name="ln-1972" href="#ln-1972"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1973" name="ln-1973" href="#ln-1973"></a>
<a id="ln-1974" name="ln-1974" href="#ln-1974"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1975" name="ln-1975" href="#ln-1975"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">term6</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1976" name="ln-1976" href="#ln-1976"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1977" name="ln-1977" href="#ln-1977"></a>
<a id="ln-1978" name="ln-1978" href="#ln-1978"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1979" name="ln-1979" href="#ln-1979"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">usuh</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1980" name="ln-1980" href="#ln-1980"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1981" name="ln-1981" href="#ln-1981"></a>
<a id="ln-1982" name="ln-1982" href="#ln-1982"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1983" name="ln-1983" href="#ln-1983"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">za_uv</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1984" name="ln-1984" href="#ln-1984"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1985" name="ln-1985" href="#ln-1985"></a>
<a id="ln-1986" name="ln-1986" href="#ln-1986"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1987" name="ln-1987" href="#ln-1987"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">za_tq</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1988" name="ln-1988" href="#ln-1988"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1989" name="ln-1989" href="#ln-1989"></a>
<a id="ln-1990" name="ln-1990" href="#ln-1990"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1991" name="ln-1991" href="#ln-1991"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">z0m</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1992" name="ln-1992" href="#ln-1992"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1993" name="ln-1993" href="#ln-1993"></a>
<a id="ln-1994" name="ln-1994" href="#ln-1994"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1995" name="ln-1995" href="#ln-1995"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">zref_uv</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-1996" name="ln-1996" href="#ln-1996"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-1997" name="ln-1997" href="#ln-1997"></a>
<a id="ln-1998" name="ln-1998" href="#ln-1998"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-1999" name="ln-1999" href="#ln-1999"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">zref_tq</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2000" name="ln-2000" href="#ln-2000"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2001" name="ln-2001" href="#ln-2001"></a>
<a id="ln-2002" name="ln-2002" href="#ln-2002"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2003" name="ln-2003" href="#ln-2003"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">zruffs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2004" name="ln-2004" href="#ln-2004"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2005" name="ln-2005" href="#ln-2005"></a>
<a id="ln-2006" name="ln-2006" href="#ln-2006"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2007" name="ln-2007" href="#ln-2007"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">z0soilsn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2008" name="ln-2008" href="#ln-2008"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2009" name="ln-2009" href="#ln-2009"></a>
<a id="ln-2010" name="ln-2010" href="#ln-2010"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2011" name="ln-2011" href="#ln-2011"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rough</span><span class="p">%</span><span class="n">z0soil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2012" name="ln-2012" href="#ln-2012"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2013" name="ln-2013" href="#ln-2013"></a>
<a id="ln-2014" name="ln-2014" href="#ln-2014"></a><span class="w">    </span><span class="c">! --------rad --------</span>
<a id="ln-2015" name="ln-2015" href="#ln-2015"></a>
<a id="ln-2016" name="ln-2016" href="#ln-2016"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2017" name="ln-2017" href="#ln-2017"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">albedo</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2018" name="ln-2018" href="#ln-2018"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2019" name="ln-2019" href="#ln-2019"></a>
<a id="ln-2020" name="ln-2020" href="#ln-2020"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2021" name="ln-2021" href="#ln-2021"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">extkb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2022" name="ln-2022" href="#ln-2022"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2023" name="ln-2023" href="#ln-2023"></a>
<a id="ln-2024" name="ln-2024" href="#ln-2024"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2025" name="ln-2025" href="#ln-2025"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">extkd2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2026" name="ln-2026" href="#ln-2026"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2027" name="ln-2027" href="#ln-2027"></a>
<a id="ln-2028" name="ln-2028" href="#ln-2028"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2029" name="ln-2029" href="#ln-2029"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">extkd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2030" name="ln-2030" href="#ln-2030"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2031" name="ln-2031" href="#ln-2031"></a>
<a id="ln-2032" name="ln-2032" href="#ln-2032"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2033" name="ln-2033" href="#ln-2033"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">flws</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2034" name="ln-2034" href="#ln-2034"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2035" name="ln-2035" href="#ln-2035"></a>
<a id="ln-2036" name="ln-2036" href="#ln-2036"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2037" name="ln-2037" href="#ln-2037"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">fvlai</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2038" name="ln-2038" href="#ln-2038"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mf</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2039" name="ln-2039" href="#ln-2039"></a>
<a id="ln-2040" name="ln-2040" href="#ln-2040"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2041" name="ln-2041" href="#ln-2041"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">gradis</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2042" name="ln-2042" href="#ln-2042"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mf</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2043" name="ln-2043" href="#ln-2043"></a>
<a id="ln-2044" name="ln-2044" href="#ln-2044"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2045" name="ln-2045" href="#ln-2045"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">latitude</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2046" name="ln-2046" href="#ln-2046"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2047" name="ln-2047" href="#ln-2047"></a>
<a id="ln-2048" name="ln-2048" href="#ln-2048"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2049" name="ln-2049" href="#ln-2049"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">lwabv</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2050" name="ln-2050" href="#ln-2050"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2051" name="ln-2051" href="#ln-2051"></a>
<a id="ln-2052" name="ln-2052" href="#ln-2052"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2053" name="ln-2053" href="#ln-2053"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">qcan</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2054" name="ln-2054" href="#ln-2054"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mf</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2055" name="ln-2055" href="#ln-2055"></a>
<a id="ln-2056" name="ln-2056" href="#ln-2056"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2057" name="ln-2057" href="#ln-2057"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">qssabs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2058" name="ln-2058" href="#ln-2058"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2059" name="ln-2059" href="#ln-2059"></a>
<a id="ln-2060" name="ln-2060" href="#ln-2060"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2061" name="ln-2061" href="#ln-2061"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">rhocdf</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2062" name="ln-2062" href="#ln-2062"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2063" name="ln-2063" href="#ln-2063"></a>
<a id="ln-2064" name="ln-2064" href="#ln-2064"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2065" name="ln-2065" href="#ln-2065"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">rniso</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2066" name="ln-2066" href="#ln-2066"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mf</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2067" name="ln-2067" href="#ln-2067"></a>
<a id="ln-2068" name="ln-2068" href="#ln-2068"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2069" name="ln-2069" href="#ln-2069"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">scalex</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2070" name="ln-2070" href="#ln-2070"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mf</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2071" name="ln-2071" href="#ln-2071"></a>
<a id="ln-2072" name="ln-2072" href="#ln-2072"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2073" name="ln-2073" href="#ln-2073"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">transd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2074" name="ln-2074" href="#ln-2074"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2075" name="ln-2075" href="#ln-2075"></a>
<a id="ln-2076" name="ln-2076" href="#ln-2076"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2077" name="ln-2077" href="#ln-2077"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">trad</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2078" name="ln-2078" href="#ln-2078"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2079" name="ln-2079" href="#ln-2079"></a>
<a id="ln-2080" name="ln-2080" href="#ln-2080"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2081" name="ln-2081" href="#ln-2081"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">reffdf</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2082" name="ln-2082" href="#ln-2082"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2083" name="ln-2083" href="#ln-2083"></a>
<a id="ln-2084" name="ln-2084" href="#ln-2084"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2085" name="ln-2085" href="#ln-2085"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">reffbm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2086" name="ln-2086" href="#ln-2086"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2087" name="ln-2087" href="#ln-2087"></a>
<a id="ln-2088" name="ln-2088" href="#ln-2088"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2089" name="ln-2089" href="#ln-2089"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">extkbm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2090" name="ln-2090" href="#ln-2090"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2091" name="ln-2091" href="#ln-2091"></a>
<a id="ln-2092" name="ln-2092" href="#ln-2092"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2093" name="ln-2093" href="#ln-2093"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">extkdm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2094" name="ln-2094" href="#ln-2094"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2095" name="ln-2095" href="#ln-2095"></a>
<a id="ln-2096" name="ln-2096" href="#ln-2096"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2097" name="ln-2097" href="#ln-2097"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">fbeam</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2098" name="ln-2098" href="#ln-2098"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2099" name="ln-2099" href="#ln-2099"></a>
<a id="ln-2100" name="ln-2100" href="#ln-2100"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2101" name="ln-2101" href="#ln-2101"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">cexpkbm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2102" name="ln-2102" href="#ln-2102"></a><span class="w">    </span><span class="c">! Maciej: cexpkbm is mp*swb</span>
<a id="ln-2103" name="ln-2103" href="#ln-2103"></a><span class="w">    </span><span class="c">!    blen(bidx) = nrb * r1len</span>
<a id="ln-2104" name="ln-2104" href="#ln-2104"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">swb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2105" name="ln-2105" href="#ln-2105"></a>
<a id="ln-2106" name="ln-2106" href="#ln-2106"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2107" name="ln-2107" href="#ln-2107"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">cexpkdm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2108" name="ln-2108" href="#ln-2108"></a><span class="w">    </span><span class="c">! Maciej: cexpkdm is mp*swb</span>
<a id="ln-2109" name="ln-2109" href="#ln-2109"></a><span class="w">    </span><span class="c">!    blen(bidx) = nrb * r1len</span>
<a id="ln-2110" name="ln-2110" href="#ln-2110"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">swb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2111" name="ln-2111" href="#ln-2111"></a>
<a id="ln-2112" name="ln-2112" href="#ln-2112"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2113" name="ln-2113" href="#ln-2113"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">rhocbm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2114" name="ln-2114" href="#ln-2114"></a><span class="w">    </span><span class="c">! Maciej: rhocbm is mp*nrb</span>
<a id="ln-2115" name="ln-2115" href="#ln-2115"></a><span class="w">    </span><span class="c">!    blen(bidx) = swb * r1len</span>
<a id="ln-2116" name="ln-2116" href="#ln-2116"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2117" name="ln-2117" href="#ln-2117"></a>
<a id="ln-2118" name="ln-2118" href="#ln-2118"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2119" name="ln-2119" href="#ln-2119"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">transb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2120" name="ln-2120" href="#ln-2120"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2121" name="ln-2121" href="#ln-2121"></a>
<a id="ln-2122" name="ln-2122" href="#ln-2122"></a><span class="w">    </span><span class="c">! ------- sum_flux -----</span>
<a id="ln-2123" name="ln-2123" href="#ln-2123"></a>
<a id="ln-2124" name="ln-2124" href="#ln-2124"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2125" name="ln-2125" href="#ln-2125"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">sumpn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2126" name="ln-2126" href="#ln-2126"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2127" name="ln-2127" href="#ln-2127"></a>
<a id="ln-2128" name="ln-2128" href="#ln-2128"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2129" name="ln-2129" href="#ln-2129"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">sumrp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2130" name="ln-2130" href="#ln-2130"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2131" name="ln-2131" href="#ln-2131"></a>
<a id="ln-2132" name="ln-2132" href="#ln-2132"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2133" name="ln-2133" href="#ln-2133"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">sumrpw</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2134" name="ln-2134" href="#ln-2134"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2135" name="ln-2135" href="#ln-2135"></a>
<a id="ln-2136" name="ln-2136" href="#ln-2136"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2137" name="ln-2137" href="#ln-2137"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">sumrpr</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2138" name="ln-2138" href="#ln-2138"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2139" name="ln-2139" href="#ln-2139"></a>
<a id="ln-2140" name="ln-2140" href="#ln-2140"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2141" name="ln-2141" href="#ln-2141"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">sumrs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2142" name="ln-2142" href="#ln-2142"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2143" name="ln-2143" href="#ln-2143"></a>
<a id="ln-2144" name="ln-2144" href="#ln-2144"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2145" name="ln-2145" href="#ln-2145"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">sumrd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2146" name="ln-2146" href="#ln-2146"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2147" name="ln-2147" href="#ln-2147"></a>
<a id="ln-2148" name="ln-2148" href="#ln-2148"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2149" name="ln-2149" href="#ln-2149"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">dsumpn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2150" name="ln-2150" href="#ln-2150"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2151" name="ln-2151" href="#ln-2151"></a>
<a id="ln-2152" name="ln-2152" href="#ln-2152"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2153" name="ln-2153" href="#ln-2153"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">dsumrp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2154" name="ln-2154" href="#ln-2154"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2155" name="ln-2155" href="#ln-2155"></a>
<a id="ln-2156" name="ln-2156" href="#ln-2156"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2157" name="ln-2157" href="#ln-2157"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">dsumrs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2158" name="ln-2158" href="#ln-2158"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2159" name="ln-2159" href="#ln-2159"></a>
<a id="ln-2160" name="ln-2160" href="#ln-2160"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2161" name="ln-2161" href="#ln-2161"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">dsumrd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2162" name="ln-2162" href="#ln-2162"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2163" name="ln-2163" href="#ln-2163"></a>
<a id="ln-2164" name="ln-2164" href="#ln-2164"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2165" name="ln-2165" href="#ln-2165"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">sumxrp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2166" name="ln-2166" href="#ln-2166"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2167" name="ln-2167" href="#ln-2167"></a>
<a id="ln-2168" name="ln-2168" href="#ln-2168"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2169" name="ln-2169" href="#ln-2169"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">sum_flux</span><span class="p">%</span><span class="n">sumxrs</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2170" name="ln-2170" href="#ln-2170"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2171" name="ln-2171" href="#ln-2171"></a>
<a id="ln-2172" name="ln-2172" href="#ln-2172"></a><span class="w">    </span><span class="c">! ------- bal ----</span>
<a id="ln-2173" name="ln-2173" href="#ln-2173"></a>
<a id="ln-2174" name="ln-2174" href="#ln-2174"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2175" name="ln-2175" href="#ln-2175"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">drybal</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2176" name="ln-2176" href="#ln-2176"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2177" name="ln-2177" href="#ln-2177"></a>
<a id="ln-2178" name="ln-2178" href="#ln-2178"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2179" name="ln-2179" href="#ln-2179"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">ebal</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2180" name="ln-2180" href="#ln-2180"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2181" name="ln-2181" href="#ln-2181"></a>
<a id="ln-2182" name="ln-2182" href="#ln-2182"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2183" name="ln-2183" href="#ln-2183"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">ebal_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2184" name="ln-2184" href="#ln-2184"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2185" name="ln-2185" href="#ln-2185"></a>
<a id="ln-2186" name="ln-2186" href="#ln-2186"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2187" name="ln-2187" href="#ln-2187"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">ebal_cncheck</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2188" name="ln-2188" href="#ln-2188"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2189" name="ln-2189" href="#ln-2189"></a>
<a id="ln-2190" name="ln-2190" href="#ln-2190"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2191" name="ln-2191" href="#ln-2191"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">ebal_tot_cncheck</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2192" name="ln-2192" href="#ln-2192"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2193" name="ln-2193" href="#ln-2193"></a>
<a id="ln-2194" name="ln-2194" href="#ln-2194"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2195" name="ln-2195" href="#ln-2195"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">evap_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2196" name="ln-2196" href="#ln-2196"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2197" name="ln-2197" href="#ln-2197"></a>
<a id="ln-2198" name="ln-2198" href="#ln-2198"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2199" name="ln-2199" href="#ln-2199"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">osnowd0</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2200" name="ln-2200" href="#ln-2200"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2201" name="ln-2201" href="#ln-2201"></a>
<a id="ln-2202" name="ln-2202" href="#ln-2202"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2203" name="ln-2203" href="#ln-2203"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">precip_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2204" name="ln-2204" href="#ln-2204"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2205" name="ln-2205" href="#ln-2205"></a>
<a id="ln-2206" name="ln-2206" href="#ln-2206"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2207" name="ln-2207" href="#ln-2207"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">rnoff_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2208" name="ln-2208" href="#ln-2208"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2209" name="ln-2209" href="#ln-2209"></a>
<a id="ln-2210" name="ln-2210" href="#ln-2210"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2211" name="ln-2211" href="#ln-2211"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">wbal</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2212" name="ln-2212" href="#ln-2212"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2213" name="ln-2213" href="#ln-2213"></a>
<a id="ln-2214" name="ln-2214" href="#ln-2214"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2215" name="ln-2215" href="#ln-2215"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">wbal_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2216" name="ln-2216" href="#ln-2216"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2217" name="ln-2217" href="#ln-2217"></a>
<a id="ln-2218" name="ln-2218" href="#ln-2218"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2219" name="ln-2219" href="#ln-2219"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">wbtot0</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2220" name="ln-2220" href="#ln-2220"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2221" name="ln-2221" href="#ln-2221"></a>
<a id="ln-2222" name="ln-2222" href="#ln-2222"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2223" name="ln-2223" href="#ln-2223"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">wetbal</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2224" name="ln-2224" href="#ln-2224"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2225" name="ln-2225" href="#ln-2225"></a>
<a id="ln-2226" name="ln-2226" href="#ln-2226"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2227" name="ln-2227" href="#ln-2227"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">owbtot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2228" name="ln-2228" href="#ln-2228"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2229" name="ln-2229" href="#ln-2229"></a>
<a id="ln-2230" name="ln-2230" href="#ln-2230"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2231" name="ln-2231" href="#ln-2231"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">evapc_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2232" name="ln-2232" href="#ln-2232"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2233" name="ln-2233" href="#ln-2233"></a>
<a id="ln-2234" name="ln-2234" href="#ln-2234"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2235" name="ln-2235" href="#ln-2235"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">evaps_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2236" name="ln-2236" href="#ln-2236"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2237" name="ln-2237" href="#ln-2237"></a>
<a id="ln-2238" name="ln-2238" href="#ln-2238"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2239" name="ln-2239" href="#ln-2239"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">rnof1_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2240" name="ln-2240" href="#ln-2240"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2241" name="ln-2241" href="#ln-2241"></a>
<a id="ln-2242" name="ln-2242" href="#ln-2242"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2243" name="ln-2243" href="#ln-2243"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">rnof2_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2244" name="ln-2244" href="#ln-2244"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2245" name="ln-2245" href="#ln-2245"></a>
<a id="ln-2246" name="ln-2246" href="#ln-2246"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2247" name="ln-2247" href="#ln-2247"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">snowdc_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2248" name="ln-2248" href="#ln-2248"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2249" name="ln-2249" href="#ln-2249"></a>
<a id="ln-2250" name="ln-2250" href="#ln-2250"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2251" name="ln-2251" href="#ln-2251"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">wbal_tot1</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2252" name="ln-2252" href="#ln-2252"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2253" name="ln-2253" href="#ln-2253"></a>
<a id="ln-2254" name="ln-2254" href="#ln-2254"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2255" name="ln-2255" href="#ln-2255"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">delwc_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2256" name="ln-2256" href="#ln-2256"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2257" name="ln-2257" href="#ln-2257"></a>
<a id="ln-2258" name="ln-2258" href="#ln-2258"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2259" name="ln-2259" href="#ln-2259"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">qasrf_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2260" name="ln-2260" href="#ln-2260"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2261" name="ln-2261" href="#ln-2261"></a>
<a id="ln-2262" name="ln-2262" href="#ln-2262"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2263" name="ln-2263" href="#ln-2263"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">qfsrf_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2264" name="ln-2264" href="#ln-2264"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2265" name="ln-2265" href="#ln-2265"></a>
<a id="ln-2266" name="ln-2266" href="#ln-2266"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2267" name="ln-2267" href="#ln-2267"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">qssrf_tot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2268" name="ln-2268" href="#ln-2268"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2269" name="ln-2269" href="#ln-2269"></a>
<a id="ln-2270" name="ln-2270" href="#ln-2270"></a><span class="w">    </span><span class="c">! additional field missing from previous versions;</span>
<a id="ln-2271" name="ln-2271" href="#ln-2271"></a><span class="w">    </span><span class="c">! added when trying to fix a bug in the new mpi code</span>
<a id="ln-2272" name="ln-2272" href="#ln-2272"></a><span class="w">    </span><span class="c">! the order of these new fields follows the order of their</span>
<a id="ln-2273" name="ln-2273" href="#ln-2273"></a><span class="w">    </span><span class="c">! declaration in cable_define_types.F90</span>
<a id="ln-2274" name="ln-2274" href="#ln-2274"></a>
<a id="ln-2275" name="ln-2275" href="#ln-2275"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2276" name="ln-2276" href="#ln-2276"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">ebaltr</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2277" name="ln-2277" href="#ln-2277"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2278" name="ln-2278" href="#ln-2278"></a>
<a id="ln-2279" name="ln-2279" href="#ln-2279"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2280" name="ln-2280" href="#ln-2280"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">ebal_tottr</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2281" name="ln-2281" href="#ln-2281"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2282" name="ln-2282" href="#ln-2282"></a>
<a id="ln-2283" name="ln-2283" href="#ln-2283"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2284" name="ln-2284" href="#ln-2284"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">cansto0</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2285" name="ln-2285" href="#ln-2285"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2286" name="ln-2286" href="#ln-2286"></a>
<a id="ln-2287" name="ln-2287" href="#ln-2287"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2288" name="ln-2288" href="#ln-2288"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">iantrct</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2289" name="ln-2289" href="#ln-2289"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2290" name="ln-2290" href="#ln-2290"></a>
<a id="ln-2291" name="ln-2291" href="#ln-2291"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2292" name="ln-2292" href="#ln-2292"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tss_p</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2293" name="ln-2293" href="#ln-2293"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2294" name="ln-2294" href="#ln-2294"></a>
<a id="ln-2295" name="ln-2295" href="#ln-2295"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2296" name="ln-2296" href="#ln-2296"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">deltss</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2297" name="ln-2297" href="#ln-2297"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2298" name="ln-2298" href="#ln-2298"></a>
<a id="ln-2299" name="ln-2299" href="#ln-2299"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2300" name="ln-2300" href="#ln-2300"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">owb1</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2301" name="ln-2301" href="#ln-2301"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2302" name="ln-2302" href="#ln-2302"></a>
<a id="ln-2303" name="ln-2303" href="#ln-2303"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2304" name="ln-2304" href="#ln-2304"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wbtot1</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2305" name="ln-2305" href="#ln-2305"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2306" name="ln-2306" href="#ln-2306"></a>
<a id="ln-2307" name="ln-2307" href="#ln-2307"></a><span class="w">    </span><span class="c">!    Maciej: duplicate!</span>
<a id="ln-2308" name="ln-2308" href="#ln-2308"></a><span class="w">    </span><span class="c">!    bidx = bidx + 1</span>
<a id="ln-2309" name="ln-2309" href="#ln-2309"></a><span class="w">    </span><span class="c">!    CALL MPI_Get_address (ssnow%wbtot1, displs(bidx), ierr)</span>
<a id="ln-2310" name="ln-2310" href="#ln-2310"></a><span class="w">    </span><span class="c">!    blen(bidx) = r1len</span>
<a id="ln-2311" name="ln-2311" href="#ln-2311"></a>
<a id="ln-2312" name="ln-2312" href="#ln-2312"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2313" name="ln-2313" href="#ln-2313"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tprecip</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2314" name="ln-2314" href="#ln-2314"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2315" name="ln-2315" href="#ln-2315"></a>
<a id="ln-2316" name="ln-2316" href="#ln-2316"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2317" name="ln-2317" href="#ln-2317"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tevap</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2318" name="ln-2318" href="#ln-2318"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2319" name="ln-2319" href="#ln-2319"></a>
<a id="ln-2320" name="ln-2320" href="#ln-2320"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2321" name="ln-2321" href="#ln-2321"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">trnoff</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2322" name="ln-2322" href="#ln-2322"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2323" name="ln-2323" href="#ln-2323"></a>
<a id="ln-2324" name="ln-2324" href="#ln-2324"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2325" name="ln-2325" href="#ln-2325"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">totenbal</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2326" name="ln-2326" href="#ln-2326"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2327" name="ln-2327" href="#ln-2327"></a>
<a id="ln-2328" name="ln-2328" href="#ln-2328"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2329" name="ln-2329" href="#ln-2329"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">totenbal2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2330" name="ln-2330" href="#ln-2330"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2331" name="ln-2331" href="#ln-2331"></a>
<a id="ln-2332" name="ln-2332" href="#ln-2332"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2333" name="ln-2333" href="#ln-2333"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">fland</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2334" name="ln-2334" href="#ln-2334"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2335" name="ln-2335" href="#ln-2335"></a>
<a id="ln-2336" name="ln-2336" href="#ln-2336"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2337" name="ln-2337" href="#ln-2337"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">ifland</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2338" name="ln-2338" href="#ln-2338"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2339" name="ln-2339" href="#ln-2339"></a>
<a id="ln-2340" name="ln-2340" href="#ln-2340"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2341" name="ln-2341" href="#ln-2341"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tilefrac</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2342" name="ln-2342" href="#ln-2342"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_tiles</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2343" name="ln-2343" href="#ln-2343"></a>
<a id="ln-2344" name="ln-2344" href="#ln-2344"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2345" name="ln-2345" href="#ln-2345"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">qasrf</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2346" name="ln-2346" href="#ln-2346"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2347" name="ln-2347" href="#ln-2347"></a>
<a id="ln-2348" name="ln-2348" href="#ln-2348"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2349" name="ln-2349" href="#ln-2349"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">qfsrf</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2350" name="ln-2350" href="#ln-2350"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2351" name="ln-2351" href="#ln-2351"></a>
<a id="ln-2352" name="ln-2352" href="#ln-2352"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2353" name="ln-2353" href="#ln-2353"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">qssrf</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2354" name="ln-2354" href="#ln-2354"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2355" name="ln-2355" href="#ln-2355"></a>
<a id="ln-2356" name="ln-2356" href="#ln-2356"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2357" name="ln-2357" href="#ln-2357"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">vlaimax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2358" name="ln-2358" href="#ln-2358"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2359" name="ln-2359" href="#ln-2359"></a>
<a id="ln-2360" name="ln-2360" href="#ln-2360"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2361" name="ln-2361" href="#ln-2361"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">albedo_T</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2362" name="ln-2362" href="#ln-2362"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2363" name="ln-2363" href="#ln-2363"></a>
<a id="ln-2364" name="ln-2364" href="#ln-2364"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2365" name="ln-2365" href="#ln-2365"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">longitude</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2366" name="ln-2366" href="#ln-2366"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-2367" name="ln-2367" href="#ln-2367"></a>
<a id="ln-2368" name="ln-2368" href="#ln-2368"></a><span class="w">    </span><span class="c">!mrd add new GW parameters here</span>
<a id="ln-2369" name="ln-2369" href="#ln-2369"></a><span class="w">    </span><span class="c">!2D</span>
<a id="ln-2370" name="ln-2370" href="#ln-2370"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2371" name="ln-2371" href="#ln-2371"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">ssat_vec</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2372" name="ln-2372" href="#ln-2372"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2373" name="ln-2373" href="#ln-2373"></a>
<a id="ln-2374" name="ln-2374" href="#ln-2374"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2375" name="ln-2375" href="#ln-2375"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">sucs_vec</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2376" name="ln-2376" href="#ln-2376"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2377" name="ln-2377" href="#ln-2377"></a>
<a id="ln-2378" name="ln-2378" href="#ln-2378"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2379" name="ln-2379" href="#ln-2379"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">hyds_vec</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2380" name="ln-2380" href="#ln-2380"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2381" name="ln-2381" href="#ln-2381"></a>
<a id="ln-2382" name="ln-2382" href="#ln-2382"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2383" name="ln-2383" href="#ln-2383"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">bch_vec</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2384" name="ln-2384" href="#ln-2384"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2385" name="ln-2385" href="#ln-2385"></a>
<a id="ln-2386" name="ln-2386" href="#ln-2386"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2387" name="ln-2387" href="#ln-2387"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">watr</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2388" name="ln-2388" href="#ln-2388"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2389" name="ln-2389" href="#ln-2389"></a>
<a id="ln-2390" name="ln-2390" href="#ln-2390"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2391" name="ln-2391" href="#ln-2391"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">swilt_vec</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2392" name="ln-2392" href="#ln-2392"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2393" name="ln-2393" href="#ln-2393"></a>
<a id="ln-2394" name="ln-2394" href="#ln-2394"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2395" name="ln-2395" href="#ln-2395"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">sfc_vec</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2396" name="ln-2396" href="#ln-2396"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2397" name="ln-2397" href="#ln-2397"></a>
<a id="ln-2398" name="ln-2398" href="#ln-2398"></a>
<a id="ln-2399" name="ln-2399" href="#ln-2399"></a><span class="w">    </span><span class="c">!1d</span>
<a id="ln-2400" name="ln-2400" href="#ln-2400"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2401" name="ln-2401" href="#ln-2401"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">GWssat_vec</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2402" name="ln-2402" href="#ln-2402"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2403" name="ln-2403" href="#ln-2403"></a>
<a id="ln-2404" name="ln-2404" href="#ln-2404"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2405" name="ln-2405" href="#ln-2405"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">GWsucs_vec</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2406" name="ln-2406" href="#ln-2406"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2407" name="ln-2407" href="#ln-2407"></a>
<a id="ln-2408" name="ln-2408" href="#ln-2408"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2409" name="ln-2409" href="#ln-2409"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">GWhyds_vec</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2410" name="ln-2410" href="#ln-2410"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2411" name="ln-2411" href="#ln-2411"></a>
<a id="ln-2412" name="ln-2412" href="#ln-2412"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2413" name="ln-2413" href="#ln-2413"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">GWbch_vec</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2414" name="ln-2414" href="#ln-2414"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2415" name="ln-2415" href="#ln-2415"></a>
<a id="ln-2416" name="ln-2416" href="#ln-2416"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2417" name="ln-2417" href="#ln-2417"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">GWwatr</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2418" name="ln-2418" href="#ln-2418"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2419" name="ln-2419" href="#ln-2419"></a>
<a id="ln-2420" name="ln-2420" href="#ln-2420"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2421" name="ln-2421" href="#ln-2421"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">GWz</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2422" name="ln-2422" href="#ln-2422"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2423" name="ln-2423" href="#ln-2423"></a>
<a id="ln-2424" name="ln-2424" href="#ln-2424"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2425" name="ln-2425" href="#ln-2425"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">GWdz</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2426" name="ln-2426" href="#ln-2426"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2427" name="ln-2427" href="#ln-2427"></a>
<a id="ln-2428" name="ln-2428" href="#ln-2428"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2429" name="ln-2429" href="#ln-2429"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">slope</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2430" name="ln-2430" href="#ln-2430"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2431" name="ln-2431" href="#ln-2431"></a>
<a id="ln-2432" name="ln-2432" href="#ln-2432"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2433" name="ln-2433" href="#ln-2433"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">slope_std</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2434" name="ln-2434" href="#ln-2434"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2435" name="ln-2435" href="#ln-2435"></a>
<a id="ln-2436" name="ln-2436" href="#ln-2436"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2437" name="ln-2437" href="#ln-2437"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">GWwb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2438" name="ln-2438" href="#ln-2438"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2439" name="ln-2439" href="#ln-2439"></a>
<a id="ln-2440" name="ln-2440" href="#ln-2440"></a><span class="w">    </span><span class="c">! MPI: sanity check</span>
<a id="ln-2441" name="ln-2441" href="#ln-2441"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ntyp</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-2442" name="ln-2442" href="#ln-2442"></a><span class="k">       WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s1">&#39; invalid number of param_t fields&#39;</span><span class="p">,</span><span class="n">bidx</span><span class="p">,</span><span class="s1">&#39;, fix it!&#39;</span><span class="w"></span>
<a id="ln-2443" name="ln-2443" href="#ln-2443"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Abort</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2444" name="ln-2444" href="#ln-2444"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-2445" name="ln-2445" href="#ln-2445"></a>
<a id="ln-2446" name="ln-2446" href="#ln-2446"></a><span class="k">    CALL </span><span class="n">MPI_Type_create_struct</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">blen</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">param_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2447" name="ln-2447" href="#ln-2447"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_commit</span><span class="w"> </span><span class="p">(</span><span class="n">param_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2448" name="ln-2448" href="#ln-2448"></a>
<a id="ln-2449" name="ln-2449" href="#ln-2449"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_size</span><span class="w"> </span><span class="p">(</span><span class="n">param_t</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2450" name="ln-2450" href="#ln-2450"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_get_extent</span><span class="w"> </span><span class="p">(</span><span class="n">param_t</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2451" name="ln-2451" href="#ln-2451"></a>
<a id="ln-2452" name="ln-2452" href="#ln-2452"></a><span class="w">    </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker param_t blocks, size, extent and lb: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">bidx</span><span class="p">,</span><span class="n">tsize</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-2453" name="ln-2453" href="#ln-2453"></a>
<a id="ln-2454" name="ln-2454" href="#ln-2454"></a><span class="w">    </span><span class="c">! MPI: check whether total size of received data equals total</span>
<a id="ln-2455" name="ln-2455" href="#ln-2455"></a><span class="w">    </span><span class="c">! data sent by all the workers</span>
<a id="ln-2456" name="ln-2456" href="#ln-2456"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Reduce</span><span class="w"> </span><span class="p">(</span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DATATYPE_NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2457" name="ln-2457" href="#ln-2457"></a>
<a id="ln-2458" name="ln-2458" href="#ln-2458"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="w"></span>
<a id="ln-2459" name="ln-2459" href="#ln-2459"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">displs</span><span class="p">)</span><span class="w"></span>
<a id="ln-2460" name="ln-2460" href="#ln-2460"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">blen</span><span class="p">)</span><span class="w"></span>
<a id="ln-2461" name="ln-2461" href="#ln-2461"></a>
<a id="ln-2462" name="ln-2462" href="#ln-2462"></a><span class="w">    </span><span class="c">! if anything went wrong the master will mpi_abort</span>
<a id="ln-2463" name="ln-2463" href="#ln-2463"></a><span class="w">    </span><span class="c">! which mpi_recv below is going to catch...</span>
<a id="ln-2464" name="ln-2464" href="#ln-2464"></a>
<a id="ln-2465" name="ln-2465" href="#ln-2465"></a><span class="w">    </span><span class="c">! so, now receive all the parameters</span>
<a id="ln-2466" name="ln-2466" href="#ln-2466"></a><span class="w">    </span><span class="c">!    CALL MPI_Recv (MPI_BOTTOM, 1, param_t, 0, 0, comm, stat, ierr)</span>
<a id="ln-2467" name="ln-2467" href="#ln-2467"></a><span class="w">    </span><span class="c">!   Maciej: buffered recv + unpac version</span>
<a id="ln-2468" name="ln-2468" href="#ln-2468"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">rbuf</span><span class="p">(</span><span class="n">tsize</span><span class="p">))</span><span class="w"></span>
<a id="ln-2469" name="ln-2469" href="#ln-2469"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">rbuf</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2470" name="ln-2470" href="#ln-2470"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_count</span><span class="w"> </span><span class="p">(</span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">param_t</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="p">,</span><span class="w"> </span><span class="n">ierr2</span><span class="p">)</span><span class="w"></span>
<a id="ln-2471" name="ln-2471" href="#ln-2471"></a>
<a id="ln-2472" name="ln-2472" href="#ln-2472"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPI_SUCCESS</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">ierr2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPI_SUCCESS</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">rcount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-2473" name="ln-2473" href="#ln-2473"></a><span class="k">       </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-2474" name="ln-2474" href="#ln-2474"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Unpack</span><span class="w"> </span><span class="p">(</span><span class="n">rbuf</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="p">,</span><span class="w"> </span><span class="n">param_t</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-2475" name="ln-2475" href="#ln-2475"></a><span class="w">            </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2476" name="ln-2476" href="#ln-2476"></a><span class="w">       </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPI_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;cable param unpack error, rank: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">ierr</span><span class="w"></span>
<a id="ln-2477" name="ln-2477" href="#ln-2477"></a><span class="w">    </span><span class="k">ELSE</span>
<a id="ln-2478" name="ln-2478" href="#ln-2478"></a><span class="k">       WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;cable param recv rank err err2 rcount: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">ierr2</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="w"></span>
<a id="ln-2479" name="ln-2479" href="#ln-2479"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-2480" name="ln-2480" href="#ln-2480"></a>
<a id="ln-2481" name="ln-2481" href="#ln-2481"></a><span class="k">    DEALLOCATE</span><span class="p">(</span><span class="n">rbuf</span><span class="p">)</span><span class="w"></span>
<a id="ln-2482" name="ln-2482" href="#ln-2482"></a>
<a id="ln-2483" name="ln-2483" href="#ln-2483"></a>
<a id="ln-2484" name="ln-2484" href="#ln-2484"></a><span class="w">    </span><span class="c">! finally free the MPI type</span>
<a id="ln-2485" name="ln-2485" href="#ln-2485"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_Free</span><span class="w"> </span><span class="p">(</span><span class="n">param_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2486" name="ln-2486" href="#ln-2486"></a>
<a id="ln-2487" name="ln-2487" href="#ln-2487"></a>
<a id="ln-2488" name="ln-2488" href="#ln-2488"></a><span class="w">    </span><span class="c">! all CABLE parameters have been received from the master by now</span>
<a id="ln-2489" name="ln-2489" href="#ln-2489"></a><span class="w">    </span><span class="k">RETURN</span>
<a id="ln-2490" name="ln-2490" href="#ln-2490"></a>
<a id="ln-2491" name="ln-2491" href="#ln-2491"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_cable_params</span><span class="w"></span>
<a id="ln-2492" name="ln-2492" href="#ln-2492"></a>
<a id="ln-2493" name="ln-2493" href="#ln-2493"></a>
<a id="ln-2494" name="ln-2494" href="#ln-2494"></a><span class="w">  </span><span class="c">! MPI: creates param_t type for the worker to receive the default casa</span>
<a id="ln-2495" name="ln-2495" href="#ln-2495"></a><span class="w">  </span><span class="c">! parameters from the master process</span>
<a id="ln-2496" name="ln-2496" href="#ln-2496"></a><span class="w">  </span><span class="c">! then receives them</span>
<a id="ln-2497" name="ln-2497" href="#ln-2497"></a><span class="w">  </span><span class="c">! and finally frees the MPI type</span>
<a id="ln-2498" name="ln-2498" href="#ln-2498"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_casa_params</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="n">casamet</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-2499" name="ln-2499" href="#ln-2499"></a><span class="w">       </span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">)</span><span class="w"></span>
<a id="ln-2500" name="ln-2500" href="#ln-2500"></a>
<a id="ln-2501" name="ln-2501" href="#ln-2501"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-2502" name="ln-2502" href="#ln-2502"></a>
<a id="ln-2503" name="ln-2503" href="#ln-2503"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-2504" name="ln-2504" href="#ln-2504"></a>
<a id="ln-2505" name="ln-2505" href="#ln-2505"></a><span class="w">    </span><span class="k">USE </span><span class="n">casavariable</span><span class="w"></span>
<a id="ln-2506" name="ln-2506" href="#ln-2506"></a><span class="w">    </span><span class="k">USE </span><span class="n">phenvariable</span><span class="w"></span>
<a id="ln-2507" name="ln-2507" href="#ln-2507"></a>
<a id="ln-2508" name="ln-2508" href="#ln-2508"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<a id="ln-2509" name="ln-2509" href="#ln-2509"></a>
<a id="ln-2510" name="ln-2510" href="#ln-2510"></a><span class="w">    </span><span class="c">! sub arguments</span>
<a id="ln-2511" name="ln-2511" href="#ln-2511"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w">  </span><span class="c">! MPI communicator</span>
<a id="ln-2512" name="ln-2512" href="#ln-2512"></a>
<a id="ln-2513" name="ln-2513" href="#ln-2513"></a><span class="w">    </span><span class="c">! TODO: have these variables been already allocated?</span>
<a id="ln-2514" name="ln-2514" href="#ln-2514"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_biome</span><span class="p">)</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casabiome</span><span class="w"></span>
<a id="ln-2515" name="ln-2515" href="#ln-2515"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_pool</span><span class="p">)</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casapool</span><span class="w"></span>
<a id="ln-2516" name="ln-2516" href="#ln-2516"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_flux</span><span class="p">)</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casaflux</span><span class="w"></span>
<a id="ln-2517" name="ln-2517" href="#ln-2517"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_met</span><span class="p">)</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casamet</span><span class="w"></span>
<a id="ln-2518" name="ln-2518" href="#ln-2518"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_balance</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casabal</span><span class="w"></span>
<a id="ln-2519" name="ln-2519" href="#ln-2519"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">phen_variable</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">phen</span><span class="w"></span>
<a id="ln-2520" name="ln-2520" href="#ln-2520"></a>
<a id="ln-2521" name="ln-2521" href="#ln-2521"></a><span class="w">    </span><span class="c">! local vars</span>
<a id="ln-2522" name="ln-2522" href="#ln-2522"></a>
<a id="ln-2523" name="ln-2523" href="#ln-2523"></a><span class="w">    </span><span class="c">! temp arrays for marshalling all fields into a single struct</span>
<a id="ln-2524" name="ln-2524" href="#ln-2524"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blen</span><span class="w"></span>
<a id="ln-2525" name="ln-2525" href="#ln-2525"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">displs</span><span class="w"></span>
<a id="ln-2526" name="ln-2526" href="#ln-2526"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<a id="ln-2527" name="ln-2527" href="#ln-2527"></a>
<a id="ln-2528" name="ln-2528" href="#ln-2528"></a><span class="w">    </span><span class="c">! temp vars for verifying block number and total length of inp_t</span>
<a id="ln-2529" name="ln-2529" href="#ln-2529"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-2530" name="ln-2530" href="#ln-2530"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tsize</span><span class="w"></span>
<a id="ln-2531" name="ln-2531" href="#ln-2531"></a>
<a id="ln-2532" name="ln-2532" href="#ln-2532"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">stat</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-2533" name="ln-2533" href="#ln-2533"></a><span class="w">    </span><span class="c">! INTEGER :: landp_t, patch_t, param_t</span>
<a id="ln-2534" name="ln-2534" href="#ln-2534"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casa_t</span><span class="w"></span>
<a id="ln-2535" name="ln-2535" href="#ln-2535"></a>
<a id="ln-2536" name="ln-2536" href="#ln-2536"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r1len</span><span class="p">,</span><span class="w"> </span><span class="n">r2len</span><span class="p">,</span><span class="w"> </span><span class="n">I1LEN</span><span class="p">,</span><span class="w"> </span><span class="n">llen</span><span class="w"> </span><span class="c">! block lengths</span>
<a id="ln-2537" name="ln-2537" href="#ln-2537"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="c">! block index</span>
<a id="ln-2538" name="ln-2538" href="#ln-2538"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntyp</span><span class="w"> </span><span class="c">! total number of blocks</span>
<a id="ln-2539" name="ln-2539" href="#ln-2539"></a>
<a id="ln-2540" name="ln-2540" href="#ln-2540"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">ierr2</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<a id="ln-2541" name="ln-2541" href="#ln-2541"></a>
<a id="ln-2542" name="ln-2542" href="#ln-2542"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rbuf</span><span class="w"></span>
<a id="ln-2543" name="ln-2543" href="#ln-2543"></a>
<a id="ln-2544" name="ln-2544" href="#ln-2544"></a><span class="w">    </span><span class="n">off</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2545" name="ln-2545" href="#ln-2545"></a>
<a id="ln-2546" name="ln-2546" href="#ln-2546"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Comm_rank</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2547" name="ln-2547" href="#ln-2547"></a>
<a id="ln-2548" name="ln-2548" href="#ln-2548"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="nb">ASSOCIATED</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ivt2</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-2549" name="ln-2549" href="#ln-2549"></a><span class="k">       WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker alloc casa and phen var with m patches: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">mp</span><span class="w"></span>
<a id="ln-2550" name="ln-2550" href="#ln-2550"></a><span class="w">       </span><span class="k">CALL </span><span class="n">alloc_casavariable</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-2551" name="ln-2551" href="#ln-2551"></a><span class="w">            </span><span class="p">&amp;</span><span class="w">      </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">)</span><span class="w"></span>
<a id="ln-2552" name="ln-2552" href="#ln-2552"></a><span class="w">       </span><span class="k">CALL </span><span class="n">alloc_phenvariable</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">)</span><span class="w"></span>
<a id="ln-2553" name="ln-2553" href="#ln-2553"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-2554" name="ln-2554" href="#ln-2554"></a>
<a id="ln-2555" name="ln-2555" href="#ln-2555"></a><span class="k">    </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncasaparam</span><span class="w"></span>
<a id="ln-2556" name="ln-2556" href="#ln-2556"></a>
<a id="ln-2557" name="ln-2557" href="#ln-2557"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">blen</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-2558" name="ln-2558" href="#ln-2558"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">displs</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-2559" name="ln-2559" href="#ln-2559"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-2560" name="ln-2560" href="#ln-2560"></a>
<a id="ln-2561" name="ln-2561" href="#ln-2561"></a><span class="w">    </span><span class="c">! default type is byte, to be overriden for multi-D types</span>
<a id="ln-2562" name="ln-2562" href="#ln-2562"></a><span class="w">    </span><span class="n">types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-2563" name="ln-2563" href="#ln-2563"></a>
<a id="ln-2564" name="ln-2564" href="#ln-2564"></a><span class="w">    </span><span class="n">r1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-2565" name="ln-2565" href="#ln-2565"></a><span class="w">    </span><span class="n">r2len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2566" name="ln-2566" href="#ln-2566"></a><span class="w">    </span><span class="n">I1LEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-2567" name="ln-2567" href="#ln-2567"></a><span class="w">    </span><span class="n">llen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extl</span><span class="w"></span>
<a id="ln-2568" name="ln-2568" href="#ln-2568"></a>
<a id="ln-2569" name="ln-2569" href="#ln-2569"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-2570" name="ln-2570" href="#ln-2570"></a>
<a id="ln-2571" name="ln-2571" href="#ln-2571"></a><span class="w">    </span><span class="c">! ------- casabiome -----</span>
<a id="ln-2572" name="ln-2572" href="#ln-2572"></a>
<a id="ln-2573" name="ln-2573" href="#ln-2573"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2574" name="ln-2574" href="#ln-2574"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ivt2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2575" name="ln-2575" href="#ln-2575"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-2576" name="ln-2576" href="#ln-2576"></a>
<a id="ln-2577" name="ln-2577" href="#ln-2577"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2578" name="ln-2578" href="#ln-2578"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">xkleafcoldmax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2579" name="ln-2579" href="#ln-2579"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2580" name="ln-2580" href="#ln-2580"></a>
<a id="ln-2581" name="ln-2581" href="#ln-2581"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2582" name="ln-2582" href="#ln-2582"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">xkleafcoldexp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2583" name="ln-2583" href="#ln-2583"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2584" name="ln-2584" href="#ln-2584"></a>
<a id="ln-2585" name="ln-2585" href="#ln-2585"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2586" name="ln-2586" href="#ln-2586"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">xkleafdrymax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2587" name="ln-2587" href="#ln-2587"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2588" name="ln-2588" href="#ln-2588"></a>
<a id="ln-2589" name="ln-2589" href="#ln-2589"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2590" name="ln-2590" href="#ln-2590"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">xkleafdryexp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2591" name="ln-2591" href="#ln-2591"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2592" name="ln-2592" href="#ln-2592"></a>
<a id="ln-2593" name="ln-2593" href="#ln-2593"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2594" name="ln-2594" href="#ln-2594"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">glaimax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2595" name="ln-2595" href="#ln-2595"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2596" name="ln-2596" href="#ln-2596"></a>
<a id="ln-2597" name="ln-2597" href="#ln-2597"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2598" name="ln-2598" href="#ln-2598"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">glaimin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2599" name="ln-2599" href="#ln-2599"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2600" name="ln-2600" href="#ln-2600"></a>
<a id="ln-2601" name="ln-2601" href="#ln-2601"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2602" name="ln-2602" href="#ln-2602"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">sla</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2603" name="ln-2603" href="#ln-2603"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2604" name="ln-2604" href="#ln-2604"></a>
<a id="ln-2605" name="ln-2605" href="#ln-2605"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2606" name="ln-2606" href="#ln-2606"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratiofrootleaf</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2607" name="ln-2607" href="#ln-2607"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2608" name="ln-2608" href="#ln-2608"></a>
<a id="ln-2609" name="ln-2609" href="#ln-2609"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2610" name="ln-2610" href="#ln-2610"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">kroot</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2611" name="ln-2611" href="#ln-2611"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2612" name="ln-2612" href="#ln-2612"></a>
<a id="ln-2613" name="ln-2613" href="#ln-2613"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2614" name="ln-2614" href="#ln-2614"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">krootlen</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2615" name="ln-2615" href="#ln-2615"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2616" name="ln-2616" href="#ln-2616"></a>
<a id="ln-2617" name="ln-2617" href="#ln-2617"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2618" name="ln-2618" href="#ln-2618"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">rootdepth</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2619" name="ln-2619" href="#ln-2619"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2620" name="ln-2620" href="#ln-2620"></a>
<a id="ln-2621" name="ln-2621" href="#ln-2621"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2622" name="ln-2622" href="#ln-2622"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">kuptake</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2623" name="ln-2623" href="#ln-2623"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2624" name="ln-2624" href="#ln-2624"></a>
<a id="ln-2625" name="ln-2625" href="#ln-2625"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2626" name="ln-2626" href="#ln-2626"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">kminN</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2627" name="ln-2627" href="#ln-2627"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2628" name="ln-2628" href="#ln-2628"></a>
<a id="ln-2629" name="ln-2629" href="#ln-2629"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2630" name="ln-2630" href="#ln-2630"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">KuplabP</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2631" name="ln-2631" href="#ln-2631"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2632" name="ln-2632" href="#ln-2632"></a>
<a id="ln-2633" name="ln-2633" href="#ln-2633"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2634" name="ln-2634" href="#ln-2634"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">kclabrate</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2635" name="ln-2635" href="#ln-2635"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2636" name="ln-2636" href="#ln-2636"></a>
<a id="ln-2637" name="ln-2637" href="#ln-2637"></a><span class="w">    </span><span class="c">!===================================================================</span>
<a id="ln-2638" name="ln-2638" href="#ln-2638"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2639" name="ln-2639" href="#ln-2639"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">xnpmax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2640" name="ln-2640" href="#ln-2640"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2641" name="ln-2641" href="#ln-2641"></a>
<a id="ln-2642" name="ln-2642" href="#ln-2642"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2643" name="ln-2643" href="#ln-2643"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">q10soil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2644" name="ln-2644" href="#ln-2644"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2645" name="ln-2645" href="#ln-2645"></a>
<a id="ln-2646" name="ln-2646" href="#ln-2646"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2647" name="ln-2647" href="#ln-2647"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">xkoptlitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2648" name="ln-2648" href="#ln-2648"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2649" name="ln-2649" href="#ln-2649"></a>
<a id="ln-2650" name="ln-2650" href="#ln-2650"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2651" name="ln-2651" href="#ln-2651"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">xkoptsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2652" name="ln-2652" href="#ln-2652"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2653" name="ln-2653" href="#ln-2653"></a>
<a id="ln-2654" name="ln-2654" href="#ln-2654"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2655" name="ln-2655" href="#ln-2655"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">maxfinelitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2656" name="ln-2656" href="#ln-2656"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2657" name="ln-2657" href="#ln-2657"></a>
<a id="ln-2658" name="ln-2658" href="#ln-2658"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2659" name="ln-2659" href="#ln-2659"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">maxcwd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2660" name="ln-2660" href="#ln-2660"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2661" name="ln-2661" href="#ln-2661"></a>
<a id="ln-2662" name="ln-2662" href="#ln-2662"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2663" name="ln-2663" href="#ln-2663"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">prodptase</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2664" name="ln-2664" href="#ln-2664"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2665" name="ln-2665" href="#ln-2665"></a>
<a id="ln-2666" name="ln-2666" href="#ln-2666"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2667" name="ln-2667" href="#ln-2667"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">costnpup</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2668" name="ln-2668" href="#ln-2668"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2669" name="ln-2669" href="#ln-2669"></a>
<a id="ln-2670" name="ln-2670" href="#ln-2670"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2671" name="ln-2671" href="#ln-2671"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">xkplab</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2672" name="ln-2672" href="#ln-2672"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mso</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2673" name="ln-2673" href="#ln-2673"></a>
<a id="ln-2674" name="ln-2674" href="#ln-2674"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2675" name="ln-2675" href="#ln-2675"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">xkpsorb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2676" name="ln-2676" href="#ln-2676"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mso</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2677" name="ln-2677" href="#ln-2677"></a>
<a id="ln-2678" name="ln-2678" href="#ln-2678"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2679" name="ln-2679" href="#ln-2679"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">xkpocc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2680" name="ln-2680" href="#ln-2680"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mso</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2681" name="ln-2681" href="#ln-2681"></a>
<a id="ln-2682" name="ln-2682" href="#ln-2682"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2683" name="ln-2683" href="#ln-2683"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">nintercept</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2684" name="ln-2684" href="#ln-2684"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2685" name="ln-2685" href="#ln-2685"></a>
<a id="ln-2686" name="ln-2686" href="#ln-2686"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2687" name="ln-2687" href="#ln-2687"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">nslope</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2688" name="ln-2688" href="#ln-2688"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2689" name="ln-2689" href="#ln-2689"></a>
<a id="ln-2690" name="ln-2690" href="#ln-2690"></a><span class="w">    </span><span class="c">!===================================================================</span>
<a id="ln-2691" name="ln-2691" href="#ln-2691"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2692" name="ln-2692" href="#ln-2692"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">plantrate</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2693" name="ln-2693" href="#ln-2693"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2694" name="ln-2694" href="#ln-2694"></a>
<a id="ln-2695" name="ln-2695" href="#ln-2695"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2696" name="ln-2696" href="#ln-2696"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">rmplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2697" name="ln-2697" href="#ln-2697"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2698" name="ln-2698" href="#ln-2698"></a>
<a id="ln-2699" name="ln-2699" href="#ln-2699"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2700" name="ln-2700" href="#ln-2700"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">fracnpptoP</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2701" name="ln-2701" href="#ln-2701"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2702" name="ln-2702" href="#ln-2702"></a>
<a id="ln-2703" name="ln-2703" href="#ln-2703"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2704" name="ln-2704" href="#ln-2704"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">fraclignin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2705" name="ln-2705" href="#ln-2705"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2706" name="ln-2706" href="#ln-2706"></a>
<a id="ln-2707" name="ln-2707" href="#ln-2707"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2708" name="ln-2708" href="#ln-2708"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">fraclabile</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2709" name="ln-2709" href="#ln-2709"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2710" name="ln-2710" href="#ln-2710"></a>
<a id="ln-2711" name="ln-2711" href="#ln-2711"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2712" name="ln-2712" href="#ln-2712"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioNCplantmin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2713" name="ln-2713" href="#ln-2713"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2714" name="ln-2714" href="#ln-2714"></a>
<a id="ln-2715" name="ln-2715" href="#ln-2715"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2716" name="ln-2716" href="#ln-2716"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioNCplantmax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2717" name="ln-2717" href="#ln-2717"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2718" name="ln-2718" href="#ln-2718"></a>
<a id="ln-2719" name="ln-2719" href="#ln-2719"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2720" name="ln-2720" href="#ln-2720"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioPCplantmin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2721" name="ln-2721" href="#ln-2721"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2722" name="ln-2722" href="#ln-2722"></a>
<a id="ln-2723" name="ln-2723" href="#ln-2723"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2724" name="ln-2724" href="#ln-2724"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioPCplantmax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2725" name="ln-2725" href="#ln-2725"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2726" name="ln-2726" href="#ln-2726"></a>
<a id="ln-2727" name="ln-2727" href="#ln-2727"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2728" name="ln-2728" href="#ln-2728"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">fracLigninplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2729" name="ln-2729" href="#ln-2729"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2730" name="ln-2730" href="#ln-2730"></a>
<a id="ln-2731" name="ln-2731" href="#ln-2731"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2732" name="ln-2732" href="#ln-2732"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ftransNPtoL</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2733" name="ln-2733" href="#ln-2733"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2734" name="ln-2734" href="#ln-2734"></a>
<a id="ln-2735" name="ln-2735" href="#ln-2735"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2736" name="ln-2736" href="#ln-2736"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ftransPPtoL</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2737" name="ln-2737" href="#ln-2737"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2738" name="ln-2738" href="#ln-2738"></a>
<a id="ln-2739" name="ln-2739" href="#ln-2739"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2740" name="ln-2740" href="#ln-2740"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">litterrate</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2741" name="ln-2741" href="#ln-2741"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2742" name="ln-2742" href="#ln-2742"></a>
<a id="ln-2743" name="ln-2743" href="#ln-2743"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2744" name="ln-2744" href="#ln-2744"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">soilrate</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2745" name="ln-2745" href="#ln-2745"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2746" name="ln-2746" href="#ln-2746"></a>
<a id="ln-2747" name="ln-2747" href="#ln-2747"></a><span class="w">    </span><span class="c">! added by ln</span>
<a id="ln-2748" name="ln-2748" href="#ln-2748"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2749" name="ln-2749" href="#ln-2749"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioNPplantmin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2750" name="ln-2750" href="#ln-2750"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2751" name="ln-2751" href="#ln-2751"></a>
<a id="ln-2752" name="ln-2752" href="#ln-2752"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2753" name="ln-2753" href="#ln-2753"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabiome</span><span class="p">%</span><span class="n">ratioNPplantmax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2754" name="ln-2754" href="#ln-2754"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-2755" name="ln-2755" href="#ln-2755"></a>
<a id="ln-2756" name="ln-2756" href="#ln-2756"></a><span class="w">    </span><span class="c">! ------ casapool ----</span>
<a id="ln-2757" name="ln-2757" href="#ln-2757"></a>
<a id="ln-2758" name="ln-2758" href="#ln-2758"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2759" name="ln-2759" href="#ln-2759"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Clabile</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2760" name="ln-2760" href="#ln-2760"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2761" name="ln-2761" href="#ln-2761"></a>
<a id="ln-2762" name="ln-2762" href="#ln-2762"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2763" name="ln-2763" href="#ln-2763"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dClabiledt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2764" name="ln-2764" href="#ln-2764"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2765" name="ln-2765" href="#ln-2765"></a>
<a id="ln-2766" name="ln-2766" href="#ln-2766"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2767" name="ln-2767" href="#ln-2767"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Cplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2768" name="ln-2768" href="#ln-2768"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2769" name="ln-2769" href="#ln-2769"></a>
<a id="ln-2770" name="ln-2770" href="#ln-2770"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2771" name="ln-2771" href="#ln-2771"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Nplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2772" name="ln-2772" href="#ln-2772"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2773" name="ln-2773" href="#ln-2773"></a>
<a id="ln-2774" name="ln-2774" href="#ln-2774"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2775" name="ln-2775" href="#ln-2775"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Pplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2776" name="ln-2776" href="#ln-2776"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2777" name="ln-2777" href="#ln-2777"></a>
<a id="ln-2778" name="ln-2778" href="#ln-2778"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2779" name="ln-2779" href="#ln-2779"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dCplantdt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2780" name="ln-2780" href="#ln-2780"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2781" name="ln-2781" href="#ln-2781"></a>
<a id="ln-2782" name="ln-2782" href="#ln-2782"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2783" name="ln-2783" href="#ln-2783"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dNplantdt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2784" name="ln-2784" href="#ln-2784"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2785" name="ln-2785" href="#ln-2785"></a>
<a id="ln-2786" name="ln-2786" href="#ln-2786"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2787" name="ln-2787" href="#ln-2787"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dPplantdt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2788" name="ln-2788" href="#ln-2788"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2789" name="ln-2789" href="#ln-2789"></a>
<a id="ln-2790" name="ln-2790" href="#ln-2790"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2791" name="ln-2791" href="#ln-2791"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNCplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2792" name="ln-2792" href="#ln-2792"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2793" name="ln-2793" href="#ln-2793"></a>
<a id="ln-2794" name="ln-2794" href="#ln-2794"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2795" name="ln-2795" href="#ln-2795"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioPCplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2796" name="ln-2796" href="#ln-2796"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2797" name="ln-2797" href="#ln-2797"></a>
<a id="ln-2798" name="ln-2798" href="#ln-2798"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2799" name="ln-2799" href="#ln-2799"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Nsoilmin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2800" name="ln-2800" href="#ln-2800"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2801" name="ln-2801" href="#ln-2801"></a>
<a id="ln-2802" name="ln-2802" href="#ln-2802"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2803" name="ln-2803" href="#ln-2803"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Psoillab</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2804" name="ln-2804" href="#ln-2804"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2805" name="ln-2805" href="#ln-2805"></a>
<a id="ln-2806" name="ln-2806" href="#ln-2806"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2807" name="ln-2807" href="#ln-2807"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Psoilsorb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2808" name="ln-2808" href="#ln-2808"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2809" name="ln-2809" href="#ln-2809"></a>
<a id="ln-2810" name="ln-2810" href="#ln-2810"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2811" name="ln-2811" href="#ln-2811"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Psoilocc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2812" name="ln-2812" href="#ln-2812"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2813" name="ln-2813" href="#ln-2813"></a>
<a id="ln-2814" name="ln-2814" href="#ln-2814"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2815" name="ln-2815" href="#ln-2815"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dNsoilmindt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2816" name="ln-2816" href="#ln-2816"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2817" name="ln-2817" href="#ln-2817"></a>
<a id="ln-2818" name="ln-2818" href="#ln-2818"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2819" name="ln-2819" href="#ln-2819"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dPsoillabdt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2820" name="ln-2820" href="#ln-2820"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2821" name="ln-2821" href="#ln-2821"></a>
<a id="ln-2822" name="ln-2822" href="#ln-2822"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2823" name="ln-2823" href="#ln-2823"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dPsoilsorbdt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2824" name="ln-2824" href="#ln-2824"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2825" name="ln-2825" href="#ln-2825"></a>
<a id="ln-2826" name="ln-2826" href="#ln-2826"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2827" name="ln-2827" href="#ln-2827"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dPsoiloccdt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2828" name="ln-2828" href="#ln-2828"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2829" name="ln-2829" href="#ln-2829"></a>
<a id="ln-2830" name="ln-2830" href="#ln-2830"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2831" name="ln-2831" href="#ln-2831"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Clitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2832" name="ln-2832" href="#ln-2832"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2833" name="ln-2833" href="#ln-2833"></a>
<a id="ln-2834" name="ln-2834" href="#ln-2834"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2835" name="ln-2835" href="#ln-2835"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Nlitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2836" name="ln-2836" href="#ln-2836"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2837" name="ln-2837" href="#ln-2837"></a>
<a id="ln-2838" name="ln-2838" href="#ln-2838"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2839" name="ln-2839" href="#ln-2839"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Plitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2840" name="ln-2840" href="#ln-2840"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2841" name="ln-2841" href="#ln-2841"></a>
<a id="ln-2842" name="ln-2842" href="#ln-2842"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2843" name="ln-2843" href="#ln-2843"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dClitterdt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2844" name="ln-2844" href="#ln-2844"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2845" name="ln-2845" href="#ln-2845"></a>
<a id="ln-2846" name="ln-2846" href="#ln-2846"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2847" name="ln-2847" href="#ln-2847"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dNlitterdt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2848" name="ln-2848" href="#ln-2848"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2849" name="ln-2849" href="#ln-2849"></a>
<a id="ln-2850" name="ln-2850" href="#ln-2850"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2851" name="ln-2851" href="#ln-2851"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dPlitterdt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2852" name="ln-2852" href="#ln-2852"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2853" name="ln-2853" href="#ln-2853"></a>
<a id="ln-2854" name="ln-2854" href="#ln-2854"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2855" name="ln-2855" href="#ln-2855"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNClitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2856" name="ln-2856" href="#ln-2856"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2857" name="ln-2857" href="#ln-2857"></a>
<a id="ln-2858" name="ln-2858" href="#ln-2858"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2859" name="ln-2859" href="#ln-2859"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioPClitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2860" name="ln-2860" href="#ln-2860"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2861" name="ln-2861" href="#ln-2861"></a>
<a id="ln-2862" name="ln-2862" href="#ln-2862"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2863" name="ln-2863" href="#ln-2863"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Csoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2864" name="ln-2864" href="#ln-2864"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2865" name="ln-2865" href="#ln-2865"></a>
<a id="ln-2866" name="ln-2866" href="#ln-2866"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2867" name="ln-2867" href="#ln-2867"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Nsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2868" name="ln-2868" href="#ln-2868"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2869" name="ln-2869" href="#ln-2869"></a>
<a id="ln-2870" name="ln-2870" href="#ln-2870"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2871" name="ln-2871" href="#ln-2871"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Psoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2872" name="ln-2872" href="#ln-2872"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2873" name="ln-2873" href="#ln-2873"></a>
<a id="ln-2874" name="ln-2874" href="#ln-2874"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2875" name="ln-2875" href="#ln-2875"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dCsoildt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2876" name="ln-2876" href="#ln-2876"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2877" name="ln-2877" href="#ln-2877"></a>
<a id="ln-2878" name="ln-2878" href="#ln-2878"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2879" name="ln-2879" href="#ln-2879"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dNsoildt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2880" name="ln-2880" href="#ln-2880"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2881" name="ln-2881" href="#ln-2881"></a>
<a id="ln-2882" name="ln-2882" href="#ln-2882"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2883" name="ln-2883" href="#ln-2883"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">dPsoildt</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2884" name="ln-2884" href="#ln-2884"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2885" name="ln-2885" href="#ln-2885"></a>
<a id="ln-2886" name="ln-2886" href="#ln-2886"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2887" name="ln-2887" href="#ln-2887"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNCsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2888" name="ln-2888" href="#ln-2888"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2889" name="ln-2889" href="#ln-2889"></a>
<a id="ln-2890" name="ln-2890" href="#ln-2890"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2891" name="ln-2891" href="#ln-2891"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioPCsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2892" name="ln-2892" href="#ln-2892"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2893" name="ln-2893" href="#ln-2893"></a>
<a id="ln-2894" name="ln-2894" href="#ln-2894"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2895" name="ln-2895" href="#ln-2895"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNCsoilnew</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2896" name="ln-2896" href="#ln-2896"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2897" name="ln-2897" href="#ln-2897"></a>
<a id="ln-2898" name="ln-2898" href="#ln-2898"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2899" name="ln-2899" href="#ln-2899"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNCsoilmin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2900" name="ln-2900" href="#ln-2900"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2901" name="ln-2901" href="#ln-2901"></a>
<a id="ln-2902" name="ln-2902" href="#ln-2902"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2903" name="ln-2903" href="#ln-2903"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNCsoilmax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2904" name="ln-2904" href="#ln-2904"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2905" name="ln-2905" href="#ln-2905"></a>
<a id="ln-2906" name="ln-2906" href="#ln-2906"></a><span class="w">    </span><span class="c">! added by LN</span>
<a id="ln-2907" name="ln-2907" href="#ln-2907"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2908" name="ln-2908" href="#ln-2908"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNPplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2909" name="ln-2909" href="#ln-2909"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2910" name="ln-2910" href="#ln-2910"></a>
<a id="ln-2911" name="ln-2911" href="#ln-2911"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2912" name="ln-2912" href="#ln-2912"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNPlitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2913" name="ln-2913" href="#ln-2913"></a><span class="w">    </span><span class="c">!    blen(bidx) = mplant * r2len</span>
<a id="ln-2914" name="ln-2914" href="#ln-2914"></a><span class="w">    </span><span class="c">! Maciej</span>
<a id="ln-2915" name="ln-2915" href="#ln-2915"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2916" name="ln-2916" href="#ln-2916"></a>
<a id="ln-2917" name="ln-2917" href="#ln-2917"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2918" name="ln-2918" href="#ln-2918"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNPsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2919" name="ln-2919" href="#ln-2919"></a><span class="w">    </span><span class="c">!    blen(bidx) = mplant * r2len</span>
<a id="ln-2920" name="ln-2920" href="#ln-2920"></a><span class="w">    </span><span class="c">! Maciej</span>
<a id="ln-2921" name="ln-2921" href="#ln-2921"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2922" name="ln-2922" href="#ln-2922"></a>
<a id="ln-2923" name="ln-2923" href="#ln-2923"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2924" name="ln-2924" href="#ln-2924"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">cwoodprod</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2925" name="ln-2925" href="#ln-2925"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mwood</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2926" name="ln-2926" href="#ln-2926"></a>
<a id="ln-2927" name="ln-2927" href="#ln-2927"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2928" name="ln-2928" href="#ln-2928"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">nwoodprod</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2929" name="ln-2929" href="#ln-2929"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mwood</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2930" name="ln-2930" href="#ln-2930"></a>
<a id="ln-2931" name="ln-2931" href="#ln-2931"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2932" name="ln-2932" href="#ln-2932"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">pwoodprod</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2933" name="ln-2933" href="#ln-2933"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mwood</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2934" name="ln-2934" href="#ln-2934"></a>
<a id="ln-2935" name="ln-2935" href="#ln-2935"></a><span class="w">    </span><span class="c">! ------- casaflux ----</span>
<a id="ln-2936" name="ln-2936" href="#ln-2936"></a>
<a id="ln-2937" name="ln-2937" href="#ln-2937"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2938" name="ln-2938" href="#ln-2938"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cgpp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2939" name="ln-2939" href="#ln-2939"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2940" name="ln-2940" href="#ln-2940"></a>
<a id="ln-2941" name="ln-2941" href="#ln-2941"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2942" name="ln-2942" href="#ln-2942"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cnpp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2943" name="ln-2943" href="#ln-2943"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2944" name="ln-2944" href="#ln-2944"></a>
<a id="ln-2945" name="ln-2945" href="#ln-2945"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2946" name="ln-2946" href="#ln-2946"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Crp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2947" name="ln-2947" href="#ln-2947"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2948" name="ln-2948" href="#ln-2948"></a>
<a id="ln-2949" name="ln-2949" href="#ln-2949"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2950" name="ln-2950" href="#ln-2950"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Crgplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2951" name="ln-2951" href="#ln-2951"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2952" name="ln-2952" href="#ln-2952"></a>
<a id="ln-2953" name="ln-2953" href="#ln-2953"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2954" name="ln-2954" href="#ln-2954"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nminfix</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2955" name="ln-2955" href="#ln-2955"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2956" name="ln-2956" href="#ln-2956"></a>
<a id="ln-2957" name="ln-2957" href="#ln-2957"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2958" name="ln-2958" href="#ln-2958"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nminuptake</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2959" name="ln-2959" href="#ln-2959"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2960" name="ln-2960" href="#ln-2960"></a>
<a id="ln-2961" name="ln-2961" href="#ln-2961"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2962" name="ln-2962" href="#ln-2962"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Plabuptake</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2963" name="ln-2963" href="#ln-2963"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2964" name="ln-2964" href="#ln-2964"></a>
<a id="ln-2965" name="ln-2965" href="#ln-2965"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2966" name="ln-2966" href="#ln-2966"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Clabloss</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2967" name="ln-2967" href="#ln-2967"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2968" name="ln-2968" href="#ln-2968"></a>
<a id="ln-2969" name="ln-2969" href="#ln-2969"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2970" name="ln-2970" href="#ln-2970"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracClabile</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2971" name="ln-2971" href="#ln-2971"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2972" name="ln-2972" href="#ln-2972"></a>
<a id="ln-2973" name="ln-2973" href="#ln-2973"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2974" name="ln-2974" href="#ln-2974"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2975" name="ln-2975" href="#ln-2975"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2976" name="ln-2976" href="#ln-2976"></a>
<a id="ln-2977" name="ln-2977" href="#ln-2977"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2978" name="ln-2978" href="#ln-2978"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracNalloc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2979" name="ln-2979" href="#ln-2979"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2980" name="ln-2980" href="#ln-2980"></a>
<a id="ln-2981" name="ln-2981" href="#ln-2981"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2982" name="ln-2982" href="#ln-2982"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracPalloc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2983" name="ln-2983" href="#ln-2983"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2984" name="ln-2984" href="#ln-2984"></a>
<a id="ln-2985" name="ln-2985" href="#ln-2985"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2986" name="ln-2986" href="#ln-2986"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Crmplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2987" name="ln-2987" href="#ln-2987"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2988" name="ln-2988" href="#ln-2988"></a>
<a id="ln-2989" name="ln-2989" href="#ln-2989"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2990" name="ln-2990" href="#ln-2990"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">kplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2991" name="ln-2991" href="#ln-2991"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2992" name="ln-2992" href="#ln-2992"></a>
<a id="ln-2993" name="ln-2993" href="#ln-2993"></a><span class="w">    </span><span class="c">! 3D</span>
<a id="ln-2994" name="ln-2994" href="#ln-2994"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2995" name="ln-2995" href="#ln-2995"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fromPtoL</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-2996" name="ln-2996" href="#ln-2996"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-2997" name="ln-2997" href="#ln-2997"></a>
<a id="ln-2998" name="ln-2998" href="#ln-2998"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-2999" name="ln-2999" href="#ln-2999"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cnep</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3000" name="ln-3000" href="#ln-3000"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3001" name="ln-3001" href="#ln-3001"></a>
<a id="ln-3002" name="ln-3002" href="#ln-3002"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3003" name="ln-3003" href="#ln-3003"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Crsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3004" name="ln-3004" href="#ln-3004"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3005" name="ln-3005" href="#ln-3005"></a>
<a id="ln-3006" name="ln-3006" href="#ln-3006"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3007" name="ln-3007" href="#ln-3007"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nmindep</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3008" name="ln-3008" href="#ln-3008"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3009" name="ln-3009" href="#ln-3009"></a>
<a id="ln-3010" name="ln-3010" href="#ln-3010"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3011" name="ln-3011" href="#ln-3011"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nminloss</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3012" name="ln-3012" href="#ln-3012"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3013" name="ln-3013" href="#ln-3013"></a>
<a id="ln-3014" name="ln-3014" href="#ln-3014"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3015" name="ln-3015" href="#ln-3015"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nminleach</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3016" name="ln-3016" href="#ln-3016"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3017" name="ln-3017" href="#ln-3017"></a>
<a id="ln-3018" name="ln-3018" href="#ln-3018"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3019" name="ln-3019" href="#ln-3019"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nupland</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3020" name="ln-3020" href="#ln-3020"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3021" name="ln-3021" href="#ln-3021"></a>
<a id="ln-3022" name="ln-3022" href="#ln-3022"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3023" name="ln-3023" href="#ln-3023"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nlittermin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3024" name="ln-3024" href="#ln-3024"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3025" name="ln-3025" href="#ln-3025"></a>
<a id="ln-3026" name="ln-3026" href="#ln-3026"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3027" name="ln-3027" href="#ln-3027"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nsmin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3028" name="ln-3028" href="#ln-3028"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3029" name="ln-3029" href="#ln-3029"></a>
<a id="ln-3030" name="ln-3030" href="#ln-3030"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3031" name="ln-3031" href="#ln-3031"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nsimm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3032" name="ln-3032" href="#ln-3032"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3033" name="ln-3033" href="#ln-3033"></a>
<a id="ln-3034" name="ln-3034" href="#ln-3034"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3035" name="ln-3035" href="#ln-3035"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nsnet</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3036" name="ln-3036" href="#ln-3036"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3037" name="ln-3037" href="#ln-3037"></a>
<a id="ln-3038" name="ln-3038" href="#ln-3038"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3039" name="ln-3039" href="#ln-3039"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fNminloss</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3040" name="ln-3040" href="#ln-3040"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3041" name="ln-3041" href="#ln-3041"></a>
<a id="ln-3042" name="ln-3042" href="#ln-3042"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3043" name="ln-3043" href="#ln-3043"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fNminleach</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3044" name="ln-3044" href="#ln-3044"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3045" name="ln-3045" href="#ln-3045"></a>
<a id="ln-3046" name="ln-3046" href="#ln-3046"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3047" name="ln-3047" href="#ln-3047"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Pdep</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3048" name="ln-3048" href="#ln-3048"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3049" name="ln-3049" href="#ln-3049"></a>
<a id="ln-3050" name="ln-3050" href="#ln-3050"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3051" name="ln-3051" href="#ln-3051"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Pwea</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3052" name="ln-3052" href="#ln-3052"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3053" name="ln-3053" href="#ln-3053"></a>
<a id="ln-3054" name="ln-3054" href="#ln-3054"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3055" name="ln-3055" href="#ln-3055"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Pleach</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3056" name="ln-3056" href="#ln-3056"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3057" name="ln-3057" href="#ln-3057"></a>
<a id="ln-3058" name="ln-3058" href="#ln-3058"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3059" name="ln-3059" href="#ln-3059"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Ploss</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3060" name="ln-3060" href="#ln-3060"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3061" name="ln-3061" href="#ln-3061"></a>
<a id="ln-3062" name="ln-3062" href="#ln-3062"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3063" name="ln-3063" href="#ln-3063"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Pupland</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3064" name="ln-3064" href="#ln-3064"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3065" name="ln-3065" href="#ln-3065"></a>
<a id="ln-3066" name="ln-3066" href="#ln-3066"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3067" name="ln-3067" href="#ln-3067"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Plittermin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3068" name="ln-3068" href="#ln-3068"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3069" name="ln-3069" href="#ln-3069"></a>
<a id="ln-3070" name="ln-3070" href="#ln-3070"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3071" name="ln-3071" href="#ln-3071"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Psmin</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3072" name="ln-3072" href="#ln-3072"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3073" name="ln-3073" href="#ln-3073"></a>
<a id="ln-3074" name="ln-3074" href="#ln-3074"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3075" name="ln-3075" href="#ln-3075"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Psimm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3076" name="ln-3076" href="#ln-3076"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3077" name="ln-3077" href="#ln-3077"></a>
<a id="ln-3078" name="ln-3078" href="#ln-3078"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3079" name="ln-3079" href="#ln-3079"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Psnet</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3080" name="ln-3080" href="#ln-3080"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3081" name="ln-3081" href="#ln-3081"></a>
<a id="ln-3082" name="ln-3082" href="#ln-3082"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3083" name="ln-3083" href="#ln-3083"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fPleach</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3084" name="ln-3084" href="#ln-3084"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3085" name="ln-3085" href="#ln-3085"></a>
<a id="ln-3086" name="ln-3086" href="#ln-3086"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3087" name="ln-3087" href="#ln-3087"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">kplab</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3088" name="ln-3088" href="#ln-3088"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3089" name="ln-3089" href="#ln-3089"></a>
<a id="ln-3090" name="ln-3090" href="#ln-3090"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3091" name="ln-3091" href="#ln-3091"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">kpsorb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3092" name="ln-3092" href="#ln-3092"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3093" name="ln-3093" href="#ln-3093"></a>
<a id="ln-3094" name="ln-3094" href="#ln-3094"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3095" name="ln-3095" href="#ln-3095"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">kpocc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3096" name="ln-3096" href="#ln-3096"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3097" name="ln-3097" href="#ln-3097"></a>
<a id="ln-3098" name="ln-3098" href="#ln-3098"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3099" name="ln-3099" href="#ln-3099"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">kmlabP</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3100" name="ln-3100" href="#ln-3100"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3101" name="ln-3101" href="#ln-3101"></a>
<a id="ln-3102" name="ln-3102" href="#ln-3102"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3103" name="ln-3103" href="#ln-3103"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Psorbmax</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3104" name="ln-3104" href="#ln-3104"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3105" name="ln-3105" href="#ln-3105"></a>
<a id="ln-3106" name="ln-3106" href="#ln-3106"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3107" name="ln-3107" href="#ln-3107"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">frac_sapwood</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3108" name="ln-3108" href="#ln-3108"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3109" name="ln-3109" href="#ln-3109"></a>
<a id="ln-3110" name="ln-3110" href="#ln-3110"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3111" name="ln-3111" href="#ln-3111"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">sapwood_area</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3112" name="ln-3112" href="#ln-3112"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3113" name="ln-3113" href="#ln-3113"></a>
<a id="ln-3114" name="ln-3114" href="#ln-3114"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3115" name="ln-3115" href="#ln-3115"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">klitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3116" name="ln-3116" href="#ln-3116"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3117" name="ln-3117" href="#ln-3117"></a>
<a id="ln-3118" name="ln-3118" href="#ln-3118"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3119" name="ln-3119" href="#ln-3119"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">ksoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3120" name="ln-3120" href="#ln-3120"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3121" name="ln-3121" href="#ln-3121"></a>
<a id="ln-3122" name="ln-3122" href="#ln-3122"></a><span class="w">    </span><span class="c">! 3D</span>
<a id="ln-3123" name="ln-3123" href="#ln-3123"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3124" name="ln-3124" href="#ln-3124"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fromLtoS</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3125" name="ln-3125" href="#ln-3125"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3126" name="ln-3126" href="#ln-3126"></a>
<a id="ln-3127" name="ln-3127" href="#ln-3127"></a><span class="w">    </span><span class="c">! 3D</span>
<a id="ln-3128" name="ln-3128" href="#ln-3128"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3129" name="ln-3129" href="#ln-3129"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fromStoS</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3130" name="ln-3130" href="#ln-3130"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3131" name="ln-3131" href="#ln-3131"></a>
<a id="ln-3132" name="ln-3132" href="#ln-3132"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3133" name="ln-3133" href="#ln-3133"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fromLtoCO2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3134" name="ln-3134" href="#ln-3134"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3135" name="ln-3135" href="#ln-3135"></a>
<a id="ln-3136" name="ln-3136" href="#ln-3136"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3137" name="ln-3137" href="#ln-3137"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fromStoCO2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3138" name="ln-3138" href="#ln-3138"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3139" name="ln-3139" href="#ln-3139"></a>
<a id="ln-3140" name="ln-3140" href="#ln-3140"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3141" name="ln-3141" href="#ln-3141"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxCtolitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3142" name="ln-3142" href="#ln-3142"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3143" name="ln-3143" href="#ln-3143"></a>
<a id="ln-3144" name="ln-3144" href="#ln-3144"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3145" name="ln-3145" href="#ln-3145"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxNtolitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3146" name="ln-3146" href="#ln-3146"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3147" name="ln-3147" href="#ln-3147"></a>
<a id="ln-3148" name="ln-3148" href="#ln-3148"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3149" name="ln-3149" href="#ln-3149"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxPtolitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3150" name="ln-3150" href="#ln-3150"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3151" name="ln-3151" href="#ln-3151"></a>
<a id="ln-3152" name="ln-3152" href="#ln-3152"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3153" name="ln-3153" href="#ln-3153"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxCtosoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3154" name="ln-3154" href="#ln-3154"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3155" name="ln-3155" href="#ln-3155"></a>
<a id="ln-3156" name="ln-3156" href="#ln-3156"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3157" name="ln-3157" href="#ln-3157"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxNtosoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3158" name="ln-3158" href="#ln-3158"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3159" name="ln-3159" href="#ln-3159"></a>
<a id="ln-3160" name="ln-3160" href="#ln-3160"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3161" name="ln-3161" href="#ln-3161"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxPtosoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3162" name="ln-3162" href="#ln-3162"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3163" name="ln-3163" href="#ln-3163"></a>
<a id="ln-3164" name="ln-3164" href="#ln-3164"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3165" name="ln-3165" href="#ln-3165"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxCtoCO2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3166" name="ln-3166" href="#ln-3166"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3167" name="ln-3167" href="#ln-3167"></a>
<a id="ln-3168" name="ln-3168" href="#ln-3168"></a><span class="w">    </span><span class="c">! ------- casamet ----</span>
<a id="ln-3169" name="ln-3169" href="#ln-3169"></a>
<a id="ln-3170" name="ln-3170" href="#ln-3170"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3171" name="ln-3171" href="#ln-3171"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">glai</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3172" name="ln-3172" href="#ln-3172"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3173" name="ln-3173" href="#ln-3173"></a>
<a id="ln-3174" name="ln-3174" href="#ln-3174"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3175" name="ln-3175" href="#ln-3175"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">Tairk</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3176" name="ln-3176" href="#ln-3176"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3177" name="ln-3177" href="#ln-3177"></a>
<a id="ln-3178" name="ln-3178" href="#ln-3178"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3179" name="ln-3179" href="#ln-3179"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">precip</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3180" name="ln-3180" href="#ln-3180"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3181" name="ln-3181" href="#ln-3181"></a>
<a id="ln-3182" name="ln-3182" href="#ln-3182"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3183" name="ln-3183" href="#ln-3183"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">tsoilavg</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3184" name="ln-3184" href="#ln-3184"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3185" name="ln-3185" href="#ln-3185"></a>
<a id="ln-3186" name="ln-3186" href="#ln-3186"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3187" name="ln-3187" href="#ln-3187"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">moistavg</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3188" name="ln-3188" href="#ln-3188"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3189" name="ln-3189" href="#ln-3189"></a>
<a id="ln-3190" name="ln-3190" href="#ln-3190"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3191" name="ln-3191" href="#ln-3191"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">btran</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3192" name="ln-3192" href="#ln-3192"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3193" name="ln-3193" href="#ln-3193"></a>
<a id="ln-3194" name="ln-3194" href="#ln-3194"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3195" name="ln-3195" href="#ln-3195"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">lnonwood</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3196" name="ln-3196" href="#ln-3196"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3197" name="ln-3197" href="#ln-3197"></a>
<a id="ln-3198" name="ln-3198" href="#ln-3198"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3199" name="ln-3199" href="#ln-3199"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">Tsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3200" name="ln-3200" href="#ln-3200"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3201" name="ln-3201" href="#ln-3201"></a>
<a id="ln-3202" name="ln-3202" href="#ln-3202"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3203" name="ln-3203" href="#ln-3203"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">moist</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3204" name="ln-3204" href="#ln-3204"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3205" name="ln-3205" href="#ln-3205"></a>
<a id="ln-3206" name="ln-3206" href="#ln-3206"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3207" name="ln-3207" href="#ln-3207"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">iveg2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3208" name="ln-3208" href="#ln-3208"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3209" name="ln-3209" href="#ln-3209"></a>
<a id="ln-3210" name="ln-3210" href="#ln-3210"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3211" name="ln-3211" href="#ln-3211"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">ijgcm</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3212" name="ln-3212" href="#ln-3212"></a><span class="w">    </span><span class="c">! Maciej: ijgcm is INTEGER</span>
<a id="ln-3213" name="ln-3213" href="#ln-3213"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-3214" name="ln-3214" href="#ln-3214"></a>
<a id="ln-3215" name="ln-3215" href="#ln-3215"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3216" name="ln-3216" href="#ln-3216"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">isorder</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3217" name="ln-3217" href="#ln-3217"></a><span class="w">    </span><span class="c">! Maciej: isorder is INTEGER</span>
<a id="ln-3218" name="ln-3218" href="#ln-3218"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-3219" name="ln-3219" href="#ln-3219"></a>
<a id="ln-3220" name="ln-3220" href="#ln-3220"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3221" name="ln-3221" href="#ln-3221"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">lat</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3222" name="ln-3222" href="#ln-3222"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3223" name="ln-3223" href="#ln-3223"></a>
<a id="ln-3224" name="ln-3224" href="#ln-3224"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3225" name="ln-3225" href="#ln-3225"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">lon</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3226" name="ln-3226" href="#ln-3226"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3227" name="ln-3227" href="#ln-3227"></a>
<a id="ln-3228" name="ln-3228" href="#ln-3228"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3229" name="ln-3229" href="#ln-3229"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">areacell</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3230" name="ln-3230" href="#ln-3230"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3231" name="ln-3231" href="#ln-3231"></a>
<a id="ln-3232" name="ln-3232" href="#ln-3232"></a><span class="w">    </span><span class="c">! ------- casabal ----</span>
<a id="ln-3233" name="ln-3233" href="#ln-3233"></a>
<a id="ln-3234" name="ln-3234" href="#ln-3234"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3235" name="ln-3235" href="#ln-3235"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCgppyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3236" name="ln-3236" href="#ln-3236"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3237" name="ln-3237" href="#ln-3237"></a>
<a id="ln-3238" name="ln-3238" href="#ln-3238"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3239" name="ln-3239" href="#ln-3239"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCnppyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3240" name="ln-3240" href="#ln-3240"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3241" name="ln-3241" href="#ln-3241"></a>
<a id="ln-3242" name="ln-3242" href="#ln-3242"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3243" name="ln-3243" href="#ln-3243"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrmleafyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3244" name="ln-3244" href="#ln-3244"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3245" name="ln-3245" href="#ln-3245"></a>
<a id="ln-3246" name="ln-3246" href="#ln-3246"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3247" name="ln-3247" href="#ln-3247"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrmwoodyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3248" name="ln-3248" href="#ln-3248"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3249" name="ln-3249" href="#ln-3249"></a>
<a id="ln-3250" name="ln-3250" href="#ln-3250"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3251" name="ln-3251" href="#ln-3251"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrmrootyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3252" name="ln-3252" href="#ln-3252"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3253" name="ln-3253" href="#ln-3253"></a>
<a id="ln-3254" name="ln-3254" href="#ln-3254"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3255" name="ln-3255" href="#ln-3255"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrgrowyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3256" name="ln-3256" href="#ln-3256"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3257" name="ln-3257" href="#ln-3257"></a>
<a id="ln-3258" name="ln-3258" href="#ln-3258"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3259" name="ln-3259" href="#ln-3259"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrpyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3260" name="ln-3260" href="#ln-3260"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3261" name="ln-3261" href="#ln-3261"></a>
<a id="ln-3262" name="ln-3262" href="#ln-3262"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3263" name="ln-3263" href="#ln-3263"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrsyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3264" name="ln-3264" href="#ln-3264"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3265" name="ln-3265" href="#ln-3265"></a>
<a id="ln-3266" name="ln-3266" href="#ln-3266"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3267" name="ln-3267" href="#ln-3267"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCneeyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3268" name="ln-3268" href="#ln-3268"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3269" name="ln-3269" href="#ln-3269"></a>
<a id="ln-3270" name="ln-3270" href="#ln-3270"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3271" name="ln-3271" href="#ln-3271"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNdepyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3272" name="ln-3272" href="#ln-3272"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3273" name="ln-3273" href="#ln-3273"></a>
<a id="ln-3274" name="ln-3274" href="#ln-3274"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3275" name="ln-3275" href="#ln-3275"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNfixyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3276" name="ln-3276" href="#ln-3276"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3277" name="ln-3277" href="#ln-3277"></a>
<a id="ln-3278" name="ln-3278" href="#ln-3278"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3279" name="ln-3279" href="#ln-3279"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNsnetyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3280" name="ln-3280" href="#ln-3280"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3281" name="ln-3281" href="#ln-3281"></a>
<a id="ln-3282" name="ln-3282" href="#ln-3282"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3283" name="ln-3283" href="#ln-3283"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNupyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3284" name="ln-3284" href="#ln-3284"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3285" name="ln-3285" href="#ln-3285"></a>
<a id="ln-3286" name="ln-3286" href="#ln-3286"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3287" name="ln-3287" href="#ln-3287"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNleachyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3288" name="ln-3288" href="#ln-3288"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3289" name="ln-3289" href="#ln-3289"></a>
<a id="ln-3290" name="ln-3290" href="#ln-3290"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3291" name="ln-3291" href="#ln-3291"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNlossyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3292" name="ln-3292" href="#ln-3292"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3293" name="ln-3293" href="#ln-3293"></a>
<a id="ln-3294" name="ln-3294" href="#ln-3294"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3295" name="ln-3295" href="#ln-3295"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPweayear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3296" name="ln-3296" href="#ln-3296"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3297" name="ln-3297" href="#ln-3297"></a>
<a id="ln-3298" name="ln-3298" href="#ln-3298"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3299" name="ln-3299" href="#ln-3299"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPdustyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3300" name="ln-3300" href="#ln-3300"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3301" name="ln-3301" href="#ln-3301"></a>
<a id="ln-3302" name="ln-3302" href="#ln-3302"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3303" name="ln-3303" href="#ln-3303"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPsnetyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3304" name="ln-3304" href="#ln-3304"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3305" name="ln-3305" href="#ln-3305"></a>
<a id="ln-3306" name="ln-3306" href="#ln-3306"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3307" name="ln-3307" href="#ln-3307"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPupyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3308" name="ln-3308" href="#ln-3308"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3309" name="ln-3309" href="#ln-3309"></a>
<a id="ln-3310" name="ln-3310" href="#ln-3310"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3311" name="ln-3311" href="#ln-3311"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPleachyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3312" name="ln-3312" href="#ln-3312"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3313" name="ln-3313" href="#ln-3313"></a>
<a id="ln-3314" name="ln-3314" href="#ln-3314"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3315" name="ln-3315" href="#ln-3315"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPlossyear</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3316" name="ln-3316" href="#ln-3316"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3317" name="ln-3317" href="#ln-3317"></a>
<a id="ln-3318" name="ln-3318" href="#ln-3318"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3319" name="ln-3319" href="#ln-3319"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">glaimon</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3320" name="ln-3320" href="#ln-3320"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3321" name="ln-3321" href="#ln-3321"></a>
<a id="ln-3322" name="ln-3322" href="#ln-3322"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3323" name="ln-3323" href="#ln-3323"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">glaimonx</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3324" name="ln-3324" href="#ln-3324"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3325" name="ln-3325" href="#ln-3325"></a>
<a id="ln-3326" name="ln-3326" href="#ln-3326"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3327" name="ln-3327" href="#ln-3327"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">cplantlast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3328" name="ln-3328" href="#ln-3328"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3329" name="ln-3329" href="#ln-3329"></a>
<a id="ln-3330" name="ln-3330" href="#ln-3330"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3331" name="ln-3331" href="#ln-3331"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">nplantlast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3332" name="ln-3332" href="#ln-3332"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3333" name="ln-3333" href="#ln-3333"></a>
<a id="ln-3334" name="ln-3334" href="#ln-3334"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3335" name="ln-3335" href="#ln-3335"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">pplantlast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3336" name="ln-3336" href="#ln-3336"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3337" name="ln-3337" href="#ln-3337"></a>
<a id="ln-3338" name="ln-3338" href="#ln-3338"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3339" name="ln-3339" href="#ln-3339"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">clitterlast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3340" name="ln-3340" href="#ln-3340"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3341" name="ln-3341" href="#ln-3341"></a>
<a id="ln-3342" name="ln-3342" href="#ln-3342"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3343" name="ln-3343" href="#ln-3343"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">nlitterlast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3344" name="ln-3344" href="#ln-3344"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3345" name="ln-3345" href="#ln-3345"></a>
<a id="ln-3346" name="ln-3346" href="#ln-3346"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3347" name="ln-3347" href="#ln-3347"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">plitterlast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3348" name="ln-3348" href="#ln-3348"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3349" name="ln-3349" href="#ln-3349"></a>
<a id="ln-3350" name="ln-3350" href="#ln-3350"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3351" name="ln-3351" href="#ln-3351"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">csoillast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3352" name="ln-3352" href="#ln-3352"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3353" name="ln-3353" href="#ln-3353"></a>
<a id="ln-3354" name="ln-3354" href="#ln-3354"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3355" name="ln-3355" href="#ln-3355"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">nsoillast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3356" name="ln-3356" href="#ln-3356"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3357" name="ln-3357" href="#ln-3357"></a>
<a id="ln-3358" name="ln-3358" href="#ln-3358"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3359" name="ln-3359" href="#ln-3359"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">psoillast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3360" name="ln-3360" href="#ln-3360"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3361" name="ln-3361" href="#ln-3361"></a>
<a id="ln-3362" name="ln-3362" href="#ln-3362"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3363" name="ln-3363" href="#ln-3363"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">nsoilminlast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3364" name="ln-3364" href="#ln-3364"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3365" name="ln-3365" href="#ln-3365"></a>
<a id="ln-3366" name="ln-3366" href="#ln-3366"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3367" name="ln-3367" href="#ln-3367"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">psoillablast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3368" name="ln-3368" href="#ln-3368"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3369" name="ln-3369" href="#ln-3369"></a>
<a id="ln-3370" name="ln-3370" href="#ln-3370"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3371" name="ln-3371" href="#ln-3371"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">psoilsorblast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3372" name="ln-3372" href="#ln-3372"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3373" name="ln-3373" href="#ln-3373"></a>
<a id="ln-3374" name="ln-3374" href="#ln-3374"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3375" name="ln-3375" href="#ln-3375"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">psoilocclast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3376" name="ln-3376" href="#ln-3376"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3377" name="ln-3377" href="#ln-3377"></a>
<a id="ln-3378" name="ln-3378" href="#ln-3378"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3379" name="ln-3379" href="#ln-3379"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">cbalance</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3380" name="ln-3380" href="#ln-3380"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3381" name="ln-3381" href="#ln-3381"></a>
<a id="ln-3382" name="ln-3382" href="#ln-3382"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3383" name="ln-3383" href="#ln-3383"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">nbalance</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3384" name="ln-3384" href="#ln-3384"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3385" name="ln-3385" href="#ln-3385"></a>
<a id="ln-3386" name="ln-3386" href="#ln-3386"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3387" name="ln-3387" href="#ln-3387"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">pbalance</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3388" name="ln-3388" href="#ln-3388"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3389" name="ln-3389" href="#ln-3389"></a>
<a id="ln-3390" name="ln-3390" href="#ln-3390"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3391" name="ln-3391" href="#ln-3391"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">sumcbal</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3392" name="ln-3392" href="#ln-3392"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3393" name="ln-3393" href="#ln-3393"></a>
<a id="ln-3394" name="ln-3394" href="#ln-3394"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3395" name="ln-3395" href="#ln-3395"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">sumnbal</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3396" name="ln-3396" href="#ln-3396"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3397" name="ln-3397" href="#ln-3397"></a>
<a id="ln-3398" name="ln-3398" href="#ln-3398"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3399" name="ln-3399" href="#ln-3399"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">sumpbal</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3400" name="ln-3400" href="#ln-3400"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3401" name="ln-3401" href="#ln-3401"></a>
<a id="ln-3402" name="ln-3402" href="#ln-3402"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3403" name="ln-3403" href="#ln-3403"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">clabilelast</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3404" name="ln-3404" href="#ln-3404"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-3405" name="ln-3405" href="#ln-3405"></a>
<a id="ln-3406" name="ln-3406" href="#ln-3406"></a><span class="w">    </span><span class="c">! ------- phen -------</span>
<a id="ln-3407" name="ln-3407" href="#ln-3407"></a>
<a id="ln-3408" name="ln-3408" href="#ln-3408"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3409" name="ln-3409" href="#ln-3409"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">phase</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3410" name="ln-3410" href="#ln-3410"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3411" name="ln-3411" href="#ln-3411"></a>
<a id="ln-3412" name="ln-3412" href="#ln-3412"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3413" name="ln-3413" href="#ln-3413"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">TKshed</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3414" name="ln-3414" href="#ln-3414"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvtype</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-3415" name="ln-3415" href="#ln-3415"></a>
<a id="ln-3416" name="ln-3416" href="#ln-3416"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3417" name="ln-3417" href="#ln-3417"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphase</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3418" name="ln-3418" href="#ln-3418"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mphase</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3419" name="ln-3419" href="#ln-3419"></a>
<a id="ln-3420" name="ln-3420" href="#ln-3420"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3421" name="ln-3421" href="#ln-3421"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">phen</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3422" name="ln-3422" href="#ln-3422"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3423" name="ln-3423" href="#ln-3423"></a>
<a id="ln-3424" name="ln-3424" href="#ln-3424"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3425" name="ln-3425" href="#ln-3425"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">aphen</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3426" name="ln-3426" href="#ln-3426"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3427" name="ln-3427" href="#ln-3427"></a>
<a id="ln-3428" name="ln-3428" href="#ln-3428"></a>
<a id="ln-3429" name="ln-3429" href="#ln-3429"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3430" name="ln-3430" href="#ln-3430"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">phasespin</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3431" name="ln-3431" href="#ln-3431"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdyear</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3432" name="ln-3432" href="#ln-3432"></a>
<a id="ln-3433" name="ln-3433" href="#ln-3433"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3434" name="ln-3434" href="#ln-3434"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphasespin_1</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3435" name="ln-3435" href="#ln-3435"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">mdyear</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3436" name="ln-3436" href="#ln-3436"></a>
<a id="ln-3437" name="ln-3437" href="#ln-3437"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3438" name="ln-3438" href="#ln-3438"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphasespin_2</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3439" name="ln-3439" href="#ln-3439"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">mdyear</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3440" name="ln-3440" href="#ln-3440"></a>
<a id="ln-3441" name="ln-3441" href="#ln-3441"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3442" name="ln-3442" href="#ln-3442"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphasespin_3</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3443" name="ln-3443" href="#ln-3443"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">mdyear</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3444" name="ln-3444" href="#ln-3444"></a>
<a id="ln-3445" name="ln-3445" href="#ln-3445"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3446" name="ln-3446" href="#ln-3446"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphasespin_4</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3447" name="ln-3447" href="#ln-3447"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">mdyear</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3448" name="ln-3448" href="#ln-3448"></a>
<a id="ln-3449" name="ln-3449" href="#ln-3449"></a>
<a id="ln-3450" name="ln-3450" href="#ln-3450"></a><span class="w">    </span><span class="c">! MPI: sanity check</span>
<a id="ln-3451" name="ln-3451" href="#ln-3451"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ntyp</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-3452" name="ln-3452" href="#ln-3452"></a><span class="k">       WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s1">&#39; invalid number of casa_t param fields &#39;</span><span class="p">,</span><span class="n">bidx</span><span class="p">,</span><span class="s1">&#39;, fix it!&#39;</span><span class="w"></span>
<a id="ln-3453" name="ln-3453" href="#ln-3453"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Abort</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3454" name="ln-3454" href="#ln-3454"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-3455" name="ln-3455" href="#ln-3455"></a>
<a id="ln-3456" name="ln-3456" href="#ln-3456"></a><span class="k">    CALL </span><span class="n">MPI_Type_create_struct</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">blen</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3457" name="ln-3457" href="#ln-3457"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_commit</span><span class="w"> </span><span class="p">(</span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3458" name="ln-3458" href="#ln-3458"></a>
<a id="ln-3459" name="ln-3459" href="#ln-3459"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_size</span><span class="w"> </span><span class="p">(</span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3460" name="ln-3460" href="#ln-3460"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_get_extent</span><span class="w"> </span><span class="p">(</span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3461" name="ln-3461" href="#ln-3461"></a>
<a id="ln-3462" name="ln-3462" href="#ln-3462"></a><span class="w">    </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker casa_t param blocks, size, extent and lb: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">bidx</span><span class="p">,</span><span class="n">tsize</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-3463" name="ln-3463" href="#ln-3463"></a>
<a id="ln-3464" name="ln-3464" href="#ln-3464"></a><span class="w">    </span><span class="c">! MPI: check whether total size of received data equals total</span>
<a id="ln-3465" name="ln-3465" href="#ln-3465"></a><span class="w">    </span><span class="c">! data sent by all the workers</span>
<a id="ln-3466" name="ln-3466" href="#ln-3466"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Reduce</span><span class="w"> </span><span class="p">(</span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DATATYPE_NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3467" name="ln-3467" href="#ln-3467"></a>
<a id="ln-3468" name="ln-3468" href="#ln-3468"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="w"></span>
<a id="ln-3469" name="ln-3469" href="#ln-3469"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">displs</span><span class="p">)</span><span class="w"></span>
<a id="ln-3470" name="ln-3470" href="#ln-3470"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">blen</span><span class="p">)</span><span class="w"></span>
<a id="ln-3471" name="ln-3471" href="#ln-3471"></a>
<a id="ln-3472" name="ln-3472" href="#ln-3472"></a><span class="w">    </span><span class="c">! if anything went wrong the master will mpi_abort</span>
<a id="ln-3473" name="ln-3473" href="#ln-3473"></a><span class="w">    </span><span class="c">! which mpi_recv below is going to catch...</span>
<a id="ln-3474" name="ln-3474" href="#ln-3474"></a>
<a id="ln-3475" name="ln-3475" href="#ln-3475"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Barrier</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3476" name="ln-3476" href="#ln-3476"></a>
<a id="ln-3477" name="ln-3477" href="#ln-3477"></a><span class="w">    </span><span class="c">! so, now receive all the parameters</span>
<a id="ln-3478" name="ln-3478" href="#ln-3478"></a><span class="w">    </span><span class="c">!    CALL MPI_Recv (MPI_BOTTOM, 1, casa_t, 0, 0, comm, stat, ierr)</span>
<a id="ln-3479" name="ln-3479" href="#ln-3479"></a>
<a id="ln-3480" name="ln-3480" href="#ln-3480"></a><span class="w">    </span><span class="c">!   Maciej: buffered recv + unpac version</span>
<a id="ln-3481" name="ln-3481" href="#ln-3481"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">rbuf</span><span class="p">(</span><span class="n">tsize</span><span class="p">))</span><span class="w"></span>
<a id="ln-3482" name="ln-3482" href="#ln-3482"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">rbuf</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3483" name="ln-3483" href="#ln-3483"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_count</span><span class="w"> </span><span class="p">(</span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="p">,</span><span class="w"> </span><span class="n">ierr2</span><span class="p">)</span><span class="w"></span>
<a id="ln-3484" name="ln-3484" href="#ln-3484"></a>
<a id="ln-3485" name="ln-3485" href="#ln-3485"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPI_SUCCESS</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">ierr2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPI_SUCCESS</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">rcount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-3486" name="ln-3486" href="#ln-3486"></a><span class="k">       </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-3487" name="ln-3487" href="#ln-3487"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Unpack</span><span class="w"> </span><span class="p">(</span><span class="n">rbuf</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="p">,</span><span class="w"> </span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-3488" name="ln-3488" href="#ln-3488"></a><span class="w">            </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3489" name="ln-3489" href="#ln-3489"></a><span class="w">       </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPI_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;casa params unpack error, rank: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">ierr</span><span class="w"></span>
<a id="ln-3490" name="ln-3490" href="#ln-3490"></a><span class="w">    </span><span class="k">ELSE</span>
<a id="ln-3491" name="ln-3491" href="#ln-3491"></a><span class="k">       WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;casa params recv rank err err2 rcount: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">ierr2</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="w"></span>
<a id="ln-3492" name="ln-3492" href="#ln-3492"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-3493" name="ln-3493" href="#ln-3493"></a>
<a id="ln-3494" name="ln-3494" href="#ln-3494"></a><span class="k">    DEALLOCATE</span><span class="p">(</span><span class="n">rbuf</span><span class="p">)</span><span class="w"></span>
<a id="ln-3495" name="ln-3495" href="#ln-3495"></a>
<a id="ln-3496" name="ln-3496" href="#ln-3496"></a>
<a id="ln-3497" name="ln-3497" href="#ln-3497"></a><span class="w">    </span><span class="c">! finally free the MPI type</span>
<a id="ln-3498" name="ln-3498" href="#ln-3498"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_Free</span><span class="w"> </span><span class="p">(</span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3499" name="ln-3499" href="#ln-3499"></a>
<a id="ln-3500" name="ln-3500" href="#ln-3500"></a><span class="w">    </span><span class="c">! all casa parameters have been received from the master by now</span>
<a id="ln-3501" name="ln-3501" href="#ln-3501"></a>
<a id="ln-3502" name="ln-3502" href="#ln-3502"></a><span class="w">    </span><span class="k">RETURN</span>
<a id="ln-3503" name="ln-3503" href="#ln-3503"></a>
<a id="ln-3504" name="ln-3504" href="#ln-3504"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_casa_params</span><span class="w"></span>
<a id="ln-3505" name="ln-3505" href="#ln-3505"></a>
<a id="ln-3506" name="ln-3506" href="#ln-3506"></a>
<a id="ln-3507" name="ln-3507" href="#ln-3507"></a><span class="w">  </span><span class="c">! MPI: creates inp_t type to receive input data from the master</span>
<a id="ln-3508" name="ln-3508" href="#ln-3508"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_intype</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="n">met</span><span class="p">,</span><span class="n">veg</span><span class="p">)</span><span class="w"></span>
<a id="ln-3509" name="ln-3509" href="#ln-3509"></a>
<a id="ln-3510" name="ln-3510" href="#ln-3510"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-3511" name="ln-3511" href="#ln-3511"></a>
<a id="ln-3512" name="ln-3512" href="#ln-3512"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-3513" name="ln-3513" href="#ln-3513"></a>
<a id="ln-3514" name="ln-3514" href="#ln-3514"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<a id="ln-3515" name="ln-3515" href="#ln-3515"></a>
<a id="ln-3516" name="ln-3516" href="#ln-3516"></a><span class="w">    </span><span class="c">! Arguments</span>
<a id="ln-3517" name="ln-3517" href="#ln-3517"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w"></span>
<a id="ln-3518" name="ln-3518" href="#ln-3518"></a><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">met_type</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span><span class="w"> </span><span class="n">met</span><span class="w"> </span><span class="c">! meteorological data</span>
<a id="ln-3519" name="ln-3519" href="#ln-3519"></a><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">veg_parameter_type</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">veg</span><span class="w"> </span><span class="c">! LAI retrieved from file</span>
<a id="ln-3520" name="ln-3520" href="#ln-3520"></a>
<a id="ln-3521" name="ln-3521" href="#ln-3521"></a><span class="w">    </span><span class="c">! Local variables</span>
<a id="ln-3522" name="ln-3522" href="#ln-3522"></a>
<a id="ln-3523" name="ln-3523" href="#ln-3523"></a><span class="w">    </span><span class="c">! temp arrays for marshalling all fields into a single struct</span>
<a id="ln-3524" name="ln-3524" href="#ln-3524"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blocks</span><span class="w"></span>
<a id="ln-3525" name="ln-3525" href="#ln-3525"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">displs</span><span class="w"></span>
<a id="ln-3526" name="ln-3526" href="#ln-3526"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<a id="ln-3527" name="ln-3527" href="#ln-3527"></a>
<a id="ln-3528" name="ln-3528" href="#ln-3528"></a><span class="w">    </span><span class="c">! temp vars for verifying block number and total length of inp_t</span>
<a id="ln-3529" name="ln-3529" href="#ln-3529"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-3530" name="ln-3530" href="#ln-3530"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tsize</span><span class="w"></span>
<a id="ln-3531" name="ln-3531" href="#ln-3531"></a>
<a id="ln-3532" name="ln-3532" href="#ln-3532"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r1len</span><span class="p">,</span><span class="w"> </span><span class="n">r2len</span><span class="p">,</span><span class="w"> </span><span class="n">I1LEN</span><span class="p">,</span><span class="w"> </span><span class="n">llen</span><span class="w"> </span><span class="c">! block lengths</span>
<a id="ln-3533" name="ln-3533" href="#ln-3533"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="c">! block index</span>
<a id="ln-3534" name="ln-3534" href="#ln-3534"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntyp</span><span class="w"> </span><span class="c">! total number of blocks</span>
<a id="ln-3535" name="ln-3535" href="#ln-3535"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-3536" name="ln-3536" href="#ln-3536"></a>
<a id="ln-3537" name="ln-3537" href="#ln-3537"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="w"></span>
<a id="ln-3538" name="ln-3538" href="#ln-3538"></a>
<a id="ln-3539" name="ln-3539" href="#ln-3539"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Comm_rank</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3540" name="ln-3540" href="#ln-3540"></a>
<a id="ln-3541" name="ln-3541" href="#ln-3541"></a><span class="w">    </span><span class="n">r1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-3542" name="ln-3542" href="#ln-3542"></a><span class="w">    </span><span class="n">r2len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-3543" name="ln-3543" href="#ln-3543"></a><span class="w">    </span><span class="n">I1LEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-3544" name="ln-3544" href="#ln-3544"></a><span class="w">    </span><span class="n">llen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extl</span><span class="w"></span>
<a id="ln-3545" name="ln-3545" href="#ln-3545"></a>
<a id="ln-3546" name="ln-3546" href="#ln-3546"></a><span class="w">    </span><span class="c">! max total number of fields to receive: met + veg fields</span>
<a id="ln-3547" name="ln-3547" href="#ln-3547"></a><span class="w">    </span><span class="c">! ntyp = 10 + 1</span>
<a id="ln-3548" name="ln-3548" href="#ln-3548"></a><span class="w">    </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ninput</span><span class="w"></span>
<a id="ln-3549" name="ln-3549" href="#ln-3549"></a>
<a id="ln-3550" name="ln-3550" href="#ln-3550"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">blocks</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-3551" name="ln-3551" href="#ln-3551"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">displs</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-3552" name="ln-3552" href="#ln-3552"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-3553" name="ln-3553" href="#ln-3553"></a>
<a id="ln-3554" name="ln-3554" href="#ln-3554"></a><span class="w">    </span><span class="c">! met fields</span>
<a id="ln-3555" name="ln-3555" href="#ln-3555"></a><span class="w">    </span><span class="c">! TODO: don&#39;t add optional field when not required</span>
<a id="ln-3556" name="ln-3556" href="#ln-3556"></a><span class="w">    </span><span class="c">! (exists% flags)</span>
<a id="ln-3557" name="ln-3557" href="#ln-3557"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-3558" name="ln-3558" href="#ln-3558"></a>
<a id="ln-3559" name="ln-3559" href="#ln-3559"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3560" name="ln-3560" href="#ln-3560"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">fsd</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3561" name="ln-3561" href="#ln-3561"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">swb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3562" name="ln-3562" href="#ln-3562"></a>
<a id="ln-3563" name="ln-3563" href="#ln-3563"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3564" name="ln-3564" href="#ln-3564"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">tk</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3565" name="ln-3565" href="#ln-3565"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3566" name="ln-3566" href="#ln-3566"></a>
<a id="ln-3567" name="ln-3567" href="#ln-3567"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3568" name="ln-3568" href="#ln-3568"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">pmb</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3569" name="ln-3569" href="#ln-3569"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3570" name="ln-3570" href="#ln-3570"></a>
<a id="ln-3571" name="ln-3571" href="#ln-3571"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3572" name="ln-3572" href="#ln-3572"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">qv</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3573" name="ln-3573" href="#ln-3573"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3574" name="ln-3574" href="#ln-3574"></a>
<a id="ln-3575" name="ln-3575" href="#ln-3575"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3576" name="ln-3576" href="#ln-3576"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">ua</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3577" name="ln-3577" href="#ln-3577"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3578" name="ln-3578" href="#ln-3578"></a>
<a id="ln-3579" name="ln-3579" href="#ln-3579"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3580" name="ln-3580" href="#ln-3580"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">precip</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3581" name="ln-3581" href="#ln-3581"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3582" name="ln-3582" href="#ln-3582"></a>
<a id="ln-3583" name="ln-3583" href="#ln-3583"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3584" name="ln-3584" href="#ln-3584"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">precip_sn</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3585" name="ln-3585" href="#ln-3585"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3586" name="ln-3586" href="#ln-3586"></a>
<a id="ln-3587" name="ln-3587" href="#ln-3587"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3588" name="ln-3588" href="#ln-3588"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">fld</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3589" name="ln-3589" href="#ln-3589"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3590" name="ln-3590" href="#ln-3590"></a>
<a id="ln-3591" name="ln-3591" href="#ln-3591"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3592" name="ln-3592" href="#ln-3592"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">ca</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3593" name="ln-3593" href="#ln-3593"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3594" name="ln-3594" href="#ln-3594"></a>
<a id="ln-3595" name="ln-3595" href="#ln-3595"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3596" name="ln-3596" href="#ln-3596"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">coszen</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3597" name="ln-3597" href="#ln-3597"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3598" name="ln-3598" href="#ln-3598"></a>
<a id="ln-3599" name="ln-3599" href="#ln-3599"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3600" name="ln-3600" href="#ln-3600"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">Ndep</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3601" name="ln-3601" href="#ln-3601"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3602" name="ln-3602" href="#ln-3602"></a>
<a id="ln-3603" name="ln-3603" href="#ln-3603"></a>
<a id="ln-3604" name="ln-3604" href="#ln-3604"></a><span class="w">    </span><span class="c">! veg fields</span>
<a id="ln-3605" name="ln-3605" href="#ln-3605"></a>
<a id="ln-3606" name="ln-3606" href="#ln-3606"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3607" name="ln-3607" href="#ln-3607"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">vlai</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3608" name="ln-3608" href="#ln-3608"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3609" name="ln-3609" href="#ln-3609"></a>
<a id="ln-3610" name="ln-3610" href="#ln-3610"></a><span class="w">    </span><span class="c">! additional field missing from previous versions;</span>
<a id="ln-3611" name="ln-3611" href="#ln-3611"></a><span class="w">    </span><span class="c">! added when trying to fix a bug in the new mpi code</span>
<a id="ln-3612" name="ln-3612" href="#ln-3612"></a><span class="w">    </span><span class="c">! the order of these new fields follows the order of their</span>
<a id="ln-3613" name="ln-3613" href="#ln-3613"></a><span class="w">    </span><span class="c">! declaration in cable_define_types.F90</span>
<a id="ln-3614" name="ln-3614" href="#ln-3614"></a>
<a id="ln-3615" name="ln-3615" href="#ln-3615"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3616" name="ln-3616" href="#ln-3616"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3617" name="ln-3617" href="#ln-3617"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3618" name="ln-3618" href="#ln-3618"></a>
<a id="ln-3619" name="ln-3619" href="#ln-3619"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3620" name="ln-3620" href="#ln-3620"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3621" name="ln-3621" href="#ln-3621"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-3622" name="ln-3622" href="#ln-3622"></a>
<a id="ln-3623" name="ln-3623" href="#ln-3623"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3624" name="ln-3624" href="#ln-3624"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3625" name="ln-3625" href="#ln-3625"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3626" name="ln-3626" href="#ln-3626"></a>
<a id="ln-3627" name="ln-3627" href="#ln-3627"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3628" name="ln-3628" href="#ln-3628"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3629" name="ln-3629" href="#ln-3629"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-3630" name="ln-3630" href="#ln-3630"></a>
<a id="ln-3631" name="ln-3631" href="#ln-3631"></a>
<a id="ln-3632" name="ln-3632" href="#ln-3632"></a><span class="w">    </span><span class="c">! MPI: sanity check</span>
<a id="ln-3633" name="ln-3633" href="#ln-3633"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ntyp</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-3634" name="ln-3634" href="#ln-3634"></a><span class="k">       WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s1">&#39;: invalid intype nmat, nvec or n3d constant, fix it!&#39;</span><span class="w"></span>
<a id="ln-3635" name="ln-3635" href="#ln-3635"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;bidx: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">bidx</span><span class="w"></span>
<a id="ln-3636" name="ln-3636" href="#ln-3636"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;nvec: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nvec</span><span class="w"></span>
<a id="ln-3637" name="ln-3637" href="#ln-3637"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;n3d:&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n3d</span><span class="w"></span>
<a id="ln-3638" name="ln-3638" href="#ln-3638"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ntyp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ntyp</span><span class="w"></span>
<a id="ln-3639" name="ln-3639" href="#ln-3639"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Abort</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3640" name="ln-3640" href="#ln-3640"></a><span class="w">    </span><span class="k">END IF</span><span class="w"></span>
<a id="ln-3641" name="ln-3641" href="#ln-3641"></a>
<a id="ln-3642" name="ln-3642" href="#ln-3642"></a>
<a id="ln-3643" name="ln-3643" href="#ln-3643"></a><span class="w">    </span><span class="c">! marshall all fields into a single MPI derived datatype</span>
<a id="ln-3644" name="ln-3644" href="#ln-3644"></a>
<a id="ln-3645" name="ln-3645" href="#ln-3645"></a><span class="w">    </span><span class="c">! all variables are contiguous blocks of memory so just send them</span>
<a id="ln-3646" name="ln-3646" href="#ln-3646"></a><span class="w">    </span><span class="c">! as blocks of bytes</span>
<a id="ln-3647" name="ln-3647" href="#ln-3647"></a><span class="w">    </span><span class="n">types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-3648" name="ln-3648" href="#ln-3648"></a>
<a id="ln-3649" name="ln-3649" href="#ln-3649"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_create_struct</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">blocks</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">inp_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3650" name="ln-3650" href="#ln-3650"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_commit</span><span class="w"> </span><span class="p">(</span><span class="n">inp_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3651" name="ln-3651" href="#ln-3651"></a>
<a id="ln-3652" name="ln-3652" href="#ln-3652"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_size</span><span class="w"> </span><span class="p">(</span><span class="n">inp_t</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3653" name="ln-3653" href="#ln-3653"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_get_extent</span><span class="w"> </span><span class="p">(</span><span class="n">inp_t</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3654" name="ln-3654" href="#ln-3654"></a>
<a id="ln-3655" name="ln-3655" href="#ln-3655"></a><span class="w">    </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s1">&#39;: intype struct blocks, size, extent and lb: &#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-3656" name="ln-3656" href="#ln-3656"></a><span class="w">         </span><span class="n">bidx</span><span class="p">,</span><span class="n">tsize</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-3657" name="ln-3657" href="#ln-3657"></a>
<a id="ln-3658" name="ln-3658" href="#ln-3658"></a><span class="w">    </span><span class="c">! MPI: check whether total size of received data equals total</span>
<a id="ln-3659" name="ln-3659" href="#ln-3659"></a><span class="w">    </span><span class="c">! data sent by all the workers</span>
<a id="ln-3660" name="ln-3660" href="#ln-3660"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Reduce</span><span class="w"> </span><span class="p">(</span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DATATYPE_NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3661" name="ln-3661" href="#ln-3661"></a>
<a id="ln-3662" name="ln-3662" href="#ln-3662"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="w"></span>
<a id="ln-3663" name="ln-3663" href="#ln-3663"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">displs</span><span class="p">)</span><span class="w"></span>
<a id="ln-3664" name="ln-3664" href="#ln-3664"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span><span class="w"></span>
<a id="ln-3665" name="ln-3665" href="#ln-3665"></a>
<a id="ln-3666" name="ln-3666" href="#ln-3666"></a><span class="w">    </span><span class="k">RETURN</span>
<a id="ln-3667" name="ln-3667" href="#ln-3667"></a>
<a id="ln-3668" name="ln-3668" href="#ln-3668"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_intype</span><span class="w"></span>
<a id="ln-3669" name="ln-3669" href="#ln-3669"></a>
<a id="ln-3670" name="ln-3670" href="#ln-3670"></a><span class="w">  </span><span class="c">! MPI: creates send_t type to send the results to the master</span>
<a id="ln-3671" name="ln-3671" href="#ln-3671"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-3672" name="ln-3672" href="#ln-3672"></a><span class="w">  </span><span class="c">! list of fields that master needs to receive for use in write_output:</span>
<a id="ln-3673" name="ln-3673" href="#ln-3673"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-3674" name="ln-3674" href="#ln-3674"></a><span class="w">  </span><span class="c">! air%          rlam</span>
<a id="ln-3675" name="ln-3675" href="#ln-3675"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-3676" name="ln-3676" href="#ln-3676"></a><span class="w">  </span><span class="c">! canopy%       delwc, fe, fev, fh, fhs, fhv, fevw, fevc, fes, fnee, fpn, frday,</span>
<a id="ln-3677" name="ln-3677" href="#ln-3677"></a><span class="w">  </span><span class="c">!               frp, frs, ga, through, spill, tv, cansto,</span>
<a id="ln-3678" name="ln-3678" href="#ln-3678"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-3679" name="ln-3679" href="#ln-3679"></a><span class="w">  </span><span class="c">! met%          precip, precip_sn, fld, fsd, tk, pmb, qv, ua, ca,</span>
<a id="ln-3680" name="ln-3680" href="#ln-3680"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-3681" name="ln-3681" href="#ln-3681"></a><span class="w">  </span><span class="c">! rad%          albedo, qcan, qssabs, transd, flws</span>
<a id="ln-3682" name="ln-3682" href="#ln-3682"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-3683" name="ln-3683" href="#ln-3683"></a><span class="w">  </span><span class="c">! soil%         zse,</span>
<a id="ln-3684" name="ln-3684" href="#ln-3684"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-3685" name="ln-3685" href="#ln-3685"></a><span class="w">  </span><span class="c">! ssnow%        wb, snowd, osnowd, runoff, cls, rnof1, rnof2, tgg, tggsn, sdepth, isflag</span>
<a id="ln-3686" name="ln-3686" href="#ln-3686"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-3687" name="ln-3687" href="#ln-3687"></a><span class="w">  </span><span class="c">! veg%          vlai</span>
<a id="ln-3688" name="ln-3688" href="#ln-3688"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-3689" name="ln-3689" href="#ln-3689"></a><span class="w">  </span><span class="c">! Total: 47</span>
<a id="ln-3690" name="ln-3690" href="#ln-3690"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_outtype</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="n">met</span><span class="p">,</span><span class="n">canopy</span><span class="p">,</span><span class="n">ssnow</span><span class="p">,</span><span class="n">rad</span><span class="p">,</span><span class="n">bal</span><span class="p">,</span><span class="n">air</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">veg</span><span class="p">)</span><span class="w"></span>
<a id="ln-3691" name="ln-3691" href="#ln-3691"></a>
<a id="ln-3692" name="ln-3692" href="#ln-3692"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-3693" name="ln-3693" href="#ln-3693"></a>
<a id="ln-3694" name="ln-3694" href="#ln-3694"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-3695" name="ln-3695" href="#ln-3695"></a>
<a id="ln-3696" name="ln-3696" href="#ln-3696"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span>
<a id="ln-3697" name="ln-3697" href="#ln-3697"></a>
<a id="ln-3698" name="ln-3698" href="#ln-3698"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w"> </span><span class="c">! MPI communicator to talk to the workers</span>
<a id="ln-3699" name="ln-3699" href="#ln-3699"></a>
<a id="ln-3700" name="ln-3700" href="#ln-3700"></a><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">met_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">met</span><span class="w"></span>
<a id="ln-3701" name="ln-3701" href="#ln-3701"></a><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">canopy_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">canopy</span><span class="w"></span>
<a id="ln-3702" name="ln-3702" href="#ln-3702"></a><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">soil_snow_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ssnow</span><span class="w"></span>
<a id="ln-3703" name="ln-3703" href="#ln-3703"></a><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">radiation_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rad</span><span class="w"></span>
<a id="ln-3704" name="ln-3704" href="#ln-3704"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">balances_type</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="kd">::</span><span class="w"> </span><span class="n">bal</span><span class="w"></span>
<a id="ln-3705" name="ln-3705" href="#ln-3705"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">air_type</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">air</span><span class="w"></span>
<a id="ln-3706" name="ln-3706" href="#ln-3706"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">soil_parameter_type</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">soil</span><span class="w"> </span><span class="c">! soil parameters</span>
<a id="ln-3707" name="ln-3707" href="#ln-3707"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">veg_parameter_type</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">veg</span><span class="w"> </span><span class="c">! vegetation parameters</span>
<a id="ln-3708" name="ln-3708" href="#ln-3708"></a>
<a id="ln-3709" name="ln-3709" href="#ln-3709"></a><span class="w">    </span><span class="c">! MPI: temp arrays for marshalling all types into a struct</span>
<a id="ln-3710" name="ln-3710" href="#ln-3710"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blocks</span><span class="w"></span>
<a id="ln-3711" name="ln-3711" href="#ln-3711"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">displs</span><span class="w"></span>
<a id="ln-3712" name="ln-3712" href="#ln-3712"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<a id="ln-3713" name="ln-3713" href="#ln-3713"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntyp</span><span class="w"> </span><span class="c">! number of worker&#39;s types</span>
<a id="ln-3714" name="ln-3714" href="#ln-3714"></a>
<a id="ln-3715" name="ln-3715" href="#ln-3715"></a><span class="w">    </span><span class="c">! MPI: block lengths and strides for hvector representing matrices</span>
<a id="ln-3716" name="ln-3716" href="#ln-3716"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r1len</span><span class="p">,</span><span class="w"> </span><span class="n">r2len</span><span class="p">,</span><span class="w"> </span><span class="n">I1LEN</span><span class="p">,</span><span class="w"> </span><span class="n">llen</span><span class="w"></span>
<a id="ln-3717" name="ln-3717" href="#ln-3717"></a>
<a id="ln-3718" name="ln-3718" href="#ln-3718"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="w"></span>
<a id="ln-3719" name="ln-3719" href="#ln-3719"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">midx</span><span class="p">,</span><span class="w"> </span><span class="n">vidx</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-3720" name="ln-3720" href="#ln-3720"></a>
<a id="ln-3721" name="ln-3721" href="#ln-3721"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tsize</span><span class="w"></span>
<a id="ln-3722" name="ln-3722" href="#ln-3722"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-3723" name="ln-3723" href="#ln-3723"></a>
<a id="ln-3724" name="ln-3724" href="#ln-3724"></a><span class="w">    </span><span class="c">! base index to make types indexing easier</span>
<a id="ln-3725" name="ln-3725" href="#ln-3725"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">istart</span><span class="w"></span>
<a id="ln-3726" name="ln-3726" href="#ln-3726"></a>
<a id="ln-3727" name="ln-3727" href="#ln-3727"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<a id="ln-3728" name="ln-3728" href="#ln-3728"></a>
<a id="ln-3729" name="ln-3729" href="#ln-3729"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Comm_rank</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3730" name="ln-3730" href="#ln-3730"></a>
<a id="ln-3731" name="ln-3731" href="#ln-3731"></a><span class="w">    </span><span class="c">! MPI: calculate the sizes/extents of Fortran types used by</span>
<a id="ln-3732" name="ln-3732" href="#ln-3732"></a><span class="w">    </span><span class="c">! CABLE</span>
<a id="ln-3733" name="ln-3733" href="#ln-3733"></a><span class="w">    </span><span class="k">CALL </span><span class="n">find_extents</span><span class="w"></span>
<a id="ln-3734" name="ln-3734" href="#ln-3734"></a>
<a id="ln-3735" name="ln-3735" href="#ln-3735"></a><span class="w">    </span><span class="c">! MPI: allocate temp vectors used for marshalling</span>
<a id="ln-3736" name="ln-3736" href="#ln-3736"></a><span class="w">    </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n3d</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nmat</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nvec</span><span class="w"></span>
<a id="ln-3737" name="ln-3737" href="#ln-3737"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">blocks</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-3738" name="ln-3738" href="#ln-3738"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">displs</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-3739" name="ln-3739" href="#ln-3739"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-3740" name="ln-3740" href="#ln-3740"></a>
<a id="ln-3741" name="ln-3741" href="#ln-3741"></a><span class="w">    </span><span class="c">! MPI: should work because worker versions of CABLE variables</span>
<a id="ln-3742" name="ln-3742" href="#ln-3742"></a><span class="w">    </span><span class="c">! are allocated with starting index set to patch0</span>
<a id="ln-3743" name="ln-3743" href="#ln-3743"></a><span class="w">    </span><span class="c">!off = wpatch%patch0</span>
<a id="ln-3744" name="ln-3744" href="#ln-3744"></a><span class="w">    </span><span class="c">!cnt = wpatch%npatch</span>
<a id="ln-3745" name="ln-3745" href="#ln-3745"></a><span class="w">    </span><span class="c">! MPI: new version, all arrays indices run 1:mp</span>
<a id="ln-3746" name="ln-3746" href="#ln-3746"></a><span class="w">    </span><span class="n">off</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3747" name="ln-3747" href="#ln-3747"></a><span class="w">    </span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"></span>
<a id="ln-3748" name="ln-3748" href="#ln-3748"></a>
<a id="ln-3749" name="ln-3749" href="#ln-3749"></a><span class="w">    </span><span class="n">r1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-3750" name="ln-3750" href="#ln-3750"></a><span class="w">    </span><span class="n">r2len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-3751" name="ln-3751" href="#ln-3751"></a><span class="w">    </span><span class="n">I1LEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-3752" name="ln-3752" href="#ln-3752"></a><span class="w">    </span><span class="n">llen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extl</span><span class="w"></span>
<a id="ln-3753" name="ln-3753" href="#ln-3753"></a>
<a id="ln-3754" name="ln-3754" href="#ln-3754"></a><span class="w">    </span><span class="c">! ------------- 3D arrays -------------</span>
<a id="ln-3755" name="ln-3755" href="#ln-3755"></a>
<a id="ln-3756" name="ln-3756" href="#ln-3756"></a><span class="w">    </span><span class="c">! rad 3D</span>
<a id="ln-3757" name="ln-3757" href="#ln-3757"></a><span class="w">    </span><span class="c">! TODO: REAL(r_1) : rad%qcan(landunits,mf,nrb)</span>
<a id="ln-3758" name="ln-3758" href="#ln-3758"></a><span class="w">    </span><span class="c">! CALL MPI_Type_create_hvector (mf*nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3759" name="ln-3759" href="#ln-3759"></a><span class="w">    </span><span class="c">!  &amp;            m3d_t(1, rank), ierr)</span>
<a id="ln-3760" name="ln-3760" href="#ln-3760"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3761" name="ln-3761" href="#ln-3761"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">qcan</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3762" name="ln-3762" href="#ln-3762"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mf</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-3763" name="ln-3763" href="#ln-3763"></a>
<a id="ln-3764" name="ln-3764" href="#ln-3764"></a><span class="w">    </span><span class="c">! ------------- 2D arrays -------------</span>
<a id="ln-3765" name="ln-3765" href="#ln-3765"></a>
<a id="ln-3766" name="ln-3766" href="#ln-3766"></a><span class="w">    </span><span class="c">! MPI: an hvector type for each vector, maddr contains displacements</span>
<a id="ln-3767" name="ln-3767" href="#ln-3767"></a><span class="w">    </span><span class="c">! for bundling these hvectors into the struct later</span>
<a id="ln-3768" name="ln-3768" href="#ln-3768"></a><span class="w">    </span><span class="c">! block length is number of patches/worker * type extent</span>
<a id="ln-3769" name="ln-3769" href="#ln-3769"></a><span class="w">    </span><span class="c">! stride is global number of patches * type extent</span>
<a id="ln-3770" name="ln-3770" href="#ln-3770"></a><span class="w">    </span><span class="c">! repeat/no of blocks is the 2nd rank</span>
<a id="ln-3771" name="ln-3771" href="#ln-3771"></a>
<a id="ln-3772" name="ln-3772" href="#ln-3772"></a><span class="w">    </span><span class="c">! met 2D</span>
<a id="ln-3773" name="ln-3773" href="#ln-3773"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3774" name="ln-3774" href="#ln-3774"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">fsd</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3775" name="ln-3775" href="#ln-3775"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">swb</span><span class="w"></span>
<a id="ln-3776" name="ln-3776" href="#ln-3776"></a>
<a id="ln-3777" name="ln-3777" href="#ln-3777"></a><span class="w">    </span><span class="c">! canopy 2D</span>
<a id="ln-3778" name="ln-3778" href="#ln-3778"></a><span class="w">    </span><span class="c">!midx = 1</span>
<a id="ln-3779" name="ln-3779" href="#ln-3779"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3780" name="ln-3780" href="#ln-3780"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%rwater(off,1), maddr(midx), ierr) ! 1</span>
<a id="ln-3781" name="ln-3781" href="#ln-3781"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (ms, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3782" name="ln-3782" href="#ln-3782"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3783" name="ln-3783" href="#ln-3783"></a>
<a id="ln-3784" name="ln-3784" href="#ln-3784"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-3785" name="ln-3785" href="#ln-3785"></a><span class="w">    </span><span class="c">!  bidx = bidx + 1</span>
<a id="ln-3786" name="ln-3786" href="#ln-3786"></a><span class="w">    </span><span class="c">!  CALL MPI_Get_address (canopy%rwater(off,1), displs(bidx), ierr)</span>
<a id="ln-3787" name="ln-3787" href="#ln-3787"></a><span class="w">    </span><span class="c">!  blocks(bidx) = r1len * ms</span>
<a id="ln-3788" name="ln-3788" href="#ln-3788"></a>
<a id="ln-3789" name="ln-3789" href="#ln-3789"></a><span class="w">    </span><span class="c">! midx = midx + 1</span>
<a id="ln-3790" name="ln-3790" href="#ln-3790"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-3791" name="ln-3791" href="#ln-3791"></a><span class="w">    </span><span class="c">! CALL MPI_Get_address (canopy%evapfbl(off,1), maddr(midx), ierr) ! 2</span>
<a id="ln-3792" name="ln-3792" href="#ln-3792"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (ms, r2len, r2stride, MPI_BYTE, &amp;</span>
<a id="ln-3793" name="ln-3793" href="#ln-3793"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3794" name="ln-3794" href="#ln-3794"></a>
<a id="ln-3795" name="ln-3795" href="#ln-3795"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-3796" name="ln-3796" href="#ln-3796"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3797" name="ln-3797" href="#ln-3797"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">evapfbl</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3798" name="ln-3798" href="#ln-3798"></a><span class="w">    </span><span class="c">! MPI: gol124: changed to r1 when Bernard ported to CABLE_r491</span>
<a id="ln-3799" name="ln-3799" href="#ln-3799"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3800" name="ln-3800" href="#ln-3800"></a>
<a id="ln-3801" name="ln-3801" href="#ln-3801"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3802" name="ln-3802" href="#ln-3802"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">gswx</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3803" name="ln-3803" href="#ln-3803"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mf</span><span class="w"></span>
<a id="ln-3804" name="ln-3804" href="#ln-3804"></a>
<a id="ln-3805" name="ln-3805" href="#ln-3805"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3806" name="ln-3806" href="#ln-3806"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">zetar</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3807" name="ln-3807" href="#ln-3807"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">niter</span><span class="w"></span>
<a id="ln-3808" name="ln-3808" href="#ln-3808"></a>
<a id="ln-3809" name="ln-3809" href="#ln-3809"></a><span class="w">    </span><span class="c">! ssnow 2D</span>
<a id="ln-3810" name="ln-3810" href="#ln-3810"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3811" name="ln-3811" href="#ln-3811"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">dtmlt</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3812" name="ln-3812" href="#ln-3812"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<a id="ln-3813" name="ln-3813" href="#ln-3813"></a>
<a id="ln-3814" name="ln-3814" href="#ln-3814"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3815" name="ln-3815" href="#ln-3815"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3816" name="ln-3816" href="#ln-3816"></a><span class="w">    </span><span class="c">! CALL MPI_Get_address (ssnow%albsoilsn(off,1), maddr(midx), ierr) ! 3</span>
<a id="ln-3817" name="ln-3817" href="#ln-3817"></a><span class="w">    </span><span class="c">! CALL MPI_Type_create_hvector (nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3818" name="ln-3818" href="#ln-3818"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3819" name="ln-3819" href="#ln-3819"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3820" name="ln-3820" href="#ln-3820"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3821" name="ln-3821" href="#ln-3821"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">albsoilsn</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3822" name="ln-3822" href="#ln-3822"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-3823" name="ln-3823" href="#ln-3823"></a>
<a id="ln-3824" name="ln-3824" href="#ln-3824"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-3825" name="ln-3825" href="#ln-3825"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%gammzz(off,1), maddr(midx), ierr) ! 4</span>
<a id="ln-3826" name="ln-3826" href="#ln-3826"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (ms, r2len, r2stride, MPI_BYTE, &amp;</span>
<a id="ln-3827" name="ln-3827" href="#ln-3827"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3828" name="ln-3828" href="#ln-3828"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3829" name="ln-3829" href="#ln-3829"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">gammzz</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3830" name="ln-3830" href="#ln-3830"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3831" name="ln-3831" href="#ln-3831"></a>
<a id="ln-3832" name="ln-3832" href="#ln-3832"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3833" name="ln-3833" href="#ln-3833"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3834" name="ln-3834" href="#ln-3834"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%sconds(off,1), maddr(midx), ierr) ! 5</span>
<a id="ln-3835" name="ln-3835" href="#ln-3835"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (msn, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3836" name="ln-3836" href="#ln-3836"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3837" name="ln-3837" href="#ln-3837"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3838" name="ln-3838" href="#ln-3838"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">sconds</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3839" name="ln-3839" href="#ln-3839"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msn</span><span class="w"></span>
<a id="ln-3840" name="ln-3840" href="#ln-3840"></a>
<a id="ln-3841" name="ln-3841" href="#ln-3841"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3842" name="ln-3842" href="#ln-3842"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3843" name="ln-3843" href="#ln-3843"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%sdepth(off,1), maddr(midx), ierr) ! 6</span>
<a id="ln-3844" name="ln-3844" href="#ln-3844"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (msn, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3845" name="ln-3845" href="#ln-3845"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3846" name="ln-3846" href="#ln-3846"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3847" name="ln-3847" href="#ln-3847"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">sdepth</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3848" name="ln-3848" href="#ln-3848"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msn</span><span class="w"></span>
<a id="ln-3849" name="ln-3849" href="#ln-3849"></a>
<a id="ln-3850" name="ln-3850" href="#ln-3850"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3851" name="ln-3851" href="#ln-3851"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3852" name="ln-3852" href="#ln-3852"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%smass(off,1), maddr(midx), ierr) ! 7</span>
<a id="ln-3853" name="ln-3853" href="#ln-3853"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (msn, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3854" name="ln-3854" href="#ln-3854"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3855" name="ln-3855" href="#ln-3855"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3856" name="ln-3856" href="#ln-3856"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">smass</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3857" name="ln-3857" href="#ln-3857"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msn</span><span class="w"></span>
<a id="ln-3858" name="ln-3858" href="#ln-3858"></a>
<a id="ln-3859" name="ln-3859" href="#ln-3859"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3860" name="ln-3860" href="#ln-3860"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3861" name="ln-3861" href="#ln-3861"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%dtmlt(off,1), maddr(midx), ierr) ! 8</span>
<a id="ln-3862" name="ln-3862" href="#ln-3862"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (msn, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3863" name="ln-3863" href="#ln-3863"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3864" name="ln-3864" href="#ln-3864"></a><span class="w">    </span><span class="c">! MPI: r1134 does not know about this field, comment out</span>
<a id="ln-3865" name="ln-3865" href="#ln-3865"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-3866" name="ln-3866" href="#ln-3866"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%dtmlt(off,1), displs(bidx), ierr)</span>
<a id="ln-3867" name="ln-3867" href="#ln-3867"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len * msn</span>
<a id="ln-3868" name="ln-3868" href="#ln-3868"></a>
<a id="ln-3869" name="ln-3869" href="#ln-3869"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3870" name="ln-3870" href="#ln-3870"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3871" name="ln-3871" href="#ln-3871"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%ssdn(off,1), maddr(midx), ierr) ! 9</span>
<a id="ln-3872" name="ln-3872" href="#ln-3872"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (msn, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3873" name="ln-3873" href="#ln-3873"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3874" name="ln-3874" href="#ln-3874"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3875" name="ln-3875" href="#ln-3875"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">ssdn</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3876" name="ln-3876" href="#ln-3876"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msn</span><span class="w"></span>
<a id="ln-3877" name="ln-3877" href="#ln-3877"></a>
<a id="ln-3878" name="ln-3878" href="#ln-3878"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3879" name="ln-3879" href="#ln-3879"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3880" name="ln-3880" href="#ln-3880"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%tgg(off,1), maddr(midx), ierr) ! 10</span>
<a id="ln-3881" name="ln-3881" href="#ln-3881"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (ms, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3882" name="ln-3882" href="#ln-3882"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3883" name="ln-3883" href="#ln-3883"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3884" name="ln-3884" href="#ln-3884"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tgg</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3885" name="ln-3885" href="#ln-3885"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3886" name="ln-3886" href="#ln-3886"></a>
<a id="ln-3887" name="ln-3887" href="#ln-3887"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3888" name="ln-3888" href="#ln-3888"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3889" name="ln-3889" href="#ln-3889"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%tggsn(off,1), maddr(midx), ierr) ! 11</span>
<a id="ln-3890" name="ln-3890" href="#ln-3890"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (msn, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3891" name="ln-3891" href="#ln-3891"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3892" name="ln-3892" href="#ln-3892"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3893" name="ln-3893" href="#ln-3893"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tggsn</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3894" name="ln-3894" href="#ln-3894"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msn</span><span class="w"></span>
<a id="ln-3895" name="ln-3895" href="#ln-3895"></a>
<a id="ln-3896" name="ln-3896" href="#ln-3896"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3897" name="ln-3897" href="#ln-3897"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-3898" name="ln-3898" href="#ln-3898"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%wb(off,1), maddr(midx), ierr) ! 12</span>
<a id="ln-3899" name="ln-3899" href="#ln-3899"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (ms, r2len, r2stride, MPI_BYTE, &amp;</span>
<a id="ln-3900" name="ln-3900" href="#ln-3900"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3901" name="ln-3901" href="#ln-3901"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3902" name="ln-3902" href="#ln-3902"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wb</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3903" name="ln-3903" href="#ln-3903"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3904" name="ln-3904" href="#ln-3904"></a>
<a id="ln-3905" name="ln-3905" href="#ln-3905"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3906" name="ln-3906" href="#ln-3906"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">evapfbl</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3907" name="ln-3907" href="#ln-3907"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3908" name="ln-3908" href="#ln-3908"></a>
<a id="ln-3909" name="ln-3909" href="#ln-3909"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3910" name="ln-3910" href="#ln-3910"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3911" name="ln-3911" href="#ln-3911"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%wbfice(off,1), maddr(midx), ierr) ! 13</span>
<a id="ln-3912" name="ln-3912" href="#ln-3912"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (ms, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3913" name="ln-3913" href="#ln-3913"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3914" name="ln-3914" href="#ln-3914"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3915" name="ln-3915" href="#ln-3915"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wbfice</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3916" name="ln-3916" href="#ln-3916"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3917" name="ln-3917" href="#ln-3917"></a>
<a id="ln-3918" name="ln-3918" href="#ln-3918"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3919" name="ln-3919" href="#ln-3919"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-3920" name="ln-3920" href="#ln-3920"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%wbice(off,1), maddr(midx), ierr) ! 14</span>
<a id="ln-3921" name="ln-3921" href="#ln-3921"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (ms, r2len, r2stride, MPI_BYTE, &amp;</span>
<a id="ln-3922" name="ln-3922" href="#ln-3922"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3923" name="ln-3923" href="#ln-3923"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3924" name="ln-3924" href="#ln-3924"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wbice</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3925" name="ln-3925" href="#ln-3925"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3926" name="ln-3926" href="#ln-3926"></a>
<a id="ln-3927" name="ln-3927" href="#ln-3927"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3928" name="ln-3928" href="#ln-3928"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-3929" name="ln-3929" href="#ln-3929"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%wblf(off,1), maddr(midx), ierr) ! 15</span>
<a id="ln-3930" name="ln-3930" href="#ln-3930"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (ms, r2len, r2stride, MPI_BYTE, &amp;</span>
<a id="ln-3931" name="ln-3931" href="#ln-3931"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3932" name="ln-3932" href="#ln-3932"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3933" name="ln-3933" href="#ln-3933"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wblf</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3934" name="ln-3934" href="#ln-3934"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3935" name="ln-3935" href="#ln-3935"></a><span class="w">    </span><span class="c">! additional  for sli</span>
<a id="ln-3936" name="ln-3936" href="#ln-3936"></a>
<a id="ln-3937" name="ln-3937" href="#ln-3937"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3938" name="ln-3938" href="#ln-3938"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">S</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3939" name="ln-3939" href="#ln-3939"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3940" name="ln-3940" href="#ln-3940"></a>
<a id="ln-3941" name="ln-3941" href="#ln-3941"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3942" name="ln-3942" href="#ln-3942"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">Tsoil</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3943" name="ln-3943" href="#ln-3943"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3944" name="ln-3944" href="#ln-3944"></a>
<a id="ln-3945" name="ln-3945" href="#ln-3945"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3946" name="ln-3946" href="#ln-3946"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">thetai</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3947" name="ln-3947" href="#ln-3947"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-3948" name="ln-3948" href="#ln-3948"></a>
<a id="ln-3949" name="ln-3949" href="#ln-3949"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3950" name="ln-3950" href="#ln-3950"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">snowliq</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3951" name="ln-3951" href="#ln-3951"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<a id="ln-3952" name="ln-3952" href="#ln-3952"></a>
<a id="ln-3953" name="ln-3953" href="#ln-3953"></a><span class="w">    </span><span class="c">! end additional for sli</span>
<a id="ln-3954" name="ln-3954" href="#ln-3954"></a>
<a id="ln-3955" name="ln-3955" href="#ln-3955"></a><span class="w">    </span><span class="c">! rad 2D</span>
<a id="ln-3956" name="ln-3956" href="#ln-3956"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3957" name="ln-3957" href="#ln-3957"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">fbeam</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3958" name="ln-3958" href="#ln-3958"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-3959" name="ln-3959" href="#ln-3959"></a>
<a id="ln-3960" name="ln-3960" href="#ln-3960"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3961" name="ln-3961" href="#ln-3961"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3962" name="ln-3962" href="#ln-3962"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%albedo(off,1), maddr(midx), ierr) ! 16</span>
<a id="ln-3963" name="ln-3963" href="#ln-3963"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3964" name="ln-3964" href="#ln-3964"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3965" name="ln-3965" href="#ln-3965"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3966" name="ln-3966" href="#ln-3966"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">albedo</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3967" name="ln-3967" href="#ln-3967"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-3968" name="ln-3968" href="#ln-3968"></a>
<a id="ln-3969" name="ln-3969" href="#ln-3969"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3970" name="ln-3970" href="#ln-3970"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3971" name="ln-3971" href="#ln-3971"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%fvlai(off,1), maddr(midx), ierr) ! 17</span>
<a id="ln-3972" name="ln-3972" href="#ln-3972"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (mf, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3973" name="ln-3973" href="#ln-3973"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3974" name="ln-3974" href="#ln-3974"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3975" name="ln-3975" href="#ln-3975"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">fvlai</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3976" name="ln-3976" href="#ln-3976"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mf</span><span class="w"></span>
<a id="ln-3977" name="ln-3977" href="#ln-3977"></a>
<a id="ln-3978" name="ln-3978" href="#ln-3978"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3979" name="ln-3979" href="#ln-3979"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-3980" name="ln-3980" href="#ln-3980"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%gradis(off,1), maddr(midx), ierr) ! 18</span>
<a id="ln-3981" name="ln-3981" href="#ln-3981"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (mf, r2len, r2stride, MPI_BYTE, &amp;</span>
<a id="ln-3982" name="ln-3982" href="#ln-3982"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3983" name="ln-3983" href="#ln-3983"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3984" name="ln-3984" href="#ln-3984"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">gradis</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3985" name="ln-3985" href="#ln-3985"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mf</span><span class="w"></span>
<a id="ln-3986" name="ln-3986" href="#ln-3986"></a>
<a id="ln-3987" name="ln-3987" href="#ln-3987"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3988" name="ln-3988" href="#ln-3988"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3989" name="ln-3989" href="#ln-3989"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%rhocdf(off,1), maddr(midx), ierr) ! 19</span>
<a id="ln-3990" name="ln-3990" href="#ln-3990"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-3991" name="ln-3991" href="#ln-3991"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-3992" name="ln-3992" href="#ln-3992"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-3993" name="ln-3993" href="#ln-3993"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">rhocdf</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-3994" name="ln-3994" href="#ln-3994"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-3995" name="ln-3995" href="#ln-3995"></a>
<a id="ln-3996" name="ln-3996" href="#ln-3996"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-3997" name="ln-3997" href="#ln-3997"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-3998" name="ln-3998" href="#ln-3998"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%rniso(off,1), maddr(midx), ierr) ! 20</span>
<a id="ln-3999" name="ln-3999" href="#ln-3999"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (mf, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-4000" name="ln-4000" href="#ln-4000"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-4001" name="ln-4001" href="#ln-4001"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4002" name="ln-4002" href="#ln-4002"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">rniso</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4003" name="ln-4003" href="#ln-4003"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mf</span><span class="w"></span>
<a id="ln-4004" name="ln-4004" href="#ln-4004"></a>
<a id="ln-4005" name="ln-4005" href="#ln-4005"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-4006" name="ln-4006" href="#ln-4006"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4007" name="ln-4007" href="#ln-4007"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%scalex(off,1), maddr(midx), ierr) ! 21</span>
<a id="ln-4008" name="ln-4008" href="#ln-4008"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (mf, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-4009" name="ln-4009" href="#ln-4009"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-4010" name="ln-4010" href="#ln-4010"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4011" name="ln-4011" href="#ln-4011"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">scalex</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4012" name="ln-4012" href="#ln-4012"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mf</span><span class="w"></span>
<a id="ln-4013" name="ln-4013" href="#ln-4013"></a>
<a id="ln-4014" name="ln-4014" href="#ln-4014"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-4015" name="ln-4015" href="#ln-4015"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4016" name="ln-4016" href="#ln-4016"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%reffdf(off,1), maddr(midx), ierr) ! 22</span>
<a id="ln-4017" name="ln-4017" href="#ln-4017"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-4018" name="ln-4018" href="#ln-4018"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-4019" name="ln-4019" href="#ln-4019"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4020" name="ln-4020" href="#ln-4020"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">reffdf</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4021" name="ln-4021" href="#ln-4021"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-4022" name="ln-4022" href="#ln-4022"></a>
<a id="ln-4023" name="ln-4023" href="#ln-4023"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-4024" name="ln-4024" href="#ln-4024"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4025" name="ln-4025" href="#ln-4025"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%reffbm(off,1), maddr(midx), ierr) ! 23</span>
<a id="ln-4026" name="ln-4026" href="#ln-4026"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-4027" name="ln-4027" href="#ln-4027"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-4028" name="ln-4028" href="#ln-4028"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4029" name="ln-4029" href="#ln-4029"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">reffbm</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4030" name="ln-4030" href="#ln-4030"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-4031" name="ln-4031" href="#ln-4031"></a>
<a id="ln-4032" name="ln-4032" href="#ln-4032"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-4033" name="ln-4033" href="#ln-4033"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4034" name="ln-4034" href="#ln-4034"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%extkbm(off,1), maddr(midx), ierr) ! 24</span>
<a id="ln-4035" name="ln-4035" href="#ln-4035"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-4036" name="ln-4036" href="#ln-4036"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-4037" name="ln-4037" href="#ln-4037"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4038" name="ln-4038" href="#ln-4038"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">extkbm</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4039" name="ln-4039" href="#ln-4039"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-4040" name="ln-4040" href="#ln-4040"></a>
<a id="ln-4041" name="ln-4041" href="#ln-4041"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-4042" name="ln-4042" href="#ln-4042"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4043" name="ln-4043" href="#ln-4043"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%extkdm(off,1), maddr(midx), ierr) ! 25</span>
<a id="ln-4044" name="ln-4044" href="#ln-4044"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-4045" name="ln-4045" href="#ln-4045"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-4046" name="ln-4046" href="#ln-4046"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4047" name="ln-4047" href="#ln-4047"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">extkdm</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4048" name="ln-4048" href="#ln-4048"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-4049" name="ln-4049" href="#ln-4049"></a>
<a id="ln-4050" name="ln-4050" href="#ln-4050"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-4051" name="ln-4051" href="#ln-4051"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4052" name="ln-4052" href="#ln-4052"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%cexpkbm(off,1), maddr(midx), ierr) ! 26</span>
<a id="ln-4053" name="ln-4053" href="#ln-4053"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-4054" name="ln-4054" href="#ln-4054"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-4055" name="ln-4055" href="#ln-4055"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4056" name="ln-4056" href="#ln-4056"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">cexpkbm</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4057" name="ln-4057" href="#ln-4057"></a><span class="w">    </span><span class="c">! Maciej: cexpkbm is mp*swb</span>
<a id="ln-4058" name="ln-4058" href="#ln-4058"></a><span class="w">    </span><span class="c">!    blocks(bidx) = r1len * nrb</span>
<a id="ln-4059" name="ln-4059" href="#ln-4059"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">swb</span><span class="w"></span>
<a id="ln-4060" name="ln-4060" href="#ln-4060"></a>
<a id="ln-4061" name="ln-4061" href="#ln-4061"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-4062" name="ln-4062" href="#ln-4062"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4063" name="ln-4063" href="#ln-4063"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%cexpkdm(off,1), maddr(midx), ierr) ! 27</span>
<a id="ln-4064" name="ln-4064" href="#ln-4064"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-4065" name="ln-4065" href="#ln-4065"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-4066" name="ln-4066" href="#ln-4066"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4067" name="ln-4067" href="#ln-4067"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">cexpkdm</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4068" name="ln-4068" href="#ln-4068"></a><span class="w">    </span><span class="c">! Maciej: cexpkdm is mp*swb</span>
<a id="ln-4069" name="ln-4069" href="#ln-4069"></a><span class="w">    </span><span class="c">!    blocks(bidx) = r1len * nrb</span>
<a id="ln-4070" name="ln-4070" href="#ln-4070"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">swb</span><span class="w"></span>
<a id="ln-4071" name="ln-4071" href="#ln-4071"></a>
<a id="ln-4072" name="ln-4072" href="#ln-4072"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4073" name="ln-4073" href="#ln-4073"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">rhocbm</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4074" name="ln-4074" href="#ln-4074"></a><span class="w">    </span><span class="c">! Maciej: rhocbm is mp*nrb</span>
<a id="ln-4075" name="ln-4075" href="#ln-4075"></a><span class="w">    </span><span class="c">!    blocks(bidx) = r1len * swb</span>
<a id="ln-4076" name="ln-4076" href="#ln-4076"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-4077" name="ln-4077" href="#ln-4077"></a>
<a id="ln-4078" name="ln-4078" href="#ln-4078"></a>
<a id="ln-4079" name="ln-4079" href="#ln-4079"></a><span class="w">    </span><span class="c">! air 2D - all fields 1D - skipped</span>
<a id="ln-4080" name="ln-4080" href="#ln-4080"></a>
<a id="ln-4081" name="ln-4081" href="#ln-4081"></a><span class="w">    </span><span class="c">! soil 2D</span>
<a id="ln-4082" name="ln-4082" href="#ln-4082"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-4083" name="ln-4083" href="#ln-4083"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4084" name="ln-4084" href="#ln-4084"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%albsoil(off,1), maddr(midx), ierr) ! 28</span>
<a id="ln-4085" name="ln-4085" href="#ln-4085"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (nrb, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-4086" name="ln-4086" href="#ln-4086"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-4087" name="ln-4087" href="#ln-4087"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4088" name="ln-4088" href="#ln-4088"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">albsoil</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4089" name="ln-4089" href="#ln-4089"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrb</span><span class="w"></span>
<a id="ln-4090" name="ln-4090" href="#ln-4090"></a>
<a id="ln-4091" name="ln-4091" href="#ln-4091"></a>
<a id="ln-4092" name="ln-4092" href="#ln-4092"></a><span class="w">    </span><span class="c">! veg 2D</span>
<a id="ln-4093" name="ln-4093" href="#ln-4093"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4094" name="ln-4094" href="#ln-4094"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">refl</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4095" name="ln-4095" href="#ln-4095"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-4096" name="ln-4096" href="#ln-4096"></a>
<a id="ln-4097" name="ln-4097" href="#ln-4097"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4098" name="ln-4098" href="#ln-4098"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">taul</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4099" name="ln-4099" href="#ln-4099"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-4100" name="ln-4100" href="#ln-4100"></a>
<a id="ln-4101" name="ln-4101" href="#ln-4101"></a><span class="w">    </span><span class="c">!midx = midx + 1</span>
<a id="ln-4102" name="ln-4102" href="#ln-4102"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4103" name="ln-4103" href="#ln-4103"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%froot(off,1), maddr(midx), ierr) ! 29</span>
<a id="ln-4104" name="ln-4104" href="#ln-4104"></a><span class="w">    </span><span class="c">!CALL MPI_Type_create_hvector (ms, r1len, r1stride, MPI_BYTE, &amp;</span>
<a id="ln-4105" name="ln-4105" href="#ln-4105"></a><span class="w">    </span><span class="c">!  &amp;            mat_t(midx, rank), ierr)</span>
<a id="ln-4106" name="ln-4106" href="#ln-4106"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4107" name="ln-4107" href="#ln-4107"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">froot</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4108" name="ln-4108" href="#ln-4108"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-4109" name="ln-4109" href="#ln-4109"></a>
<a id="ln-4110" name="ln-4110" href="#ln-4110"></a>
<a id="ln-4111" name="ln-4111" href="#ln-4111"></a>
<a id="ln-4112" name="ln-4112" href="#ln-4112"></a><span class="w">    </span><span class="c">! ------------- 1D arrays -------------</span>
<a id="ln-4113" name="ln-4113" href="#ln-4113"></a>
<a id="ln-4114" name="ln-4114" href="#ln-4114"></a><span class="w">    </span><span class="c">! met</span>
<a id="ln-4115" name="ln-4115" href="#ln-4115"></a><span class="w">    </span><span class="c">!vidx = 1</span>
<a id="ln-4116" name="ln-4116" href="#ln-4116"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4117" name="ln-4117" href="#ln-4117"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%ca(off), vaddr(vidx), ierr) ! 1</span>
<a id="ln-4118" name="ln-4118" href="#ln-4118"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4119" name="ln-4119" href="#ln-4119"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4120" name="ln-4120" href="#ln-4120"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">ca</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4121" name="ln-4121" href="#ln-4121"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4122" name="ln-4122" href="#ln-4122"></a>
<a id="ln-4123" name="ln-4123" href="#ln-4123"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4124" name="ln-4124" href="#ln-4124"></a><span class="w">    </span><span class="c">! INTEGER(i_d)</span>
<a id="ln-4125" name="ln-4125" href="#ln-4125"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%year(off), vaddr(vidx), ierr) ! 2</span>
<a id="ln-4126" name="ln-4126" href="#ln-4126"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extid</span>
<a id="ln-4127" name="ln-4127" href="#ln-4127"></a><span class="w">    </span><span class="c">! gol124: not output, removed</span>
<a id="ln-4128" name="ln-4128" href="#ln-4128"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-4129" name="ln-4129" href="#ln-4129"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%year(off), displs(bidx), ierr)</span>
<a id="ln-4130" name="ln-4130" href="#ln-4130"></a><span class="w">    </span><span class="c">!blocks(bidx) = I1LEN</span>
<a id="ln-4131" name="ln-4131" href="#ln-4131"></a>
<a id="ln-4132" name="ln-4132" href="#ln-4132"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4133" name="ln-4133" href="#ln-4133"></a><span class="w">    </span><span class="c">! INTEGER(i_d)</span>
<a id="ln-4134" name="ln-4134" href="#ln-4134"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%moy(off), vaddr(vidx), ierr) ! 3</span>
<a id="ln-4135" name="ln-4135" href="#ln-4135"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extid</span>
<a id="ln-4136" name="ln-4136" href="#ln-4136"></a><span class="w">    </span><span class="c">! gol124: not output, removed</span>
<a id="ln-4137" name="ln-4137" href="#ln-4137"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-4138" name="ln-4138" href="#ln-4138"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%moy(off), displs(bidx), ierr)</span>
<a id="ln-4139" name="ln-4139" href="#ln-4139"></a><span class="w">    </span><span class="c">!blocks(bidx) = I1LEN</span>
<a id="ln-4140" name="ln-4140" href="#ln-4140"></a>
<a id="ln-4141" name="ln-4141" href="#ln-4141"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4142" name="ln-4142" href="#ln-4142"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4143" name="ln-4143" href="#ln-4143"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%doy(off), vaddr(vidx), ierr) ! 4</span>
<a id="ln-4144" name="ln-4144" href="#ln-4144"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4145" name="ln-4145" href="#ln-4145"></a><span class="w">    </span><span class="c">! gol124: not output, removed</span>
<a id="ln-4146" name="ln-4146" href="#ln-4146"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-4147" name="ln-4147" href="#ln-4147"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%doy(off), displs(bidx), ierr)</span>
<a id="ln-4148" name="ln-4148" href="#ln-4148"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-4149" name="ln-4149" href="#ln-4149"></a>
<a id="ln-4150" name="ln-4150" href="#ln-4150"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4151" name="ln-4151" href="#ln-4151"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4152" name="ln-4152" href="#ln-4152"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%hod(off), vaddr(vidx), ierr) ! 5</span>
<a id="ln-4153" name="ln-4153" href="#ln-4153"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4154" name="ln-4154" href="#ln-4154"></a><span class="w">    </span><span class="c">! gol124: not output, removed</span>
<a id="ln-4155" name="ln-4155" href="#ln-4155"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-4156" name="ln-4156" href="#ln-4156"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%hod(off), displs(bidx), ierr)</span>
<a id="ln-4157" name="ln-4157" href="#ln-4157"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-4158" name="ln-4158" href="#ln-4158"></a>
<a id="ln-4159" name="ln-4159" href="#ln-4159"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4160" name="ln-4160" href="#ln-4160"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4161" name="ln-4161" href="#ln-4161"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%fsd(off), vaddr(vidx), ierr)</span>
<a id="ln-4162" name="ln-4162" href="#ln-4162"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4163" name="ln-4163" href="#ln-4163"></a><span class="w">    </span><span class="c">! MPI: gol124: changed to 2D and move up when Bernard</span>
<a id="ln-4164" name="ln-4164" href="#ln-4164"></a><span class="w">    </span><span class="c">! ported to CABLE_r491</span>
<a id="ln-4165" name="ln-4165" href="#ln-4165"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-4166" name="ln-4166" href="#ln-4166"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%fsd(off,1), displs(bidx), ierr)</span>
<a id="ln-4167" name="ln-4167" href="#ln-4167"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-4168" name="ln-4168" href="#ln-4168"></a>
<a id="ln-4169" name="ln-4169" href="#ln-4169"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4170" name="ln-4170" href="#ln-4170"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4171" name="ln-4171" href="#ln-4171"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%fld(off), vaddr(vidx), ierr)</span>
<a id="ln-4172" name="ln-4172" href="#ln-4172"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4173" name="ln-4173" href="#ln-4173"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4174" name="ln-4174" href="#ln-4174"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">fld</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4175" name="ln-4175" href="#ln-4175"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4176" name="ln-4176" href="#ln-4176"></a>
<a id="ln-4177" name="ln-4177" href="#ln-4177"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4178" name="ln-4178" href="#ln-4178"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4179" name="ln-4179" href="#ln-4179"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%precip(off), vaddr(vidx), ierr)</span>
<a id="ln-4180" name="ln-4180" href="#ln-4180"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4181" name="ln-4181" href="#ln-4181"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4182" name="ln-4182" href="#ln-4182"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">precip</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4183" name="ln-4183" href="#ln-4183"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4184" name="ln-4184" href="#ln-4184"></a>
<a id="ln-4185" name="ln-4185" href="#ln-4185"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4186" name="ln-4186" href="#ln-4186"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4187" name="ln-4187" href="#ln-4187"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%precip_sn(off), vaddr(vidx), ierr)</span>
<a id="ln-4188" name="ln-4188" href="#ln-4188"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4189" name="ln-4189" href="#ln-4189"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4190" name="ln-4190" href="#ln-4190"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">precip_sn</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4191" name="ln-4191" href="#ln-4191"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4192" name="ln-4192" href="#ln-4192"></a>
<a id="ln-4193" name="ln-4193" href="#ln-4193"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4194" name="ln-4194" href="#ln-4194"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4195" name="ln-4195" href="#ln-4195"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%tk(off), vaddr(vidx), ierr)</span>
<a id="ln-4196" name="ln-4196" href="#ln-4196"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4197" name="ln-4197" href="#ln-4197"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4198" name="ln-4198" href="#ln-4198"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">tk</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4199" name="ln-4199" href="#ln-4199"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4200" name="ln-4200" href="#ln-4200"></a>
<a id="ln-4201" name="ln-4201" href="#ln-4201"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4202" name="ln-4202" href="#ln-4202"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4203" name="ln-4203" href="#ln-4203"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%tvair(off), vaddr(vidx), ierr)</span>
<a id="ln-4204" name="ln-4204" href="#ln-4204"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4205" name="ln-4205" href="#ln-4205"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4206" name="ln-4206" href="#ln-4206"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">tvair</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4207" name="ln-4207" href="#ln-4207"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4208" name="ln-4208" href="#ln-4208"></a>
<a id="ln-4209" name="ln-4209" href="#ln-4209"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4210" name="ln-4210" href="#ln-4210"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4211" name="ln-4211" href="#ln-4211"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%tvrad(off), vaddr(vidx), ierr)</span>
<a id="ln-4212" name="ln-4212" href="#ln-4212"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4213" name="ln-4213" href="#ln-4213"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4214" name="ln-4214" href="#ln-4214"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">tvrad</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4215" name="ln-4215" href="#ln-4215"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4216" name="ln-4216" href="#ln-4216"></a>
<a id="ln-4217" name="ln-4217" href="#ln-4217"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4218" name="ln-4218" href="#ln-4218"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4219" name="ln-4219" href="#ln-4219"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%pmb(off), vaddr(vidx), ierr)</span>
<a id="ln-4220" name="ln-4220" href="#ln-4220"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4221" name="ln-4221" href="#ln-4221"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4222" name="ln-4222" href="#ln-4222"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">pmb</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4223" name="ln-4223" href="#ln-4223"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4224" name="ln-4224" href="#ln-4224"></a>
<a id="ln-4225" name="ln-4225" href="#ln-4225"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4226" name="ln-4226" href="#ln-4226"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4227" name="ln-4227" href="#ln-4227"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%ua(off), vaddr(vidx), ierr)</span>
<a id="ln-4228" name="ln-4228" href="#ln-4228"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4229" name="ln-4229" href="#ln-4229"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4230" name="ln-4230" href="#ln-4230"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">ua</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4231" name="ln-4231" href="#ln-4231"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4232" name="ln-4232" href="#ln-4232"></a>
<a id="ln-4233" name="ln-4233" href="#ln-4233"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4234" name="ln-4234" href="#ln-4234"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4235" name="ln-4235" href="#ln-4235"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%qv(off), vaddr(vidx), ierr)</span>
<a id="ln-4236" name="ln-4236" href="#ln-4236"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4237" name="ln-4237" href="#ln-4237"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4238" name="ln-4238" href="#ln-4238"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">qv</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4239" name="ln-4239" href="#ln-4239"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4240" name="ln-4240" href="#ln-4240"></a>
<a id="ln-4241" name="ln-4241" href="#ln-4241"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4242" name="ln-4242" href="#ln-4242"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4243" name="ln-4243" href="#ln-4243"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%qvair(off), vaddr(vidx), ierr)</span>
<a id="ln-4244" name="ln-4244" href="#ln-4244"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4245" name="ln-4245" href="#ln-4245"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4246" name="ln-4246" href="#ln-4246"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">qvair</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4247" name="ln-4247" href="#ln-4247"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4248" name="ln-4248" href="#ln-4248"></a>
<a id="ln-4249" name="ln-4249" href="#ln-4249"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4250" name="ln-4250" href="#ln-4250"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4251" name="ln-4251" href="#ln-4251"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%da(off), vaddr(vidx), ierr)</span>
<a id="ln-4252" name="ln-4252" href="#ln-4252"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4253" name="ln-4253" href="#ln-4253"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4254" name="ln-4254" href="#ln-4254"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">da</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4255" name="ln-4255" href="#ln-4255"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4256" name="ln-4256" href="#ln-4256"></a>
<a id="ln-4257" name="ln-4257" href="#ln-4257"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4258" name="ln-4258" href="#ln-4258"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4259" name="ln-4259" href="#ln-4259"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%dva(off), vaddr(vidx), ierr)</span>
<a id="ln-4260" name="ln-4260" href="#ln-4260"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4261" name="ln-4261" href="#ln-4261"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4262" name="ln-4262" href="#ln-4262"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">dva</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4263" name="ln-4263" href="#ln-4263"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4264" name="ln-4264" href="#ln-4264"></a>
<a id="ln-4265" name="ln-4265" href="#ln-4265"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4266" name="ln-4266" href="#ln-4266"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4267" name="ln-4267" href="#ln-4267"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (met%coszen(off), vaddr(vidx), ierr) ! 19</span>
<a id="ln-4268" name="ln-4268" href="#ln-4268"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4269" name="ln-4269" href="#ln-4269"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4270" name="ln-4270" href="#ln-4270"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">coszen</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4271" name="ln-4271" href="#ln-4271"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4272" name="ln-4272" href="#ln-4272"></a>
<a id="ln-4273" name="ln-4273" href="#ln-4273"></a>
<a id="ln-4274" name="ln-4274" href="#ln-4274"></a><span class="w">    </span><span class="c">! canopy</span>
<a id="ln-4275" name="ln-4275" href="#ln-4275"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4276" name="ln-4276" href="#ln-4276"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fess</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4277" name="ln-4277" href="#ln-4277"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-4278" name="ln-4278" href="#ln-4278"></a>
<a id="ln-4279" name="ln-4279" href="#ln-4279"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4280" name="ln-4280" href="#ln-4280"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fesp</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4281" name="ln-4281" href="#ln-4281"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-4282" name="ln-4282" href="#ln-4282"></a>
<a id="ln-4283" name="ln-4283" href="#ln-4283"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4284" name="ln-4284" href="#ln-4284"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4285" name="ln-4285" href="#ln-4285"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%cansto(off), vaddr(vidx), ierr) ! 20</span>
<a id="ln-4286" name="ln-4286" href="#ln-4286"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4287" name="ln-4287" href="#ln-4287"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4288" name="ln-4288" href="#ln-4288"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">cansto</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4289" name="ln-4289" href="#ln-4289"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4290" name="ln-4290" href="#ln-4290"></a>
<a id="ln-4291" name="ln-4291" href="#ln-4291"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4292" name="ln-4292" href="#ln-4292"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4293" name="ln-4293" href="#ln-4293"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%cduv(off), vaddr(vidx), ierr) ! 21</span>
<a id="ln-4294" name="ln-4294" href="#ln-4294"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4295" name="ln-4295" href="#ln-4295"></a>
<a id="ln-4296" name="ln-4296" href="#ln-4296"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-4297" name="ln-4297" href="#ln-4297"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4298" name="ln-4298" href="#ln-4298"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">cduv</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4299" name="ln-4299" href="#ln-4299"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4300" name="ln-4300" href="#ln-4300"></a>
<a id="ln-4301" name="ln-4301" href="#ln-4301"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4302" name="ln-4302" href="#ln-4302"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4303" name="ln-4303" href="#ln-4303"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%delwc(off), vaddr(vidx), ierr) ! 22</span>
<a id="ln-4304" name="ln-4304" href="#ln-4304"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4305" name="ln-4305" href="#ln-4305"></a>
<a id="ln-4306" name="ln-4306" href="#ln-4306"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4307" name="ln-4307" href="#ln-4307"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">delwc</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4308" name="ln-4308" href="#ln-4308"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4309" name="ln-4309" href="#ln-4309"></a>
<a id="ln-4310" name="ln-4310" href="#ln-4310"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4311" name="ln-4311" href="#ln-4311"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4312" name="ln-4312" href="#ln-4312"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%dewmm(off), vaddr(vidx), ierr) ! 23</span>
<a id="ln-4313" name="ln-4313" href="#ln-4313"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4314" name="ln-4314" href="#ln-4314"></a>
<a id="ln-4315" name="ln-4315" href="#ln-4315"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-4316" name="ln-4316" href="#ln-4316"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4317" name="ln-4317" href="#ln-4317"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">dewmm</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4318" name="ln-4318" href="#ln-4318"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4319" name="ln-4319" href="#ln-4319"></a>
<a id="ln-4320" name="ln-4320" href="#ln-4320"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4321" name="ln-4321" href="#ln-4321"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-4322" name="ln-4322" href="#ln-4322"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%dgdtg(off), vaddr(vidx), ierr) ! 24</span>
<a id="ln-4323" name="ln-4323" href="#ln-4323"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr2</span>
<a id="ln-4324" name="ln-4324" href="#ln-4324"></a>
<a id="ln-4325" name="ln-4325" href="#ln-4325"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-4326" name="ln-4326" href="#ln-4326"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4327" name="ln-4327" href="#ln-4327"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">dgdtg</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4328" name="ln-4328" href="#ln-4328"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-4329" name="ln-4329" href="#ln-4329"></a>
<a id="ln-4330" name="ln-4330" href="#ln-4330"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4331" name="ln-4331" href="#ln-4331"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4332" name="ln-4332" href="#ln-4332"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fe(off), vaddr(vidx), ierr) ! 25</span>
<a id="ln-4333" name="ln-4333" href="#ln-4333"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4334" name="ln-4334" href="#ln-4334"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4335" name="ln-4335" href="#ln-4335"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fe</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4336" name="ln-4336" href="#ln-4336"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4337" name="ln-4337" href="#ln-4337"></a>
<a id="ln-4338" name="ln-4338" href="#ln-4338"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4339" name="ln-4339" href="#ln-4339"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4340" name="ln-4340" href="#ln-4340"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fh(off), vaddr(vidx), ierr) ! 26</span>
<a id="ln-4341" name="ln-4341" href="#ln-4341"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4342" name="ln-4342" href="#ln-4342"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4343" name="ln-4343" href="#ln-4343"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fh</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4344" name="ln-4344" href="#ln-4344"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4345" name="ln-4345" href="#ln-4345"></a>
<a id="ln-4346" name="ln-4346" href="#ln-4346"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4347" name="ln-4347" href="#ln-4347"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4348" name="ln-4348" href="#ln-4348"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fpn(off), vaddr(vidx), ierr) ! 27</span>
<a id="ln-4349" name="ln-4349" href="#ln-4349"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4350" name="ln-4350" href="#ln-4350"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4351" name="ln-4351" href="#ln-4351"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fpn</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4352" name="ln-4352" href="#ln-4352"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4353" name="ln-4353" href="#ln-4353"></a>
<a id="ln-4354" name="ln-4354" href="#ln-4354"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4355" name="ln-4355" href="#ln-4355"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4356" name="ln-4356" href="#ln-4356"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%frp(off), vaddr(vidx), ierr) ! 28</span>
<a id="ln-4357" name="ln-4357" href="#ln-4357"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4358" name="ln-4358" href="#ln-4358"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4359" name="ln-4359" href="#ln-4359"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frp</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4360" name="ln-4360" href="#ln-4360"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4361" name="ln-4361" href="#ln-4361"></a>
<a id="ln-4362" name="ln-4362" href="#ln-4362"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4363" name="ln-4363" href="#ln-4363"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4364" name="ln-4364" href="#ln-4364"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%frpw(off), vaddr(vidx), ierr) ! 29</span>
<a id="ln-4365" name="ln-4365" href="#ln-4365"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4366" name="ln-4366" href="#ln-4366"></a>
<a id="ln-4367" name="ln-4367" href="#ln-4367"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-4368" name="ln-4368" href="#ln-4368"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4369" name="ln-4369" href="#ln-4369"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frpw</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4370" name="ln-4370" href="#ln-4370"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4371" name="ln-4371" href="#ln-4371"></a>
<a id="ln-4372" name="ln-4372" href="#ln-4372"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4373" name="ln-4373" href="#ln-4373"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4374" name="ln-4374" href="#ln-4374"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%frpr(off), vaddr(vidx), ierr) ! 30</span>
<a id="ln-4375" name="ln-4375" href="#ln-4375"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4376" name="ln-4376" href="#ln-4376"></a>
<a id="ln-4377" name="ln-4377" href="#ln-4377"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-4378" name="ln-4378" href="#ln-4378"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4379" name="ln-4379" href="#ln-4379"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frpr</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4380" name="ln-4380" href="#ln-4380"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4381" name="ln-4381" href="#ln-4381"></a>
<a id="ln-4382" name="ln-4382" href="#ln-4382"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4383" name="ln-4383" href="#ln-4383"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4384" name="ln-4384" href="#ln-4384"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%frs(off), vaddr(vidx), ierr) ! 31</span>
<a id="ln-4385" name="ln-4385" href="#ln-4385"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4386" name="ln-4386" href="#ln-4386"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4387" name="ln-4387" href="#ln-4387"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frs</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4388" name="ln-4388" href="#ln-4388"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4389" name="ln-4389" href="#ln-4389"></a>
<a id="ln-4390" name="ln-4390" href="#ln-4390"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4391" name="ln-4391" href="#ln-4391"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4392" name="ln-4392" href="#ln-4392"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fnee(off), vaddr(vidx), ierr) ! 32</span>
<a id="ln-4393" name="ln-4393" href="#ln-4393"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4394" name="ln-4394" href="#ln-4394"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4395" name="ln-4395" href="#ln-4395"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fnee</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4396" name="ln-4396" href="#ln-4396"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4397" name="ln-4397" href="#ln-4397"></a>
<a id="ln-4398" name="ln-4398" href="#ln-4398"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4399" name="ln-4399" href="#ln-4399"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4400" name="ln-4400" href="#ln-4400"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%frday(off), vaddr(vidx), ierr) ! 33</span>
<a id="ln-4401" name="ln-4401" href="#ln-4401"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4402" name="ln-4402" href="#ln-4402"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4403" name="ln-4403" href="#ln-4403"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frday</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4404" name="ln-4404" href="#ln-4404"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4405" name="ln-4405" href="#ln-4405"></a>
<a id="ln-4406" name="ln-4406" href="#ln-4406"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4407" name="ln-4407" href="#ln-4407"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4408" name="ln-4408" href="#ln-4408"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fnv(off), vaddr(vidx), ierr) ! 34</span>
<a id="ln-4409" name="ln-4409" href="#ln-4409"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4410" name="ln-4410" href="#ln-4410"></a>
<a id="ln-4411" name="ln-4411" href="#ln-4411"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-4412" name="ln-4412" href="#ln-4412"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4413" name="ln-4413" href="#ln-4413"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fnv</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4414" name="ln-4414" href="#ln-4414"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4415" name="ln-4415" href="#ln-4415"></a>
<a id="ln-4416" name="ln-4416" href="#ln-4416"></a>
<a id="ln-4417" name="ln-4417" href="#ln-4417"></a><span class="w">    </span><span class="c">! gol124: MPI: DONE until here!!!</span>
<a id="ln-4418" name="ln-4418" href="#ln-4418"></a>
<a id="ln-4419" name="ln-4419" href="#ln-4419"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4420" name="ln-4420" href="#ln-4420"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4421" name="ln-4421" href="#ln-4421"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fev(off), vaddr(vidx), ierr) ! 35</span>
<a id="ln-4422" name="ln-4422" href="#ln-4422"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4423" name="ln-4423" href="#ln-4423"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4424" name="ln-4424" href="#ln-4424"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fev</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4425" name="ln-4425" href="#ln-4425"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4426" name="ln-4426" href="#ln-4426"></a>
<a id="ln-4427" name="ln-4427" href="#ln-4427"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4428" name="ln-4428" href="#ln-4428"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-4429" name="ln-4429" href="#ln-4429"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fevc(off), vaddr(vidx), ierr) ! 36</span>
<a id="ln-4430" name="ln-4430" href="#ln-4430"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr2</span>
<a id="ln-4431" name="ln-4431" href="#ln-4431"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4432" name="ln-4432" href="#ln-4432"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fevc</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4433" name="ln-4433" href="#ln-4433"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-4434" name="ln-4434" href="#ln-4434"></a>
<a id="ln-4435" name="ln-4435" href="#ln-4435"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4436" name="ln-4436" href="#ln-4436"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-4437" name="ln-4437" href="#ln-4437"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fevw(off), vaddr(vidx), ierr) ! 37</span>
<a id="ln-4438" name="ln-4438" href="#ln-4438"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr2</span>
<a id="ln-4439" name="ln-4439" href="#ln-4439"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4440" name="ln-4440" href="#ln-4440"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fevw</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4441" name="ln-4441" href="#ln-4441"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4442" name="ln-4442" href="#ln-4442"></a>
<a id="ln-4443" name="ln-4443" href="#ln-4443"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4444" name="ln-4444" href="#ln-4444"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-4445" name="ln-4445" href="#ln-4445"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%potev_c(off), vaddr(vidx), ierr) ! 38</span>
<a id="ln-4446" name="ln-4446" href="#ln-4446"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr2</span>
<a id="ln-4447" name="ln-4447" href="#ln-4447"></a><span class="w">    </span><span class="c">!  bidx = bidx + 1</span>
<a id="ln-4448" name="ln-4448" href="#ln-4448"></a><span class="w">    </span><span class="c">!  CALL MPI_Get_address (canopy%potev_c(off), displs(bidx), ierr)</span>
<a id="ln-4449" name="ln-4449" href="#ln-4449"></a><span class="w">    </span><span class="c">!  blocks(bidx) = r2len</span>
<a id="ln-4450" name="ln-4450" href="#ln-4450"></a>
<a id="ln-4451" name="ln-4451" href="#ln-4451"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4452" name="ln-4452" href="#ln-4452"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4453" name="ln-4453" href="#ln-4453"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fhv(off), vaddr(vidx), ierr) ! 39</span>
<a id="ln-4454" name="ln-4454" href="#ln-4454"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4455" name="ln-4455" href="#ln-4455"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4456" name="ln-4456" href="#ln-4456"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fhv</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4457" name="ln-4457" href="#ln-4457"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4458" name="ln-4458" href="#ln-4458"></a>
<a id="ln-4459" name="ln-4459" href="#ln-4459"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4460" name="ln-4460" href="#ln-4460"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-4461" name="ln-4461" href="#ln-4461"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fhvw(off), vaddr(vidx), ierr) ! 40</span>
<a id="ln-4462" name="ln-4462" href="#ln-4462"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr2</span>
<a id="ln-4463" name="ln-4463" href="#ln-4463"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4464" name="ln-4464" href="#ln-4464"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fhvw</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4465" name="ln-4465" href="#ln-4465"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4466" name="ln-4466" href="#ln-4466"></a>
<a id="ln-4467" name="ln-4467" href="#ln-4467"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4468" name="ln-4468" href="#ln-4468"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4469" name="ln-4469" href="#ln-4469"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fns(off), vaddr(vidx), ierr) ! 41</span>
<a id="ln-4470" name="ln-4470" href="#ln-4470"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4471" name="ln-4471" href="#ln-4471"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4472" name="ln-4472" href="#ln-4472"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fns</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4473" name="ln-4473" href="#ln-4473"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4474" name="ln-4474" href="#ln-4474"></a>
<a id="ln-4475" name="ln-4475" href="#ln-4475"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4476" name="ln-4476" href="#ln-4476"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fns_cor</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4477" name="ln-4477" href="#ln-4477"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4478" name="ln-4478" href="#ln-4478"></a>
<a id="ln-4479" name="ln-4479" href="#ln-4479"></a>
<a id="ln-4480" name="ln-4480" href="#ln-4480"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4481" name="ln-4481" href="#ln-4481"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4482" name="ln-4482" href="#ln-4482"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fes(off), vaddr(vidx), ierr) ! 42</span>
<a id="ln-4483" name="ln-4483" href="#ln-4483"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4484" name="ln-4484" href="#ln-4484"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4485" name="ln-4485" href="#ln-4485"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fes</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4486" name="ln-4486" href="#ln-4486"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-4487" name="ln-4487" href="#ln-4487"></a>
<a id="ln-4488" name="ln-4488" href="#ln-4488"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4489" name="ln-4489" href="#ln-4489"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fes_cor</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4490" name="ln-4490" href="#ln-4490"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-4491" name="ln-4491" href="#ln-4491"></a>
<a id="ln-4492" name="ln-4492" href="#ln-4492"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4493" name="ln-4493" href="#ln-4493"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4494" name="ln-4494" href="#ln-4494"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fhs(off), vaddr(vidx), ierr) ! 43</span>
<a id="ln-4495" name="ln-4495" href="#ln-4495"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4496" name="ln-4496" href="#ln-4496"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4497" name="ln-4497" href="#ln-4497"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fhs</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4498" name="ln-4498" href="#ln-4498"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4499" name="ln-4499" href="#ln-4499"></a>
<a id="ln-4500" name="ln-4500" href="#ln-4500"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4501" name="ln-4501" href="#ln-4501"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fhs_cor</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4502" name="ln-4502" href="#ln-4502"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4503" name="ln-4503" href="#ln-4503"></a>
<a id="ln-4504" name="ln-4504" href="#ln-4504"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4505" name="ln-4505" href="#ln-4505"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4506" name="ln-4506" href="#ln-4506"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%fwet(off), vaddr(vidx), ierr) ! 44</span>
<a id="ln-4507" name="ln-4507" href="#ln-4507"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4508" name="ln-4508" href="#ln-4508"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4509" name="ln-4509" href="#ln-4509"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fwet</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4510" name="ln-4510" href="#ln-4510"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4511" name="ln-4511" href="#ln-4511"></a>
<a id="ln-4512" name="ln-4512" href="#ln-4512"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4513" name="ln-4513" href="#ln-4513"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">epot</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4514" name="ln-4514" href="#ln-4514"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4515" name="ln-4515" href="#ln-4515"></a>
<a id="ln-4516" name="ln-4516" href="#ln-4516"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4517" name="ln-4517" href="#ln-4517"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fnpp</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4518" name="ln-4518" href="#ln-4518"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4519" name="ln-4519" href="#ln-4519"></a>
<a id="ln-4520" name="ln-4520" href="#ln-4520"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4521" name="ln-4521" href="#ln-4521"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fevw_pot</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4522" name="ln-4522" href="#ln-4522"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4523" name="ln-4523" href="#ln-4523"></a>
<a id="ln-4524" name="ln-4524" href="#ln-4524"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4525" name="ln-4525" href="#ln-4525"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">gswx_T</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4526" name="ln-4526" href="#ln-4526"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4527" name="ln-4527" href="#ln-4527"></a>
<a id="ln-4528" name="ln-4528" href="#ln-4528"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4529" name="ln-4529" href="#ln-4529"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">cdtq</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4530" name="ln-4530" href="#ln-4530"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4531" name="ln-4531" href="#ln-4531"></a>
<a id="ln-4532" name="ln-4532" href="#ln-4532"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4533" name="ln-4533" href="#ln-4533"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">wetfac_cs</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4534" name="ln-4534" href="#ln-4534"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4535" name="ln-4535" href="#ln-4535"></a>
<a id="ln-4536" name="ln-4536" href="#ln-4536"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4537" name="ln-4537" href="#ln-4537"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4538" name="ln-4538" href="#ln-4538"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%ga(off), vaddr(vidx), ierr) ! 45</span>
<a id="ln-4539" name="ln-4539" href="#ln-4539"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4540" name="ln-4540" href="#ln-4540"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4541" name="ln-4541" href="#ln-4541"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">ga</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4542" name="ln-4542" href="#ln-4542"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4543" name="ln-4543" href="#ln-4543"></a>
<a id="ln-4544" name="ln-4544" href="#ln-4544"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4545" name="ln-4545" href="#ln-4545"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">ga_cor</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4546" name="ln-4546" href="#ln-4546"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4547" name="ln-4547" href="#ln-4547"></a>
<a id="ln-4548" name="ln-4548" href="#ln-4548"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4549" name="ln-4549" href="#ln-4549"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4550" name="ln-4550" href="#ln-4550"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%ghflux(off), vaddr(vidx), ierr) ! 46</span>
<a id="ln-4551" name="ln-4551" href="#ln-4551"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4552" name="ln-4552" href="#ln-4552"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4553" name="ln-4553" href="#ln-4553"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">ghflux</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4554" name="ln-4554" href="#ln-4554"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4555" name="ln-4555" href="#ln-4555"></a>
<a id="ln-4556" name="ln-4556" href="#ln-4556"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4557" name="ln-4557" href="#ln-4557"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4558" name="ln-4558" href="#ln-4558"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%precis(off), vaddr(vidx), ierr) ! 47</span>
<a id="ln-4559" name="ln-4559" href="#ln-4559"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4560" name="ln-4560" href="#ln-4560"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4561" name="ln-4561" href="#ln-4561"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">precis</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4562" name="ln-4562" href="#ln-4562"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4563" name="ln-4563" href="#ln-4563"></a>
<a id="ln-4564" name="ln-4564" href="#ln-4564"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4565" name="ln-4565" href="#ln-4565"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4566" name="ln-4566" href="#ln-4566"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%qscrn(off), vaddr(vidx), ierr) ! 48</span>
<a id="ln-4567" name="ln-4567" href="#ln-4567"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4568" name="ln-4568" href="#ln-4568"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4569" name="ln-4569" href="#ln-4569"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">qscrn</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4570" name="ln-4570" href="#ln-4570"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4571" name="ln-4571" href="#ln-4571"></a>
<a id="ln-4572" name="ln-4572" href="#ln-4572"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4573" name="ln-4573" href="#ln-4573"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4574" name="ln-4574" href="#ln-4574"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%rnet(off), vaddr(vidx), ierr) ! 49</span>
<a id="ln-4575" name="ln-4575" href="#ln-4575"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4576" name="ln-4576" href="#ln-4576"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4577" name="ln-4577" href="#ln-4577"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">rnet</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4578" name="ln-4578" href="#ln-4578"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4579" name="ln-4579" href="#ln-4579"></a>
<a id="ln-4580" name="ln-4580" href="#ln-4580"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4581" name="ln-4581" href="#ln-4581"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4582" name="ln-4582" href="#ln-4582"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%segg(off), vaddr(vidx), ierr) ! 50</span>
<a id="ln-4583" name="ln-4583" href="#ln-4583"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4584" name="ln-4584" href="#ln-4584"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4585" name="ln-4585" href="#ln-4585"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">segg</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4586" name="ln-4586" href="#ln-4586"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4587" name="ln-4587" href="#ln-4587"></a>
<a id="ln-4588" name="ln-4588" href="#ln-4588"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4589" name="ln-4589" href="#ln-4589"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4590" name="ln-4590" href="#ln-4590"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%sghflux(off), vaddr(vidx), ierr) ! 51</span>
<a id="ln-4591" name="ln-4591" href="#ln-4591"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4592" name="ln-4592" href="#ln-4592"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4593" name="ln-4593" href="#ln-4593"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">sghflux</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4594" name="ln-4594" href="#ln-4594"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4595" name="ln-4595" href="#ln-4595"></a>
<a id="ln-4596" name="ln-4596" href="#ln-4596"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4597" name="ln-4597" href="#ln-4597"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4598" name="ln-4598" href="#ln-4598"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%spill(off), vaddr(vidx), ierr) ! 52</span>
<a id="ln-4599" name="ln-4599" href="#ln-4599"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4600" name="ln-4600" href="#ln-4600"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4601" name="ln-4601" href="#ln-4601"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">spill</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4602" name="ln-4602" href="#ln-4602"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4603" name="ln-4603" href="#ln-4603"></a>
<a id="ln-4604" name="ln-4604" href="#ln-4604"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4605" name="ln-4605" href="#ln-4605"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4606" name="ln-4606" href="#ln-4606"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%through(off), vaddr(vidx), ierr) ! 53</span>
<a id="ln-4607" name="ln-4607" href="#ln-4607"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4608" name="ln-4608" href="#ln-4608"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4609" name="ln-4609" href="#ln-4609"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">through</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4610" name="ln-4610" href="#ln-4610"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4611" name="ln-4611" href="#ln-4611"></a>
<a id="ln-4612" name="ln-4612" href="#ln-4612"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4613" name="ln-4613" href="#ln-4613"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4614" name="ln-4614" href="#ln-4614"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%tscrn(off), vaddr(vidx), ierr) ! 54</span>
<a id="ln-4615" name="ln-4615" href="#ln-4615"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4616" name="ln-4616" href="#ln-4616"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4617" name="ln-4617" href="#ln-4617"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">tscrn</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4618" name="ln-4618" href="#ln-4618"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4619" name="ln-4619" href="#ln-4619"></a>
<a id="ln-4620" name="ln-4620" href="#ln-4620"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4621" name="ln-4621" href="#ln-4621"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4622" name="ln-4622" href="#ln-4622"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%tv(off), vaddr(vidx), ierr) ! 55</span>
<a id="ln-4623" name="ln-4623" href="#ln-4623"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4624" name="ln-4624" href="#ln-4624"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4625" name="ln-4625" href="#ln-4625"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">tv</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4626" name="ln-4626" href="#ln-4626"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4627" name="ln-4627" href="#ln-4627"></a>
<a id="ln-4628" name="ln-4628" href="#ln-4628"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4629" name="ln-4629" href="#ln-4629"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4630" name="ln-4630" href="#ln-4630"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%us(off), vaddr(vidx), ierr) ! 56</span>
<a id="ln-4631" name="ln-4631" href="#ln-4631"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4632" name="ln-4632" href="#ln-4632"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4633" name="ln-4633" href="#ln-4633"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">us</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4634" name="ln-4634" href="#ln-4634"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4635" name="ln-4635" href="#ln-4635"></a>
<a id="ln-4636" name="ln-4636" href="#ln-4636"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4637" name="ln-4637" href="#ln-4637"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4638" name="ln-4638" href="#ln-4638"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%uscrn(off), vaddr(vidx), ierr) ! 57</span>
<a id="ln-4639" name="ln-4639" href="#ln-4639"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4640" name="ln-4640" href="#ln-4640"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4641" name="ln-4641" href="#ln-4641"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">uscrn</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4642" name="ln-4642" href="#ln-4642"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4643" name="ln-4643" href="#ln-4643"></a>
<a id="ln-4644" name="ln-4644" href="#ln-4644"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4645" name="ln-4645" href="#ln-4645"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4646" name="ln-4646" href="#ln-4646"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%vlaiw(off), vaddr(vidx), ierr) ! 58</span>
<a id="ln-4647" name="ln-4647" href="#ln-4647"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4648" name="ln-4648" href="#ln-4648"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4649" name="ln-4649" href="#ln-4649"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">vlaiw</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4650" name="ln-4650" href="#ln-4650"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4651" name="ln-4651" href="#ln-4651"></a>
<a id="ln-4652" name="ln-4652" href="#ln-4652"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4653" name="ln-4653" href="#ln-4653"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">rghlai</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4654" name="ln-4654" href="#ln-4654"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4655" name="ln-4655" href="#ln-4655"></a>
<a id="ln-4656" name="ln-4656" href="#ln-4656"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4657" name="ln-4657" href="#ln-4657"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4658" name="ln-4658" href="#ln-4658"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (canopy%wcint(off), vaddr(vidx), ierr) ! 59</span>
<a id="ln-4659" name="ln-4659" href="#ln-4659"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4660" name="ln-4660" href="#ln-4660"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4661" name="ln-4661" href="#ln-4661"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">wcint</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4662" name="ln-4662" href="#ln-4662"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4663" name="ln-4663" href="#ln-4663"></a>
<a id="ln-4664" name="ln-4664" href="#ln-4664"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4665" name="ln-4665" href="#ln-4665"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fwsoil</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4666" name="ln-4666" href="#ln-4666"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-4667" name="ln-4667" href="#ln-4667"></a>
<a id="ln-4668" name="ln-4668" href="#ln-4668"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-4669" name="ln-4669" href="#ln-4669"></a><span class="w">    </span><span class="c">! rwater</span>
<a id="ln-4670" name="ln-4670" href="#ln-4670"></a><span class="w">    </span><span class="c">! evapfbl</span>
<a id="ln-4671" name="ln-4671" href="#ln-4671"></a>
<a id="ln-4672" name="ln-4672" href="#ln-4672"></a><span class="w">    </span><span class="c">! ssnow</span>
<a id="ln-4673" name="ln-4673" href="#ln-4673"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-4674" name="ln-4674" href="#ln-4674"></a><span class="w">    </span><span class="c">! albsoilsn</span>
<a id="ln-4675" name="ln-4675" href="#ln-4675"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4676" name="ln-4676" href="#ln-4676"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">pudsto</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4677" name="ln-4677" href="#ln-4677"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4678" name="ln-4678" href="#ln-4678"></a>
<a id="ln-4679" name="ln-4679" href="#ln-4679"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4680" name="ln-4680" href="#ln-4680"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">pudsmx</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4681" name="ln-4681" href="#ln-4681"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4682" name="ln-4682" href="#ln-4682"></a>
<a id="ln-4683" name="ln-4683" href="#ln-4683"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4684" name="ln-4684" href="#ln-4684"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4685" name="ln-4685" href="#ln-4685"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%cls(off), vaddr(vidx), ierr) ! 60</span>
<a id="ln-4686" name="ln-4686" href="#ln-4686"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4687" name="ln-4687" href="#ln-4687"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4688" name="ln-4688" href="#ln-4688"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">cls</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4689" name="ln-4689" href="#ln-4689"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4690" name="ln-4690" href="#ln-4690"></a>
<a id="ln-4691" name="ln-4691" href="#ln-4691"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4692" name="ln-4692" href="#ln-4692"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4693" name="ln-4693" href="#ln-4693"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%dfn_dtg(off), vaddr(vidx), ierr) ! 61</span>
<a id="ln-4694" name="ln-4694" href="#ln-4694"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4695" name="ln-4695" href="#ln-4695"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4696" name="ln-4696" href="#ln-4696"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">dfn_dtg</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4697" name="ln-4697" href="#ln-4697"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4698" name="ln-4698" href="#ln-4698"></a>
<a id="ln-4699" name="ln-4699" href="#ln-4699"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4700" name="ln-4700" href="#ln-4700"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4701" name="ln-4701" href="#ln-4701"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%dfh_dtg(off), vaddr(vidx), ierr) ! 62</span>
<a id="ln-4702" name="ln-4702" href="#ln-4702"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4703" name="ln-4703" href="#ln-4703"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4704" name="ln-4704" href="#ln-4704"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">dfh_dtg</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4705" name="ln-4705" href="#ln-4705"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4706" name="ln-4706" href="#ln-4706"></a>
<a id="ln-4707" name="ln-4707" href="#ln-4707"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4708" name="ln-4708" href="#ln-4708"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">dfe_ddq</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"> </span><span class="c">! +1</span>
<a id="ln-4709" name="ln-4709" href="#ln-4709"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4710" name="ln-4710" href="#ln-4710"></a>
<a id="ln-4711" name="ln-4711" href="#ln-4711"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4712" name="ln-4712" href="#ln-4712"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">dfe_dtg</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"> </span><span class="c">! +1</span>
<a id="ln-4713" name="ln-4713" href="#ln-4713"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4714" name="ln-4714" href="#ln-4714"></a>
<a id="ln-4715" name="ln-4715" href="#ln-4715"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4716" name="ln-4716" href="#ln-4716"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4717" name="ln-4717" href="#ln-4717"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%ddq_dtg(off), vaddr(vidx), ierr) ! 63</span>
<a id="ln-4718" name="ln-4718" href="#ln-4718"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4719" name="ln-4719" href="#ln-4719"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4720" name="ln-4720" href="#ln-4720"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">ddq_dtg</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4721" name="ln-4721" href="#ln-4721"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4722" name="ln-4722" href="#ln-4722"></a>
<a id="ln-4723" name="ln-4723" href="#ln-4723"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4724" name="ln-4724" href="#ln-4724"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4725" name="ln-4725" href="#ln-4725"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%evapsn(off), vaddr(vidx), ierr) ! 64</span>
<a id="ln-4726" name="ln-4726" href="#ln-4726"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4727" name="ln-4727" href="#ln-4727"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4728" name="ln-4728" href="#ln-4728"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">evapsn</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4729" name="ln-4729" href="#ln-4729"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4730" name="ln-4730" href="#ln-4730"></a>
<a id="ln-4731" name="ln-4731" href="#ln-4731"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4732" name="ln-4732" href="#ln-4732"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4733" name="ln-4733" href="#ln-4733"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%fwtop(off), vaddr(vidx), ierr) ! 65</span>
<a id="ln-4734" name="ln-4734" href="#ln-4734"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4735" name="ln-4735" href="#ln-4735"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4736" name="ln-4736" href="#ln-4736"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">fwtop</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4737" name="ln-4737" href="#ln-4737"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4738" name="ln-4738" href="#ln-4738"></a>
<a id="ln-4739" name="ln-4739" href="#ln-4739"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4740" name="ln-4740" href="#ln-4740"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">fwtop1</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4741" name="ln-4741" href="#ln-4741"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4742" name="ln-4742" href="#ln-4742"></a>
<a id="ln-4743" name="ln-4743" href="#ln-4743"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4744" name="ln-4744" href="#ln-4744"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">fwtop2</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4745" name="ln-4745" href="#ln-4745"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4746" name="ln-4746" href="#ln-4746"></a>
<a id="ln-4747" name="ln-4747" href="#ln-4747"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4748" name="ln-4748" href="#ln-4748"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">fwtop3</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4749" name="ln-4749" href="#ln-4749"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4750" name="ln-4750" href="#ln-4750"></a>
<a id="ln-4751" name="ln-4751" href="#ln-4751"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-4752" name="ln-4752" href="#ln-4752"></a><span class="w">    </span><span class="c">! gammzz</span>
<a id="ln-4753" name="ln-4753" href="#ln-4753"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4754" name="ln-4754" href="#ln-4754"></a><span class="w">    </span><span class="c">! INTEGER(i_d)</span>
<a id="ln-4755" name="ln-4755" href="#ln-4755"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%isflag(off), vaddr(vidx), ierr) ! 66</span>
<a id="ln-4756" name="ln-4756" href="#ln-4756"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extid</span>
<a id="ln-4757" name="ln-4757" href="#ln-4757"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4758" name="ln-4758" href="#ln-4758"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">isflag</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4759" name="ln-4759" href="#ln-4759"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-4760" name="ln-4760" href="#ln-4760"></a>
<a id="ln-4761" name="ln-4761" href="#ln-4761"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4762" name="ln-4762" href="#ln-4762"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4763" name="ln-4763" href="#ln-4763"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%osnowd(off), vaddr(vidx), ierr) ! 67</span>
<a id="ln-4764" name="ln-4764" href="#ln-4764"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4765" name="ln-4765" href="#ln-4765"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4766" name="ln-4766" href="#ln-4766"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">osnowd</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4767" name="ln-4767" href="#ln-4767"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4768" name="ln-4768" href="#ln-4768"></a>
<a id="ln-4769" name="ln-4769" href="#ln-4769"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4770" name="ln-4770" href="#ln-4770"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4771" name="ln-4771" href="#ln-4771"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%potev(off), vaddr(vidx), ierr) ! 68</span>
<a id="ln-4772" name="ln-4772" href="#ln-4772"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4773" name="ln-4773" href="#ln-4773"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4774" name="ln-4774" href="#ln-4774"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">potev</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4775" name="ln-4775" href="#ln-4775"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4776" name="ln-4776" href="#ln-4776"></a>
<a id="ln-4777" name="ln-4777" href="#ln-4777"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4778" name="ln-4778" href="#ln-4778"></a><span class="w">    </span><span class="c">! REAL(r_2)</span>
<a id="ln-4779" name="ln-4779" href="#ln-4779"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%pwb_min(off), vaddr(vidx), ierr) ! 69</span>
<a id="ln-4780" name="ln-4780" href="#ln-4780"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr2</span>
<a id="ln-4781" name="ln-4781" href="#ln-4781"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4782" name="ln-4782" href="#ln-4782"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">pwb_min</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4783" name="ln-4783" href="#ln-4783"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-4784" name="ln-4784" href="#ln-4784"></a>
<a id="ln-4785" name="ln-4785" href="#ln-4785"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4786" name="ln-4786" href="#ln-4786"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4787" name="ln-4787" href="#ln-4787"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%runoff(off), vaddr(vidx), ierr) ! 70</span>
<a id="ln-4788" name="ln-4788" href="#ln-4788"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4789" name="ln-4789" href="#ln-4789"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4790" name="ln-4790" href="#ln-4790"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">runoff</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4791" name="ln-4791" href="#ln-4791"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4792" name="ln-4792" href="#ln-4792"></a>
<a id="ln-4793" name="ln-4793" href="#ln-4793"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4794" name="ln-4794" href="#ln-4794"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4795" name="ln-4795" href="#ln-4795"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%rnof1(off), vaddr(vidx), ierr) ! 71</span>
<a id="ln-4796" name="ln-4796" href="#ln-4796"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4797" name="ln-4797" href="#ln-4797"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4798" name="ln-4798" href="#ln-4798"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof1</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4799" name="ln-4799" href="#ln-4799"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4800" name="ln-4800" href="#ln-4800"></a>
<a id="ln-4801" name="ln-4801" href="#ln-4801"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4802" name="ln-4802" href="#ln-4802"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4803" name="ln-4803" href="#ln-4803"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%rnof2(off), vaddr(vidx), ierr) ! 72</span>
<a id="ln-4804" name="ln-4804" href="#ln-4804"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4805" name="ln-4805" href="#ln-4805"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4806" name="ln-4806" href="#ln-4806"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">rnof2</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4807" name="ln-4807" href="#ln-4807"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4808" name="ln-4808" href="#ln-4808"></a>
<a id="ln-4809" name="ln-4809" href="#ln-4809"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4810" name="ln-4810" href="#ln-4810"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4811" name="ln-4811" href="#ln-4811"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%rtsoil(off), vaddr(vidx), ierr) ! 73</span>
<a id="ln-4812" name="ln-4812" href="#ln-4812"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4813" name="ln-4813" href="#ln-4813"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4814" name="ln-4814" href="#ln-4814"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">rtsoil</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4815" name="ln-4815" href="#ln-4815"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4816" name="ln-4816" href="#ln-4816"></a>
<a id="ln-4817" name="ln-4817" href="#ln-4817"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-4818" name="ln-4818" href="#ln-4818"></a><span class="w">    </span><span class="c">! sconds</span>
<a id="ln-4819" name="ln-4819" href="#ln-4819"></a><span class="w">    </span><span class="c">! sdepth</span>
<a id="ln-4820" name="ln-4820" href="#ln-4820"></a><span class="w">    </span><span class="c">! smass</span>
<a id="ln-4821" name="ln-4821" href="#ln-4821"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4822" name="ln-4822" href="#ln-4822"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4823" name="ln-4823" href="#ln-4823"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%snage(off), vaddr(vidx), ierr) ! 74</span>
<a id="ln-4824" name="ln-4824" href="#ln-4824"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4825" name="ln-4825" href="#ln-4825"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4826" name="ln-4826" href="#ln-4826"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">snage</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4827" name="ln-4827" href="#ln-4827"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4828" name="ln-4828" href="#ln-4828"></a>
<a id="ln-4829" name="ln-4829" href="#ln-4829"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4830" name="ln-4830" href="#ln-4830"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4831" name="ln-4831" href="#ln-4831"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%snowd(off), vaddr(vidx), ierr) ! 75</span>
<a id="ln-4832" name="ln-4832" href="#ln-4832"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4833" name="ln-4833" href="#ln-4833"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4834" name="ln-4834" href="#ln-4834"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">snowd</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4835" name="ln-4835" href="#ln-4835"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4836" name="ln-4836" href="#ln-4836"></a>
<a id="ln-4837" name="ln-4837" href="#ln-4837"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4838" name="ln-4838" href="#ln-4838"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4839" name="ln-4839" href="#ln-4839"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%smelt(off), vaddr(vidx), ierr) ! 76</span>
<a id="ln-4840" name="ln-4840" href="#ln-4840"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4841" name="ln-4841" href="#ln-4841"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4842" name="ln-4842" href="#ln-4842"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">smelt</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4843" name="ln-4843" href="#ln-4843"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4844" name="ln-4844" href="#ln-4844"></a>
<a id="ln-4845" name="ln-4845" href="#ln-4845"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-4846" name="ln-4846" href="#ln-4846"></a><span class="w">    </span><span class="c">! dtmlt</span>
<a id="ln-4847" name="ln-4847" href="#ln-4847"></a><span class="w">    </span><span class="c">! ssdn</span>
<a id="ln-4848" name="ln-4848" href="#ln-4848"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4849" name="ln-4849" href="#ln-4849"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4850" name="ln-4850" href="#ln-4850"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%ssdnn(off), vaddr(vidx), ierr) ! 77</span>
<a id="ln-4851" name="ln-4851" href="#ln-4851"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4852" name="ln-4852" href="#ln-4852"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4853" name="ln-4853" href="#ln-4853"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">ssdnn</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4854" name="ln-4854" href="#ln-4854"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4855" name="ln-4855" href="#ln-4855"></a>
<a id="ln-4856" name="ln-4856" href="#ln-4856"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-4857" name="ln-4857" href="#ln-4857"></a><span class="w">    </span><span class="c">! tgg</span>
<a id="ln-4858" name="ln-4858" href="#ln-4858"></a><span class="w">    </span><span class="c">! tggsn</span>
<a id="ln-4859" name="ln-4859" href="#ln-4859"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4860" name="ln-4860" href="#ln-4860"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4861" name="ln-4861" href="#ln-4861"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%tss(off), vaddr(vidx), ierr) ! 78</span>
<a id="ln-4862" name="ln-4862" href="#ln-4862"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4863" name="ln-4863" href="#ln-4863"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4864" name="ln-4864" href="#ln-4864"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tss</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4865" name="ln-4865" href="#ln-4865"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4866" name="ln-4866" href="#ln-4866"></a>
<a id="ln-4867" name="ln-4867" href="#ln-4867"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4868" name="ln-4868" href="#ln-4868"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4869" name="ln-4869" href="#ln-4869"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%otss(off), vaddr(vidx), ierr) ! 79</span>
<a id="ln-4870" name="ln-4870" href="#ln-4870"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4871" name="ln-4871" href="#ln-4871"></a><span class="w">    </span><span class="c">! MPI: r1134 does not know about this field, comment out</span>
<a id="ln-4872" name="ln-4872" href="#ln-4872"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-4873" name="ln-4873" href="#ln-4873"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%otss(off), displs(bidx), ierr)</span>
<a id="ln-4874" name="ln-4874" href="#ln-4874"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-4875" name="ln-4875" href="#ln-4875"></a>
<a id="ln-4876" name="ln-4876" href="#ln-4876"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-4877" name="ln-4877" href="#ln-4877"></a><span class="w">    </span><span class="c">! wb</span>
<a id="ln-4878" name="ln-4878" href="#ln-4878"></a><span class="w">    </span><span class="c">! wbfice</span>
<a id="ln-4879" name="ln-4879" href="#ln-4879"></a><span class="w">    </span><span class="c">! wbice</span>
<a id="ln-4880" name="ln-4880" href="#ln-4880"></a><span class="w">    </span><span class="c">! wblf</span>
<a id="ln-4881" name="ln-4881" href="#ln-4881"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4882" name="ln-4882" href="#ln-4882"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4883" name="ln-4883" href="#ln-4883"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%wbtot(off), vaddr(vidx), ierr) ! 90</span>
<a id="ln-4884" name="ln-4884" href="#ln-4884"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4885" name="ln-4885" href="#ln-4885"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4886" name="ln-4886" href="#ln-4886"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wbtot</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4887" name="ln-4887" href="#ln-4887"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-4888" name="ln-4888" href="#ln-4888"></a>
<a id="ln-4889" name="ln-4889" href="#ln-4889"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4890" name="ln-4890" href="#ln-4890"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wb_lake</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4891" name="ln-4891" href="#ln-4891"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4892" name="ln-4892" href="#ln-4892"></a>
<a id="ln-4893" name="ln-4893" href="#ln-4893"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4894" name="ln-4894" href="#ln-4894"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">sinfil</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4895" name="ln-4895" href="#ln-4895"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4896" name="ln-4896" href="#ln-4896"></a>
<a id="ln-4897" name="ln-4897" href="#ln-4897"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4898" name="ln-4898" href="#ln-4898"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">qstss</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4899" name="ln-4899" href="#ln-4899"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4900" name="ln-4900" href="#ln-4900"></a>
<a id="ln-4901" name="ln-4901" href="#ln-4901"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4902" name="ln-4902" href="#ln-4902"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4903" name="ln-4903" href="#ln-4903"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%wetfac(off), vaddr(vidx), ierr) ! 91</span>
<a id="ln-4904" name="ln-4904" href="#ln-4904"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4905" name="ln-4905" href="#ln-4905"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4906" name="ln-4906" href="#ln-4906"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wetfac</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4907" name="ln-4907" href="#ln-4907"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4908" name="ln-4908" href="#ln-4908"></a>
<a id="ln-4909" name="ln-4909" href="#ln-4909"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4910" name="ln-4910" href="#ln-4910"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4911" name="ln-4911" href="#ln-4911"></a><span class="w">    </span><span class="c">! MPI: TODO: maybe not needed for transfer to master?</span>
<a id="ln-4912" name="ln-4912" href="#ln-4912"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (ssnow%owetfac(off), vaddr(vidx), ierr) ! 92</span>
<a id="ln-4913" name="ln-4913" href="#ln-4913"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4914" name="ln-4914" href="#ln-4914"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4915" name="ln-4915" href="#ln-4915"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">owetfac</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4916" name="ln-4916" href="#ln-4916"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4917" name="ln-4917" href="#ln-4917"></a>
<a id="ln-4918" name="ln-4918" href="#ln-4918"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4919" name="ln-4919" href="#ln-4919"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">t_snwlr</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4920" name="ln-4920" href="#ln-4920"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4921" name="ln-4921" href="#ln-4921"></a>
<a id="ln-4922" name="ln-4922" href="#ln-4922"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4923" name="ln-4923" href="#ln-4923"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">tggav</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4924" name="ln-4924" href="#ln-4924"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4925" name="ln-4925" href="#ln-4925"></a>
<a id="ln-4926" name="ln-4926" href="#ln-4926"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4927" name="ln-4927" href="#ln-4927"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">otss</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4928" name="ln-4928" href="#ln-4928"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4929" name="ln-4929" href="#ln-4929"></a>
<a id="ln-4930" name="ln-4930" href="#ln-4930"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4931" name="ln-4931" href="#ln-4931"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">otss_0</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4932" name="ln-4932" href="#ln-4932"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4933" name="ln-4933" href="#ln-4933"></a>
<a id="ln-4934" name="ln-4934" href="#ln-4934"></a>
<a id="ln-4935" name="ln-4935" href="#ln-4935"></a><span class="w">    </span><span class="c">! rad</span>
<a id="ln-4936" name="ln-4936" href="#ln-4936"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-4937" name="ln-4937" href="#ln-4937"></a><span class="w">    </span><span class="c">! albedo</span>
<a id="ln-4938" name="ln-4938" href="#ln-4938"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4939" name="ln-4939" href="#ln-4939"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4940" name="ln-4940" href="#ln-4940"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%extkb(off), vaddr(vidx), ierr) ! 93</span>
<a id="ln-4941" name="ln-4941" href="#ln-4941"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4942" name="ln-4942" href="#ln-4942"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4943" name="ln-4943" href="#ln-4943"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">extkb</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4944" name="ln-4944" href="#ln-4944"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4945" name="ln-4945" href="#ln-4945"></a>
<a id="ln-4946" name="ln-4946" href="#ln-4946"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4947" name="ln-4947" href="#ln-4947"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4948" name="ln-4948" href="#ln-4948"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%extkd2(off), vaddr(vidx), ierr) ! 94</span>
<a id="ln-4949" name="ln-4949" href="#ln-4949"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4950" name="ln-4950" href="#ln-4950"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4951" name="ln-4951" href="#ln-4951"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">extkd2</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4952" name="ln-4952" href="#ln-4952"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4953" name="ln-4953" href="#ln-4953"></a>
<a id="ln-4954" name="ln-4954" href="#ln-4954"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4955" name="ln-4955" href="#ln-4955"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4956" name="ln-4956" href="#ln-4956"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%extkd(off), vaddr(vidx), ierr) ! 95</span>
<a id="ln-4957" name="ln-4957" href="#ln-4957"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4958" name="ln-4958" href="#ln-4958"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4959" name="ln-4959" href="#ln-4959"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">extkd</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4960" name="ln-4960" href="#ln-4960"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4961" name="ln-4961" href="#ln-4961"></a>
<a id="ln-4962" name="ln-4962" href="#ln-4962"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4963" name="ln-4963" href="#ln-4963"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4964" name="ln-4964" href="#ln-4964"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%flws(off), vaddr(vidx), ierr) ! 96</span>
<a id="ln-4965" name="ln-4965" href="#ln-4965"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4966" name="ln-4966" href="#ln-4966"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4967" name="ln-4967" href="#ln-4967"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">flws</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4968" name="ln-4968" href="#ln-4968"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4969" name="ln-4969" href="#ln-4969"></a>
<a id="ln-4970" name="ln-4970" href="#ln-4970"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-4971" name="ln-4971" href="#ln-4971"></a><span class="w">    </span><span class="c">! fvlai</span>
<a id="ln-4972" name="ln-4972" href="#ln-4972"></a><span class="w">    </span><span class="c">! gradis</span>
<a id="ln-4973" name="ln-4973" href="#ln-4973"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4974" name="ln-4974" href="#ln-4974"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4975" name="ln-4975" href="#ln-4975"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%latitude(off), vaddr(vidx), ierr) ! 97</span>
<a id="ln-4976" name="ln-4976" href="#ln-4976"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4977" name="ln-4977" href="#ln-4977"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4978" name="ln-4978" href="#ln-4978"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">latitude</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4979" name="ln-4979" href="#ln-4979"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4980" name="ln-4980" href="#ln-4980"></a>
<a id="ln-4981" name="ln-4981" href="#ln-4981"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4982" name="ln-4982" href="#ln-4982"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4983" name="ln-4983" href="#ln-4983"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%lwabv(off), vaddr(vidx), ierr) !98</span>
<a id="ln-4984" name="ln-4984" href="#ln-4984"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4985" name="ln-4985" href="#ln-4985"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4986" name="ln-4986" href="#ln-4986"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">lwabv</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4987" name="ln-4987" href="#ln-4987"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4988" name="ln-4988" href="#ln-4988"></a>
<a id="ln-4989" name="ln-4989" href="#ln-4989"></a><span class="w">    </span><span class="c">! MPI: 3D vars moved above</span>
<a id="ln-4990" name="ln-4990" href="#ln-4990"></a><span class="w">    </span><span class="c">! qcan</span>
<a id="ln-4991" name="ln-4991" href="#ln-4991"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-4992" name="ln-4992" href="#ln-4992"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-4993" name="ln-4993" href="#ln-4993"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%qssabs(off), vaddr(vidx), ierr) !99</span>
<a id="ln-4994" name="ln-4994" href="#ln-4994"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-4995" name="ln-4995" href="#ln-4995"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-4996" name="ln-4996" href="#ln-4996"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">qssabs</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-4997" name="ln-4997" href="#ln-4997"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-4998" name="ln-4998" href="#ln-4998"></a>
<a id="ln-4999" name="ln-4999" href="#ln-4999"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-5000" name="ln-5000" href="#ln-5000"></a><span class="w">    </span><span class="c">! rhocdf</span>
<a id="ln-5001" name="ln-5001" href="#ln-5001"></a><span class="w">    </span><span class="c">! rniso</span>
<a id="ln-5002" name="ln-5002" href="#ln-5002"></a><span class="w">    </span><span class="c">! scalex</span>
<a id="ln-5003" name="ln-5003" href="#ln-5003"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5004" name="ln-5004" href="#ln-5004"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5005" name="ln-5005" href="#ln-5005"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%transd(off), vaddr(vidx), ierr) ! 100</span>
<a id="ln-5006" name="ln-5006" href="#ln-5006"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5007" name="ln-5007" href="#ln-5007"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5008" name="ln-5008" href="#ln-5008"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">transd</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5009" name="ln-5009" href="#ln-5009"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5010" name="ln-5010" href="#ln-5010"></a>
<a id="ln-5011" name="ln-5011" href="#ln-5011"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5012" name="ln-5012" href="#ln-5012"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5013" name="ln-5013" href="#ln-5013"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%trad(off), vaddr(vidx), ierr) ! 101</span>
<a id="ln-5014" name="ln-5014" href="#ln-5014"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5015" name="ln-5015" href="#ln-5015"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5016" name="ln-5016" href="#ln-5016"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">trad</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5017" name="ln-5017" href="#ln-5017"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5018" name="ln-5018" href="#ln-5018"></a>
<a id="ln-5019" name="ln-5019" href="#ln-5019"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5020" name="ln-5020" href="#ln-5020"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">rad</span><span class="p">%</span><span class="n">transb</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5021" name="ln-5021" href="#ln-5021"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5022" name="ln-5022" href="#ln-5022"></a>
<a id="ln-5023" name="ln-5023" href="#ln-5023"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-5024" name="ln-5024" href="#ln-5024"></a><span class="w">    </span><span class="c">! reffdf</span>
<a id="ln-5025" name="ln-5025" href="#ln-5025"></a><span class="w">    </span><span class="c">! reffbm</span>
<a id="ln-5026" name="ln-5026" href="#ln-5026"></a><span class="w">    </span><span class="c">! extkbm</span>
<a id="ln-5027" name="ln-5027" href="#ln-5027"></a><span class="w">    </span><span class="c">! extkdm</span>
<a id="ln-5028" name="ln-5028" href="#ln-5028"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5029" name="ln-5029" href="#ln-5029"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5030" name="ln-5030" href="#ln-5030"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%fbeam(off), vaddr(vidx), ierr) ! 102</span>
<a id="ln-5031" name="ln-5031" href="#ln-5031"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5032" name="ln-5032" href="#ln-5032"></a><span class="w">    </span><span class="c">! MPI: gol124: changed to 2D and moved up when Bernard</span>
<a id="ln-5033" name="ln-5033" href="#ln-5033"></a><span class="w">    </span><span class="c">! ported to CABLE_r491</span>
<a id="ln-5034" name="ln-5034" href="#ln-5034"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-5035" name="ln-5035" href="#ln-5035"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (rad%fbeam(off,1), displs(bidx), ierr)</span>
<a id="ln-5036" name="ln-5036" href="#ln-5036"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-5037" name="ln-5037" href="#ln-5037"></a>
<a id="ln-5038" name="ln-5038" href="#ln-5038"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-5039" name="ln-5039" href="#ln-5039"></a><span class="w">    </span><span class="c">! cexpkbm</span>
<a id="ln-5040" name="ln-5040" href="#ln-5040"></a><span class="w">    </span><span class="c">! cexpkdm</span>
<a id="ln-5041" name="ln-5041" href="#ln-5041"></a>
<a id="ln-5042" name="ln-5042" href="#ln-5042"></a><span class="w">    </span><span class="c">! bal</span>
<a id="ln-5043" name="ln-5043" href="#ln-5043"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5044" name="ln-5044" href="#ln-5044"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5045" name="ln-5045" href="#ln-5045"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%drybal(off), vaddr(vidx), ierr) ! 103</span>
<a id="ln-5046" name="ln-5046" href="#ln-5046"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5047" name="ln-5047" href="#ln-5047"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5048" name="ln-5048" href="#ln-5048"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">drybal</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5049" name="ln-5049" href="#ln-5049"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5050" name="ln-5050" href="#ln-5050"></a>
<a id="ln-5051" name="ln-5051" href="#ln-5051"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5052" name="ln-5052" href="#ln-5052"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5053" name="ln-5053" href="#ln-5053"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%ebal(off), vaddr(vidx), ierr) ! 104</span>
<a id="ln-5054" name="ln-5054" href="#ln-5054"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5055" name="ln-5055" href="#ln-5055"></a><span class="w">    </span><span class="c">! MPI: remove ebal from exchanged data, calculate temp val on the master</span>
<a id="ln-5056" name="ln-5056" href="#ln-5056"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-5057" name="ln-5057" href="#ln-5057"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%ebal(off), displs(bidx), ierr)</span>
<a id="ln-5058" name="ln-5058" href="#ln-5058"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-5059" name="ln-5059" href="#ln-5059"></a>
<a id="ln-5060" name="ln-5060" href="#ln-5060"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5061" name="ln-5061" href="#ln-5061"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5062" name="ln-5062" href="#ln-5062"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%ebal_tot(off), vaddr(vidx), ierr) ! 105</span>
<a id="ln-5063" name="ln-5063" href="#ln-5063"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5064" name="ln-5064" href="#ln-5064"></a><span class="w">    </span><span class="c">! MPI: remove ebal_tot from exchanged data, calculate val on the master</span>
<a id="ln-5065" name="ln-5065" href="#ln-5065"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-5066" name="ln-5066" href="#ln-5066"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%ebal_tot(off), displs(bidx), ierr)</span>
<a id="ln-5067" name="ln-5067" href="#ln-5067"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-5068" name="ln-5068" href="#ln-5068"></a>
<a id="ln-5069" name="ln-5069" href="#ln-5069"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5070" name="ln-5070" href="#ln-5070"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5071" name="ln-5071" href="#ln-5071"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%seb(off), vaddr(vidx), ierr) ! 106</span>
<a id="ln-5072" name="ln-5072" href="#ln-5072"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5073" name="ln-5073" href="#ln-5073"></a><span class="w">    </span><span class="c">! MPI: remove seb from exchanged data, calculate temp val on the master</span>
<a id="ln-5074" name="ln-5074" href="#ln-5074"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-5075" name="ln-5075" href="#ln-5075"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%seb(off), displs(bidx), ierr)</span>
<a id="ln-5076" name="ln-5076" href="#ln-5076"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-5077" name="ln-5077" href="#ln-5077"></a>
<a id="ln-5078" name="ln-5078" href="#ln-5078"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5079" name="ln-5079" href="#ln-5079"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5080" name="ln-5080" href="#ln-5080"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%seb_tot(off), vaddr(vidx), ierr) ! 107</span>
<a id="ln-5081" name="ln-5081" href="#ln-5081"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5082" name="ln-5082" href="#ln-5082"></a><span class="w">    </span><span class="c">! MPI: remove seb_tot from exchanged data, calculate val on the master</span>
<a id="ln-5083" name="ln-5083" href="#ln-5083"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-5084" name="ln-5084" href="#ln-5084"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%seb_tot(off), displs(bidx), ierr)</span>
<a id="ln-5085" name="ln-5085" href="#ln-5085"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-5086" name="ln-5086" href="#ln-5086"></a>
<a id="ln-5087" name="ln-5087" href="#ln-5087"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5088" name="ln-5088" href="#ln-5088"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5089" name="ln-5089" href="#ln-5089"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%evap_tot(off), vaddr(vidx), ierr) ! 108</span>
<a id="ln-5090" name="ln-5090" href="#ln-5090"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5091" name="ln-5091" href="#ln-5091"></a><span class="w">    </span><span class="c">! MPI: remove evap_tot from exchanged data</span>
<a id="ln-5092" name="ln-5092" href="#ln-5092"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-5093" name="ln-5093" href="#ln-5093"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%evap_tot(off), displs(bidx), ierr)</span>
<a id="ln-5094" name="ln-5094" href="#ln-5094"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-5095" name="ln-5095" href="#ln-5095"></a>
<a id="ln-5096" name="ln-5096" href="#ln-5096"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5097" name="ln-5097" href="#ln-5097"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5098" name="ln-5098" href="#ln-5098"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%osnowd0(off), vaddr(vidx), ierr) ! 109</span>
<a id="ln-5099" name="ln-5099" href="#ln-5099"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5100" name="ln-5100" href="#ln-5100"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5101" name="ln-5101" href="#ln-5101"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">osnowd0</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5102" name="ln-5102" href="#ln-5102"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5103" name="ln-5103" href="#ln-5103"></a>
<a id="ln-5104" name="ln-5104" href="#ln-5104"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5105" name="ln-5105" href="#ln-5105"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5106" name="ln-5106" href="#ln-5106"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%precip_tot(off), vaddr(vidx), ierr) ! 110</span>
<a id="ln-5107" name="ln-5107" href="#ln-5107"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5108" name="ln-5108" href="#ln-5108"></a><span class="w">    </span><span class="c">! MPI: remove wbal from exchanged data</span>
<a id="ln-5109" name="ln-5109" href="#ln-5109"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-5110" name="ln-5110" href="#ln-5110"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%precip_tot(off), displs(bidx), ierr)</span>
<a id="ln-5111" name="ln-5111" href="#ln-5111"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-5112" name="ln-5112" href="#ln-5112"></a>
<a id="ln-5113" name="ln-5113" href="#ln-5113"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5114" name="ln-5114" href="#ln-5114"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5115" name="ln-5115" href="#ln-5115"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%rnoff_tot(off), vaddr(vidx), ierr) ! 111</span>
<a id="ln-5116" name="ln-5116" href="#ln-5116"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5117" name="ln-5117" href="#ln-5117"></a><span class="w">    </span><span class="c">! MPI: remove wbal from exchanged data</span>
<a id="ln-5118" name="ln-5118" href="#ln-5118"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-5119" name="ln-5119" href="#ln-5119"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%rnoff_tot(off), displs(bidx), ierr)</span>
<a id="ln-5120" name="ln-5120" href="#ln-5120"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-5121" name="ln-5121" href="#ln-5121"></a>
<a id="ln-5122" name="ln-5122" href="#ln-5122"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5123" name="ln-5123" href="#ln-5123"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5124" name="ln-5124" href="#ln-5124"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%wbal(off), vaddr(vidx), ierr) ! 112</span>
<a id="ln-5125" name="ln-5125" href="#ln-5125"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5126" name="ln-5126" href="#ln-5126"></a><span class="w">    </span><span class="c">! MPI: remove wbal from exchanged data</span>
<a id="ln-5127" name="ln-5127" href="#ln-5127"></a><span class="w">    </span><span class="c">! bidx = bidx + 1</span>
<a id="ln-5128" name="ln-5128" href="#ln-5128"></a><span class="w">    </span><span class="c">! CALL MPI_Get_address (bal%wbal(off), displs(bidx), ierr)</span>
<a id="ln-5129" name="ln-5129" href="#ln-5129"></a><span class="w">    </span><span class="c">! blocks(bidx) = r1len</span>
<a id="ln-5130" name="ln-5130" href="#ln-5130"></a>
<a id="ln-5131" name="ln-5131" href="#ln-5131"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5132" name="ln-5132" href="#ln-5132"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5133" name="ln-5133" href="#ln-5133"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%wbal_tot(off), vaddr(vidx), ierr) ! 113</span>
<a id="ln-5134" name="ln-5134" href="#ln-5134"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5135" name="ln-5135" href="#ln-5135"></a><span class="w">    </span><span class="c">! MPI: remove wbal_tot from exchanged data</span>
<a id="ln-5136" name="ln-5136" href="#ln-5136"></a><span class="w">    </span><span class="c">!bidx = bidx + 1</span>
<a id="ln-5137" name="ln-5137" href="#ln-5137"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%wbal_tot(off), displs(bidx), ierr)</span>
<a id="ln-5138" name="ln-5138" href="#ln-5138"></a><span class="w">    </span><span class="c">!blocks(bidx) = r1len</span>
<a id="ln-5139" name="ln-5139" href="#ln-5139"></a>
<a id="ln-5140" name="ln-5140" href="#ln-5140"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5141" name="ln-5141" href="#ln-5141"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5142" name="ln-5142" href="#ln-5142"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%wbtot0(off), vaddr(vidx), ierr) ! 114</span>
<a id="ln-5143" name="ln-5143" href="#ln-5143"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5144" name="ln-5144" href="#ln-5144"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5145" name="ln-5145" href="#ln-5145"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">wbtot0</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5146" name="ln-5146" href="#ln-5146"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5147" name="ln-5147" href="#ln-5147"></a>
<a id="ln-5148" name="ln-5148" href="#ln-5148"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5149" name="ln-5149" href="#ln-5149"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5150" name="ln-5150" href="#ln-5150"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (bal%wetbal(off), vaddr(vidx), ierr) ! 115</span>
<a id="ln-5151" name="ln-5151" href="#ln-5151"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5152" name="ln-5152" href="#ln-5152"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5153" name="ln-5153" href="#ln-5153"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">bal</span><span class="p">%</span><span class="n">wetbal</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5154" name="ln-5154" href="#ln-5154"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5155" name="ln-5155" href="#ln-5155"></a>
<a id="ln-5156" name="ln-5156" href="#ln-5156"></a>
<a id="ln-5157" name="ln-5157" href="#ln-5157"></a><span class="w">    </span><span class="c">! air</span>
<a id="ln-5158" name="ln-5158" href="#ln-5158"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5159" name="ln-5159" href="#ln-5159"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5160" name="ln-5160" href="#ln-5160"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (air%rho(off), vaddr(vidx), ierr) ! 116</span>
<a id="ln-5161" name="ln-5161" href="#ln-5161"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5162" name="ln-5162" href="#ln-5162"></a>
<a id="ln-5163" name="ln-5163" href="#ln-5163"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-5164" name="ln-5164" href="#ln-5164"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5165" name="ln-5165" href="#ln-5165"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">rho</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5166" name="ln-5166" href="#ln-5166"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5167" name="ln-5167" href="#ln-5167"></a>
<a id="ln-5168" name="ln-5168" href="#ln-5168"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5169" name="ln-5169" href="#ln-5169"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5170" name="ln-5170" href="#ln-5170"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (air%volm(off), vaddr(vidx), ierr) ! 117</span>
<a id="ln-5171" name="ln-5171" href="#ln-5171"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5172" name="ln-5172" href="#ln-5172"></a>
<a id="ln-5173" name="ln-5173" href="#ln-5173"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-5174" name="ln-5174" href="#ln-5174"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5175" name="ln-5175" href="#ln-5175"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">volm</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5176" name="ln-5176" href="#ln-5176"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5177" name="ln-5177" href="#ln-5177"></a>
<a id="ln-5178" name="ln-5178" href="#ln-5178"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5179" name="ln-5179" href="#ln-5179"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5180" name="ln-5180" href="#ln-5180"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (air%rlam(off), vaddr(vidx), ierr) ! 118</span>
<a id="ln-5181" name="ln-5181" href="#ln-5181"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5182" name="ln-5182" href="#ln-5182"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5183" name="ln-5183" href="#ln-5183"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">rlam</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5184" name="ln-5184" href="#ln-5184"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5185" name="ln-5185" href="#ln-5185"></a>
<a id="ln-5186" name="ln-5186" href="#ln-5186"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5187" name="ln-5187" href="#ln-5187"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5188" name="ln-5188" href="#ln-5188"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (air%qsat(off), vaddr(vidx), ierr) ! 119</span>
<a id="ln-5189" name="ln-5189" href="#ln-5189"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5190" name="ln-5190" href="#ln-5190"></a>
<a id="ln-5191" name="ln-5191" href="#ln-5191"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-5192" name="ln-5192" href="#ln-5192"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5193" name="ln-5193" href="#ln-5193"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">qsat</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5194" name="ln-5194" href="#ln-5194"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5195" name="ln-5195" href="#ln-5195"></a>
<a id="ln-5196" name="ln-5196" href="#ln-5196"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5197" name="ln-5197" href="#ln-5197"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5198" name="ln-5198" href="#ln-5198"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (air%epsi(off), vaddr(vidx), ierr) ! 120</span>
<a id="ln-5199" name="ln-5199" href="#ln-5199"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5200" name="ln-5200" href="#ln-5200"></a>
<a id="ln-5201" name="ln-5201" href="#ln-5201"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-5202" name="ln-5202" href="#ln-5202"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5203" name="ln-5203" href="#ln-5203"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">epsi</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5204" name="ln-5204" href="#ln-5204"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5205" name="ln-5205" href="#ln-5205"></a>
<a id="ln-5206" name="ln-5206" href="#ln-5206"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5207" name="ln-5207" href="#ln-5207"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5208" name="ln-5208" href="#ln-5208"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (air%visc(off), vaddr(vidx), ierr) ! 121</span>
<a id="ln-5209" name="ln-5209" href="#ln-5209"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5210" name="ln-5210" href="#ln-5210"></a>
<a id="ln-5211" name="ln-5211" href="#ln-5211"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-5212" name="ln-5212" href="#ln-5212"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5213" name="ln-5213" href="#ln-5213"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">visc</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5214" name="ln-5214" href="#ln-5214"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5215" name="ln-5215" href="#ln-5215"></a>
<a id="ln-5216" name="ln-5216" href="#ln-5216"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5217" name="ln-5217" href="#ln-5217"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5218" name="ln-5218" href="#ln-5218"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (air%psyc(off), vaddr(vidx), ierr) ! 122</span>
<a id="ln-5219" name="ln-5219" href="#ln-5219"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5220" name="ln-5220" href="#ln-5220"></a>
<a id="ln-5221" name="ln-5221" href="#ln-5221"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-5222" name="ln-5222" href="#ln-5222"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5223" name="ln-5223" href="#ln-5223"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">psyc</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5224" name="ln-5224" href="#ln-5224"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5225" name="ln-5225" href="#ln-5225"></a>
<a id="ln-5226" name="ln-5226" href="#ln-5226"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5227" name="ln-5227" href="#ln-5227"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5228" name="ln-5228" href="#ln-5228"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (air%dsatdk(off), vaddr(vidx), ierr) ! 123</span>
<a id="ln-5229" name="ln-5229" href="#ln-5229"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5230" name="ln-5230" href="#ln-5230"></a>
<a id="ln-5231" name="ln-5231" href="#ln-5231"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-5232" name="ln-5232" href="#ln-5232"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5233" name="ln-5233" href="#ln-5233"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">dsatdk</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5234" name="ln-5234" href="#ln-5234"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5235" name="ln-5235" href="#ln-5235"></a>
<a id="ln-5236" name="ln-5236" href="#ln-5236"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5237" name="ln-5237" href="#ln-5237"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5238" name="ln-5238" href="#ln-5238"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (air%cmolar(off), vaddr(vidx), ierr) ! 124</span>
<a id="ln-5239" name="ln-5239" href="#ln-5239"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5240" name="ln-5240" href="#ln-5240"></a>
<a id="ln-5241" name="ln-5241" href="#ln-5241"></a><span class="w">    </span><span class="c">! TODO: skip, used for restart but not output</span>
<a id="ln-5242" name="ln-5242" href="#ln-5242"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5243" name="ln-5243" href="#ln-5243"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">cmolar</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5244" name="ln-5244" href="#ln-5244"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5245" name="ln-5245" href="#ln-5245"></a>
<a id="ln-5246" name="ln-5246" href="#ln-5246"></a>
<a id="ln-5247" name="ln-5247" href="#ln-5247"></a><span class="w">    </span><span class="c">! soil</span>
<a id="ln-5248" name="ln-5248" href="#ln-5248"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-5249" name="ln-5249" href="#ln-5249"></a><span class="w">    </span><span class="c">! albsoil</span>
<a id="ln-5250" name="ln-5250" href="#ln-5250"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5251" name="ln-5251" href="#ln-5251"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5252" name="ln-5252" href="#ln-5252"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%bch(off), vaddr(vidx), ierr) ! 125</span>
<a id="ln-5253" name="ln-5253" href="#ln-5253"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5254" name="ln-5254" href="#ln-5254"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5255" name="ln-5255" href="#ln-5255"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">bch</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5256" name="ln-5256" href="#ln-5256"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5257" name="ln-5257" href="#ln-5257"></a>
<a id="ln-5258" name="ln-5258" href="#ln-5258"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5259" name="ln-5259" href="#ln-5259"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5260" name="ln-5260" href="#ln-5260"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%c3(off), vaddr(vidx), ierr) ! 126</span>
<a id="ln-5261" name="ln-5261" href="#ln-5261"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5262" name="ln-5262" href="#ln-5262"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5263" name="ln-5263" href="#ln-5263"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">c3</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5264" name="ln-5264" href="#ln-5264"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5265" name="ln-5265" href="#ln-5265"></a>
<a id="ln-5266" name="ln-5266" href="#ln-5266"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5267" name="ln-5267" href="#ln-5267"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5268" name="ln-5268" href="#ln-5268"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%clay(off), vaddr(vidx), ierr) ! 127</span>
<a id="ln-5269" name="ln-5269" href="#ln-5269"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5270" name="ln-5270" href="#ln-5270"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5271" name="ln-5271" href="#ln-5271"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">clay</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5272" name="ln-5272" href="#ln-5272"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5273" name="ln-5273" href="#ln-5273"></a>
<a id="ln-5274" name="ln-5274" href="#ln-5274"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5275" name="ln-5275" href="#ln-5275"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5276" name="ln-5276" href="#ln-5276"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%cnsd(off), vaddr(vidx), ierr) ! 128</span>
<a id="ln-5277" name="ln-5277" href="#ln-5277"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5278" name="ln-5278" href="#ln-5278"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5279" name="ln-5279" href="#ln-5279"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">cnsd</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5280" name="ln-5280" href="#ln-5280"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-5281" name="ln-5281" href="#ln-5281"></a>
<a id="ln-5282" name="ln-5282" href="#ln-5282"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5283" name="ln-5283" href="#ln-5283"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5284" name="ln-5284" href="#ln-5284"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%css(off), vaddr(vidx), ierr) ! 129</span>
<a id="ln-5285" name="ln-5285" href="#ln-5285"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5286" name="ln-5286" href="#ln-5286"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5287" name="ln-5287" href="#ln-5287"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">css</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5288" name="ln-5288" href="#ln-5288"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5289" name="ln-5289" href="#ln-5289"></a>
<a id="ln-5290" name="ln-5290" href="#ln-5290"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5291" name="ln-5291" href="#ln-5291"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5292" name="ln-5292" href="#ln-5292"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%hsbh(off), vaddr(vidx), ierr) ! 130</span>
<a id="ln-5293" name="ln-5293" href="#ln-5293"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5294" name="ln-5294" href="#ln-5294"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5295" name="ln-5295" href="#ln-5295"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">hsbh</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5296" name="ln-5296" href="#ln-5296"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5297" name="ln-5297" href="#ln-5297"></a>
<a id="ln-5298" name="ln-5298" href="#ln-5298"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5299" name="ln-5299" href="#ln-5299"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5300" name="ln-5300" href="#ln-5300"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%hyds(off), vaddr(vidx), ierr) ! 131</span>
<a id="ln-5301" name="ln-5301" href="#ln-5301"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5302" name="ln-5302" href="#ln-5302"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5303" name="ln-5303" href="#ln-5303"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">hyds</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5304" name="ln-5304" href="#ln-5304"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5305" name="ln-5305" href="#ln-5305"></a>
<a id="ln-5306" name="ln-5306" href="#ln-5306"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5307" name="ln-5307" href="#ln-5307"></a><span class="w">    </span><span class="c">! INTEGER(i_d)</span>
<a id="ln-5308" name="ln-5308" href="#ln-5308"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%i2bp3(off), vaddr(vidx), ierr) ! 132</span>
<a id="ln-5309" name="ln-5309" href="#ln-5309"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extid</span>
<a id="ln-5310" name="ln-5310" href="#ln-5310"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5311" name="ln-5311" href="#ln-5311"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">i2bp3</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5312" name="ln-5312" href="#ln-5312"></a><span class="w">    </span><span class="c">! Maciej: i2bp3 is REAL</span>
<a id="ln-5313" name="ln-5313" href="#ln-5313"></a><span class="w">    </span><span class="c">!    blocks(bidx) = I1LEN</span>
<a id="ln-5314" name="ln-5314" href="#ln-5314"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R1LEN</span><span class="w"></span>
<a id="ln-5315" name="ln-5315" href="#ln-5315"></a>
<a id="ln-5316" name="ln-5316" href="#ln-5316"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5317" name="ln-5317" href="#ln-5317"></a><span class="w">    </span><span class="c">! INTEGER(i_d)</span>
<a id="ln-5318" name="ln-5318" href="#ln-5318"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%ibp2(off), vaddr(vidx), ierr) ! 133</span>
<a id="ln-5319" name="ln-5319" href="#ln-5319"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extid</span>
<a id="ln-5320" name="ln-5320" href="#ln-5320"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5321" name="ln-5321" href="#ln-5321"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">ibp2</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5322" name="ln-5322" href="#ln-5322"></a><span class="w">    </span><span class="c">! Maciej: ibp2 is REAL</span>
<a id="ln-5323" name="ln-5323" href="#ln-5323"></a><span class="w">    </span><span class="c">!    blocks(bidx) = I1LEN</span>
<a id="ln-5324" name="ln-5324" href="#ln-5324"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R1LEN</span><span class="w"></span>
<a id="ln-5325" name="ln-5325" href="#ln-5325"></a>
<a id="ln-5326" name="ln-5326" href="#ln-5326"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5327" name="ln-5327" href="#ln-5327"></a><span class="w">    </span><span class="c">! INTEGER(i_d)</span>
<a id="ln-5328" name="ln-5328" href="#ln-5328"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%isoilm(off), vaddr(vidx), ierr) ! 134</span>
<a id="ln-5329" name="ln-5329" href="#ln-5329"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extid</span>
<a id="ln-5330" name="ln-5330" href="#ln-5330"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5331" name="ln-5331" href="#ln-5331"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">isoilm</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5332" name="ln-5332" href="#ln-5332"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-5333" name="ln-5333" href="#ln-5333"></a>
<a id="ln-5334" name="ln-5334" href="#ln-5334"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5335" name="ln-5335" href="#ln-5335"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5336" name="ln-5336" href="#ln-5336"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%rhosoil(off), vaddr(vidx), ierr) ! 135</span>
<a id="ln-5337" name="ln-5337" href="#ln-5337"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5338" name="ln-5338" href="#ln-5338"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5339" name="ln-5339" href="#ln-5339"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">rhosoil</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5340" name="ln-5340" href="#ln-5340"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5341" name="ln-5341" href="#ln-5341"></a>
<a id="ln-5342" name="ln-5342" href="#ln-5342"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5343" name="ln-5343" href="#ln-5343"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5344" name="ln-5344" href="#ln-5344"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%rs20(off), vaddr(vidx), ierr) ! 136</span>
<a id="ln-5345" name="ln-5345" href="#ln-5345"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5346" name="ln-5346" href="#ln-5346"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5347" name="ln-5347" href="#ln-5347"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">rs20</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5348" name="ln-5348" href="#ln-5348"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5349" name="ln-5349" href="#ln-5349"></a>
<a id="ln-5350" name="ln-5350" href="#ln-5350"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5351" name="ln-5351" href="#ln-5351"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5352" name="ln-5352" href="#ln-5352"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%sand(off), vaddr(vidx), ierr) ! 137</span>
<a id="ln-5353" name="ln-5353" href="#ln-5353"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5354" name="ln-5354" href="#ln-5354"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5355" name="ln-5355" href="#ln-5355"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">sand</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5356" name="ln-5356" href="#ln-5356"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5357" name="ln-5357" href="#ln-5357"></a>
<a id="ln-5358" name="ln-5358" href="#ln-5358"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5359" name="ln-5359" href="#ln-5359"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5360" name="ln-5360" href="#ln-5360"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%sfc(off), vaddr(vidx), ierr) ! 138</span>
<a id="ln-5361" name="ln-5361" href="#ln-5361"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5362" name="ln-5362" href="#ln-5362"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5363" name="ln-5363" href="#ln-5363"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">sfc</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5364" name="ln-5364" href="#ln-5364"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5365" name="ln-5365" href="#ln-5365"></a>
<a id="ln-5366" name="ln-5366" href="#ln-5366"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5367" name="ln-5367" href="#ln-5367"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5368" name="ln-5368" href="#ln-5368"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%silt(off), vaddr(vidx), ierr) ! 139</span>
<a id="ln-5369" name="ln-5369" href="#ln-5369"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5370" name="ln-5370" href="#ln-5370"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5371" name="ln-5371" href="#ln-5371"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">silt</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5372" name="ln-5372" href="#ln-5372"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5373" name="ln-5373" href="#ln-5373"></a>
<a id="ln-5374" name="ln-5374" href="#ln-5374"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5375" name="ln-5375" href="#ln-5375"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5376" name="ln-5376" href="#ln-5376"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%ssat(off), vaddr(vidx), ierr) ! 140</span>
<a id="ln-5377" name="ln-5377" href="#ln-5377"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5378" name="ln-5378" href="#ln-5378"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5379" name="ln-5379" href="#ln-5379"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">ssat</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5380" name="ln-5380" href="#ln-5380"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5381" name="ln-5381" href="#ln-5381"></a>
<a id="ln-5382" name="ln-5382" href="#ln-5382"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5383" name="ln-5383" href="#ln-5383"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5384" name="ln-5384" href="#ln-5384"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%sucs(off), vaddr(vidx), ierr) ! 141</span>
<a id="ln-5385" name="ln-5385" href="#ln-5385"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5386" name="ln-5386" href="#ln-5386"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5387" name="ln-5387" href="#ln-5387"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">sucs</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5388" name="ln-5388" href="#ln-5388"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5389" name="ln-5389" href="#ln-5389"></a>
<a id="ln-5390" name="ln-5390" href="#ln-5390"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5391" name="ln-5391" href="#ln-5391"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5392" name="ln-5392" href="#ln-5392"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (soil%swilt(off), vaddr(vidx), ierr) ! 142</span>
<a id="ln-5393" name="ln-5393" href="#ln-5393"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5394" name="ln-5394" href="#ln-5394"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5395" name="ln-5395" href="#ln-5395"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">soil</span><span class="p">%</span><span class="n">swilt</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5396" name="ln-5396" href="#ln-5396"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5397" name="ln-5397" href="#ln-5397"></a>
<a id="ln-5398" name="ln-5398" href="#ln-5398"></a>
<a id="ln-5399" name="ln-5399" href="#ln-5399"></a><span class="w">    </span><span class="c">! veg</span>
<a id="ln-5400" name="ln-5400" href="#ln-5400"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5401" name="ln-5401" href="#ln-5401"></a><span class="w">    </span><span class="c">! INTEGER(i_d)</span>
<a id="ln-5402" name="ln-5402" href="#ln-5402"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%iveg(off), vaddr(vidx), ierr) ! 143</span>
<a id="ln-5403" name="ln-5403" href="#ln-5403"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extid</span>
<a id="ln-5404" name="ln-5404" href="#ln-5404"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5405" name="ln-5405" href="#ln-5405"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">iveg</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5406" name="ln-5406" href="#ln-5406"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-5407" name="ln-5407" href="#ln-5407"></a>
<a id="ln-5408" name="ln-5408" href="#ln-5408"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5409" name="ln-5409" href="#ln-5409"></a><span class="w">    </span><span class="c">! INTEGER(i_d)</span>
<a id="ln-5410" name="ln-5410" href="#ln-5410"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%meth(off), vaddr(vidx), ierr) ! 144</span>
<a id="ln-5411" name="ln-5411" href="#ln-5411"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extid</span>
<a id="ln-5412" name="ln-5412" href="#ln-5412"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5413" name="ln-5413" href="#ln-5413"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">meth</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5414" name="ln-5414" href="#ln-5414"></a><span class="w">    </span><span class="c">! Maciej: veg%meth is REAL</span>
<a id="ln-5415" name="ln-5415" href="#ln-5415"></a><span class="w">    </span><span class="c">!    blocks(bidx) = I1LEN</span>
<a id="ln-5416" name="ln-5416" href="#ln-5416"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R1LEN</span><span class="w"></span>
<a id="ln-5417" name="ln-5417" href="#ln-5417"></a>
<a id="ln-5418" name="ln-5418" href="#ln-5418"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5419" name="ln-5419" href="#ln-5419"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5420" name="ln-5420" href="#ln-5420"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%vlai(off), vaddr(vidx), ierr) ! 145</span>
<a id="ln-5421" name="ln-5421" href="#ln-5421"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5422" name="ln-5422" href="#ln-5422"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5423" name="ln-5423" href="#ln-5423"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">vlai</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5424" name="ln-5424" href="#ln-5424"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5425" name="ln-5425" href="#ln-5425"></a>
<a id="ln-5426" name="ln-5426" href="#ln-5426"></a><span class="w">    </span><span class="c">! MPI: 2D vars moved above</span>
<a id="ln-5427" name="ln-5427" href="#ln-5427"></a><span class="w">    </span><span class="c">! froot</span>
<a id="ln-5428" name="ln-5428" href="#ln-5428"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5429" name="ln-5429" href="#ln-5429"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5430" name="ln-5430" href="#ln-5430"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%canst1(off), vaddr(vidx), ierr) ! 146</span>
<a id="ln-5431" name="ln-5431" href="#ln-5431"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5432" name="ln-5432" href="#ln-5432"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5433" name="ln-5433" href="#ln-5433"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">canst1</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5434" name="ln-5434" href="#ln-5434"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5435" name="ln-5435" href="#ln-5435"></a>
<a id="ln-5436" name="ln-5436" href="#ln-5436"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5437" name="ln-5437" href="#ln-5437"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5438" name="ln-5438" href="#ln-5438"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%ejmax(off), vaddr(vidx), ierr) ! 147</span>
<a id="ln-5439" name="ln-5439" href="#ln-5439"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5440" name="ln-5440" href="#ln-5440"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5441" name="ln-5441" href="#ln-5441"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">ejmax</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5442" name="ln-5442" href="#ln-5442"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5443" name="ln-5443" href="#ln-5443"></a>
<a id="ln-5444" name="ln-5444" href="#ln-5444"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5445" name="ln-5445" href="#ln-5445"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5446" name="ln-5446" href="#ln-5446"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%frac4(off), vaddr(vidx), ierr) ! 148</span>
<a id="ln-5447" name="ln-5447" href="#ln-5447"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5448" name="ln-5448" href="#ln-5448"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5449" name="ln-5449" href="#ln-5449"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">frac4</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5450" name="ln-5450" href="#ln-5450"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5451" name="ln-5451" href="#ln-5451"></a>
<a id="ln-5452" name="ln-5452" href="#ln-5452"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5453" name="ln-5453" href="#ln-5453"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5454" name="ln-5454" href="#ln-5454"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%wai(off), vaddr(vidx), ierr) ! 149</span>
<a id="ln-5455" name="ln-5455" href="#ln-5455"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5456" name="ln-5456" href="#ln-5456"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5457" name="ln-5457" href="#ln-5457"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">wai</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5458" name="ln-5458" href="#ln-5458"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5459" name="ln-5459" href="#ln-5459"></a>
<a id="ln-5460" name="ln-5460" href="#ln-5460"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5461" name="ln-5461" href="#ln-5461"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5462" name="ln-5462" href="#ln-5462"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%vegcf(off), vaddr(vidx), ierr) ! 150</span>
<a id="ln-5463" name="ln-5463" href="#ln-5463"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5464" name="ln-5464" href="#ln-5464"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5465" name="ln-5465" href="#ln-5465"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">vegcf</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5466" name="ln-5466" href="#ln-5466"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5467" name="ln-5467" href="#ln-5467"></a>
<a id="ln-5468" name="ln-5468" href="#ln-5468"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5469" name="ln-5469" href="#ln-5469"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5470" name="ln-5470" href="#ln-5470"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%tminvj(off), vaddr(vidx), ierr) ! 151</span>
<a id="ln-5471" name="ln-5471" href="#ln-5471"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5472" name="ln-5472" href="#ln-5472"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5473" name="ln-5473" href="#ln-5473"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">tminvj</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5474" name="ln-5474" href="#ln-5474"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5475" name="ln-5475" href="#ln-5475"></a>
<a id="ln-5476" name="ln-5476" href="#ln-5476"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5477" name="ln-5477" href="#ln-5477"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5478" name="ln-5478" href="#ln-5478"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%tmaxvj(off), vaddr(vidx), ierr) ! 152</span>
<a id="ln-5479" name="ln-5479" href="#ln-5479"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5480" name="ln-5480" href="#ln-5480"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5481" name="ln-5481" href="#ln-5481"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">tmaxvj</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5482" name="ln-5482" href="#ln-5482"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5483" name="ln-5483" href="#ln-5483"></a>
<a id="ln-5484" name="ln-5484" href="#ln-5484"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5485" name="ln-5485" href="#ln-5485"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5486" name="ln-5486" href="#ln-5486"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%vbeta(off), vaddr(vidx), ierr) ! 153</span>
<a id="ln-5487" name="ln-5487" href="#ln-5487"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5488" name="ln-5488" href="#ln-5488"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5489" name="ln-5489" href="#ln-5489"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">vbeta</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5490" name="ln-5490" href="#ln-5490"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5491" name="ln-5491" href="#ln-5491"></a>
<a id="ln-5492" name="ln-5492" href="#ln-5492"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5493" name="ln-5493" href="#ln-5493"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5494" name="ln-5494" href="#ln-5494"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%xalbnir(off), vaddr(vidx), ierr) ! 154</span>
<a id="ln-5495" name="ln-5495" href="#ln-5495"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5496" name="ln-5496" href="#ln-5496"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5497" name="ln-5497" href="#ln-5497"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">xalbnir</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5498" name="ln-5498" href="#ln-5498"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5499" name="ln-5499" href="#ln-5499"></a>
<a id="ln-5500" name="ln-5500" href="#ln-5500"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5501" name="ln-5501" href="#ln-5501"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5502" name="ln-5502" href="#ln-5502"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%hc(off), vaddr(vidx), ierr) ! 155</span>
<a id="ln-5503" name="ln-5503" href="#ln-5503"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5504" name="ln-5504" href="#ln-5504"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5505" name="ln-5505" href="#ln-5505"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">hc</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5506" name="ln-5506" href="#ln-5506"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5507" name="ln-5507" href="#ln-5507"></a>
<a id="ln-5508" name="ln-5508" href="#ln-5508"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5509" name="ln-5509" href="#ln-5509"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5510" name="ln-5510" href="#ln-5510"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%shelrb(off), vaddr(vidx), ierr) ! 156</span>
<a id="ln-5511" name="ln-5511" href="#ln-5511"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5512" name="ln-5512" href="#ln-5512"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5513" name="ln-5513" href="#ln-5513"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">shelrb</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5514" name="ln-5514" href="#ln-5514"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5515" name="ln-5515" href="#ln-5515"></a>
<a id="ln-5516" name="ln-5516" href="#ln-5516"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5517" name="ln-5517" href="#ln-5517"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5518" name="ln-5518" href="#ln-5518"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%vcmax(off), vaddr(vidx), ierr) ! 157</span>
<a id="ln-5519" name="ln-5519" href="#ln-5519"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5520" name="ln-5520" href="#ln-5520"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5521" name="ln-5521" href="#ln-5521"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">vcmax</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5522" name="ln-5522" href="#ln-5522"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5523" name="ln-5523" href="#ln-5523"></a>
<a id="ln-5524" name="ln-5524" href="#ln-5524"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5525" name="ln-5525" href="#ln-5525"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5526" name="ln-5526" href="#ln-5526"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%xfang(off), vaddr(vidx), ierr) ! 158</span>
<a id="ln-5527" name="ln-5527" href="#ln-5527"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5528" name="ln-5528" href="#ln-5528"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5529" name="ln-5529" href="#ln-5529"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">xfang</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5530" name="ln-5530" href="#ln-5530"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5531" name="ln-5531" href="#ln-5531"></a>
<a id="ln-5532" name="ln-5532" href="#ln-5532"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5533" name="ln-5533" href="#ln-5533"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5534" name="ln-5534" href="#ln-5534"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%dleaf(off), vaddr(vidx), ierr) ! 159</span>
<a id="ln-5535" name="ln-5535" href="#ln-5535"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5536" name="ln-5536" href="#ln-5536"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5537" name="ln-5537" href="#ln-5537"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">dleaf</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5538" name="ln-5538" href="#ln-5538"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5539" name="ln-5539" href="#ln-5539"></a>
<a id="ln-5540" name="ln-5540" href="#ln-5540"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5541" name="ln-5541" href="#ln-5541"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5542" name="ln-5542" href="#ln-5542"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%rp20(off), vaddr(vidx), ierr) ! 160</span>
<a id="ln-5543" name="ln-5543" href="#ln-5543"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5544" name="ln-5544" href="#ln-5544"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5545" name="ln-5545" href="#ln-5545"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">rp20</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5546" name="ln-5546" href="#ln-5546"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5547" name="ln-5547" href="#ln-5547"></a>
<a id="ln-5548" name="ln-5548" href="#ln-5548"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5549" name="ln-5549" href="#ln-5549"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5550" name="ln-5550" href="#ln-5550"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%rpcoef(off), vaddr(vidx), ierr) ! 161</span>
<a id="ln-5551" name="ln-5551" href="#ln-5551"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5552" name="ln-5552" href="#ln-5552"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5553" name="ln-5553" href="#ln-5553"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">rpcoef</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5554" name="ln-5554" href="#ln-5554"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5555" name="ln-5555" href="#ln-5555"></a>
<a id="ln-5556" name="ln-5556" href="#ln-5556"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5557" name="ln-5557" href="#ln-5557"></a><span class="w">    </span><span class="c">! REAL(r_1)</span>
<a id="ln-5558" name="ln-5558" href="#ln-5558"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%extkn(off), vaddr(vidx), ierr) ! 162</span>
<a id="ln-5559" name="ln-5559" href="#ln-5559"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extr1</span>
<a id="ln-5560" name="ln-5560" href="#ln-5560"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5561" name="ln-5561" href="#ln-5561"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">extkn</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5562" name="ln-5562" href="#ln-5562"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-5563" name="ln-5563" href="#ln-5563"></a>
<a id="ln-5564" name="ln-5564" href="#ln-5564"></a><span class="w">    </span><span class="c">!vidx = vidx + 1</span>
<a id="ln-5565" name="ln-5565" href="#ln-5565"></a><span class="w">    </span><span class="c">! LOGICAL</span>
<a id="ln-5566" name="ln-5566" href="#ln-5566"></a><span class="w">    </span><span class="c">!CALL MPI_Get_address (veg%deciduous(off), vaddr(vidx), ierr) ! 163</span>
<a id="ln-5567" name="ln-5567" href="#ln-5567"></a><span class="w">    </span><span class="c">!blen(vidx) = cnt * extl</span>
<a id="ln-5568" name="ln-5568" href="#ln-5568"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5569" name="ln-5569" href="#ln-5569"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">veg</span><span class="p">%</span><span class="n">deciduous</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5570" name="ln-5570" href="#ln-5570"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">llen</span><span class="w"></span>
<a id="ln-5571" name="ln-5571" href="#ln-5571"></a>
<a id="ln-5572" name="ln-5572" href="#ln-5572"></a><span class="w">    </span><span class="c">!mrd 1D GW</span>
<a id="ln-5573" name="ln-5573" href="#ln-5573"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5574" name="ln-5574" href="#ln-5574"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">GWwb</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5575" name="ln-5575" href="#ln-5575"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-5576" name="ln-5576" href="#ln-5576"></a>
<a id="ln-5577" name="ln-5577" href="#ln-5577"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5578" name="ln-5578" href="#ln-5578"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">wtd</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5579" name="ln-5579" href="#ln-5579"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-5580" name="ln-5580" href="#ln-5580"></a>
<a id="ln-5581" name="ln-5581" href="#ln-5581"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5582" name="ln-5582" href="#ln-5582"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">satfrac</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5583" name="ln-5583" href="#ln-5583"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-5584" name="ln-5584" href="#ln-5584"></a>
<a id="ln-5585" name="ln-5585" href="#ln-5585"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5586" name="ln-5586" href="#ln-5586"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">Qrecharge</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5587" name="ln-5587" href="#ln-5587"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-5588" name="ln-5588" href="#ln-5588"></a>
<a id="ln-5589" name="ln-5589" href="#ln-5589"></a><span class="w">    </span><span class="c">! additional for SLI</span>
<a id="ln-5590" name="ln-5590" href="#ln-5590"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5591" name="ln-5591" href="#ln-5591"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">Tsurface</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5592" name="ln-5592" href="#ln-5592"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-5593" name="ln-5593" href="#ln-5593"></a>
<a id="ln-5594" name="ln-5594" href="#ln-5594"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5595" name="ln-5595" href="#ln-5595"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">h0</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5596" name="ln-5596" href="#ln-5596"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-5597" name="ln-5597" href="#ln-5597"></a>
<a id="ln-5598" name="ln-5598" href="#ln-5598"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5599" name="ln-5599" href="#ln-5599"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">delwcol</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5600" name="ln-5600" href="#ln-5600"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-5601" name="ln-5601" href="#ln-5601"></a>
<a id="ln-5602" name="ln-5602" href="#ln-5602"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5603" name="ln-5603" href="#ln-5603"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">evap</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5604" name="ln-5604" href="#ln-5604"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-5605" name="ln-5605" href="#ln-5605"></a>
<a id="ln-5606" name="ln-5606" href="#ln-5606"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5607" name="ln-5607" href="#ln-5607"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">nsnow</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5608" name="ln-5608" href="#ln-5608"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-5609" name="ln-5609" href="#ln-5609"></a>
<a id="ln-5610" name="ln-5610" href="#ln-5610"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5611" name="ln-5611" href="#ln-5611"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">ssnow</span><span class="p">%</span><span class="n">nsteps</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5612" name="ln-5612" href="#ln-5612"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-5613" name="ln-5613" href="#ln-5613"></a><span class="w">    </span><span class="c">! end additional for SLI</span>
<a id="ln-5614" name="ln-5614" href="#ln-5614"></a>
<a id="ln-5615" name="ln-5615" href="#ln-5615"></a>
<a id="ln-5616" name="ln-5616" href="#ln-5616"></a><span class="w">    </span><span class="c">! MPI: sanity check</span>
<a id="ln-5617" name="ln-5617" href="#ln-5617"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ntyp</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-5618" name="ln-5618" href="#ln-5618"></a><span class="k">       WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s1">&#39;: invalid outtype nmat, nvec or n3d constant, fix it!&#39;</span><span class="w"></span>
<a id="ln-5619" name="ln-5619" href="#ln-5619"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;bidx: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">bidx</span><span class="w"></span>
<a id="ln-5620" name="ln-5620" href="#ln-5620"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;nvec: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nvec</span><span class="w"></span>
<a id="ln-5621" name="ln-5621" href="#ln-5621"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;n3d:&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n3d</span><span class="w"></span>
<a id="ln-5622" name="ln-5622" href="#ln-5622"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ntyp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ntyp</span><span class="w"></span>
<a id="ln-5623" name="ln-5623" href="#ln-5623"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Abort</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5624" name="ln-5624" href="#ln-5624"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-5625" name="ln-5625" href="#ln-5625"></a>
<a id="ln-5626" name="ln-5626" href="#ln-5626"></a><span class="k">    </span><span class="n">types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-5627" name="ln-5627" href="#ln-5627"></a>
<a id="ln-5628" name="ln-5628" href="#ln-5628"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_create_struct</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">blocks</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">send_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5629" name="ln-5629" href="#ln-5629"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_commit</span><span class="w"> </span><span class="p">(</span><span class="n">send_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5630" name="ln-5630" href="#ln-5630"></a>
<a id="ln-5631" name="ln-5631" href="#ln-5631"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_size</span><span class="w"> </span><span class="p">(</span><span class="n">send_t</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5632" name="ln-5632" href="#ln-5632"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_get_extent</span><span class="w"> </span><span class="p">(</span><span class="n">send_t</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5633" name="ln-5633" href="#ln-5633"></a>
<a id="ln-5634" name="ln-5634" href="#ln-5634"></a><span class="w">    </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s1">&#39;: struct blocks, size, extent and lb: &#39;</span><span class="p">,</span><span class="n">bidx</span><span class="p">,</span><span class="n">tsize</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-5635" name="ln-5635" href="#ln-5635"></a>
<a id="ln-5636" name="ln-5636" href="#ln-5636"></a><span class="w">    </span><span class="c">! MPI: check whether total size of received data equals total</span>
<a id="ln-5637" name="ln-5637" href="#ln-5637"></a><span class="w">    </span><span class="c">! data sent by all the workers</span>
<a id="ln-5638" name="ln-5638" href="#ln-5638"></a><span class="w">    </span><span class="c">!mcd287  CALL MPI_Reduce (tsize, tsize, 1, MPI_INTEGER, MPI_SUM, 0, comm, ierr)</span>
<a id="ln-5639" name="ln-5639" href="#ln-5639"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Reduce</span><span class="w"> </span><span class="p">(</span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DATATYPE_NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5640" name="ln-5640" href="#ln-5640"></a>
<a id="ln-5641" name="ln-5641" href="#ln-5641"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="w"></span>
<a id="ln-5642" name="ln-5642" href="#ln-5642"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">displs</span><span class="p">)</span><span class="w"></span>
<a id="ln-5643" name="ln-5643" href="#ln-5643"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span><span class="w"></span>
<a id="ln-5644" name="ln-5644" href="#ln-5644"></a>
<a id="ln-5645" name="ln-5645" href="#ln-5645"></a><span class="w">    </span><span class="k">RETURN</span>
<a id="ln-5646" name="ln-5646" href="#ln-5646"></a>
<a id="ln-5647" name="ln-5647" href="#ln-5647"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_outtype</span><span class="w"></span>
<a id="ln-5648" name="ln-5648" href="#ln-5648"></a>
<a id="ln-5649" name="ln-5649" href="#ln-5649"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_time_update</span><span class="w"> </span><span class="p">(</span><span class="n">met</span><span class="p">,</span><span class="w"> </span><span class="n">kend</span><span class="p">,</span><span class="w"> </span><span class="n">dels</span><span class="p">)</span><span class="w"></span>
<a id="ln-5650" name="ln-5650" href="#ln-5650"></a>
<a id="ln-5651" name="ln-5651" href="#ln-5651"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_common_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">ktau_gl</span><span class="w"></span>
<a id="ln-5652" name="ln-5652" href="#ln-5652"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-5653" name="ln-5653" href="#ln-5653"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_IO_vars_module</span><span class="w"></span>
<a id="ln-5654" name="ln-5654" href="#ln-5654"></a>
<a id="ln-5655" name="ln-5655" href="#ln-5655"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span>
<a id="ln-5656" name="ln-5656" href="#ln-5656"></a>
<a id="ln-5657" name="ln-5657" href="#ln-5657"></a><span class="k">    TYPE</span><span class="p">(</span><span class="n">met_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">met</span><span class="w"></span>
<a id="ln-5658" name="ln-5658" href="#ln-5658"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">kend</span><span class="w"> </span><span class="c">! number of time steps in simulation</span>
<a id="ln-5659" name="ln-5659" href="#ln-5659"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dels</span><span class="w"> </span><span class="c">! time step size</span>
<a id="ln-5660" name="ln-5660" href="#ln-5660"></a>
<a id="ln-5661" name="ln-5661" href="#ln-5661"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<a id="ln-5662" name="ln-5662" href="#ln-5662"></a>
<a id="ln-5663" name="ln-5663" href="#ln-5663"></a><span class="w">    </span><span class="k">DO </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mland</span><span class="w"> </span><span class="c">! over all land points/grid cells</span>
<a id="ln-5664" name="ln-5664" href="#ln-5664"></a><span class="w">       </span><span class="c">! First set timing variables:</span>
<a id="ln-5665" name="ln-5665" href="#ln-5665"></a><span class="w">       </span><span class="c">! All timing details below are initially written to the first patch</span>
<a id="ln-5666" name="ln-5666" href="#ln-5666"></a><span class="w">       </span><span class="c">! of each gridcell, then dumped to all patches for the gridcell.</span>
<a id="ln-5667" name="ln-5667" href="#ln-5667"></a><span class="w">       </span><span class="k">IF</span><span class="p">(</span><span class="n">ktau_gl</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="c">! initialise...</span>
<a id="ln-5668" name="ln-5668" href="#ln-5668"></a><span class="w">          </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">time_coord</span><span class="p">)</span><span class="w"></span>
<a id="ln-5669" name="ln-5669" href="#ln-5669"></a><span class="w">          </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;LOC&#39;</span><span class="p">)</span><span class="c">! i.e. use local time by default</span>
<a id="ln-5670" name="ln-5670" href="#ln-5670"></a><span class="w">             </span><span class="c">! hour-of-day = starting hod</span>
<a id="ln-5671" name="ln-5671" href="#ln-5671"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shod</span><span class="w"></span>
<a id="ln-5672" name="ln-5672" href="#ln-5672"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sdoy</span><span class="w"></span>
<a id="ln-5673" name="ln-5673" href="#ln-5673"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smoy</span><span class="w"></span>
<a id="ln-5674" name="ln-5674" href="#ln-5674"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">syear</span><span class="w"></span>
<a id="ln-5675" name="ln-5675" href="#ln-5675"></a><span class="w">          </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;GMT&#39;</span><span class="p">)</span><span class="c">! use GMT</span>
<a id="ln-5676" name="ln-5676" href="#ln-5676"></a><span class="w">             </span><span class="c">! hour-of-day = starting hod + offset from GMT time:</span>
<a id="ln-5677" name="ln-5677" href="#ln-5677"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shod</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">longitude</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="mi">18</span><span class="mf">0.0</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="mf">2.0</span><span class="w"></span>
<a id="ln-5678" name="ln-5678" href="#ln-5678"></a><span class="w">             </span><span class="c">! Note above that all met%* vars have dim mp,</span>
<a id="ln-5679" name="ln-5679" href="#ln-5679"></a><span class="w">             </span><span class="c">! while longitude and latitude have dimension mland.</span>
<a id="ln-5680" name="ln-5680" href="#ln-5680"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sdoy</span><span class="w"></span>
<a id="ln-5681" name="ln-5681" href="#ln-5681"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smoy</span><span class="w"></span>
<a id="ln-5682" name="ln-5682" href="#ln-5682"></a><span class="w">             </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">syear</span><span class="w"></span>
<a id="ln-5683" name="ln-5683" href="#ln-5683"></a><span class="w">          </span><span class="k">CASE </span><span class="n">DEFAULT</span><span class="w"></span>
<a id="ln-5684" name="ln-5684" href="#ln-5684"></a><span class="w">             </span><span class="k">CALL </span><span class="nb">abort</span><span class="p">(</span><span class="s1">&#39;Unknown time coordinate! &#39;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-5685" name="ln-5685" href="#ln-5685"></a><span class="w">                  </span><span class="o">//</span><span class="s1">&#39; (SUBROUTINE get_met_data)&#39;</span><span class="p">)</span><span class="w"></span>
<a id="ln-5686" name="ln-5686" href="#ln-5686"></a><span class="w">          </span><span class="k">END SELECT</span>
<a id="ln-5687" name="ln-5687" href="#ln-5687"></a><span class="k">       ELSE</span><span class="w"></span>
<a id="ln-5688" name="ln-5688" href="#ln-5688"></a><span class="w">          </span><span class="c">! increment hour-of-day by time step size:</span>
<a id="ln-5689" name="ln-5689" href="#ln-5689"></a><span class="w">          </span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dels</span><span class="o">/</span><span class="mi">360</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-5690" name="ln-5690" href="#ln-5690"></a><span class="w">       </span><span class="k">END IF</span><span class="w"></span>
<a id="ln-5691" name="ln-5691" href="#ln-5691"></a><span class="w">       </span><span class="c">!</span>
<a id="ln-5692" name="ln-5692" href="#ln-5692"></a><span class="w">       </span><span class="k">IF</span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="c">! may be -ve since longitude</span>
<a id="ln-5693" name="ln-5693" href="#ln-5693"></a><span class="w">          </span><span class="c">! has range [-180,180]</span>
<a id="ln-5694" name="ln-5694" href="#ln-5694"></a><span class="w">          </span><span class="c">! Reduce day-of-year by one and ammend hour-of-day:</span>
<a id="ln-5695" name="ln-5695" href="#ln-5695"></a><span class="w">          </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5696" name="ln-5696" href="#ln-5696"></a><span class="w">          </span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="mf">4.0</span><span class="w"></span>
<a id="ln-5697" name="ln-5697" href="#ln-5697"></a><span class="w">          </span><span class="c">! If a leap year AND we&#39;re using leap year timing:</span>
<a id="ln-5698" name="ln-5698" href="#ln-5698"></a><span class="w">          </span><span class="k">IF</span><span class="p">(((</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">==</span><span class="mf">0.</span><span class="nb">AND</span><span class="p">.</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-5699" name="ln-5699" href="#ln-5699"></a><span class="w">               </span><span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">==</span><span class="mf">0.</span><span class="nb">AND</span><span class="p">.</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)).</span><span class="nb">AND</span><span class="p">.</span><span class="n">leaps</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-5700" name="ln-5700" href="#ln-5700"></a><span class="k">             SELECT CASE</span><span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)))</span><span class="w"></span>
<a id="ln-5701" name="ln-5701" href="#ln-5701"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c">! ie Dec previous year</span>
<a id="ln-5702" name="ln-5702" href="#ln-5702"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<a id="ln-5703" name="ln-5703" href="#ln-5703"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5704" name="ln-5704" href="#ln-5704"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">365</span><span class="w"> </span><span class="c">! prev year not leap year as this is</span>
<a id="ln-5705" name="ln-5705" href="#ln-5705"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="c">! Jan</span>
<a id="ln-5706" name="ln-5706" href="#ln-5706"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5707" name="ln-5707" href="#ln-5707"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span><span class="w"> </span><span class="c">! Feb</span>
<a id="ln-5708" name="ln-5708" href="#ln-5708"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-5709" name="ln-5709" href="#ln-5709"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">91</span><span class="p">)</span><span class="w"> </span><span class="c">! Mar</span>
<a id="ln-5710" name="ln-5710" href="#ln-5710"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<a id="ln-5711" name="ln-5711" href="#ln-5711"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span><span class="w"></span>
<a id="ln-5712" name="ln-5712" href="#ln-5712"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<a id="ln-5713" name="ln-5713" href="#ln-5713"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">152</span><span class="p">)</span><span class="w"></span>
<a id="ln-5714" name="ln-5714" href="#ln-5714"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<a id="ln-5715" name="ln-5715" href="#ln-5715"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">182</span><span class="p">)</span><span class="w"></span>
<a id="ln-5716" name="ln-5716" href="#ln-5716"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<a id="ln-5717" name="ln-5717" href="#ln-5717"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">213</span><span class="p">)</span><span class="w"></span>
<a id="ln-5718" name="ln-5718" href="#ln-5718"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<a id="ln-5719" name="ln-5719" href="#ln-5719"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">244</span><span class="p">)</span><span class="w"></span>
<a id="ln-5720" name="ln-5720" href="#ln-5720"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<a id="ln-5721" name="ln-5721" href="#ln-5721"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">274</span><span class="p">)</span><span class="w"></span>
<a id="ln-5722" name="ln-5722" href="#ln-5722"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<a id="ln-5723" name="ln-5723" href="#ln-5723"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">305</span><span class="p">)</span><span class="w"></span>
<a id="ln-5724" name="ln-5724" href="#ln-5724"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<a id="ln-5725" name="ln-5725" href="#ln-5725"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">335</span><span class="p">)</span><span class="w"></span>
<a id="ln-5726" name="ln-5726" href="#ln-5726"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="w"></span>
<a id="ln-5727" name="ln-5727" href="#ln-5727"></a><span class="w">             </span><span class="k">END SELECT</span>
<a id="ln-5728" name="ln-5728" href="#ln-5728"></a><span class="k">          ELSE</span><span class="w"> </span><span class="c">! not a leap year or not using leap year timing</span>
<a id="ln-5729" name="ln-5729" href="#ln-5729"></a><span class="w">             </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)))</span><span class="w"></span>
<a id="ln-5730" name="ln-5730" href="#ln-5730"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c">! ie Dec previous year</span>
<a id="ln-5731" name="ln-5731" href="#ln-5731"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<a id="ln-5732" name="ln-5732" href="#ln-5732"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5733" name="ln-5733" href="#ln-5733"></a><span class="w">                </span><span class="c">! If previous year is a leap year</span>
<a id="ln-5734" name="ln-5734" href="#ln-5734"></a><span class="w">                </span><span class="k">IF</span><span class="p">((</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">==</span><span class="mf">0.</span><span class="nb">AND</span><span class="p">.</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-5735" name="ln-5735" href="#ln-5735"></a><span class="w">                     </span><span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">==</span><span class="mf">0.</span><span class="nb">AND</span><span class="p">.</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-5736" name="ln-5736" href="#ln-5736"></a><span class="k">                   </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">366</span><span class="w"></span>
<a id="ln-5737" name="ln-5737" href="#ln-5737"></a><span class="w">                </span><span class="k">ELSE</span>
<a id="ln-5738" name="ln-5738" href="#ln-5738"></a><span class="k">                   </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">365</span><span class="w"></span>
<a id="ln-5739" name="ln-5739" href="#ln-5739"></a><span class="w">                </span><span class="k">END IF</span>
<a id="ln-5740" name="ln-5740" href="#ln-5740"></a><span class="k">             CASE</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="c">! Jan</span>
<a id="ln-5741" name="ln-5741" href="#ln-5741"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5742" name="ln-5742" href="#ln-5742"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">59</span><span class="p">)</span><span class="w"> </span><span class="c">! Feb</span>
<a id="ln-5743" name="ln-5743" href="#ln-5743"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-5744" name="ln-5744" href="#ln-5744"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span><span class="w"></span>
<a id="ln-5745" name="ln-5745" href="#ln-5745"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<a id="ln-5746" name="ln-5746" href="#ln-5746"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span><span class="w"></span>
<a id="ln-5747" name="ln-5747" href="#ln-5747"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<a id="ln-5748" name="ln-5748" href="#ln-5748"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">151</span><span class="p">)</span><span class="w"></span>
<a id="ln-5749" name="ln-5749" href="#ln-5749"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<a id="ln-5750" name="ln-5750" href="#ln-5750"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">181</span><span class="p">)</span><span class="w"></span>
<a id="ln-5751" name="ln-5751" href="#ln-5751"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<a id="ln-5752" name="ln-5752" href="#ln-5752"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span><span class="w"></span>
<a id="ln-5753" name="ln-5753" href="#ln-5753"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<a id="ln-5754" name="ln-5754" href="#ln-5754"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">243</span><span class="p">)</span><span class="w"></span>
<a id="ln-5755" name="ln-5755" href="#ln-5755"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<a id="ln-5756" name="ln-5756" href="#ln-5756"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">273</span><span class="p">)</span><span class="w"></span>
<a id="ln-5757" name="ln-5757" href="#ln-5757"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<a id="ln-5758" name="ln-5758" href="#ln-5758"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">304</span><span class="p">)</span><span class="w"></span>
<a id="ln-5759" name="ln-5759" href="#ln-5759"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<a id="ln-5760" name="ln-5760" href="#ln-5760"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">334</span><span class="p">)</span><span class="w"></span>
<a id="ln-5761" name="ln-5761" href="#ln-5761"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="w"></span>
<a id="ln-5762" name="ln-5762" href="#ln-5762"></a><span class="w">             </span><span class="k">END SELECT</span>
<a id="ln-5763" name="ln-5763" href="#ln-5763"></a><span class="k">          END IF</span><span class="w"> </span><span class="c">! if leap year or not</span>
<a id="ln-5764" name="ln-5764" href="#ln-5764"></a><span class="w">       </span><span class="k">ELSE IF</span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">2</span><span class="mf">4.0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"></span>
<a id="ln-5765" name="ln-5765" href="#ln-5765"></a><span class="w">          </span><span class="c">! increment or GMT adj has shifted day</span>
<a id="ln-5766" name="ln-5766" href="#ln-5766"></a><span class="w">          </span><span class="c">! Adjust day-of-year and hour-of-day:</span>
<a id="ln-5767" name="ln-5767" href="#ln-5767"></a><span class="w">          </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5768" name="ln-5768" href="#ln-5768"></a><span class="w">          </span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="mf">4.0</span><span class="w"></span>
<a id="ln-5769" name="ln-5769" href="#ln-5769"></a><span class="w">          </span><span class="c">! If a leap year AND we&#39;re using leap year timing:</span>
<a id="ln-5770" name="ln-5770" href="#ln-5770"></a><span class="w">          </span><span class="k">IF</span><span class="p">(((</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">==</span><span class="mf">0.</span><span class="nb">AND</span><span class="p">.</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-5771" name="ln-5771" href="#ln-5771"></a><span class="w">               </span><span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">==</span><span class="mf">0.</span><span class="nb">AND</span><span class="p">.</span><span class="nb">MOD</span><span class="p">(</span><span class="n">syear</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)).</span><span class="nb">AND</span><span class="p">.</span><span class="n">leaps</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-5772" name="ln-5772" href="#ln-5772"></a><span class="k">             SELECT CASE</span><span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)))</span><span class="w"></span>
<a id="ln-5773" name="ln-5773" href="#ln-5773"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="c">! Feb</span>
<a id="ln-5774" name="ln-5774" href="#ln-5774"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-5775" name="ln-5775" href="#ln-5775"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">61</span><span class="p">)</span><span class="w"> </span><span class="c">! Mar</span>
<a id="ln-5776" name="ln-5776" href="#ln-5776"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<a id="ln-5777" name="ln-5777" href="#ln-5777"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="w"></span>
<a id="ln-5778" name="ln-5778" href="#ln-5778"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<a id="ln-5779" name="ln-5779" href="#ln-5779"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span><span class="w"></span>
<a id="ln-5780" name="ln-5780" href="#ln-5780"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<a id="ln-5781" name="ln-5781" href="#ln-5781"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">153</span><span class="p">)</span><span class="w"></span>
<a id="ln-5782" name="ln-5782" href="#ln-5782"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<a id="ln-5783" name="ln-5783" href="#ln-5783"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">183</span><span class="p">)</span><span class="w"></span>
<a id="ln-5784" name="ln-5784" href="#ln-5784"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<a id="ln-5785" name="ln-5785" href="#ln-5785"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">214</span><span class="p">)</span><span class="w"></span>
<a id="ln-5786" name="ln-5786" href="#ln-5786"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<a id="ln-5787" name="ln-5787" href="#ln-5787"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">245</span><span class="p">)</span><span class="w"></span>
<a id="ln-5788" name="ln-5788" href="#ln-5788"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<a id="ln-5789" name="ln-5789" href="#ln-5789"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">275</span><span class="p">)</span><span class="w"></span>
<a id="ln-5790" name="ln-5790" href="#ln-5790"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<a id="ln-5791" name="ln-5791" href="#ln-5791"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">306</span><span class="p">)</span><span class="w"></span>
<a id="ln-5792" name="ln-5792" href="#ln-5792"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="w"></span>
<a id="ln-5793" name="ln-5793" href="#ln-5793"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">336</span><span class="p">)</span><span class="w"></span>
<a id="ln-5794" name="ln-5794" href="#ln-5794"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<a id="ln-5795" name="ln-5795" href="#ln-5795"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">367</span><span class="p">)</span><span class="c">! end of year; increment</span>
<a id="ln-5796" name="ln-5796" href="#ln-5796"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5797" name="ln-5797" href="#ln-5797"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5798" name="ln-5798" href="#ln-5798"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5799" name="ln-5799" href="#ln-5799"></a><span class="w">             </span><span class="k">END SELECT</span><span class="w"></span>
<a id="ln-5800" name="ln-5800" href="#ln-5800"></a><span class="w">             </span><span class="c">! ELSE IF not leap year and Dec 31st, increment year</span>
<a id="ln-5801" name="ln-5801" href="#ln-5801"></a><span class="w">          </span><span class="k">ELSE</span>
<a id="ln-5802" name="ln-5802" href="#ln-5802"></a><span class="k">             SELECT CASE</span><span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)))</span><span class="w"></span>
<a id="ln-5803" name="ln-5803" href="#ln-5803"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="c">! Feb</span>
<a id="ln-5804" name="ln-5804" href="#ln-5804"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-5805" name="ln-5805" href="#ln-5805"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span><span class="w"> </span><span class="c">! Mar</span>
<a id="ln-5806" name="ln-5806" href="#ln-5806"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<a id="ln-5807" name="ln-5807" href="#ln-5807"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">91</span><span class="p">)</span><span class="w"></span>
<a id="ln-5808" name="ln-5808" href="#ln-5808"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<a id="ln-5809" name="ln-5809" href="#ln-5809"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span><span class="w"></span>
<a id="ln-5810" name="ln-5810" href="#ln-5810"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<a id="ln-5811" name="ln-5811" href="#ln-5811"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">152</span><span class="p">)</span><span class="w"></span>
<a id="ln-5812" name="ln-5812" href="#ln-5812"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<a id="ln-5813" name="ln-5813" href="#ln-5813"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">182</span><span class="p">)</span><span class="w"></span>
<a id="ln-5814" name="ln-5814" href="#ln-5814"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<a id="ln-5815" name="ln-5815" href="#ln-5815"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">213</span><span class="p">)</span><span class="w"></span>
<a id="ln-5816" name="ln-5816" href="#ln-5816"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<a id="ln-5817" name="ln-5817" href="#ln-5817"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">244</span><span class="p">)</span><span class="w"></span>
<a id="ln-5818" name="ln-5818" href="#ln-5818"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<a id="ln-5819" name="ln-5819" href="#ln-5819"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">274</span><span class="p">)</span><span class="w"></span>
<a id="ln-5820" name="ln-5820" href="#ln-5820"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<a id="ln-5821" name="ln-5821" href="#ln-5821"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">305</span><span class="p">)</span><span class="w"></span>
<a id="ln-5822" name="ln-5822" href="#ln-5822"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="w"></span>
<a id="ln-5823" name="ln-5823" href="#ln-5823"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">335</span><span class="p">)</span><span class="w"></span>
<a id="ln-5824" name="ln-5824" href="#ln-5824"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<a id="ln-5825" name="ln-5825" href="#ln-5825"></a><span class="w">             </span><span class="k">CASE</span><span class="p">(</span><span class="mi">366</span><span class="p">)</span><span class="c">! end of year; increment</span>
<a id="ln-5826" name="ln-5826" href="#ln-5826"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5827" name="ln-5827" href="#ln-5827"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5828" name="ln-5828" href="#ln-5828"></a><span class="w">                </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5829" name="ln-5829" href="#ln-5829"></a><span class="w">             </span><span class="k">END SELECT</span>
<a id="ln-5830" name="ln-5830" href="#ln-5830"></a><span class="k">          END IF</span><span class="w"> </span><span class="c">! if leap year or not</span>
<a id="ln-5831" name="ln-5831" href="#ln-5831"></a><span class="w">       </span><span class="k">END IF</span><span class="w"> </span><span class="c">! if increment has pushed hod to a different day</span>
<a id="ln-5832" name="ln-5832" href="#ln-5832"></a><span class="w">       </span><span class="c">! Now copy these values to all veg/soil patches in the current grid cell:</span>
<a id="ln-5833" name="ln-5833" href="#ln-5833"></a><span class="w">       </span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">:</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">hod</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"></span>
<a id="ln-5834" name="ln-5834" href="#ln-5834"></a><span class="w">       </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">:</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">doy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"></span>
<a id="ln-5835" name="ln-5835" href="#ln-5835"></a><span class="w">       </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">:</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">moy</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"></span>
<a id="ln-5836" name="ln-5836" href="#ln-5836"></a><span class="w">       </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">:</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">met</span><span class="p">%</span><span class="n">year</span><span class="p">(</span><span class="n">landpt</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">cstart</span><span class="p">)</span><span class="w"></span>
<a id="ln-5837" name="ln-5837" href="#ln-5837"></a><span class="w">    </span><span class="k">ENDDO</span>
<a id="ln-5838" name="ln-5838" href="#ln-5838"></a>
<a id="ln-5839" name="ln-5839" href="#ln-5839"></a><span class="k">    RETURN</span>
<a id="ln-5840" name="ln-5840" href="#ln-5840"></a>
<a id="ln-5841" name="ln-5841" href="#ln-5841"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_time_update</span><span class="w"></span>
<a id="ln-5842" name="ln-5842" href="#ln-5842"></a>
<a id="ln-5843" name="ln-5843" href="#ln-5843"></a><span class="w">  </span><span class="c">! creates MPI types for sending casa results back to the master at</span>
<a id="ln-5844" name="ln-5844" href="#ln-5844"></a><span class="w">  </span><span class="c">! the end of the simulation</span>
<a id="ln-5845" name="ln-5845" href="#ln-5845"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-5846" name="ln-5846" href="#ln-5846"></a><span class="w">  </span><span class="c">! changes from old mpi version:</span>
<a id="ln-5847" name="ln-5847" href="#ln-5847"></a><span class="w">  </span><span class="c">!  phen: removed out because casa_poolout in this version</span>
<a id="ln-5848" name="ln-5848" href="#ln-5848"></a><span class="w">  </span><span class="c">!  is no longer writing phen%phase</span>
<a id="ln-5849" name="ln-5849" href="#ln-5849"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-5850" name="ln-5850" href="#ln-5850"></a>
<a id="ln-5851" name="ln-5851" href="#ln-5851"></a><span class="w">  </span><span class="c">!</span>
<a id="ln-5852" name="ln-5852" href="#ln-5852"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_casa_type</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-5853" name="ln-5853" href="#ln-5853"></a><span class="w">       </span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="w"> </span><span class="n">phen</span><span class="p">)</span><span class="w"></span>
<a id="ln-5854" name="ln-5854" href="#ln-5854"></a>
<a id="ln-5855" name="ln-5855" href="#ln-5855"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-5856" name="ln-5856" href="#ln-5856"></a><span class="w">    </span><span class="c">! USE cable_vars</span>
<a id="ln-5857" name="ln-5857" href="#ln-5857"></a>
<a id="ln-5858" name="ln-5858" href="#ln-5858"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-5859" name="ln-5859" href="#ln-5859"></a><span class="w">    </span><span class="k">USE </span><span class="n">casadimension</span><span class="w"></span>
<a id="ln-5860" name="ln-5860" href="#ln-5860"></a><span class="w">    </span><span class="k">USE </span><span class="n">casavariable</span><span class="w"></span>
<a id="ln-5861" name="ln-5861" href="#ln-5861"></a><span class="w">    </span><span class="c">!  gol124: commented out because casa_poolout in this version</span>
<a id="ln-5862" name="ln-5862" href="#ln-5862"></a><span class="w">    </span><span class="c">!  is no longer writing phen%phase</span>
<a id="ln-5863" name="ln-5863" href="#ln-5863"></a><span class="w">    </span><span class="k">USE </span><span class="n">phenvariable</span><span class="w"></span>
<a id="ln-5864" name="ln-5864" href="#ln-5864"></a>
<a id="ln-5865" name="ln-5865" href="#ln-5865"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<a id="ln-5866" name="ln-5866" href="#ln-5866"></a>
<a id="ln-5867" name="ln-5867" href="#ln-5867"></a><span class="w">    </span><span class="c">! subroutine arguments</span>
<a id="ln-5868" name="ln-5868" href="#ln-5868"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w"> </span><span class="c">! MPI communicator to talk to the workers</span>
<a id="ln-5869" name="ln-5869" href="#ln-5869"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_pool</span><span class="p">),</span><span class="w">           </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casapool</span><span class="w"></span>
<a id="ln-5870" name="ln-5870" href="#ln-5870"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_flux</span><span class="p">),</span><span class="w">           </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casaflux</span><span class="w"></span>
<a id="ln-5871" name="ln-5871" href="#ln-5871"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_met</span><span class="p">),</span><span class="w">            </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casamet</span><span class="w"></span>
<a id="ln-5872" name="ln-5872" href="#ln-5872"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_balance</span><span class="p">),</span><span class="w">        </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casabal</span><span class="w"></span>
<a id="ln-5873" name="ln-5873" href="#ln-5873"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">phen_variable</span><span class="p">),</span><span class="w">       </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phen</span><span class="w"></span>
<a id="ln-5874" name="ln-5874" href="#ln-5874"></a>
<a id="ln-5875" name="ln-5875" href="#ln-5875"></a><span class="w">    </span><span class="c">! local variables</span>
<a id="ln-5876" name="ln-5876" href="#ln-5876"></a>
<a id="ln-5877" name="ln-5877" href="#ln-5877"></a><span class="w">    </span><span class="c">! MPI: temp arrays for marshalling all types into a struct</span>
<a id="ln-5878" name="ln-5878" href="#ln-5878"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blocks</span><span class="w"></span>
<a id="ln-5879" name="ln-5879" href="#ln-5879"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">displs</span><span class="w"></span>
<a id="ln-5880" name="ln-5880" href="#ln-5880"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<a id="ln-5881" name="ln-5881" href="#ln-5881"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntyp</span><span class="w"> </span><span class="c">! number of worker&#39;s types</span>
<a id="ln-5882" name="ln-5882" href="#ln-5882"></a>
<a id="ln-5883" name="ln-5883" href="#ln-5883"></a><span class="w">    </span><span class="c">! MPI: block lengths and strides for hvector representing matrices</span>
<a id="ln-5884" name="ln-5884" href="#ln-5884"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r1len</span><span class="p">,</span><span class="w"> </span><span class="n">r2len</span><span class="p">,</span><span class="w"> </span><span class="n">I1LEN</span><span class="p">,</span><span class="w"> </span><span class="n">llen</span><span class="w"></span>
<a id="ln-5885" name="ln-5885" href="#ln-5885"></a>
<a id="ln-5886" name="ln-5886" href="#ln-5886"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="w"></span>
<a id="ln-5887" name="ln-5887" href="#ln-5887"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">midx</span><span class="p">,</span><span class="w"> </span><span class="n">vidx</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-5888" name="ln-5888" href="#ln-5888"></a>
<a id="ln-5889" name="ln-5889" href="#ln-5889"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tsize</span><span class="w"></span>
<a id="ln-5890" name="ln-5890" href="#ln-5890"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-5891" name="ln-5891" href="#ln-5891"></a>
<a id="ln-5892" name="ln-5892" href="#ln-5892"></a><span class="w">    </span><span class="c">! MPI: allocate temp vectors used for marshalling</span>
<a id="ln-5893" name="ln-5893" href="#ln-5893"></a><span class="w">    </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncasa_mat</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ncasa_vec</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">nphen</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-5894" name="ln-5894" href="#ln-5894"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">blocks</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-5895" name="ln-5895" href="#ln-5895"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">displs</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-5896" name="ln-5896" href="#ln-5896"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-5897" name="ln-5897" href="#ln-5897"></a>
<a id="ln-5898" name="ln-5898" href="#ln-5898"></a><span class="w">    </span><span class="c">!off = wpatch%patch0</span>
<a id="ln-5899" name="ln-5899" href="#ln-5899"></a><span class="w">    </span><span class="c">!cnt = wpatch%npatch</span>
<a id="ln-5900" name="ln-5900" href="#ln-5900"></a><span class="w">    </span><span class="n">off</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5901" name="ln-5901" href="#ln-5901"></a><span class="w">    </span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"></span>
<a id="ln-5902" name="ln-5902" href="#ln-5902"></a>
<a id="ln-5903" name="ln-5903" href="#ln-5903"></a><span class="w">    </span><span class="n">r1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-5904" name="ln-5904" href="#ln-5904"></a><span class="w">    </span><span class="n">r2len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-5905" name="ln-5905" href="#ln-5905"></a><span class="w">    </span><span class="n">I1LEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-5906" name="ln-5906" href="#ln-5906"></a><span class="w">    </span><span class="n">llen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extl</span><span class="w"></span>
<a id="ln-5907" name="ln-5907" href="#ln-5907"></a>
<a id="ln-5908" name="ln-5908" href="#ln-5908"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-5909" name="ln-5909" href="#ln-5909"></a>
<a id="ln-5910" name="ln-5910" href="#ln-5910"></a><span class="w">    </span><span class="c">! ------------- 2D arrays -------------</span>
<a id="ln-5911" name="ln-5911" href="#ln-5911"></a>
<a id="ln-5912" name="ln-5912" href="#ln-5912"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5913" name="ln-5913" href="#ln-5913"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5914" name="ln-5914" href="#ln-5914"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"></span>
<a id="ln-5915" name="ln-5915" href="#ln-5915"></a>
<a id="ln-5916" name="ln-5916" href="#ln-5916"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5917" name="ln-5917" href="#ln-5917"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">clitter</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5918" name="ln-5918" href="#ln-5918"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"></span>
<a id="ln-5919" name="ln-5919" href="#ln-5919"></a>
<a id="ln-5920" name="ln-5920" href="#ln-5920"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5921" name="ln-5921" href="#ln-5921"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">csoil</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5922" name="ln-5922" href="#ln-5922"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"></span>
<a id="ln-5923" name="ln-5923" href="#ln-5923"></a>
<a id="ln-5924" name="ln-5924" href="#ln-5924"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5925" name="ln-5925" href="#ln-5925"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">nplant</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5926" name="ln-5926" href="#ln-5926"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"></span>
<a id="ln-5927" name="ln-5927" href="#ln-5927"></a>
<a id="ln-5928" name="ln-5928" href="#ln-5928"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5929" name="ln-5929" href="#ln-5929"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">nlitter</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5930" name="ln-5930" href="#ln-5930"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"></span>
<a id="ln-5931" name="ln-5931" href="#ln-5931"></a>
<a id="ln-5932" name="ln-5932" href="#ln-5932"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5933" name="ln-5933" href="#ln-5933"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">nsoil</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5934" name="ln-5934" href="#ln-5934"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"></span>
<a id="ln-5935" name="ln-5935" href="#ln-5935"></a>
<a id="ln-5936" name="ln-5936" href="#ln-5936"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5937" name="ln-5937" href="#ln-5937"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">pplant</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5938" name="ln-5938" href="#ln-5938"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"></span>
<a id="ln-5939" name="ln-5939" href="#ln-5939"></a>
<a id="ln-5940" name="ln-5940" href="#ln-5940"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5941" name="ln-5941" href="#ln-5941"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">plitter</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5942" name="ln-5942" href="#ln-5942"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"></span>
<a id="ln-5943" name="ln-5943" href="#ln-5943"></a>
<a id="ln-5944" name="ln-5944" href="#ln-5944"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5945" name="ln-5945" href="#ln-5945"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">psoil</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5946" name="ln-5946" href="#ln-5946"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"></span>
<a id="ln-5947" name="ln-5947" href="#ln-5947"></a>
<a id="ln-5948" name="ln-5948" href="#ln-5948"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5949" name="ln-5949" href="#ln-5949"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNCplant</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5950" name="ln-5950" href="#ln-5950"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"></span>
<a id="ln-5951" name="ln-5951" href="#ln-5951"></a>
<a id="ln-5952" name="ln-5952" href="#ln-5952"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5953" name="ln-5953" href="#ln-5953"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioPCplant</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5954" name="ln-5954" href="#ln-5954"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"></span>
<a id="ln-5955" name="ln-5955" href="#ln-5955"></a>
<a id="ln-5956" name="ln-5956" href="#ln-5956"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5957" name="ln-5957" href="#ln-5957"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNClitter</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5958" name="ln-5958" href="#ln-5958"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"></span>
<a id="ln-5959" name="ln-5959" href="#ln-5959"></a>
<a id="ln-5960" name="ln-5960" href="#ln-5960"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5961" name="ln-5961" href="#ln-5961"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioPClitter</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5962" name="ln-5962" href="#ln-5962"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"></span>
<a id="ln-5963" name="ln-5963" href="#ln-5963"></a>
<a id="ln-5964" name="ln-5964" href="#ln-5964"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5965" name="ln-5965" href="#ln-5965"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNCsoil</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5966" name="ln-5966" href="#ln-5966"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"></span>
<a id="ln-5967" name="ln-5967" href="#ln-5967"></a>
<a id="ln-5968" name="ln-5968" href="#ln-5968"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5969" name="ln-5969" href="#ln-5969"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioPCsoil</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5970" name="ln-5970" href="#ln-5970"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"></span>
<a id="ln-5971" name="ln-5971" href="#ln-5971"></a>
<a id="ln-5972" name="ln-5972" href="#ln-5972"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5973" name="ln-5973" href="#ln-5973"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">cwoodprod</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5974" name="ln-5974" href="#ln-5974"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mwood</span><span class="w"></span>
<a id="ln-5975" name="ln-5975" href="#ln-5975"></a>
<a id="ln-5976" name="ln-5976" href="#ln-5976"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5977" name="ln-5977" href="#ln-5977"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">nwoodprod</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5978" name="ln-5978" href="#ln-5978"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mwood</span><span class="w"></span>
<a id="ln-5979" name="ln-5979" href="#ln-5979"></a>
<a id="ln-5980" name="ln-5980" href="#ln-5980"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5981" name="ln-5981" href="#ln-5981"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">pwoodprod</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5982" name="ln-5982" href="#ln-5982"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mwood</span><span class="w"></span>
<a id="ln-5983" name="ln-5983" href="#ln-5983"></a>
<a id="ln-5984" name="ln-5984" href="#ln-5984"></a><span class="w">   </span><span class="c">! </span>
<a id="ln-5985" name="ln-5985" href="#ln-5985"></a>
<a id="ln-5986" name="ln-5986" href="#ln-5986"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5987" name="ln-5987" href="#ln-5987"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphase</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5988" name="ln-5988" href="#ln-5988"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mphase</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-5989" name="ln-5989" href="#ln-5989"></a>
<a id="ln-5990" name="ln-5990" href="#ln-5990"></a>
<a id="ln-5991" name="ln-5991" href="#ln-5991"></a>
<a id="ln-5992" name="ln-5992" href="#ln-5992"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5993" name="ln-5993" href="#ln-5993"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">phasespin</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5994" name="ln-5994" href="#ln-5994"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdyear</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-5995" name="ln-5995" href="#ln-5995"></a>
<a id="ln-5996" name="ln-5996" href="#ln-5996"></a>
<a id="ln-5997" name="ln-5997" href="#ln-5997"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-5998" name="ln-5998" href="#ln-5998"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphasespin_1</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-5999" name="ln-5999" href="#ln-5999"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdyear</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-6000" name="ln-6000" href="#ln-6000"></a>
<a id="ln-6001" name="ln-6001" href="#ln-6001"></a>
<a id="ln-6002" name="ln-6002" href="#ln-6002"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6003" name="ln-6003" href="#ln-6003"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphasespin_2</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6004" name="ln-6004" href="#ln-6004"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdyear</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-6005" name="ln-6005" href="#ln-6005"></a>
<a id="ln-6006" name="ln-6006" href="#ln-6006"></a>
<a id="ln-6007" name="ln-6007" href="#ln-6007"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6008" name="ln-6008" href="#ln-6008"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphasespin_3</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6009" name="ln-6009" href="#ln-6009"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdyear</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-6010" name="ln-6010" href="#ln-6010"></a>
<a id="ln-6011" name="ln-6011" href="#ln-6011"></a>
<a id="ln-6012" name="ln-6012" href="#ln-6012"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6013" name="ln-6013" href="#ln-6013"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphasespin_4</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6014" name="ln-6014" href="#ln-6014"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mdyear</span><span class="o">*</span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-6015" name="ln-6015" href="#ln-6015"></a>
<a id="ln-6016" name="ln-6016" href="#ln-6016"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6017" name="ln-6017" href="#ln-6017"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cplant_turnover</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6018" name="ln-6018" href="#ln-6018"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="o">*</span><span class="n">r2LEN</span><span class="w"></span>
<a id="ln-6019" name="ln-6019" href="#ln-6019"></a>
<a id="ln-6020" name="ln-6020" href="#ln-6020"></a>
<a id="ln-6021" name="ln-6021" href="#ln-6021"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6022" name="ln-6022" href="#ln-6022"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6023" name="ln-6023" href="#ln-6023"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6024" name="ln-6024" href="#ln-6024"></a>
<a id="ln-6025" name="ln-6025" href="#ln-6025"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6026" name="ln-6026" href="#ln-6026"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracNalloc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6027" name="ln-6027" href="#ln-6027"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6028" name="ln-6028" href="#ln-6028"></a>
<a id="ln-6029" name="ln-6029" href="#ln-6029"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6030" name="ln-6030" href="#ln-6030"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracPalloc</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6031" name="ln-6031" href="#ln-6031"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6032" name="ln-6032" href="#ln-6032"></a>
<a id="ln-6033" name="ln-6033" href="#ln-6033"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6034" name="ln-6034" href="#ln-6034"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Crmplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6035" name="ln-6035" href="#ln-6035"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6036" name="ln-6036" href="#ln-6036"></a>
<a id="ln-6037" name="ln-6037" href="#ln-6037"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6038" name="ln-6038" href="#ln-6038"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">kplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6039" name="ln-6039" href="#ln-6039"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6040" name="ln-6040" href="#ln-6040"></a>
<a id="ln-6041" name="ln-6041" href="#ln-6041"></a><span class="w">    </span><span class="c">! 3D</span>
<a id="ln-6042" name="ln-6042" href="#ln-6042"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6043" name="ln-6043" href="#ln-6043"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fromPtoL</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6044" name="ln-6044" href="#ln-6044"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6045" name="ln-6045" href="#ln-6045"></a>
<a id="ln-6046" name="ln-6046" href="#ln-6046"></a>
<a id="ln-6047" name="ln-6047" href="#ln-6047"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6048" name="ln-6048" href="#ln-6048"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">klitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6049" name="ln-6049" href="#ln-6049"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6050" name="ln-6050" href="#ln-6050"></a>
<a id="ln-6051" name="ln-6051" href="#ln-6051"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6052" name="ln-6052" href="#ln-6052"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">ksoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6053" name="ln-6053" href="#ln-6053"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6054" name="ln-6054" href="#ln-6054"></a>
<a id="ln-6055" name="ln-6055" href="#ln-6055"></a><span class="w">    </span><span class="c">! 3D</span>
<a id="ln-6056" name="ln-6056" href="#ln-6056"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6057" name="ln-6057" href="#ln-6057"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fromLtoS</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6058" name="ln-6058" href="#ln-6058"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6059" name="ln-6059" href="#ln-6059"></a>
<a id="ln-6060" name="ln-6060" href="#ln-6060"></a><span class="w">    </span><span class="c">! 3D</span>
<a id="ln-6061" name="ln-6061" href="#ln-6061"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6062" name="ln-6062" href="#ln-6062"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fromStoS</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6063" name="ln-6063" href="#ln-6063"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6064" name="ln-6064" href="#ln-6064"></a>
<a id="ln-6065" name="ln-6065" href="#ln-6065"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6066" name="ln-6066" href="#ln-6066"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fromLtoCO2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6067" name="ln-6067" href="#ln-6067"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6068" name="ln-6068" href="#ln-6068"></a>
<a id="ln-6069" name="ln-6069" href="#ln-6069"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6070" name="ln-6070" href="#ln-6070"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fromStoCO2</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6071" name="ln-6071" href="#ln-6071"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6072" name="ln-6072" href="#ln-6072"></a>
<a id="ln-6073" name="ln-6073" href="#ln-6073"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6074" name="ln-6074" href="#ln-6074"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxCtolitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6075" name="ln-6075" href="#ln-6075"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6076" name="ln-6076" href="#ln-6076"></a>
<a id="ln-6077" name="ln-6077" href="#ln-6077"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6078" name="ln-6078" href="#ln-6078"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxNtolitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6079" name="ln-6079" href="#ln-6079"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6080" name="ln-6080" href="#ln-6080"></a>
<a id="ln-6081" name="ln-6081" href="#ln-6081"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6082" name="ln-6082" href="#ln-6082"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxPtolitter</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6083" name="ln-6083" href="#ln-6083"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mlitter</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6084" name="ln-6084" href="#ln-6084"></a>
<a id="ln-6085" name="ln-6085" href="#ln-6085"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6086" name="ln-6086" href="#ln-6086"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxCtosoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6087" name="ln-6087" href="#ln-6087"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6088" name="ln-6088" href="#ln-6088"></a>
<a id="ln-6089" name="ln-6089" href="#ln-6089"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6090" name="ln-6090" href="#ln-6090"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxNtosoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6091" name="ln-6091" href="#ln-6091"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6092" name="ln-6092" href="#ln-6092"></a>
<a id="ln-6093" name="ln-6093" href="#ln-6093"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6094" name="ln-6094" href="#ln-6094"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fluxPtosoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6095" name="ln-6095" href="#ln-6095"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msoil</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6096" name="ln-6096" href="#ln-6096"></a>
<a id="ln-6097" name="ln-6097" href="#ln-6097"></a>
<a id="ln-6098" name="ln-6098" href="#ln-6098"></a>
<a id="ln-6099" name="ln-6099" href="#ln-6099"></a>
<a id="ln-6100" name="ln-6100" href="#ln-6100"></a>
<a id="ln-6101" name="ln-6101" href="#ln-6101"></a>
<a id="ln-6102" name="ln-6102" href="#ln-6102"></a>
<a id="ln-6103" name="ln-6103" href="#ln-6103"></a>
<a id="ln-6104" name="ln-6104" href="#ln-6104"></a>
<a id="ln-6105" name="ln-6105" href="#ln-6105"></a>
<a id="ln-6106" name="ln-6106" href="#ln-6106"></a>
<a id="ln-6107" name="ln-6107" href="#ln-6107"></a>
<a id="ln-6108" name="ln-6108" href="#ln-6108"></a>
<a id="ln-6109" name="ln-6109" href="#ln-6109"></a>
<a id="ln-6110" name="ln-6110" href="#ln-6110"></a>
<a id="ln-6111" name="ln-6111" href="#ln-6111"></a>
<a id="ln-6112" name="ln-6112" href="#ln-6112"></a>
<a id="ln-6113" name="ln-6113" href="#ln-6113"></a><span class="w">    </span><span class="c">! ------------- 1D vectors -------------</span>
<a id="ln-6114" name="ln-6114" href="#ln-6114"></a>
<a id="ln-6115" name="ln-6115" href="#ln-6115"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6116" name="ln-6116" href="#ln-6116"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">glai</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6117" name="ln-6117" href="#ln-6117"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6118" name="ln-6118" href="#ln-6118"></a>
<a id="ln-6119" name="ln-6119" href="#ln-6119"></a><span class="w">    </span><span class="c">!  gol124: commented out because casa_poolout in this version</span>
<a id="ln-6120" name="ln-6120" href="#ln-6120"></a><span class="w">    </span><span class="c">!  is no longer writing phen%phase</span>
<a id="ln-6121" name="ln-6121" href="#ln-6121"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6122" name="ln-6122" href="#ln-6122"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">phase</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6123" name="ln-6123" href="#ln-6123"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-6124" name="ln-6124" href="#ln-6124"></a>
<a id="ln-6125" name="ln-6125" href="#ln-6125"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6126" name="ln-6126" href="#ln-6126"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">phen</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6127" name="ln-6127" href="#ln-6127"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6128" name="ln-6128" href="#ln-6128"></a>
<a id="ln-6129" name="ln-6129" href="#ln-6129"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6130" name="ln-6130" href="#ln-6130"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">aphen</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6131" name="ln-6131" href="#ln-6131"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6132" name="ln-6132" href="#ln-6132"></a>
<a id="ln-6133" name="ln-6133" href="#ln-6133"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6134" name="ln-6134" href="#ln-6134"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">clabile</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6135" name="ln-6135" href="#ln-6135"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6136" name="ln-6136" href="#ln-6136"></a>
<a id="ln-6137" name="ln-6137" href="#ln-6137"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6138" name="ln-6138" href="#ln-6138"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Ctot</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6139" name="ln-6139" href="#ln-6139"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6140" name="ln-6140" href="#ln-6140"></a>
<a id="ln-6141" name="ln-6141" href="#ln-6141"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6142" name="ln-6142" href="#ln-6142"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Ctot_0</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6143" name="ln-6143" href="#ln-6143"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6144" name="ln-6144" href="#ln-6144"></a>
<a id="ln-6145" name="ln-6145" href="#ln-6145"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6146" name="ln-6146" href="#ln-6146"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">nsoilmin</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6147" name="ln-6147" href="#ln-6147"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6148" name="ln-6148" href="#ln-6148"></a>
<a id="ln-6149" name="ln-6149" href="#ln-6149"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6150" name="ln-6150" href="#ln-6150"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">psoillab</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6151" name="ln-6151" href="#ln-6151"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6152" name="ln-6152" href="#ln-6152"></a>
<a id="ln-6153" name="ln-6153" href="#ln-6153"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6154" name="ln-6154" href="#ln-6154"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">psoilsorb</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6155" name="ln-6155" href="#ln-6155"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6156" name="ln-6156" href="#ln-6156"></a>
<a id="ln-6157" name="ln-6157" href="#ln-6157"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6158" name="ln-6158" href="#ln-6158"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">psoilocc</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6159" name="ln-6159" href="#ln-6159"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6160" name="ln-6160" href="#ln-6160"></a>
<a id="ln-6161" name="ln-6161" href="#ln-6161"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6162" name="ln-6162" href="#ln-6162"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">psorbmax</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6163" name="ln-6163" href="#ln-6163"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6164" name="ln-6164" href="#ln-6164"></a>
<a id="ln-6165" name="ln-6165" href="#ln-6165"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6166" name="ln-6166" href="#ln-6166"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">sumcbal</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6167" name="ln-6167" href="#ln-6167"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6168" name="ln-6168" href="#ln-6168"></a>
<a id="ln-6169" name="ln-6169" href="#ln-6169"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6170" name="ln-6170" href="#ln-6170"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">sumnbal</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6171" name="ln-6171" href="#ln-6171"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6172" name="ln-6172" href="#ln-6172"></a>
<a id="ln-6173" name="ln-6173" href="#ln-6173"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6174" name="ln-6174" href="#ln-6174"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">sumpbal</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6175" name="ln-6175" href="#ln-6175"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6176" name="ln-6176" href="#ln-6176"></a>
<a id="ln-6177" name="ln-6177" href="#ln-6177"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6178" name="ln-6178" href="#ln-6178"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCgppyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6179" name="ln-6179" href="#ln-6179"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6180" name="ln-6180" href="#ln-6180"></a>
<a id="ln-6181" name="ln-6181" href="#ln-6181"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6182" name="ln-6182" href="#ln-6182"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCnppyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6183" name="ln-6183" href="#ln-6183"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6184" name="ln-6184" href="#ln-6184"></a>
<a id="ln-6185" name="ln-6185" href="#ln-6185"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6186" name="ln-6186" href="#ln-6186"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrmleafyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6187" name="ln-6187" href="#ln-6187"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6188" name="ln-6188" href="#ln-6188"></a>
<a id="ln-6189" name="ln-6189" href="#ln-6189"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6190" name="ln-6190" href="#ln-6190"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrmwoodyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6191" name="ln-6191" href="#ln-6191"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6192" name="ln-6192" href="#ln-6192"></a>
<a id="ln-6193" name="ln-6193" href="#ln-6193"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6194" name="ln-6194" href="#ln-6194"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrmrootyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6195" name="ln-6195" href="#ln-6195"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6196" name="ln-6196" href="#ln-6196"></a>
<a id="ln-6197" name="ln-6197" href="#ln-6197"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6198" name="ln-6198" href="#ln-6198"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrgrowyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6199" name="ln-6199" href="#ln-6199"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6200" name="ln-6200" href="#ln-6200"></a>
<a id="ln-6201" name="ln-6201" href="#ln-6201"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6202" name="ln-6202" href="#ln-6202"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrpyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6203" name="ln-6203" href="#ln-6203"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6204" name="ln-6204" href="#ln-6204"></a>
<a id="ln-6205" name="ln-6205" href="#ln-6205"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6206" name="ln-6206" href="#ln-6206"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCrsyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6207" name="ln-6207" href="#ln-6207"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6208" name="ln-6208" href="#ln-6208"></a>
<a id="ln-6209" name="ln-6209" href="#ln-6209"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6210" name="ln-6210" href="#ln-6210"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCneeyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6211" name="ln-6211" href="#ln-6211"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6212" name="ln-6212" href="#ln-6212"></a>
<a id="ln-6213" name="ln-6213" href="#ln-6213"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6214" name="ln-6214" href="#ln-6214"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNdepyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6215" name="ln-6215" href="#ln-6215"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6216" name="ln-6216" href="#ln-6216"></a>
<a id="ln-6217" name="ln-6217" href="#ln-6217"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6218" name="ln-6218" href="#ln-6218"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNfixyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6219" name="ln-6219" href="#ln-6219"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6220" name="ln-6220" href="#ln-6220"></a>
<a id="ln-6221" name="ln-6221" href="#ln-6221"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6222" name="ln-6222" href="#ln-6222"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNsnetyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6223" name="ln-6223" href="#ln-6223"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6224" name="ln-6224" href="#ln-6224"></a>
<a id="ln-6225" name="ln-6225" href="#ln-6225"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6226" name="ln-6226" href="#ln-6226"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNupyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6227" name="ln-6227" href="#ln-6227"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6228" name="ln-6228" href="#ln-6228"></a>
<a id="ln-6229" name="ln-6229" href="#ln-6229"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6230" name="ln-6230" href="#ln-6230"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNleachyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6231" name="ln-6231" href="#ln-6231"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6232" name="ln-6232" href="#ln-6232"></a>
<a id="ln-6233" name="ln-6233" href="#ln-6233"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6234" name="ln-6234" href="#ln-6234"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FNlossyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6235" name="ln-6235" href="#ln-6235"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6236" name="ln-6236" href="#ln-6236"></a>
<a id="ln-6237" name="ln-6237" href="#ln-6237"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6238" name="ln-6238" href="#ln-6238"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPweayear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6239" name="ln-6239" href="#ln-6239"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6240" name="ln-6240" href="#ln-6240"></a>
<a id="ln-6241" name="ln-6241" href="#ln-6241"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6242" name="ln-6242" href="#ln-6242"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPdustyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6243" name="ln-6243" href="#ln-6243"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6244" name="ln-6244" href="#ln-6244"></a>
<a id="ln-6245" name="ln-6245" href="#ln-6245"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6246" name="ln-6246" href="#ln-6246"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPsnetyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6247" name="ln-6247" href="#ln-6247"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6248" name="ln-6248" href="#ln-6248"></a>
<a id="ln-6249" name="ln-6249" href="#ln-6249"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6250" name="ln-6250" href="#ln-6250"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPupyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6251" name="ln-6251" href="#ln-6251"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6252" name="ln-6252" href="#ln-6252"></a>
<a id="ln-6253" name="ln-6253" href="#ln-6253"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6254" name="ln-6254" href="#ln-6254"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPleachyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6255" name="ln-6255" href="#ln-6255"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6256" name="ln-6256" href="#ln-6256"></a>
<a id="ln-6257" name="ln-6257" href="#ln-6257"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6258" name="ln-6258" href="#ln-6258"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FPlossyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6259" name="ln-6259" href="#ln-6259"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6260" name="ln-6260" href="#ln-6260"></a><span class="w">    </span><span class="c">!*****************************</span>
<a id="ln-6261" name="ln-6261" href="#ln-6261"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6262" name="ln-6262" href="#ln-6262"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cgpp</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6263" name="ln-6263" href="#ln-6263"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6264" name="ln-6264" href="#ln-6264"></a>
<a id="ln-6265" name="ln-6265" href="#ln-6265"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6266" name="ln-6266" href="#ln-6266"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cnpp</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6267" name="ln-6267" href="#ln-6267"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6268" name="ln-6268" href="#ln-6268"></a>
<a id="ln-6269" name="ln-6269" href="#ln-6269"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6270" name="ln-6270" href="#ln-6270"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Crp</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6271" name="ln-6271" href="#ln-6271"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6272" name="ln-6272" href="#ln-6272"></a>
<a id="ln-6273" name="ln-6273" href="#ln-6273"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6274" name="ln-6274" href="#ln-6274"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Crgplant</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6275" name="ln-6275" href="#ln-6275"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6276" name="ln-6276" href="#ln-6276"></a>
<a id="ln-6277" name="ln-6277" href="#ln-6277"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6278" name="ln-6278" href="#ln-6278"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nminfix</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6279" name="ln-6279" href="#ln-6279"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6280" name="ln-6280" href="#ln-6280"></a>
<a id="ln-6281" name="ln-6281" href="#ln-6281"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6282" name="ln-6282" href="#ln-6282"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nminuptake</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6283" name="ln-6283" href="#ln-6283"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6284" name="ln-6284" href="#ln-6284"></a>
<a id="ln-6285" name="ln-6285" href="#ln-6285"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6286" name="ln-6286" href="#ln-6286"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Plabuptake</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6287" name="ln-6287" href="#ln-6287"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6288" name="ln-6288" href="#ln-6288"></a>
<a id="ln-6289" name="ln-6289" href="#ln-6289"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6290" name="ln-6290" href="#ln-6290"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Clabloss</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6291" name="ln-6291" href="#ln-6291"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6292" name="ln-6292" href="#ln-6292"></a>
<a id="ln-6293" name="ln-6293" href="#ln-6293"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6294" name="ln-6294" href="#ln-6294"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracClabile</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6295" name="ln-6295" href="#ln-6295"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6296" name="ln-6296" href="#ln-6296"></a>
<a id="ln-6297" name="ln-6297" href="#ln-6297"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6298" name="ln-6298" href="#ln-6298"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cnep</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6299" name="ln-6299" href="#ln-6299"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6300" name="ln-6300" href="#ln-6300"></a>
<a id="ln-6301" name="ln-6301" href="#ln-6301"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6302" name="ln-6302" href="#ln-6302"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Crsoil</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6303" name="ln-6303" href="#ln-6303"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6304" name="ln-6304" href="#ln-6304"></a>
<a id="ln-6305" name="ln-6305" href="#ln-6305"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6306" name="ln-6306" href="#ln-6306"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nmindep</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6307" name="ln-6307" href="#ln-6307"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6308" name="ln-6308" href="#ln-6308"></a>
<a id="ln-6309" name="ln-6309" href="#ln-6309"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6310" name="ln-6310" href="#ln-6310"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nminloss</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6311" name="ln-6311" href="#ln-6311"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6312" name="ln-6312" href="#ln-6312"></a>
<a id="ln-6313" name="ln-6313" href="#ln-6313"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6314" name="ln-6314" href="#ln-6314"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nminleach</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6315" name="ln-6315" href="#ln-6315"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6316" name="ln-6316" href="#ln-6316"></a>
<a id="ln-6317" name="ln-6317" href="#ln-6317"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6318" name="ln-6318" href="#ln-6318"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nupland</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6319" name="ln-6319" href="#ln-6319"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6320" name="ln-6320" href="#ln-6320"></a>
<a id="ln-6321" name="ln-6321" href="#ln-6321"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6322" name="ln-6322" href="#ln-6322"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nlittermin</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6323" name="ln-6323" href="#ln-6323"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6324" name="ln-6324" href="#ln-6324"></a>
<a id="ln-6325" name="ln-6325" href="#ln-6325"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6326" name="ln-6326" href="#ln-6326"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nsmin</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6327" name="ln-6327" href="#ln-6327"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6328" name="ln-6328" href="#ln-6328"></a>
<a id="ln-6329" name="ln-6329" href="#ln-6329"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6330" name="ln-6330" href="#ln-6330"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nsimm</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6331" name="ln-6331" href="#ln-6331"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6332" name="ln-6332" href="#ln-6332"></a>
<a id="ln-6333" name="ln-6333" href="#ln-6333"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6334" name="ln-6334" href="#ln-6334"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nsnet</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6335" name="ln-6335" href="#ln-6335"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6336" name="ln-6336" href="#ln-6336"></a>
<a id="ln-6337" name="ln-6337" href="#ln-6337"></a><span class="w">    </span><span class="c">!*****************************</span>
<a id="ln-6338" name="ln-6338" href="#ln-6338"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6339" name="ln-6339" href="#ln-6339"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">frac_sapwood</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6340" name="ln-6340" href="#ln-6340"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6341" name="ln-6341" href="#ln-6341"></a>
<a id="ln-6342" name="ln-6342" href="#ln-6342"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6343" name="ln-6343" href="#ln-6343"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">sapwood_area</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6344" name="ln-6344" href="#ln-6344"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6345" name="ln-6345" href="#ln-6345"></a>
<a id="ln-6346" name="ln-6346" href="#ln-6346"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6347" name="ln-6347" href="#ln-6347"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cplant_turnover_disturbance</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6348" name="ln-6348" href="#ln-6348"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6349" name="ln-6349" href="#ln-6349"></a>
<a id="ln-6350" name="ln-6350" href="#ln-6350"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6351" name="ln-6351" href="#ln-6351"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cplant_turnover_crowding</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6352" name="ln-6352" href="#ln-6352"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6353" name="ln-6353" href="#ln-6353"></a>
<a id="ln-6354" name="ln-6354" href="#ln-6354"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6355" name="ln-6355" href="#ln-6355"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cplant_turnover_resource_limitation</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6356" name="ln-6356" href="#ln-6356"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6357" name="ln-6357" href="#ln-6357"></a>
<a id="ln-6358" name="ln-6358" href="#ln-6358"></a><span class="w">    </span><span class="c">! MPI: sanity check</span>
<a id="ln-6359" name="ln-6359" href="#ln-6359"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ntyp</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-6360" name="ln-6360" href="#ln-6360"></a><span class="k">       WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker: invalid number of casa fields, fix it!&#39;</span><span class="w"></span>
<a id="ln-6361" name="ln-6361" href="#ln-6361"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Abort</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6362" name="ln-6362" href="#ln-6362"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-6363" name="ln-6363" href="#ln-6363"></a>
<a id="ln-6364" name="ln-6364" href="#ln-6364"></a><span class="k">    </span><span class="n">types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6365" name="ln-6365" href="#ln-6365"></a>
<a id="ln-6366" name="ln-6366" href="#ln-6366"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_create_struct</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">blocks</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6367" name="ln-6367" href="#ln-6367"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_commit</span><span class="w"> </span><span class="p">(</span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6368" name="ln-6368" href="#ln-6368"></a>
<a id="ln-6369" name="ln-6369" href="#ln-6369"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_size</span><span class="w"> </span><span class="p">(</span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6370" name="ln-6370" href="#ln-6370"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_get_extent</span><span class="w"> </span><span class="p">(</span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6371" name="ln-6371" href="#ln-6371"></a>
<a id="ln-6372" name="ln-6372" href="#ln-6372"></a><span class="w">    </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;casa type struct blocks, size, extent and lb: &#39;</span><span class="p">,</span><span class="n">bidx</span><span class="p">,</span><span class="n">tsize</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-6373" name="ln-6373" href="#ln-6373"></a>
<a id="ln-6374" name="ln-6374" href="#ln-6374"></a><span class="w">    </span><span class="c">! MPI: check whether total size of received data equals total</span>
<a id="ln-6375" name="ln-6375" href="#ln-6375"></a><span class="w">    </span><span class="c">! data sent by all the workers</span>
<a id="ln-6376" name="ln-6376" href="#ln-6376"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Reduce</span><span class="w"> </span><span class="p">(</span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DATATYPE_NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6377" name="ln-6377" href="#ln-6377"></a>
<a id="ln-6378" name="ln-6378" href="#ln-6378"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="w"></span>
<a id="ln-6379" name="ln-6379" href="#ln-6379"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">displs</span><span class="p">)</span><span class="w"></span>
<a id="ln-6380" name="ln-6380" href="#ln-6380"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span><span class="w"></span>
<a id="ln-6381" name="ln-6381" href="#ln-6381"></a>
<a id="ln-6382" name="ln-6382" href="#ln-6382"></a><span class="w">    </span><span class="k">RETURN</span>
<a id="ln-6383" name="ln-6383" href="#ln-6383"></a>
<a id="ln-6384" name="ln-6384" href="#ln-6384"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_casa_type</span><span class="w"></span>
<a id="ln-6385" name="ln-6385" href="#ln-6385"></a>
<a id="ln-6386" name="ln-6386" href="#ln-6386"></a>
<a id="ln-6387" name="ln-6387" href="#ln-6387"></a>
<a id="ln-6388" name="ln-6388" href="#ln-6388"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_climate_types</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-6389" name="ln-6389" href="#ln-6389"></a>
<a id="ln-6390" name="ln-6390" href="#ln-6390"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-6391" name="ln-6391" href="#ln-6391"></a>
<a id="ln-6392" name="ln-6392" href="#ln-6392"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">climate_type</span><span class="p">,</span><span class="w"> </span><span class="n">alloc_cbm_var</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="w"></span>
<a id="ln-6393" name="ln-6393" href="#ln-6393"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_climate_mod</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">climate_init</span><span class="w"></span>
<a id="ln-6394" name="ln-6394" href="#ln-6394"></a>
<a id="ln-6395" name="ln-6395" href="#ln-6395"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span>
<a id="ln-6396" name="ln-6396" href="#ln-6396"></a>
<a id="ln-6397" name="ln-6397" href="#ln-6397"></a><span class="k">    TYPE</span><span class="p">(</span><span class="n">climate_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="kd">::</span><span class="w"> </span><span class="n">climate</span><span class="w"></span>
<a id="ln-6398" name="ln-6398" href="#ln-6398"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="w"></span>
<a id="ln-6399" name="ln-6399" href="#ln-6399"></a>
<a id="ln-6400" name="ln-6400" href="#ln-6400"></a><span class="w">    </span><span class="c">! MPI: temp arrays for marshalling all types into a struct</span>
<a id="ln-6401" name="ln-6401" href="#ln-6401"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blocks</span><span class="w"></span>
<a id="ln-6402" name="ln-6402" href="#ln-6402"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">displs</span><span class="w"></span>
<a id="ln-6403" name="ln-6403" href="#ln-6403"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<a id="ln-6404" name="ln-6404" href="#ln-6404"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntyp</span><span class="w"> </span><span class="c">! number of worker&#39;s types</span>
<a id="ln-6405" name="ln-6405" href="#ln-6405"></a>
<a id="ln-6406" name="ln-6406" href="#ln-6406"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">last2d</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<a id="ln-6407" name="ln-6407" href="#ln-6407"></a>
<a id="ln-6408" name="ln-6408" href="#ln-6408"></a><span class="w">    </span><span class="c">! MPI: block lenghts for hindexed representing all vectors</span>
<a id="ln-6409" name="ln-6409" href="#ln-6409"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blen</span><span class="w"></span>
<a id="ln-6410" name="ln-6410" href="#ln-6410"></a>
<a id="ln-6411" name="ln-6411" href="#ln-6411"></a><span class="w">    </span><span class="c">! MPI: block lengths and strides for hvector representing matrices</span>
<a id="ln-6412" name="ln-6412" href="#ln-6412"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r1len</span><span class="p">,</span><span class="w"> </span><span class="n">r2len</span><span class="p">,</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-6413" name="ln-6413" href="#ln-6413"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r1stride</span><span class="p">,</span><span class="w"> </span><span class="n">r2stride</span><span class="w"></span>
<a id="ln-6414" name="ln-6414" href="#ln-6414"></a>
<a id="ln-6415" name="ln-6415" href="#ln-6415"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">totalrecv</span><span class="p">,</span><span class="w"> </span><span class="n">totalsend</span><span class="w"></span>
<a id="ln-6416" name="ln-6416" href="#ln-6416"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-6417" name="ln-6417" href="#ln-6417"></a>
<a id="ln-6418" name="ln-6418" href="#ln-6418"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="w"></span>
<a id="ln-6419" name="ln-6419" href="#ln-6419"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">midx</span><span class="p">,</span><span class="w"> </span><span class="n">vidx</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">ny</span><span class="p">,</span><span class="w"> </span><span class="n">nd</span><span class="p">,</span><span class="w"> </span><span class="n">ndq</span><span class="w"></span>
<a id="ln-6420" name="ln-6420" href="#ln-6420"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">stat</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">),</span><span class="w"> </span><span class="n">ierr2</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="w"></span>
<a id="ln-6421" name="ln-6421" href="#ln-6421"></a>
<a id="ln-6422" name="ln-6422" href="#ln-6422"></a>
<a id="ln-6423" name="ln-6423" href="#ln-6423"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rbuf</span><span class="w"></span>
<a id="ln-6424" name="ln-6424" href="#ln-6424"></a>
<a id="ln-6425" name="ln-6425" href="#ln-6425"></a><span class="w">    </span><span class="c">! CALL alloc_cbm_var(climate,mp)</span>
<a id="ln-6426" name="ln-6426" href="#ln-6426"></a>
<a id="ln-6427" name="ln-6427" href="#ln-6427"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">call_climate</span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">climate_init</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">climate</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">,</span><span class="w"> </span><span class="n">ktauday</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-6428" name="ln-6428" href="#ln-6428"></a><span class="w">    </span><span class="c">! MPI: allocate temp vectors used for marshalling</span>
<a id="ln-6429" name="ln-6429" href="#ln-6429"></a><span class="w">    </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nclimate</span><span class="w"></span>
<a id="ln-6430" name="ln-6430" href="#ln-6430"></a>
<a id="ln-6431" name="ln-6431" href="#ln-6431"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">blocks</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6432" name="ln-6432" href="#ln-6432"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">displs</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6433" name="ln-6433" href="#ln-6433"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6434" name="ln-6434" href="#ln-6434"></a><span class="w">    </span><span class="n">off</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6435" name="ln-6435" href="#ln-6435"></a>
<a id="ln-6436" name="ln-6436" href="#ln-6436"></a><span class="w">    </span><span class="c">! counter to sum total number of bytes receives from all workers</span>
<a id="ln-6437" name="ln-6437" href="#ln-6437"></a><span class="w">    </span><span class="n">totalrecv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-6438" name="ln-6438" href="#ln-6438"></a>
<a id="ln-6439" name="ln-6439" href="#ln-6439"></a><span class="w">    </span><span class="n">r1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-6440" name="ln-6440" href="#ln-6440"></a><span class="w">    </span><span class="n">r2len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-6441" name="ln-6441" href="#ln-6441"></a><span class="w">    </span><span class="n">I1LEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-6442" name="ln-6442" href="#ln-6442"></a>
<a id="ln-6443" name="ln-6443" href="#ln-6443"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-6444" name="ln-6444" href="#ln-6444"></a>
<a id="ln-6445" name="ln-6445" href="#ln-6445"></a><span class="w">    </span><span class="c">! ------------- 2D arrays -------------</span>
<a id="ln-6446" name="ln-6446" href="#ln-6446"></a><span class="w">    </span><span class="n">ny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">climate</span><span class="p">%</span><span class="n">nyear_average</span><span class="w"></span>
<a id="ln-6447" name="ln-6447" href="#ln-6447"></a><span class="w">    </span><span class="n">nd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">climate</span><span class="p">%</span><span class="n">nday_average</span><span class="w"></span>
<a id="ln-6448" name="ln-6448" href="#ln-6448"></a><span class="w">    </span><span class="n">ndq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">91</span><span class="w"></span>
<a id="ln-6449" name="ln-6449" href="#ln-6449"></a>
<a id="ln-6450" name="ln-6450" href="#ln-6450"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6451" name="ln-6451" href="#ln-6451"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">mtemp_min_20</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6452" name="ln-6452" href="#ln-6452"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ny</span><span class="o">*</span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6453" name="ln-6453" href="#ln-6453"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6454" name="ln-6454" href="#ln-6454"></a>
<a id="ln-6455" name="ln-6455" href="#ln-6455"></a>
<a id="ln-6456" name="ln-6456" href="#ln-6456"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6457" name="ln-6457" href="#ln-6457"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">mtemp_max_20</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6458" name="ln-6458" href="#ln-6458"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ny</span><span class="o">*</span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6459" name="ln-6459" href="#ln-6459"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6460" name="ln-6460" href="#ln-6460"></a>
<a id="ln-6461" name="ln-6461" href="#ln-6461"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6462" name="ln-6462" href="#ln-6462"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">alpha_PT_20</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6463" name="ln-6463" href="#ln-6463"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ny</span><span class="o">*</span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6464" name="ln-6464" href="#ln-6464"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6465" name="ln-6465" href="#ln-6465"></a>
<a id="ln-6466" name="ln-6466" href="#ln-6466"></a>
<a id="ln-6467" name="ln-6467" href="#ln-6467"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6468" name="ln-6468" href="#ln-6468"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">dtemp_31</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6469" name="ln-6469" href="#ln-6469"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nd</span><span class="o">*</span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6470" name="ln-6470" href="#ln-6470"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6471" name="ln-6471" href="#ln-6471"></a>
<a id="ln-6472" name="ln-6472" href="#ln-6472"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6473" name="ln-6473" href="#ln-6473"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">dtemp_91</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6474" name="ln-6474" href="#ln-6474"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndq</span><span class="o">*</span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6475" name="ln-6475" href="#ln-6475"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6476" name="ln-6476" href="#ln-6476"></a>
<a id="ln-6477" name="ln-6477" href="#ln-6477"></a>
<a id="ln-6478" name="ln-6478" href="#ln-6478"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6479" name="ln-6479" href="#ln-6479"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">dmoist_31</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6480" name="ln-6480" href="#ln-6480"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nd</span><span class="o">*</span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6481" name="ln-6481" href="#ln-6481"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6482" name="ln-6482" href="#ln-6482"></a>
<a id="ln-6483" name="ln-6483" href="#ln-6483"></a>
<a id="ln-6484" name="ln-6484" href="#ln-6484"></a><span class="w">    </span><span class="c">! ------------- 1D vectors -------------</span>
<a id="ln-6485" name="ln-6485" href="#ln-6485"></a>
<a id="ln-6486" name="ln-6486" href="#ln-6486"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6487" name="ln-6487" href="#ln-6487"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">chilldays</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6488" name="ln-6488" href="#ln-6488"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-6489" name="ln-6489" href="#ln-6489"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6490" name="ln-6490" href="#ln-6490"></a>
<a id="ln-6491" name="ln-6491" href="#ln-6491"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6492" name="ln-6492" href="#ln-6492"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">iveg</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6493" name="ln-6493" href="#ln-6493"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-6494" name="ln-6494" href="#ln-6494"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6495" name="ln-6495" href="#ln-6495"></a>
<a id="ln-6496" name="ln-6496" href="#ln-6496"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6497" name="ln-6497" href="#ln-6497"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">biome</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6498" name="ln-6498" href="#ln-6498"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-6499" name="ln-6499" href="#ln-6499"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6500" name="ln-6500" href="#ln-6500"></a>
<a id="ln-6501" name="ln-6501" href="#ln-6501"></a>
<a id="ln-6502" name="ln-6502" href="#ln-6502"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6503" name="ln-6503" href="#ln-6503"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">dtemp</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6504" name="ln-6504" href="#ln-6504"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6505" name="ln-6505" href="#ln-6505"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6506" name="ln-6506" href="#ln-6506"></a>
<a id="ln-6507" name="ln-6507" href="#ln-6507"></a>
<a id="ln-6508" name="ln-6508" href="#ln-6508"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6509" name="ln-6509" href="#ln-6509"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">dmoist</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6510" name="ln-6510" href="#ln-6510"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6511" name="ln-6511" href="#ln-6511"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6512" name="ln-6512" href="#ln-6512"></a>
<a id="ln-6513" name="ln-6513" href="#ln-6513"></a>
<a id="ln-6514" name="ln-6514" href="#ln-6514"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6515" name="ln-6515" href="#ln-6515"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">mtemp</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6516" name="ln-6516" href="#ln-6516"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6517" name="ln-6517" href="#ln-6517"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6518" name="ln-6518" href="#ln-6518"></a>
<a id="ln-6519" name="ln-6519" href="#ln-6519"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6520" name="ln-6520" href="#ln-6520"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">qtemp</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6521" name="ln-6521" href="#ln-6521"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6522" name="ln-6522" href="#ln-6522"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6523" name="ln-6523" href="#ln-6523"></a>
<a id="ln-6524" name="ln-6524" href="#ln-6524"></a>
<a id="ln-6525" name="ln-6525" href="#ln-6525"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6526" name="ln-6526" href="#ln-6526"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">mmoist</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6527" name="ln-6527" href="#ln-6527"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6528" name="ln-6528" href="#ln-6528"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6529" name="ln-6529" href="#ln-6529"></a>
<a id="ln-6530" name="ln-6530" href="#ln-6530"></a>
<a id="ln-6531" name="ln-6531" href="#ln-6531"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6532" name="ln-6532" href="#ln-6532"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">mtemp_min</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6533" name="ln-6533" href="#ln-6533"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6534" name="ln-6534" href="#ln-6534"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6535" name="ln-6535" href="#ln-6535"></a>
<a id="ln-6536" name="ln-6536" href="#ln-6536"></a>
<a id="ln-6537" name="ln-6537" href="#ln-6537"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6538" name="ln-6538" href="#ln-6538"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">mtemp_max</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6539" name="ln-6539" href="#ln-6539"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6540" name="ln-6540" href="#ln-6540"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6541" name="ln-6541" href="#ln-6541"></a>
<a id="ln-6542" name="ln-6542" href="#ln-6542"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6543" name="ln-6543" href="#ln-6543"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">qtemp_max</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6544" name="ln-6544" href="#ln-6544"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6545" name="ln-6545" href="#ln-6545"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6546" name="ln-6546" href="#ln-6546"></a>
<a id="ln-6547" name="ln-6547" href="#ln-6547"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6548" name="ln-6548" href="#ln-6548"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">qtemp_max_last_year</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6549" name="ln-6549" href="#ln-6549"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6550" name="ln-6550" href="#ln-6550"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6551" name="ln-6551" href="#ln-6551"></a>
<a id="ln-6552" name="ln-6552" href="#ln-6552"></a>
<a id="ln-6553" name="ln-6553" href="#ln-6553"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6554" name="ln-6554" href="#ln-6554"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">mtemp_min20</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6555" name="ln-6555" href="#ln-6555"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6556" name="ln-6556" href="#ln-6556"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6557" name="ln-6557" href="#ln-6557"></a>
<a id="ln-6558" name="ln-6558" href="#ln-6558"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6559" name="ln-6559" href="#ln-6559"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">mtemp_max20</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6560" name="ln-6560" href="#ln-6560"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6561" name="ln-6561" href="#ln-6561"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6562" name="ln-6562" href="#ln-6562"></a>
<a id="ln-6563" name="ln-6563" href="#ln-6563"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6564" name="ln-6564" href="#ln-6564"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">atemp_mean</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6565" name="ln-6565" href="#ln-6565"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6566" name="ln-6566" href="#ln-6566"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6567" name="ln-6567" href="#ln-6567"></a>
<a id="ln-6568" name="ln-6568" href="#ln-6568"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6569" name="ln-6569" href="#ln-6569"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">agdd5</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6570" name="ln-6570" href="#ln-6570"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6571" name="ln-6571" href="#ln-6571"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6572" name="ln-6572" href="#ln-6572"></a>
<a id="ln-6573" name="ln-6573" href="#ln-6573"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6574" name="ln-6574" href="#ln-6574"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">gdd5</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6575" name="ln-6575" href="#ln-6575"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6576" name="ln-6576" href="#ln-6576"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6577" name="ln-6577" href="#ln-6577"></a>
<a id="ln-6578" name="ln-6578" href="#ln-6578"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6579" name="ln-6579" href="#ln-6579"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">agdd0</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6580" name="ln-6580" href="#ln-6580"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6581" name="ln-6581" href="#ln-6581"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6582" name="ln-6582" href="#ln-6582"></a>
<a id="ln-6583" name="ln-6583" href="#ln-6583"></a>
<a id="ln-6584" name="ln-6584" href="#ln-6584"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6585" name="ln-6585" href="#ln-6585"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">gdd0</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6586" name="ln-6586" href="#ln-6586"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6587" name="ln-6587" href="#ln-6587"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6588" name="ln-6588" href="#ln-6588"></a>
<a id="ln-6589" name="ln-6589" href="#ln-6589"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6590" name="ln-6590" href="#ln-6590"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">alpha_PT</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6591" name="ln-6591" href="#ln-6591"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6592" name="ln-6592" href="#ln-6592"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6593" name="ln-6593" href="#ln-6593"></a>
<a id="ln-6594" name="ln-6594" href="#ln-6594"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6595" name="ln-6595" href="#ln-6595"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">evap_PT</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6596" name="ln-6596" href="#ln-6596"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6597" name="ln-6597" href="#ln-6597"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6598" name="ln-6598" href="#ln-6598"></a>
<a id="ln-6599" name="ln-6599" href="#ln-6599"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6600" name="ln-6600" href="#ln-6600"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">aevap</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6601" name="ln-6601" href="#ln-6601"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6602" name="ln-6602" href="#ln-6602"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6603" name="ln-6603" href="#ln-6603"></a>
<a id="ln-6604" name="ln-6604" href="#ln-6604"></a><span class="w">    </span><span class="c">! ------------- scalars  -------------</span>
<a id="ln-6605" name="ln-6605" href="#ln-6605"></a>
<a id="ln-6606" name="ln-6606" href="#ln-6606"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6607" name="ln-6607" href="#ln-6607"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">nyears</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6608" name="ln-6608" href="#ln-6608"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-6609" name="ln-6609" href="#ln-6609"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6610" name="ln-6610" href="#ln-6610"></a>
<a id="ln-6611" name="ln-6611" href="#ln-6611"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6612" name="ln-6612" href="#ln-6612"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">climate</span><span class="p">%</span><span class="n">doy</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6613" name="ln-6613" href="#ln-6613"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-6614" name="ln-6614" href="#ln-6614"></a><span class="w">    </span><span class="n">types</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6615" name="ln-6615" href="#ln-6615"></a>
<a id="ln-6616" name="ln-6616" href="#ln-6616"></a>
<a id="ln-6617" name="ln-6617" href="#ln-6617"></a><span class="c">!!$types = MPI_BYTE</span>
<a id="ln-6618" name="ln-6618" href="#ln-6618"></a><span class="w">    </span><span class="c">! MPI: sanity check</span>
<a id="ln-6619" name="ln-6619" href="#ln-6619"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ntyp</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-6620" name="ln-6620" href="#ln-6620"></a><span class="k">       WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker: invalid number of climate fields, fix it!&#39;</span><span class="w"></span>
<a id="ln-6621" name="ln-6621" href="#ln-6621"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Abort</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6622" name="ln-6622" href="#ln-6622"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-6623" name="ln-6623" href="#ln-6623"></a>
<a id="ln-6624" name="ln-6624" href="#ln-6624"></a>
<a id="ln-6625" name="ln-6625" href="#ln-6625"></a><span class="k">    CALL </span><span class="n">MPI_Type_create_struct</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">blocks</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">climate_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6626" name="ln-6626" href="#ln-6626"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_commit</span><span class="w"> </span><span class="p">(</span><span class="n">climate_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6627" name="ln-6627" href="#ln-6627"></a>
<a id="ln-6628" name="ln-6628" href="#ln-6628"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_size</span><span class="w"> </span><span class="p">(</span><span class="n">climate_t</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6629" name="ln-6629" href="#ln-6629"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_get_extent</span><span class="w"> </span><span class="p">(</span><span class="n">climate_t</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6630" name="ln-6630" href="#ln-6630"></a>
<a id="ln-6631" name="ln-6631" href="#ln-6631"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Reduce</span><span class="w"> </span><span class="p">(</span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DATATYPE_NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6632" name="ln-6632" href="#ln-6632"></a>
<a id="ln-6633" name="ln-6633" href="#ln-6633"></a><span class="w">    </span><span class="c">! so, now receive all the parameters</span>
<a id="ln-6634" name="ln-6634" href="#ln-6634"></a><span class="w">    </span><span class="c">!    CALL MPI_Recv (MPI_BOTTOM, 1, climate_t, 0, 0, comm, stat, ierr)</span>
<a id="ln-6635" name="ln-6635" href="#ln-6635"></a>
<a id="ln-6636" name="ln-6636" href="#ln-6636"></a><span class="w">    </span><span class="c">!   Maciej: buffered recv + unpac version</span>
<a id="ln-6637" name="ln-6637" href="#ln-6637"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">rbuf</span><span class="p">(</span><span class="n">tsize</span><span class="p">))</span><span class="w"></span>
<a id="ln-6638" name="ln-6638" href="#ln-6638"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">rbuf</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6639" name="ln-6639" href="#ln-6639"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_count</span><span class="w"> </span><span class="p">(</span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">climate_t</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="p">,</span><span class="w"> </span><span class="n">ierr2</span><span class="p">)</span><span class="w"></span>
<a id="ln-6640" name="ln-6640" href="#ln-6640"></a>
<a id="ln-6641" name="ln-6641" href="#ln-6641"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPI_SUCCESS</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">ierr2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPI_SUCCESS</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">rcount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-6642" name="ln-6642" href="#ln-6642"></a><span class="k">       </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-6643" name="ln-6643" href="#ln-6643"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Unpack</span><span class="w"> </span><span class="p">(</span><span class="n">rbuf</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="p">,</span><span class="w"> </span><span class="n">climate_t</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-6644" name="ln-6644" href="#ln-6644"></a><span class="w">            </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6645" name="ln-6645" href="#ln-6645"></a><span class="w">       </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPI_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;climate unpack error, rank: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">ierr</span><span class="w"></span>
<a id="ln-6646" name="ln-6646" href="#ln-6646"></a><span class="w">    </span><span class="k">ELSE</span>
<a id="ln-6647" name="ln-6647" href="#ln-6647"></a><span class="k">       WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;climate recv rank err err2 rcount: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">ierr2</span><span class="p">,</span><span class="w"> </span><span class="n">rcount</span><span class="w"></span>
<a id="ln-6648" name="ln-6648" href="#ln-6648"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-6649" name="ln-6649" href="#ln-6649"></a>
<a id="ln-6650" name="ln-6650" href="#ln-6650"></a><span class="k">    DEALLOCATE</span><span class="p">(</span><span class="n">rbuf</span><span class="p">)</span><span class="w"></span>
<a id="ln-6651" name="ln-6651" href="#ln-6651"></a>
<a id="ln-6652" name="ln-6652" href="#ln-6652"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="w"></span>
<a id="ln-6653" name="ln-6653" href="#ln-6653"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">displs</span><span class="p">)</span><span class="w"></span>
<a id="ln-6654" name="ln-6654" href="#ln-6654"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span><span class="w"></span>
<a id="ln-6655" name="ln-6655" href="#ln-6655"></a>
<a id="ln-6656" name="ln-6656" href="#ln-6656"></a><span class="w">    </span><span class="k">RETURN</span>
<a id="ln-6657" name="ln-6657" href="#ln-6657"></a>
<a id="ln-6658" name="ln-6658" href="#ln-6658"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_climate_types</span><span class="w"></span>
<a id="ln-6659" name="ln-6659" href="#ln-6659"></a><span class="c">!!$</span>
<a id="ln-6660" name="ln-6660" href="#ln-6660"></a><span class="w">  </span><span class="c">! MPI: creates restart_t type to send to the master the fields</span>
<a id="ln-6661" name="ln-6661" href="#ln-6661"></a><span class="w">  </span><span class="c">! that are only required for the restart file but not included in the</span>
<a id="ln-6662" name="ln-6662" href="#ln-6662"></a><span class="w">  </span><span class="c">! results sent at the end of each time step</span>
<a id="ln-6663" name="ln-6663" href="#ln-6663"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_restart_type</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">canopy</span><span class="p">,</span><span class="w"> </span><span class="n">air</span><span class="p">)</span><span class="w"></span>
<a id="ln-6664" name="ln-6664" href="#ln-6664"></a>
<a id="ln-6665" name="ln-6665" href="#ln-6665"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-6666" name="ln-6666" href="#ln-6666"></a>
<a id="ln-6667" name="ln-6667" href="#ln-6667"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-6668" name="ln-6668" href="#ln-6668"></a>
<a id="ln-6669" name="ln-6669" href="#ln-6669"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span>
<a id="ln-6670" name="ln-6670" href="#ln-6670"></a>
<a id="ln-6671" name="ln-6671" href="#ln-6671"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w"></span>
<a id="ln-6672" name="ln-6672" href="#ln-6672"></a>
<a id="ln-6673" name="ln-6673" href="#ln-6673"></a><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">canopy_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">canopy</span><span class="w"></span>
<a id="ln-6674" name="ln-6674" href="#ln-6674"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">air_type</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">air</span><span class="w"></span>
<a id="ln-6675" name="ln-6675" href="#ln-6675"></a>
<a id="ln-6676" name="ln-6676" href="#ln-6676"></a><span class="w">    </span><span class="c">! MPI: temp arrays for marshalling all types into a struct</span>
<a id="ln-6677" name="ln-6677" href="#ln-6677"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blocks</span><span class="w"></span>
<a id="ln-6678" name="ln-6678" href="#ln-6678"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">displs</span><span class="w"></span>
<a id="ln-6679" name="ln-6679" href="#ln-6679"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<a id="ln-6680" name="ln-6680" href="#ln-6680"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntyp</span><span class="w"> </span><span class="c">! number of worker&#39;s types</span>
<a id="ln-6681" name="ln-6681" href="#ln-6681"></a>
<a id="ln-6682" name="ln-6682" href="#ln-6682"></a><span class="w">    </span><span class="c">! MPI: block lengths and strides for hvector representing matrices</span>
<a id="ln-6683" name="ln-6683" href="#ln-6683"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r1len</span><span class="p">,</span><span class="w"> </span><span class="n">r2len</span><span class="p">,</span><span class="w"> </span><span class="n">I1LEN</span><span class="p">,</span><span class="w"> </span><span class="n">llen</span><span class="w"></span>
<a id="ln-6684" name="ln-6684" href="#ln-6684"></a>
<a id="ln-6685" name="ln-6685" href="#ln-6685"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="w"></span>
<a id="ln-6686" name="ln-6686" href="#ln-6686"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">midx</span><span class="p">,</span><span class="w"> </span><span class="n">vidx</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">nd</span><span class="p">,</span><span class="w"> </span><span class="n">ny</span><span class="w"></span>
<a id="ln-6687" name="ln-6687" href="#ln-6687"></a>
<a id="ln-6688" name="ln-6688" href="#ln-6688"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tsize</span><span class="w"></span>
<a id="ln-6689" name="ln-6689" href="#ln-6689"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-6690" name="ln-6690" href="#ln-6690"></a>
<a id="ln-6691" name="ln-6691" href="#ln-6691"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Comm_rank</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6692" name="ln-6692" href="#ln-6692"></a>
<a id="ln-6693" name="ln-6693" href="#ln-6693"></a><span class="w">    </span><span class="c">! MPI: allocate temp vectors used for marshalling</span>
<a id="ln-6694" name="ln-6694" href="#ln-6694"></a><span class="w">    </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrestart</span><span class="w"></span>
<a id="ln-6695" name="ln-6695" href="#ln-6695"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">blocks</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6696" name="ln-6696" href="#ln-6696"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">displs</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6697" name="ln-6697" href="#ln-6697"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6698" name="ln-6698" href="#ln-6698"></a>
<a id="ln-6699" name="ln-6699" href="#ln-6699"></a><span class="w">    </span><span class="n">off</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6700" name="ln-6700" href="#ln-6700"></a><span class="w">    </span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"></span>
<a id="ln-6701" name="ln-6701" href="#ln-6701"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-6702" name="ln-6702" href="#ln-6702"></a>
<a id="ln-6703" name="ln-6703" href="#ln-6703"></a><span class="w">    </span><span class="n">r1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-6704" name="ln-6704" href="#ln-6704"></a><span class="w">    </span><span class="n">r2len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-6705" name="ln-6705" href="#ln-6705"></a><span class="w">    </span><span class="n">I1LEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-6706" name="ln-6706" href="#ln-6706"></a><span class="w">    </span><span class="n">llen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extl</span><span class="w"></span>
<a id="ln-6707" name="ln-6707" href="#ln-6707"></a>
<a id="ln-6708" name="ln-6708" href="#ln-6708"></a><span class="w">    </span><span class="c">!  bidx = bidx + 1</span>
<a id="ln-6709" name="ln-6709" href="#ln-6709"></a><span class="w">    </span><span class="c">!  CALL MPI_Get_address (canopy%rwater(off,1), displs(bidx), ierr)</span>
<a id="ln-6710" name="ln-6710" href="#ln-6710"></a><span class="w">    </span><span class="c">!  blocks(bidx) = r1len * ms</span>
<a id="ln-6711" name="ln-6711" href="#ln-6711"></a>
<a id="ln-6712" name="ln-6712" href="#ln-6712"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6713" name="ln-6713" href="#ln-6713"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">evapfbl</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6714" name="ln-6714" href="#ln-6714"></a><span class="w">    </span><span class="c">! MPI: gol124: changed to r1 when Bernard ported to CABLE_r491</span>
<a id="ln-6715" name="ln-6715" href="#ln-6715"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ms</span><span class="w"></span>
<a id="ln-6716" name="ln-6716" href="#ln-6716"></a>
<a id="ln-6717" name="ln-6717" href="#ln-6717"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6718" name="ln-6718" href="#ln-6718"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">cduv</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6719" name="ln-6719" href="#ln-6719"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6720" name="ln-6720" href="#ln-6720"></a>
<a id="ln-6721" name="ln-6721" href="#ln-6721"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6722" name="ln-6722" href="#ln-6722"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">dewmm</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6723" name="ln-6723" href="#ln-6723"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6724" name="ln-6724" href="#ln-6724"></a>
<a id="ln-6725" name="ln-6725" href="#ln-6725"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6726" name="ln-6726" href="#ln-6726"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">dgdtg</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6727" name="ln-6727" href="#ln-6727"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6728" name="ln-6728" href="#ln-6728"></a>
<a id="ln-6729" name="ln-6729" href="#ln-6729"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6730" name="ln-6730" href="#ln-6730"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frpw</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6731" name="ln-6731" href="#ln-6731"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6732" name="ln-6732" href="#ln-6732"></a>
<a id="ln-6733" name="ln-6733" href="#ln-6733"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6734" name="ln-6734" href="#ln-6734"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">frpr</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6735" name="ln-6735" href="#ln-6735"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6736" name="ln-6736" href="#ln-6736"></a>
<a id="ln-6737" name="ln-6737" href="#ln-6737"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6738" name="ln-6738" href="#ln-6738"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">canopy</span><span class="p">%</span><span class="n">fnv</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6739" name="ln-6739" href="#ln-6739"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6740" name="ln-6740" href="#ln-6740"></a>
<a id="ln-6741" name="ln-6741" href="#ln-6741"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6742" name="ln-6742" href="#ln-6742"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">rho</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6743" name="ln-6743" href="#ln-6743"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6744" name="ln-6744" href="#ln-6744"></a>
<a id="ln-6745" name="ln-6745" href="#ln-6745"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6746" name="ln-6746" href="#ln-6746"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">volm</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6747" name="ln-6747" href="#ln-6747"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6748" name="ln-6748" href="#ln-6748"></a>
<a id="ln-6749" name="ln-6749" href="#ln-6749"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6750" name="ln-6750" href="#ln-6750"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">qsat</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6751" name="ln-6751" href="#ln-6751"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6752" name="ln-6752" href="#ln-6752"></a>
<a id="ln-6753" name="ln-6753" href="#ln-6753"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6754" name="ln-6754" href="#ln-6754"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">epsi</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6755" name="ln-6755" href="#ln-6755"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6756" name="ln-6756" href="#ln-6756"></a>
<a id="ln-6757" name="ln-6757" href="#ln-6757"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6758" name="ln-6758" href="#ln-6758"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">visc</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6759" name="ln-6759" href="#ln-6759"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6760" name="ln-6760" href="#ln-6760"></a>
<a id="ln-6761" name="ln-6761" href="#ln-6761"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6762" name="ln-6762" href="#ln-6762"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">psyc</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6763" name="ln-6763" href="#ln-6763"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6764" name="ln-6764" href="#ln-6764"></a>
<a id="ln-6765" name="ln-6765" href="#ln-6765"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6766" name="ln-6766" href="#ln-6766"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">dsatdk</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6767" name="ln-6767" href="#ln-6767"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6768" name="ln-6768" href="#ln-6768"></a>
<a id="ln-6769" name="ln-6769" href="#ln-6769"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6770" name="ln-6770" href="#ln-6770"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">air</span><span class="p">%</span><span class="n">cmolar</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6771" name="ln-6771" href="#ln-6771"></a><span class="w">    </span><span class="n">blocks</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r1len</span><span class="w"></span>
<a id="ln-6772" name="ln-6772" href="#ln-6772"></a>
<a id="ln-6773" name="ln-6773" href="#ln-6773"></a><span class="w">    </span><span class="c">! MPI: sanity check</span>
<a id="ln-6774" name="ln-6774" href="#ln-6774"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ntyp</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-6775" name="ln-6775" href="#ln-6775"></a><span class="k">       WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;invalid nrestart constant, fix it!&#39;</span><span class="w"></span>
<a id="ln-6776" name="ln-6776" href="#ln-6776"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Abort</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6777" name="ln-6777" href="#ln-6777"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-6778" name="ln-6778" href="#ln-6778"></a>
<a id="ln-6779" name="ln-6779" href="#ln-6779"></a><span class="k">    </span><span class="n">types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6780" name="ln-6780" href="#ln-6780"></a>
<a id="ln-6781" name="ln-6781" href="#ln-6781"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_create_struct</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">blocks</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">restart_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6782" name="ln-6782" href="#ln-6782"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_commit</span><span class="w"> </span><span class="p">(</span><span class="n">restart_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6783" name="ln-6783" href="#ln-6783"></a>
<a id="ln-6784" name="ln-6784" href="#ln-6784"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_size</span><span class="w"> </span><span class="p">(</span><span class="n">restart_t</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6785" name="ln-6785" href="#ln-6785"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_get_extent</span><span class="w"> </span><span class="p">(</span><span class="n">restart_t</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6786" name="ln-6786" href="#ln-6786"></a>
<a id="ln-6787" name="ln-6787" href="#ln-6787"></a><span class="w">    </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;restart struct blocks, size, extent and lb: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="n">bidx</span><span class="p">,</span><span class="n">tsize</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-6788" name="ln-6788" href="#ln-6788"></a>
<a id="ln-6789" name="ln-6789" href="#ln-6789"></a><span class="w">    </span><span class="c">! MPI: check whether total size of received data equals total</span>
<a id="ln-6790" name="ln-6790" href="#ln-6790"></a><span class="w">    </span><span class="c">! data sent by all the workers</span>
<a id="ln-6791" name="ln-6791" href="#ln-6791"></a><span class="w">    </span><span class="c">!mcd287  CALL MPI_Reduce (tsize, tsize, 1, MPI_INTEGER, MPI_SUM, 0, comm, ierr)</span>
<a id="ln-6792" name="ln-6792" href="#ln-6792"></a><span class="w">    </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;b4 reduce wk&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DATATYPE_NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-6793" name="ln-6793" href="#ln-6793"></a><span class="w">    </span><span class="k">CALL </span><span class="nb">flush</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<a id="ln-6794" name="ln-6794" href="#ln-6794"></a><span class="w">    </span><span class="c">!call flush(wlogn)</span>
<a id="ln-6795" name="ln-6795" href="#ln-6795"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Reduce</span><span class="w"> </span><span class="p">(</span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DATATYPE_NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6796" name="ln-6796" href="#ln-6796"></a>
<a id="ln-6797" name="ln-6797" href="#ln-6797"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="w"></span>
<a id="ln-6798" name="ln-6798" href="#ln-6798"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">displs</span><span class="p">)</span><span class="w"></span>
<a id="ln-6799" name="ln-6799" href="#ln-6799"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span><span class="w"></span>
<a id="ln-6800" name="ln-6800" href="#ln-6800"></a>
<a id="ln-6801" name="ln-6801" href="#ln-6801"></a><span class="w">    </span><span class="k">RETURN</span>
<a id="ln-6802" name="ln-6802" href="#ln-6802"></a>
<a id="ln-6803" name="ln-6803" href="#ln-6803"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_restart_type</span><span class="w"></span>
<a id="ln-6804" name="ln-6804" href="#ln-6804"></a>
<a id="ln-6805" name="ln-6805" href="#ln-6805"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_casa_dump_types</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="n">phen</span><span class="p">,</span><span class="w"> </span><span class="n">climate</span><span class="p">)</span><span class="w"></span>
<a id="ln-6806" name="ln-6806" href="#ln-6806"></a>
<a id="ln-6807" name="ln-6807" href="#ln-6807"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-6808" name="ln-6808" href="#ln-6808"></a>
<a id="ln-6809" name="ln-6809" href="#ln-6809"></a><span class="w">    </span><span class="k">USE </span><span class="n">casavariable</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">casa_met</span><span class="p">,</span><span class="w"> </span><span class="n">casa_flux</span><span class="p">,</span><span class="w"> </span><span class="n">mplant</span><span class="w"></span>
<a id="ln-6810" name="ln-6810" href="#ln-6810"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">climate_type</span><span class="w"></span>
<a id="ln-6811" name="ln-6811" href="#ln-6811"></a><span class="w">    </span><span class="k">USE </span><span class="n">phenvariable</span><span class="w"></span>
<a id="ln-6812" name="ln-6812" href="#ln-6812"></a>
<a id="ln-6813" name="ln-6813" href="#ln-6813"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<a id="ln-6814" name="ln-6814" href="#ln-6814"></a>
<a id="ln-6815" name="ln-6815" href="#ln-6815"></a><span class="w">    </span><span class="c">! sub arguments</span>
<a id="ln-6816" name="ln-6816" href="#ln-6816"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w">  </span><span class="c">! MPI communicator</span>
<a id="ln-6817" name="ln-6817" href="#ln-6817"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_flux</span><span class="p">)</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casaflux</span><span class="w"></span>
<a id="ln-6818" name="ln-6818" href="#ln-6818"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_met</span><span class="p">)</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casamet</span><span class="w"></span>
<a id="ln-6819" name="ln-6819" href="#ln-6819"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">phen_variable</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">phen</span><span class="w"></span>
<a id="ln-6820" name="ln-6820" href="#ln-6820"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">climate_type</span><span class="p">)</span><span class="kd">::</span><span class="w"> </span><span class="n">climate</span><span class="w"></span>
<a id="ln-6821" name="ln-6821" href="#ln-6821"></a>
<a id="ln-6822" name="ln-6822" href="#ln-6822"></a><span class="w">    </span><span class="c">! local vars</span>
<a id="ln-6823" name="ln-6823" href="#ln-6823"></a>
<a id="ln-6824" name="ln-6824" href="#ln-6824"></a><span class="w">    </span><span class="c">! temp arrays for marshalling all fields into a single struct</span>
<a id="ln-6825" name="ln-6825" href="#ln-6825"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blen</span><span class="w"></span>
<a id="ln-6826" name="ln-6826" href="#ln-6826"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">displs</span><span class="w"></span>
<a id="ln-6827" name="ln-6827" href="#ln-6827"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<a id="ln-6828" name="ln-6828" href="#ln-6828"></a>
<a id="ln-6829" name="ln-6829" href="#ln-6829"></a><span class="w">    </span><span class="c">! temp vars for verifying block number and total length of inp_t</span>
<a id="ln-6830" name="ln-6830" href="#ln-6830"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-6831" name="ln-6831" href="#ln-6831"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tsize</span><span class="w"></span>
<a id="ln-6832" name="ln-6832" href="#ln-6832"></a>
<a id="ln-6833" name="ln-6833" href="#ln-6833"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">stat</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-6834" name="ln-6834" href="#ln-6834"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">landp_t</span><span class="p">,</span><span class="w"> </span><span class="n">patch_t</span><span class="p">,</span><span class="w"> </span><span class="n">param_t</span><span class="w"></span>
<a id="ln-6835" name="ln-6835" href="#ln-6835"></a>
<a id="ln-6836" name="ln-6836" href="#ln-6836"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r1len</span><span class="p">,</span><span class="w"> </span><span class="n">r2len</span><span class="p">,</span><span class="w"> </span><span class="n">I1LEN</span><span class="p">,</span><span class="w"> </span><span class="n">llen</span><span class="w"> </span><span class="c">! block lengths</span>
<a id="ln-6837" name="ln-6837" href="#ln-6837"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="c">! block index</span>
<a id="ln-6838" name="ln-6838" href="#ln-6838"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntyp</span><span class="w"> </span><span class="c">! total number of blocks</span>
<a id="ln-6839" name="ln-6839" href="#ln-6839"></a>
<a id="ln-6840" name="ln-6840" href="#ln-6840"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="w"></span>
<a id="ln-6841" name="ln-6841" href="#ln-6841"></a>
<a id="ln-6842" name="ln-6842" href="#ln-6842"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Comm_rank</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6843" name="ln-6843" href="#ln-6843"></a>
<a id="ln-6844" name="ln-6844" href="#ln-6844"></a><span class="w">    </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ncdumprw</span><span class="w"></span>
<a id="ln-6845" name="ln-6845" href="#ln-6845"></a>
<a id="ln-6846" name="ln-6846" href="#ln-6846"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">blen</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6847" name="ln-6847" href="#ln-6847"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">displs</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6848" name="ln-6848" href="#ln-6848"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6849" name="ln-6849" href="#ln-6849"></a>
<a id="ln-6850" name="ln-6850" href="#ln-6850"></a><span class="w">    </span><span class="c">! default type is byte, to be overriden for multi-D types</span>
<a id="ln-6851" name="ln-6851" href="#ln-6851"></a><span class="w">    </span><span class="n">types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6852" name="ln-6852" href="#ln-6852"></a>
<a id="ln-6853" name="ln-6853" href="#ln-6853"></a><span class="w">    </span><span class="n">r1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-6854" name="ln-6854" href="#ln-6854"></a><span class="w">    </span><span class="n">r2len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-6855" name="ln-6855" href="#ln-6855"></a><span class="w">    </span><span class="n">i1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-6856" name="ln-6856" href="#ln-6856"></a>
<a id="ln-6857" name="ln-6857" href="#ln-6857"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-6858" name="ln-6858" href="#ln-6858"></a>
<a id="ln-6859" name="ln-6859" href="#ln-6859"></a><span class="w">    </span><span class="c">! ------- casamet ----</span>
<a id="ln-6860" name="ln-6860" href="#ln-6860"></a>
<a id="ln-6861" name="ln-6861" href="#ln-6861"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6862" name="ln-6862" href="#ln-6862"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">Tairk</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6863" name="ln-6863" href="#ln-6863"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6864" name="ln-6864" href="#ln-6864"></a>
<a id="ln-6865" name="ln-6865" href="#ln-6865"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6866" name="ln-6866" href="#ln-6866"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">Tsoil</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6867" name="ln-6867" href="#ln-6867"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6868" name="ln-6868" href="#ln-6868"></a>
<a id="ln-6869" name="ln-6869" href="#ln-6869"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6870" name="ln-6870" href="#ln-6870"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">moist</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6871" name="ln-6871" href="#ln-6871"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6872" name="ln-6872" href="#ln-6872"></a>
<a id="ln-6873" name="ln-6873" href="#ln-6873"></a><span class="w">    </span><span class="c">! ------- casaflux ----</span>
<a id="ln-6874" name="ln-6874" href="#ln-6874"></a>
<a id="ln-6875" name="ln-6875" href="#ln-6875"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6876" name="ln-6876" href="#ln-6876"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Cgpp</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6877" name="ln-6877" href="#ln-6877"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6878" name="ln-6878" href="#ln-6878"></a>
<a id="ln-6879" name="ln-6879" href="#ln-6879"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6880" name="ln-6880" href="#ln-6880"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Crmplant</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6881" name="ln-6881" href="#ln-6881"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mplant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6882" name="ln-6882" href="#ln-6882"></a>
<a id="ln-6883" name="ln-6883" href="#ln-6883"></a>
<a id="ln-6884" name="ln-6884" href="#ln-6884"></a>
<a id="ln-6885" name="ln-6885" href="#ln-6885"></a><span class="w">    </span><span class="c">!****************************************************************</span>
<a id="ln-6886" name="ln-6886" href="#ln-6886"></a><span class="w">    </span><span class="c">! phen fields</span>
<a id="ln-6887" name="ln-6887" href="#ln-6887"></a>
<a id="ln-6888" name="ln-6888" href="#ln-6888"></a>
<a id="ln-6889" name="ln-6889" href="#ln-6889"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6890" name="ln-6890" href="#ln-6890"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">phase</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6891" name="ln-6891" href="#ln-6891"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1LEN</span><span class="w"></span>
<a id="ln-6892" name="ln-6892" href="#ln-6892"></a>
<a id="ln-6893" name="ln-6893" href="#ln-6893"></a>
<a id="ln-6894" name="ln-6894" href="#ln-6894"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6895" name="ln-6895" href="#ln-6895"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">phen</span><span class="p">%</span><span class="n">doyphase</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6896" name="ln-6896" href="#ln-6896"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mphase</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i1len</span><span class="w"></span>
<a id="ln-6897" name="ln-6897" href="#ln-6897"></a>
<a id="ln-6898" name="ln-6898" href="#ln-6898"></a><span class="w">    </span><span class="c">! #294 - Avoid malformed var write for now </span>
<a id="ln-6899" name="ln-6899" href="#ln-6899"></a><span class="w">    </span><span class="c">! bidx = bidx + 1</span>
<a id="ln-6900" name="ln-6900" href="#ln-6900"></a><span class="w">    </span><span class="c">! CALL MPI_Get_address (climate%mtemp_max, displs(bidx), ierr)</span>
<a id="ln-6901" name="ln-6901" href="#ln-6901"></a><span class="w">    </span><span class="c">! blen(bidx) = r1len</span>
<a id="ln-6902" name="ln-6902" href="#ln-6902"></a>
<a id="ln-6903" name="ln-6903" href="#ln-6903"></a><span class="w">    </span><span class="c">!****************************************************************</span>
<a id="ln-6904" name="ln-6904" href="#ln-6904"></a><span class="w">    </span><span class="c">! Ndep</span>
<a id="ln-6905" name="ln-6905" href="#ln-6905"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6906" name="ln-6906" href="#ln-6906"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nmindep</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6907" name="ln-6907" href="#ln-6907"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-6908" name="ln-6908" href="#ln-6908"></a>
<a id="ln-6909" name="ln-6909" href="#ln-6909"></a>
<a id="ln-6910" name="ln-6910" href="#ln-6910"></a><span class="w">    </span><span class="c">!******************************************************************</span>
<a id="ln-6911" name="ln-6911" href="#ln-6911"></a>
<a id="ln-6912" name="ln-6912" href="#ln-6912"></a>
<a id="ln-6913" name="ln-6913" href="#ln-6913"></a><span class="w">    </span><span class="c">! MPI: sanity check</span>
<a id="ln-6914" name="ln-6914" href="#ln-6914"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ntyp</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-6915" name="ln-6915" href="#ln-6915"></a><span class="k">       WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s1">&#39; invalid number of casa_dump_t param fields &#39;</span><span class="p">,</span><span class="n">bidx</span><span class="p">,</span><span class="s1">&#39;, fix it!&#39;</span><span class="w"></span>
<a id="ln-6916" name="ln-6916" href="#ln-6916"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Abort</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6917" name="ln-6917" href="#ln-6917"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-6918" name="ln-6918" href="#ln-6918"></a>
<a id="ln-6919" name="ln-6919" href="#ln-6919"></a><span class="k">    CALL </span><span class="n">MPI_Type_create_struct</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">blen</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">casa_dump_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6920" name="ln-6920" href="#ln-6920"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_commit</span><span class="w"> </span><span class="p">(</span><span class="n">casa_dump_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6921" name="ln-6921" href="#ln-6921"></a>
<a id="ln-6922" name="ln-6922" href="#ln-6922"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_size</span><span class="w"> </span><span class="p">(</span><span class="n">casa_dump_t</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6923" name="ln-6923" href="#ln-6923"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_get_extent</span><span class="w"> </span><span class="p">(</span><span class="n">casa_dump_t</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6924" name="ln-6924" href="#ln-6924"></a>
<a id="ln-6925" name="ln-6925" href="#ln-6925"></a><span class="w">    </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker casa_dump_t param blocks, size, extent and lb: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-6926" name="ln-6926" href="#ln-6926"></a><span class="w">         </span><span class="n">bidx</span><span class="p">,</span><span class="n">tsize</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-6927" name="ln-6927" href="#ln-6927"></a>
<a id="ln-6928" name="ln-6928" href="#ln-6928"></a><span class="w">    </span><span class="c">! MPI: check whether total size of received data equals total</span>
<a id="ln-6929" name="ln-6929" href="#ln-6929"></a><span class="w">    </span><span class="c">! data sent by all the workers</span>
<a id="ln-6930" name="ln-6930" href="#ln-6930"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Reduce</span><span class="w"> </span><span class="p">(</span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DATATYPE_NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6931" name="ln-6931" href="#ln-6931"></a>
<a id="ln-6932" name="ln-6932" href="#ln-6932"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="w"></span>
<a id="ln-6933" name="ln-6933" href="#ln-6933"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">displs</span><span class="p">)</span><span class="w"></span>
<a id="ln-6934" name="ln-6934" href="#ln-6934"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">blen</span><span class="p">)</span><span class="w"></span>
<a id="ln-6935" name="ln-6935" href="#ln-6935"></a>
<a id="ln-6936" name="ln-6936" href="#ln-6936"></a><span class="c">!!$ ! if anything went wrong the master will mpi_abort</span>
<a id="ln-6937" name="ln-6937" href="#ln-6937"></a><span class="c">!!$ ! which mpi_recv below is going to catch...</span>
<a id="ln-6938" name="ln-6938" href="#ln-6938"></a><span class="c">!!$ ! so, now receive all the parameters</span>
<a id="ln-6939" name="ln-6939" href="#ln-6939"></a><span class="c">!!$ CALL MPI_Recv (MPI_BOTTOM, 1, casa_dump_t, 0, 0, comm, stat, ierr)</span>
<a id="ln-6940" name="ln-6940" href="#ln-6940"></a><span class="c">!!$</span>
<a id="ln-6941" name="ln-6941" href="#ln-6941"></a><span class="c">!!$ ! finally free the MPI type</span>
<a id="ln-6942" name="ln-6942" href="#ln-6942"></a><span class="c">!!$ CALL MPI_Type_Free (casa_dump_t, ierr)</span>
<a id="ln-6943" name="ln-6943" href="#ln-6943"></a>
<a id="ln-6944" name="ln-6944" href="#ln-6944"></a><span class="w">    </span><span class="c">! all casa parameters have been received from the master by now</span>
<a id="ln-6945" name="ln-6945" href="#ln-6945"></a>
<a id="ln-6946" name="ln-6946" href="#ln-6946"></a><span class="w">  </span><span class="k">END SUBROUTINE </span><span class="n">worker_casa_dump_types</span><span class="w"></span>
<a id="ln-6947" name="ln-6947" href="#ln-6947"></a>
<a id="ln-6948" name="ln-6948" href="#ln-6948"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_casa_LUC_types</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">)</span><span class="w"></span>
<a id="ln-6949" name="ln-6949" href="#ln-6949"></a>
<a id="ln-6950" name="ln-6950" href="#ln-6950"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-6951" name="ln-6951" href="#ln-6951"></a>
<a id="ln-6952" name="ln-6952" href="#ln-6952"></a><span class="w">    </span><span class="k">USE </span><span class="n">casavariable</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">casa_pool</span><span class="p">,</span><span class="w"> </span><span class="n">mplant</span><span class="p">,</span><span class="w"> </span><span class="n">mlitter</span><span class="p">,</span><span class="w"> </span><span class="n">msoil</span><span class="p">,</span><span class="w"> </span><span class="n">casa_balance</span><span class="w"></span>
<a id="ln-6953" name="ln-6953" href="#ln-6953"></a>
<a id="ln-6954" name="ln-6954" href="#ln-6954"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<a id="ln-6955" name="ln-6955" href="#ln-6955"></a>
<a id="ln-6956" name="ln-6956" href="#ln-6956"></a><span class="w">    </span><span class="c">! sub arguments</span>
<a id="ln-6957" name="ln-6957" href="#ln-6957"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w">  </span><span class="c">! MPI communicator</span>
<a id="ln-6958" name="ln-6958" href="#ln-6958"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_pool</span><span class="p">)</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casapool</span><span class="w"></span>
<a id="ln-6959" name="ln-6959" href="#ln-6959"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_balance</span><span class="p">),</span><span class="w">        </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casabal</span><span class="w"></span>
<a id="ln-6960" name="ln-6960" href="#ln-6960"></a>
<a id="ln-6961" name="ln-6961" href="#ln-6961"></a><span class="w">    </span><span class="c">! local vars</span>
<a id="ln-6962" name="ln-6962" href="#ln-6962"></a>
<a id="ln-6963" name="ln-6963" href="#ln-6963"></a><span class="w">    </span><span class="c">! temp arrays for marshalling all fields into a single struct</span>
<a id="ln-6964" name="ln-6964" href="#ln-6964"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blen</span><span class="w"></span>
<a id="ln-6965" name="ln-6965" href="#ln-6965"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">displs</span><span class="w"></span>
<a id="ln-6966" name="ln-6966" href="#ln-6966"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">types</span><span class="w"></span>
<a id="ln-6967" name="ln-6967" href="#ln-6967"></a>
<a id="ln-6968" name="ln-6968" href="#ln-6968"></a><span class="w">    </span><span class="c">! temp vars for verifying block number and total length of inp_t</span>
<a id="ln-6969" name="ln-6969" href="#ln-6969"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">MPI_ADDRESS_KIND</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-6970" name="ln-6970" href="#ln-6970"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tsize</span><span class="w"></span>
<a id="ln-6971" name="ln-6971" href="#ln-6971"></a>
<a id="ln-6972" name="ln-6972" href="#ln-6972"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">stat</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-6973" name="ln-6973" href="#ln-6973"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">landp_t</span><span class="p">,</span><span class="w"> </span><span class="n">patch_t</span><span class="p">,</span><span class="w"> </span><span class="n">param_t</span><span class="w"></span>
<a id="ln-6974" name="ln-6974" href="#ln-6974"></a>
<a id="ln-6975" name="ln-6975" href="#ln-6975"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r1len</span><span class="p">,</span><span class="w"> </span><span class="n">r2len</span><span class="p">,</span><span class="w"> </span><span class="n">I1LEN</span><span class="p">,</span><span class="w"> </span><span class="n">llen</span><span class="w"> </span><span class="c">! block lengths</span>
<a id="ln-6976" name="ln-6976" href="#ln-6976"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="c">! block index</span>
<a id="ln-6977" name="ln-6977" href="#ln-6977"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntyp</span><span class="w"> </span><span class="c">! total number of blocks</span>
<a id="ln-6978" name="ln-6978" href="#ln-6978"></a>
<a id="ln-6979" name="ln-6979" href="#ln-6979"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">off</span><span class="w"></span>
<a id="ln-6980" name="ln-6980" href="#ln-6980"></a>
<a id="ln-6981" name="ln-6981" href="#ln-6981"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Comm_rank</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-6982" name="ln-6982" href="#ln-6982"></a>
<a id="ln-6983" name="ln-6983" href="#ln-6983"></a><span class="w">    </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nLUCrw</span><span class="w"></span>
<a id="ln-6984" name="ln-6984" href="#ln-6984"></a>
<a id="ln-6985" name="ln-6985" href="#ln-6985"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">blen</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6986" name="ln-6986" href="#ln-6986"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">displs</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6987" name="ln-6987" href="#ln-6987"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="n">ntyp</span><span class="p">))</span><span class="w"></span>
<a id="ln-6988" name="ln-6988" href="#ln-6988"></a>
<a id="ln-6989" name="ln-6989" href="#ln-6989"></a><span class="w">    </span><span class="c">! default type is byte, to be overriden for multi-D types</span>
<a id="ln-6990" name="ln-6990" href="#ln-6990"></a><span class="w">    </span><span class="n">types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_BYTE</span><span class="w"></span>
<a id="ln-6991" name="ln-6991" href="#ln-6991"></a>
<a id="ln-6992" name="ln-6992" href="#ln-6992"></a><span class="w">    </span><span class="n">r1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr1</span><span class="w"></span>
<a id="ln-6993" name="ln-6993" href="#ln-6993"></a><span class="w">    </span><span class="n">r2len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extr2</span><span class="w"></span>
<a id="ln-6994" name="ln-6994" href="#ln-6994"></a><span class="w">    </span><span class="n">i1len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">extid</span><span class="w"></span>
<a id="ln-6995" name="ln-6995" href="#ln-6995"></a><span class="w">    </span><span class="n">off</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6996" name="ln-6996" href="#ln-6996"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-6997" name="ln-6997" href="#ln-6997"></a>
<a id="ln-6998" name="ln-6998" href="#ln-6998"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-6999" name="ln-6999" href="#ln-6999"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7000" name="ln-7000" href="#ln-7000"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"></span>
<a id="ln-7001" name="ln-7001" href="#ln-7001"></a>
<a id="ln-7002" name="ln-7002" href="#ln-7002"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7003" name="ln-7003" href="#ln-7003"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">clitter</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7004" name="ln-7004" href="#ln-7004"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"></span>
<a id="ln-7005" name="ln-7005" href="#ln-7005"></a>
<a id="ln-7006" name="ln-7006" href="#ln-7006"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7007" name="ln-7007" href="#ln-7007"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">csoil</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7008" name="ln-7008" href="#ln-7008"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"></span>
<a id="ln-7009" name="ln-7009" href="#ln-7009"></a>
<a id="ln-7010" name="ln-7010" href="#ln-7010"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7011" name="ln-7011" href="#ln-7011"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">nplant</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7012" name="ln-7012" href="#ln-7012"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"></span>
<a id="ln-7013" name="ln-7013" href="#ln-7013"></a>
<a id="ln-7014" name="ln-7014" href="#ln-7014"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7015" name="ln-7015" href="#ln-7015"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">nlitter</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7016" name="ln-7016" href="#ln-7016"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"></span>
<a id="ln-7017" name="ln-7017" href="#ln-7017"></a>
<a id="ln-7018" name="ln-7018" href="#ln-7018"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7019" name="ln-7019" href="#ln-7019"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">nsoil</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7020" name="ln-7020" href="#ln-7020"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"></span>
<a id="ln-7021" name="ln-7021" href="#ln-7021"></a>
<a id="ln-7022" name="ln-7022" href="#ln-7022"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7023" name="ln-7023" href="#ln-7023"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">pplant</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7024" name="ln-7024" href="#ln-7024"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mplant</span><span class="w"></span>
<a id="ln-7025" name="ln-7025" href="#ln-7025"></a>
<a id="ln-7026" name="ln-7026" href="#ln-7026"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7027" name="ln-7027" href="#ln-7027"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">plitter</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7028" name="ln-7028" href="#ln-7028"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mlitter</span><span class="w"></span>
<a id="ln-7029" name="ln-7029" href="#ln-7029"></a>
<a id="ln-7030" name="ln-7030" href="#ln-7030"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7031" name="ln-7031" href="#ln-7031"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">psoil</span><span class="p">(</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7032" name="ln-7032" href="#ln-7032"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">msoil</span><span class="w"></span>
<a id="ln-7033" name="ln-7033" href="#ln-7033"></a>
<a id="ln-7034" name="ln-7034" href="#ln-7034"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7035" name="ln-7035" href="#ln-7035"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">Nsoilmin</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7036" name="ln-7036" href="#ln-7036"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-7037" name="ln-7037" href="#ln-7037"></a>
<a id="ln-7038" name="ln-7038" href="#ln-7038"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7039" name="ln-7039" href="#ln-7039"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casapool</span><span class="p">%</span><span class="n">clabile</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7040" name="ln-7040" href="#ln-7040"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-7041" name="ln-7041" href="#ln-7041"></a>
<a id="ln-7042" name="ln-7042" href="#ln-7042"></a><span class="w">    </span><span class="n">bidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bidx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7043" name="ln-7043" href="#ln-7043"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Get_address</span><span class="w"> </span><span class="p">(</span><span class="n">casabal</span><span class="p">%</span><span class="n">FCneeyear</span><span class="p">(</span><span class="n">off</span><span class="p">),</span><span class="w"> </span><span class="n">displs</span><span class="p">(</span><span class="n">bidx</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7044" name="ln-7044" href="#ln-7044"></a><span class="w">    </span><span class="n">blen</span><span class="p">(</span><span class="n">bidx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r2len</span><span class="w"></span>
<a id="ln-7045" name="ln-7045" href="#ln-7045"></a>
<a id="ln-7046" name="ln-7046" href="#ln-7046"></a>
<a id="ln-7047" name="ln-7047" href="#ln-7047"></a>
<a id="ln-7048" name="ln-7048" href="#ln-7048"></a><span class="w">    </span><span class="c">! MPI: sanity check</span>
<a id="ln-7049" name="ln-7049" href="#ln-7049"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ntyp</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7050" name="ln-7050" href="#ln-7050"></a><span class="k">       WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="s1">&#39; invalid number of casa_LUC_t param fields &#39;</span><span class="p">,</span><span class="n">bidx</span><span class="p">,</span><span class="s1">&#39;, fix it!&#39;</span><span class="w"></span>
<a id="ln-7051" name="ln-7051" href="#ln-7051"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Abort</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7052" name="ln-7052" href="#ln-7052"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-7053" name="ln-7053" href="#ln-7053"></a>
<a id="ln-7054" name="ln-7054" href="#ln-7054"></a><span class="k">    CALL </span><span class="n">MPI_Type_create_struct</span><span class="w"> </span><span class="p">(</span><span class="n">bidx</span><span class="p">,</span><span class="w"> </span><span class="n">blen</span><span class="p">,</span><span class="w"> </span><span class="n">displs</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">casa_LUC_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7055" name="ln-7055" href="#ln-7055"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_commit</span><span class="w"> </span><span class="p">(</span><span class="n">casa_LUC_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7056" name="ln-7056" href="#ln-7056"></a>
<a id="ln-7057" name="ln-7057" href="#ln-7057"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_size</span><span class="w"> </span><span class="p">(</span><span class="n">casa_LUC_t</span><span class="p">,</span><span class="w"> </span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7058" name="ln-7058" href="#ln-7058"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_get_extent</span><span class="w"> </span><span class="p">(</span><span class="n">casa_LUC_t</span><span class="p">,</span><span class="w"> </span><span class="n">tmplb</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7059" name="ln-7059" href="#ln-7059"></a>
<a id="ln-7060" name="ln-7060" href="#ln-7060"></a><span class="w">    </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;worker casa_LUC_t param blocks, size, extent and lb: &#39;</span><span class="p">,</span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7061" name="ln-7061" href="#ln-7061"></a><span class="w">         </span><span class="n">bidx</span><span class="p">,</span><span class="n">tsize</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">tmplb</span><span class="w"></span>
<a id="ln-7062" name="ln-7062" href="#ln-7062"></a>
<a id="ln-7063" name="ln-7063" href="#ln-7063"></a><span class="w">    </span><span class="c">! MPI: check whether total size of received data equals total</span>
<a id="ln-7064" name="ln-7064" href="#ln-7064"></a><span class="w">    </span><span class="c">! data sent by all the workers</span>
<a id="ln-7065" name="ln-7065" href="#ln-7065"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Reduce</span><span class="w"> </span><span class="p">(</span><span class="n">tsize</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DATATYPE_NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7066" name="ln-7066" href="#ln-7066"></a>
<a id="ln-7067" name="ln-7067" href="#ln-7067"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="w"></span>
<a id="ln-7068" name="ln-7068" href="#ln-7068"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">displs</span><span class="p">)</span><span class="w"></span>
<a id="ln-7069" name="ln-7069" href="#ln-7069"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">blen</span><span class="p">)</span><span class="w"></span>
<a id="ln-7070" name="ln-7070" href="#ln-7070"></a>
<a id="ln-7071" name="ln-7071" href="#ln-7071"></a><span class="c">!!$ ! if anything went wrong the master will mpi_abort</span>
<a id="ln-7072" name="ln-7072" href="#ln-7072"></a><span class="c">!!$ ! which mpi_recv below is going to catch...</span>
<a id="ln-7073" name="ln-7073" href="#ln-7073"></a><span class="c">!!$ ! so, now receive all the parameters</span>
<a id="ln-7074" name="ln-7074" href="#ln-7074"></a><span class="c">!!$ CALL MPI_Recv (MPI_BOTTOM, 1, casa_dump_t, 0, 0, comm, stat, ierr)</span>
<a id="ln-7075" name="ln-7075" href="#ln-7075"></a><span class="c">!!$</span>
<a id="ln-7076" name="ln-7076" href="#ln-7076"></a><span class="c">!!$ ! finally free the MPI type</span>
<a id="ln-7077" name="ln-7077" href="#ln-7077"></a><span class="c">!!$ CALL MPI_Type_Free (casa_dump_t, ierr)</span>
<a id="ln-7078" name="ln-7078" href="#ln-7078"></a>
<a id="ln-7079" name="ln-7079" href="#ln-7079"></a><span class="w">    </span><span class="c">! all casa parameters have been received from the master by now</span>
<a id="ln-7080" name="ln-7080" href="#ln-7080"></a>
<a id="ln-7081" name="ln-7081" href="#ln-7081"></a><span class="w">  </span><span class="k">END SUBROUTINE </span><span class="n">worker_casa_LUC_types</span><span class="w"></span>
<a id="ln-7082" name="ln-7082" href="#ln-7082"></a>
<a id="ln-7083" name="ln-7083" href="#ln-7083"></a>
<a id="ln-7084" name="ln-7084" href="#ln-7084"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_pop_types</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">casamet</span><span class="p">,</span><span class="w"> </span><span class="n">pop</span><span class="p">)</span><span class="w"></span>
<a id="ln-7085" name="ln-7085" href="#ln-7085"></a>
<a id="ln-7086" name="ln-7086" href="#ln-7086"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-7087" name="ln-7087" href="#ln-7087"></a><span class="w">    </span><span class="k">USE </span><span class="n">POP_mpi</span><span class="w"></span>
<a id="ln-7088" name="ln-7088" href="#ln-7088"></a><span class="w">    </span><span class="k">USE </span><span class="n">POPmodule</span><span class="p">,</span><span class="w">          </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">ALLOC_POP</span><span class="p">,</span><span class="n">POP_INIT</span><span class="w"></span>
<a id="ln-7089" name="ln-7089" href="#ln-7089"></a><span class="w">    </span><span class="k">USE </span><span class="n">POP_types</span><span class="p">,</span><span class="w">          </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">pop_type</span><span class="w"></span>
<a id="ln-7090" name="ln-7090" href="#ln-7090"></a><span class="w">    </span><span class="k">USE </span><span class="n">casavariable</span><span class="p">,</span><span class="w">       </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">casa_met</span><span class="w"></span>
<a id="ln-7091" name="ln-7091" href="#ln-7091"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="p">,</span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">veg_parameter_type</span><span class="w"></span>
<a id="ln-7092" name="ln-7092" href="#ln-7092"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_common_module</span><span class="p">,</span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">cable_user</span><span class="w"></span>
<a id="ln-7093" name="ln-7093" href="#ln-7093"></a>
<a id="ln-7094" name="ln-7094" href="#ln-7094"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span>
<a id="ln-7095" name="ln-7095" href="#ln-7095"></a>
<a id="ln-7096" name="ln-7096" href="#ln-7096"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">         </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w"></span>
<a id="ln-7097" name="ln-7097" href="#ln-7097"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_met</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">casamet</span><span class="w"></span>
<a id="ln-7098" name="ln-7098" href="#ln-7098"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">pop_type</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pop</span><span class="w"></span>
<a id="ln-7099" name="ln-7099" href="#ln-7099"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">veg_parameter_type</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">veg</span><span class="w"></span>
<a id="ln-7100" name="ln-7100" href="#ln-7100"></a>
<a id="ln-7101" name="ln-7101" href="#ln-7101"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Iwood</span><span class="p">,</span><span class="w"> </span><span class="n">ainv</span><span class="w"></span>
<a id="ln-7102" name="ln-7102" href="#ln-7102"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mp_pop</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">),</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-7103" name="ln-7103" href="#ln-7103"></a>
<a id="ln-7104" name="ln-7104" href="#ln-7104"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">inv</span><span class="w"></span>
<a id="ln-7105" name="ln-7105" href="#ln-7105"></a>
<a id="ln-7106" name="ln-7106" href="#ln-7106"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Comm_rank</span><span class="w"> </span><span class="p">(</span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7107" name="ln-7107" href="#ln-7107"></a>
<a id="ln-7108" name="ln-7108" href="#ln-7108"></a><span class="w">    </span><span class="c">! Get POP relevant info from Master</span>
<a id="ln-7109" name="ln-7109" href="#ln-7109"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">mp_pop</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-7110" name="ln-7110" href="#ln-7110"></a><span class="w">    </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;worker iwood to allocate&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">mp_pop</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="w"></span>
<a id="ln-7111" name="ln-7111" href="#ln-7111"></a><span class="w">    </span><span class="c">!write(*,*),&#39;worker mppop&#39;, rank, mp_pop</span>
<a id="ln-7112" name="ln-7112" href="#ln-7112"></a><span class="w">    </span><span class="c">!ALLOCATE( POP%Iwood( mp_pop ) )</span>
<a id="ln-7113" name="ln-7113" href="#ln-7113"></a><span class="w">    </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="w"> </span><span class="n">Iwood</span><span class="p">(</span><span class="w"> </span><span class="n">mp_pop</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-7114" name="ln-7114" href="#ln-7114"></a><span class="w">    </span><span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;worker iwood allocated&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">mp_pop</span><span class="w"></span>
<a id="ln-7115" name="ln-7115" href="#ln-7115"></a><span class="w">    </span><span class="c">!CALL MPI_Recv ( POP%Iwood, mp_pop, MPI_INTEGER, 0, 0, comm, stat, ierr )</span>
<a id="ln-7116" name="ln-7116" href="#ln-7116"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Iwood</span><span class="p">,</span><span class="w"> </span><span class="n">mp_pop</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_INTEGER</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-7117" name="ln-7117" href="#ln-7117"></a><span class="w">    </span><span class="c">!write(*,*),&#39;worker Iwood&#39;, rank, POP%Iwood</span>
<a id="ln-7118" name="ln-7118" href="#ln-7118"></a><span class="w">    </span><span class="c">! Maciej</span>
<a id="ln-7119" name="ln-7119" href="#ln-7119"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">ANY</span><span class="w"> </span><span class="p">(</span><span class="n">Iwood</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="nb">ANY</span><span class="w"> </span><span class="p">(</span><span class="n">Iwood</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">mp</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7120" name="ln-7120" href="#ln-7120"></a><span class="k">       WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;worker iwood values outside valid ranges&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="w"></span>
<a id="ln-7121" name="ln-7121" href="#ln-7121"></a><span class="w">       </span><span class="n">inv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">COUNT</span><span class="p">(</span><span class="n">Iwood</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-7122" name="ln-7122" href="#ln-7122"></a><span class="w">       </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">inv</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7123" name="ln-7123" href="#ln-7123"></a><span class="k">          WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;no of values below 1: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">inv</span><span class="w"></span>
<a id="ln-7124" name="ln-7124" href="#ln-7124"></a><span class="w">          </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">ainv</span><span class="p">(</span><span class="n">inv</span><span class="p">))</span><span class="w"></span>
<a id="ln-7125" name="ln-7125" href="#ln-7125"></a><span class="w">          </span><span class="n">ainv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">PACK</span><span class="w"> </span><span class="p">(</span><span class="n">Iwood</span><span class="p">,</span><span class="w"> </span><span class="n">Iwood</span><span class="w"> </span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-7126" name="ln-7126" href="#ln-7126"></a><span class="w">          </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;values below 1: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ainv</span><span class="w"></span>
<a id="ln-7127" name="ln-7127" href="#ln-7127"></a><span class="w">          </span><span class="k">DEALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">ainv</span><span class="p">)</span><span class="w"></span>
<a id="ln-7128" name="ln-7128" href="#ln-7128"></a><span class="w">       </span><span class="k">END IF</span>
<a id="ln-7129" name="ln-7129" href="#ln-7129"></a><span class="k">       </span><span class="n">inv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">COUNT</span><span class="p">(</span><span class="n">Iwood</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">mp</span><span class="p">)</span><span class="w"></span>
<a id="ln-7130" name="ln-7130" href="#ln-7130"></a><span class="w">       </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">inv</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7131" name="ln-7131" href="#ln-7131"></a><span class="k">          WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;no of values above mp &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">mp</span><span class="p">,</span><span class="w"> </span><span class="n">inv</span><span class="w"></span>
<a id="ln-7132" name="ln-7132" href="#ln-7132"></a><span class="w">          </span><span class="k">ALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">ainv</span><span class="p">(</span><span class="n">inv</span><span class="p">))</span><span class="w"></span>
<a id="ln-7133" name="ln-7133" href="#ln-7133"></a><span class="w">          </span><span class="n">ainv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">PACK</span><span class="w"> </span><span class="p">(</span><span class="n">Iwood</span><span class="p">,</span><span class="w"> </span><span class="n">Iwood</span><span class="w"> </span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="w"> </span><span class="n">mp</span><span class="p">)</span><span class="w"></span>
<a id="ln-7134" name="ln-7134" href="#ln-7134"></a><span class="w">          </span><span class="k">WRITE</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;values above mp: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ainv</span><span class="w"></span>
<a id="ln-7135" name="ln-7135" href="#ln-7135"></a><span class="w">          </span><span class="k">DEALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">ainv</span><span class="p">)</span><span class="w"></span>
<a id="ln-7136" name="ln-7136" href="#ln-7136"></a><span class="w">       </span><span class="k">END IF</span>
<a id="ln-7137" name="ln-7137" href="#ln-7137"></a>
<a id="ln-7138" name="ln-7138" href="#ln-7138"></a><span class="k">    END IF</span><span class="w"></span>
<a id="ln-7139" name="ln-7139" href="#ln-7139"></a><span class="w">    </span><span class="c">! maciej: unnecessary, pop_init starts with a call to alloc_pop</span>
<a id="ln-7140" name="ln-7140" href="#ln-7140"></a><span class="w">    </span><span class="c">! CALL ALLOC_POP ( POP, mp_pop )</span>
<a id="ln-7141" name="ln-7141" href="#ln-7141"></a><span class="w">    </span><span class="c">!CALL POP_INIT( pop,veg%disturbance_interval,mp_pop,POP%Iwood )</span>
<a id="ln-7142" name="ln-7142" href="#ln-7142"></a><span class="w">    </span><span class="c">! maciej: veg%disturbance_levels received earlier in worker_cable_params</span>
<a id="ln-7143" name="ln-7143" href="#ln-7143"></a><span class="w">    </span><span class="k">CALL </span><span class="n">POP_INIT</span><span class="p">(</span><span class="w"> </span><span class="n">pop</span><span class="p">,</span><span class="n">veg</span><span class="p">%</span><span class="n">disturbance_interval</span><span class="p">,</span><span class="n">mp_pop</span><span class="p">,</span><span class="n">Iwood</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-7144" name="ln-7144" href="#ln-7144"></a>
<a id="ln-7145" name="ln-7145" href="#ln-7145"></a><span class="w">    </span><span class="k">DEALLOCATE</span><span class="w"> </span><span class="p">(</span><span class="n">Iwood</span><span class="p">)</span><span class="w"></span>
<a id="ln-7146" name="ln-7146" href="#ln-7146"></a>
<a id="ln-7147" name="ln-7147" href="#ln-7147"></a><span class="w">    </span><span class="c">! Maciej: pop_t used also for sending results back to master, even if from zero</span>
<a id="ln-7148" name="ln-7148" href="#ln-7148"></a><span class="w">    </span><span class="k">CALL </span><span class="n">create_pop_gridcell_type</span><span class="w"> </span><span class="p">(</span><span class="n">pop_t</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">)</span><span class="w"></span>
<a id="ln-7149" name="ln-7149" href="#ln-7149"></a>
<a id="ln-7150" name="ln-7150" href="#ln-7150"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">POP_fromZero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7151" name="ln-7151" href="#ln-7151"></a><span class="k">       WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;rank receiving pop_grid from master&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="w"></span>
<a id="ln-7152" name="ln-7152" href="#ln-7152"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="p">(</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">pop_grid</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">mp_pop</span><span class="p">,</span><span class="w"> </span><span class="n">pop_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-7153" name="ln-7153" href="#ln-7153"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-7154" name="ln-7154" href="#ln-7154"></a>
<a id="ln-7155" name="ln-7155" href="#ln-7155"></a>
<a id="ln-7156" name="ln-7156" href="#ln-7156"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_pop_types</span><span class="w"></span>
<a id="ln-7157" name="ln-7157" href="#ln-7157"></a>
<a id="ln-7158" name="ln-7158" href="#ln-7158"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_send_pop</span><span class="w"> </span><span class="p">(</span><span class="n">POP</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">)</span><span class="w"></span>
<a id="ln-7159" name="ln-7159" href="#ln-7159"></a>
<a id="ln-7160" name="ln-7160" href="#ln-7160"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-7161" name="ln-7161" href="#ln-7161"></a><span class="w">    </span><span class="k">USE </span><span class="n">POP_mpi</span><span class="w"></span>
<a id="ln-7162" name="ln-7162" href="#ln-7162"></a><span class="w">    </span><span class="k">USE </span><span class="n">POP_Types</span><span class="p">,</span><span class="w">           </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">pop_type</span><span class="w"></span>
<a id="ln-7163" name="ln-7163" href="#ln-7163"></a>
<a id="ln-7164" name="ln-7164" href="#ln-7164"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span>
<a id="ln-7165" name="ln-7165" href="#ln-7165"></a>
<a id="ln-7166" name="ln-7166" href="#ln-7166"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="w">         </span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">comm</span><span class="w"></span>
<a id="ln-7167" name="ln-7167" href="#ln-7167"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">pop_type</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pop</span><span class="w"></span>
<a id="ln-7168" name="ln-7168" href="#ln-7168"></a>
<a id="ln-7169" name="ln-7169" href="#ln-7169"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-7170" name="ln-7170" href="#ln-7170"></a>
<a id="ln-7171" name="ln-7171" href="#ln-7171"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">np</span><span class="w"> </span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span>
<a id="ln-7172" name="ln-7172" href="#ln-7172"></a>
<a id="ln-7173" name="ln-7173" href="#ln-7173"></a><span class="k">    CALL </span><span class="n">MPI_Send</span><span class="p">(</span><span class="n">POP</span><span class="p">%</span><span class="n">pop_grid</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">np</span><span class="p">,</span><span class="w"> </span><span class="n">pop_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-7174" name="ln-7174" href="#ln-7174"></a>
<a id="ln-7175" name="ln-7175" href="#ln-7175"></a>
<a id="ln-7176" name="ln-7176" href="#ln-7176"></a><span class="w">  </span><span class="k">END SUBROUTINE </span><span class="n">worker_send_pop</span><span class="w"></span>
<a id="ln-7177" name="ln-7177" href="#ln-7177"></a>
<a id="ln-7178" name="ln-7178" href="#ln-7178"></a>
<a id="ln-7179" name="ln-7179" href="#ln-7179"></a><span class="w">  </span><span class="c">! frees memory used for worker&#39;s data structures</span>
<a id="ln-7180" name="ln-7180" href="#ln-7180"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_end</span><span class="p">(</span><span class="n">icycle</span><span class="p">,</span><span class="w"> </span><span class="n">restart</span><span class="p">)</span><span class="w"></span>
<a id="ln-7181" name="ln-7181" href="#ln-7181"></a>
<a id="ln-7182" name="ln-7182" href="#ln-7182"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-7183" name="ln-7183" href="#ln-7183"></a>
<a id="ln-7184" name="ln-7184" href="#ln-7184"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span>
<a id="ln-7185" name="ln-7185" href="#ln-7185"></a>
<a id="ln-7186" name="ln-7186" href="#ln-7186"></a><span class="k">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icycle</span><span class="w"> </span><span class="c">! casa flag</span>
<a id="ln-7187" name="ln-7187" href="#ln-7187"></a><span class="w">    </span><span class="kt">LOGICAL</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">restart</span><span class="w"></span>
<a id="ln-7188" name="ln-7188" href="#ln-7188"></a>
<a id="ln-7189" name="ln-7189" href="#ln-7189"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-7190" name="ln-7190" href="#ln-7190"></a>
<a id="ln-7191" name="ln-7191" href="#ln-7191"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_free</span><span class="w"> </span><span class="p">(</span><span class="n">inp_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7192" name="ln-7192" href="#ln-7192"></a>
<a id="ln-7193" name="ln-7193" href="#ln-7193"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Type_free</span><span class="w"> </span><span class="p">(</span><span class="n">send_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7194" name="ln-7194" href="#ln-7194"></a>
<a id="ln-7195" name="ln-7195" href="#ln-7195"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">icycle</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7196" name="ln-7196" href="#ln-7196"></a><span class="k">       CALL </span><span class="n">MPI_Type_free</span><span class="w"> </span><span class="p">(</span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7197" name="ln-7197" href="#ln-7197"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-7198" name="ln-7198" href="#ln-7198"></a>
<a id="ln-7199" name="ln-7199" href="#ln-7199"></a><span class="k">    IF</span><span class="w"> </span><span class="p">(</span><span class="n">restart</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7200" name="ln-7200" href="#ln-7200"></a><span class="k">       CALL </span><span class="n">MPI_Type_free</span><span class="w"> </span><span class="p">(</span><span class="n">restart_t</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7201" name="ln-7201" href="#ln-7201"></a><span class="w">    </span><span class="k">END IF</span>
<a id="ln-7202" name="ln-7202" href="#ln-7202"></a>
<a id="ln-7203" name="ln-7203" href="#ln-7203"></a><span class="k">    RETURN</span>
<a id="ln-7204" name="ln-7204" href="#ln-7204"></a>
<a id="ln-7205" name="ln-7205" href="#ln-7205"></a><span class="k">  END SUBROUTINE </span><span class="n">worker_end</span><span class="w"></span>
<a id="ln-7206" name="ln-7206" href="#ln-7206"></a>
<a id="ln-7207" name="ln-7207" href="#ln-7207"></a>
<a id="ln-7208" name="ln-7208" href="#ln-7208"></a><span class="w">  </span><span class="c">!*********************************************************************************************</span>
<a id="ln-7209" name="ln-7209" href="#ln-7209"></a>
<a id="ln-7210" name="ln-7210" href="#ln-7210"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_spincasacnp</span><span class="p">(</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="n">kstart</span><span class="p">,</span><span class="n">kend</span><span class="p">,</span><span class="n">mloop</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7211" name="ln-7211" href="#ln-7211"></a><span class="w">       </span><span class="n">casaflux</span><span class="p">,</span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="n">LALLOC</span><span class="p">,</span><span class="w">  </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-7212" name="ln-7212" href="#ln-7212"></a>
<a id="ln-7213" name="ln-7213" href="#ln-7213"></a><span class="w">    </span><span class="c">! USE cable_mpiworker</span>
<a id="ln-7214" name="ln-7214" href="#ln-7214"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-7215" name="ln-7215" href="#ln-7215"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_carbon_module</span><span class="w"></span>
<a id="ln-7216" name="ln-7216" href="#ln-7216"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_common_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="w"></span>
<a id="ln-7217" name="ln-7217" href="#ln-7217"></a><span class="w">    </span><span class="k">USE </span><span class="n">casadimension</span><span class="w"></span>
<a id="ln-7218" name="ln-7218" href="#ln-7218"></a><span class="w">    </span><span class="k">USE </span><span class="n">casaparm</span><span class="w"></span>
<a id="ln-7219" name="ln-7219" href="#ln-7219"></a><span class="w">    </span><span class="k">USE </span><span class="n">casavariable</span><span class="w"></span>
<a id="ln-7220" name="ln-7220" href="#ln-7220"></a><span class="w">    </span><span class="k">USE </span><span class="n">phenvariable</span><span class="w"></span>
<a id="ln-7221" name="ln-7221" href="#ln-7221"></a><span class="w">    </span><span class="k">USE </span><span class="n">POP_Types</span><span class="p">,</span><span class="w">  </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">POP_TYPE</span><span class="w"></span>
<a id="ln-7222" name="ln-7222" href="#ln-7222"></a><span class="w">    </span><span class="k">USE </span><span class="n">POPMODULE</span><span class="p">,</span><span class="w">            </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">POPStep</span><span class="w"></span>
<a id="ln-7223" name="ln-7223" href="#ln-7223"></a><span class="w">    </span><span class="k">USE </span><span class="n">TypeDef</span><span class="p">,</span><span class="w">              </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">i4b</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"></span>
<a id="ln-7224" name="ln-7224" href="#ln-7224"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-7225" name="ln-7225" href="#ln-7225"></a>
<a id="ln-7226" name="ln-7226" href="#ln-7226"></a><span class="w">    </span><span class="c">!mrd561 debug</span>
<a id="ln-7227" name="ln-7227" href="#ln-7227"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_IO_vars_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">wlogn</span><span class="w"></span>
<a id="ln-7228" name="ln-7228" href="#ln-7228"></a>
<a id="ln-7229" name="ln-7229" href="#ln-7229"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<a id="ln-7230" name="ln-7230" href="#ln-7230"></a><span class="w">    </span><span class="c">!!CLN  CHARACTER(LEN=99), INTENT(IN)  :: fcnpspin</span>
<a id="ln-7231" name="ln-7231" href="#ln-7231"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">    </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">dels</span><span class="w"></span>
<a id="ln-7232" name="ln-7232" href="#ln-7232"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">kstart</span><span class="w"></span>
<a id="ln-7233" name="ln-7233" href="#ln-7233"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">kend</span><span class="w"></span>
<a id="ln-7234" name="ln-7234" href="#ln-7234"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">mloop</span><span class="w"></span>
<a id="ln-7235" name="ln-7235" href="#ln-7235"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">LALLOC</span><span class="w"></span>
<a id="ln-7236" name="ln-7236" href="#ln-7236"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">veg_parameter_type</span><span class="p">),</span><span class="w">    </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">veg</span><span class="w">  </span><span class="c">! vegetation parameters</span>
<a id="ln-7237" name="ln-7237" href="#ln-7237"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">soil_parameter_type</span><span class="p">),</span><span class="w">   </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">soil</span><span class="w"> </span><span class="c">! soil parameters</span>
<a id="ln-7238" name="ln-7238" href="#ln-7238"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_biome</span><span class="p">),</span><span class="w">            </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casabiome</span><span class="w"></span>
<a id="ln-7239" name="ln-7239" href="#ln-7239"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_pool</span><span class="p">),</span><span class="w">             </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casapool</span><span class="w"></span>
<a id="ln-7240" name="ln-7240" href="#ln-7240"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_flux</span><span class="p">),</span><span class="w">             </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casaflux</span><span class="w"></span>
<a id="ln-7241" name="ln-7241" href="#ln-7241"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_met</span><span class="p">),</span><span class="w">              </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casamet</span><span class="w"></span>
<a id="ln-7242" name="ln-7242" href="#ln-7242"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_balance</span><span class="p">),</span><span class="w">          </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casabal</span><span class="w"></span>
<a id="ln-7243" name="ln-7243" href="#ln-7243"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">phen_variable</span><span class="p">),</span><span class="w">         </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phen</span><span class="w"></span>
<a id="ln-7244" name="ln-7244" href="#ln-7244"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">POP_TYPE</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">POP</span><span class="w"></span>
<a id="ln-7245" name="ln-7245" href="#ln-7245"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">climate_TYPE</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">climate</span><span class="w"></span>
<a id="ln-7246" name="ln-7246" href="#ln-7246"></a>
<a id="ln-7247" name="ln-7247" href="#ln-7247"></a>
<a id="ln-7248" name="ln-7248" href="#ln-7248"></a>
<a id="ln-7249" name="ln-7249" href="#ln-7249"></a><span class="w">    </span><span class="c">! communicator for error-messages</span>
<a id="ln-7250" name="ln-7250" href="#ln-7250"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="w"></span>
<a id="ln-7251" name="ln-7251" href="#ln-7251"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_met</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">casaspin</span><span class="w"></span>
<a id="ln-7252" name="ln-7252" href="#ln-7252"></a>
<a id="ln-7253" name="ln-7253" href="#ln-7253"></a><span class="w">    </span><span class="c">! local variables</span>
<a id="ln-7254" name="ln-7254" href="#ln-7254"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_cleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_cleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_croot2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_croot2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_cwood2cwd</span><span class="w"></span>
<a id="ln-7255" name="ln-7255" href="#ln-7255"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_nleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_nleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_nroot2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_nroot2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_nwood2cwd</span><span class="w"></span>
<a id="ln-7256" name="ln-7256" href="#ln-7256"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_pleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_pleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_proot2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_proot2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_pwood2cwd</span><span class="w"></span>
<a id="ln-7257" name="ln-7257" href="#ln-7257"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_cgpp</span><span class="p">,</span><span class="w">      </span><span class="n">avg_cnpp</span><span class="p">,</span><span class="w">      </span><span class="n">avg_nuptake</span><span class="p">,</span><span class="w">   </span><span class="n">avg_puptake</span><span class="w"></span>
<a id="ln-7258" name="ln-7258" href="#ln-7258"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_nsoilmin</span><span class="p">,</span><span class="w">  </span><span class="n">avg_psoillab</span><span class="p">,</span><span class="w">  </span><span class="n">avg_psoilsorb</span><span class="p">,</span><span class="w"> </span><span class="n">avg_psoilocc</span><span class="w"></span>
<a id="ln-7259" name="ln-7259" href="#ln-7259"></a><span class="w">    </span><span class="c">!chris 12/oct/2012 for spin up casa</span>
<a id="ln-7260" name="ln-7260" href="#ln-7260"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_ratioNCsoilmic</span><span class="p">,</span><span class="w">  </span><span class="n">avg_ratioNCsoilslow</span><span class="p">,</span><span class="w">  </span><span class="n">avg_ratioNCsoilpass</span><span class="w"></span>
<a id="ln-7261" name="ln-7261" href="#ln-7261"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">r_2</span><span class="p">),</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_xnplimit</span><span class="p">,</span><span class="w">  </span><span class="n">avg_xkNlimiting</span><span class="p">,</span><span class="n">avg_xklitter</span><span class="p">,</span><span class="w"> </span><span class="n">avg_xksoil</span><span class="w"></span>
<a id="ln-7262" name="ln-7262" href="#ln-7262"></a>
<a id="ln-7263" name="ln-7263" href="#ln-7263"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_af</span><span class="w"></span>
<a id="ln-7264" name="ln-7264" href="#ln-7264"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_aw</span><span class="w"></span>
<a id="ln-7265" name="ln-7265" href="#ln-7265"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_ar</span><span class="w"></span>
<a id="ln-7266" name="ln-7266" href="#ln-7266"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_lf</span><span class="w"></span>
<a id="ln-7267" name="ln-7267" href="#ln-7267"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_lw</span><span class="w"></span>
<a id="ln-7268" name="ln-7268" href="#ln-7268"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_lr</span><span class="w"></span>
<a id="ln-7269" name="ln-7269" href="#ln-7269"></a><span class="w">  </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_annual_cnpp</span><span class="w"></span>
<a id="ln-7270" name="ln-7270" href="#ln-7270"></a>
<a id="ln-7271" name="ln-7271" href="#ln-7271"></a><span class="w">    </span><span class="c">! local variables</span>
<a id="ln-7272" name="ln-7272" href="#ln-7272"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">myearspin</span><span class="p">,</span><span class="n">nyear</span><span class="p">,</span><span class="w"> </span><span class="n">nloop1</span><span class="p">,</span><span class="w"> </span><span class="n">LOY</span><span class="w"></span>
<a id="ln-7273" name="ln-7273" href="#ln-7273"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">ncfile</span><span class="w"></span>
<a id="ln-7274" name="ln-7274" href="#ln-7274"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">cyear</span><span class="w"></span>
<a id="ln-7275" name="ln-7275" href="#ln-7275"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="n">ktauday</span><span class="p">,</span><span class="n">nday</span><span class="p">,</span><span class="n">idoy</span><span class="p">,</span><span class="n">ktaux</span><span class="p">,</span><span class="n">ktauy</span><span class="p">,</span><span class="n">nloop</span><span class="w"></span>
<a id="ln-7276" name="ln-7276" href="#ln-7276"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">ndays</span><span class="w"></span>
<a id="ln-7277" name="ln-7277" href="#ln-7277"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">cleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">cleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">croot2met</span><span class="p">,</span><span class="w"> </span><span class="n">croot2str</span><span class="p">,</span><span class="w"> </span><span class="n">cwood2cwd</span><span class="w"></span>
<a id="ln-7278" name="ln-7278" href="#ln-7278"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">nleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">nleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">nroot2met</span><span class="p">,</span><span class="w"> </span><span class="n">nroot2str</span><span class="p">,</span><span class="w"> </span><span class="n">nwood2cwd</span><span class="w"></span>
<a id="ln-7279" name="ln-7279" href="#ln-7279"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">pleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">pleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">proot2met</span><span class="p">,</span><span class="w"> </span><span class="n">proot2str</span><span class="p">,</span><span class="w"> </span><span class="n">pwood2cwd</span><span class="w"></span>
<a id="ln-7280" name="ln-7280" href="#ln-7280"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">xcgpp</span><span class="p">,</span><span class="w">     </span><span class="n">xcnpp</span><span class="p">,</span><span class="w">     </span><span class="n">xnuptake</span><span class="p">,</span><span class="w">  </span><span class="n">xpuptake</span><span class="w"></span>
<a id="ln-7281" name="ln-7281" href="#ln-7281"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">xnsoilmin</span><span class="p">,</span><span class="w"> </span><span class="n">xpsoillab</span><span class="p">,</span><span class="w"> </span><span class="n">xpsoilsorb</span><span class="p">,</span><span class="n">xpsoilocc</span><span class="w"></span>
<a id="ln-7282" name="ln-7282" href="#ln-7282"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">r_2</span><span class="p">),</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">xnplimit</span><span class="p">,</span><span class="w">  </span><span class="n">xkNlimiting</span><span class="p">,</span><span class="w"> </span><span class="n">xklitter</span><span class="p">,</span><span class="w"> </span><span class="n">xksoil</span><span class="p">,</span><span class="n">xkleaf</span><span class="p">,</span><span class="w"> </span><span class="n">xkleafcold</span><span class="p">,</span><span class="w"> </span><span class="n">xkleafdry</span><span class="w"></span>
<a id="ln-7283" name="ln-7283" href="#ln-7283"></a>
<a id="ln-7284" name="ln-7284" href="#ln-7284"></a><span class="w">    </span><span class="c">! more variables to store the spinup pool size over the last 10 loops. Added by Yp Wang 30 Nov 2012</span>
<a id="ln-7285" name="ln-7285" href="#ln-7285"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">mvtype</span><span class="p">,</span><span class="n">mplant</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">bmcplant</span><span class="p">,</span><span class="w">  </span><span class="n">bmnplant</span><span class="p">,</span><span class="w">  </span><span class="n">bmpplant</span><span class="w"></span>
<a id="ln-7286" name="ln-7286" href="#ln-7286"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">mvtype</span><span class="p">,</span><span class="n">mlitter</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bmclitter</span><span class="p">,</span><span class="w"> </span><span class="n">bmnlitter</span><span class="p">,</span><span class="w"> </span><span class="n">bmplitter</span><span class="w"></span>
<a id="ln-7287" name="ln-7287" href="#ln-7287"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">mvtype</span><span class="p">,</span><span class="n">msoil</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">bmcsoil</span><span class="p">,</span><span class="w">   </span><span class="n">bmnsoil</span><span class="p">,</span><span class="w">   </span><span class="n">bmpsoil</span><span class="w"></span>
<a id="ln-7288" name="ln-7288" href="#ln-7288"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">mvtype</span><span class="p">)</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">bmnsoilmin</span><span class="p">,</span><span class="n">bmpsoillab</span><span class="p">,</span><span class="n">bmpsoilsorb</span><span class="p">,</span><span class="w"> </span><span class="n">bmpsoilocc</span><span class="w"></span>
<a id="ln-7289" name="ln-7289" href="#ln-7289"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mvtype</span><span class="p">)</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">bmarea</span><span class="w"></span>
<a id="ln-7290" name="ln-7290" href="#ln-7290"></a><span class="w">    </span><span class="kt">INTEGER </span><span class="n">nptx</span><span class="p">,</span><span class="n">nvt</span><span class="p">,</span><span class="n">kloop</span><span class="w"></span>
<a id="ln-7291" name="ln-7291" href="#ln-7291"></a>
<a id="ln-7292" name="ln-7292" href="#ln-7292"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w">                               </span><span class="kd">::</span><span class="w"> </span><span class="n">StemNPP</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-7293" name="ln-7293" href="#ln-7293"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Iw</span><span class="p">(:)</span><span class="w"> </span><span class="c">! array of indices corresponding to woody (shrub or forest) tiles</span>
<a id="ln-7294" name="ln-7294" href="#ln-7294"></a>
<a id="ln-7295" name="ln-7295" href="#ln-7295"></a>
<a id="ln-7296" name="ln-7296" href="#ln-7296"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">stat</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">)</span><span class="w"></span>
<a id="ln-7297" name="ln-7297" href="#ln-7297"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<a id="ln-7298" name="ln-7298" href="#ln-7298"></a>
<a id="ln-7299" name="ln-7299" href="#ln-7299"></a>
<a id="ln-7300" name="ln-7300" href="#ln-7300"></a>
<a id="ln-7301" name="ln-7301" href="#ln-7301"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">Iw</span><span class="p">))</span><span class="w"> </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Iw</span><span class="p">(</span><span class="n">POP</span><span class="p">%</span><span class="n">np</span><span class="p">))</span><span class="w"></span>
<a id="ln-7302" name="ln-7302" href="#ln-7302"></a>
<a id="ln-7303" name="ln-7303" href="#ln-7303"></a>
<a id="ln-7304" name="ln-7304" href="#ln-7304"></a><span class="w">    </span><span class="c">!! vh_js !!</span>
<a id="ln-7305" name="ln-7305" href="#ln-7305"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_POP</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7306" name="ln-7306" href="#ln-7306"></a>
<a id="ln-7307" name="ln-7307" href="#ln-7307"></a><span class="k">       </span><span class="n">Iw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">Iwood</span><span class="w"></span>
<a id="ln-7308" name="ln-7308" href="#ln-7308"></a>
<a id="ln-7309" name="ln-7309" href="#ln-7309"></a><span class="w">    </span><span class="k">ENDIF</span>
<a id="ln-7310" name="ln-7310" href="#ln-7310"></a>
<a id="ln-7311" name="ln-7311" href="#ln-7311"></a><span class="k">    </span><span class="n">ktauday</span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="mi">2</span><span class="mf">4.0</span><span class="o">*</span><span class="mi">360</span><span class="mf">0.0</span><span class="o">/</span><span class="n">dels</span><span class="p">)</span><span class="w"></span>
<a id="ln-7312" name="ln-7312" href="#ln-7312"></a><span class="w">    </span><span class="n">nday</span><span class="o">=</span><span class="p">(</span><span class="n">kend</span><span class="o">-</span><span class="n">kstart</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">ktauday</span><span class="w"></span>
<a id="ln-7313" name="ln-7313" href="#ln-7313"></a><span class="w">    </span><span class="n">LOY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">365</span><span class="w"></span>
<a id="ln-7314" name="ln-7314" href="#ln-7314"></a><span class="w">    </span><span class="c">!chris 12/oct/2012 for spin up casa</span>
<a id="ln-7315" name="ln-7315" href="#ln-7315"></a><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">avg_cleaf2met</span><span class="p">)))</span><span class="w">  </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">avg_cleaf2met</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_cleaf2str</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_croot2met</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_croot2str</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7316" name="ln-7316" href="#ln-7316"></a><span class="w">         </span><span class="n">avg_cwood2cwd</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7317" name="ln-7317" href="#ln-7317"></a><span class="w">         </span><span class="n">avg_nleaf2met</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_nleaf2str</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_nroot2met</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_nroot2str</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_nwood2cwd</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7318" name="ln-7318" href="#ln-7318"></a><span class="w">         </span><span class="n">avg_pleaf2met</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_pleaf2str</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_proot2met</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_proot2str</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_pwood2cwd</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7319" name="ln-7319" href="#ln-7319"></a><span class="w">         </span><span class="n">avg_cgpp</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w">      </span><span class="n">avg_cnpp</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w">      </span><span class="n">avg_nuptake</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w">   </span><span class="n">avg_puptake</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7320" name="ln-7320" href="#ln-7320"></a><span class="w">         </span><span class="n">avg_xnplimit</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w">  </span><span class="n">avg_xkNlimiting</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_xklitter</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_xksoil</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7321" name="ln-7321" href="#ln-7321"></a><span class="w">         </span><span class="n">avg_rationcsoilmic</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="n">avg_rationcsoilslow</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="n">avg_rationcsoilpass</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w">                        </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7322" name="ln-7322" href="#ln-7322"></a><span class="w">         </span><span class="n">avg_nsoilmin</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w">  </span><span class="n">avg_psoillab</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w">    </span><span class="n">avg_psoilsorb</span><span class="p">(</span><span class="n">mp</span><span class="p">),</span><span class="w"> </span><span class="n">avg_psoilocc</span><span class="p">(</span><span class="n">mp</span><span class="p">))</span><span class="w"></span>
<a id="ln-7323" name="ln-7323" href="#ln-7323"></a>
<a id="ln-7324" name="ln-7324" href="#ln-7324"></a><span class="w">  </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">avg_af</span><span class="p">(</span><span class="n">mp</span><span class="p">))</span><span class="w"></span>
<a id="ln-7325" name="ln-7325" href="#ln-7325"></a><span class="w">  </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">avg_aw</span><span class="p">(</span><span class="n">mp</span><span class="p">))</span><span class="w"></span>
<a id="ln-7326" name="ln-7326" href="#ln-7326"></a><span class="w">  </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">avg_ar</span><span class="p">(</span><span class="n">mp</span><span class="p">))</span><span class="w"></span>
<a id="ln-7327" name="ln-7327" href="#ln-7327"></a><span class="w">  </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">avg_lf</span><span class="p">(</span><span class="n">mp</span><span class="p">))</span><span class="w"></span>
<a id="ln-7328" name="ln-7328" href="#ln-7328"></a><span class="w">  </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">avg_lw</span><span class="p">(</span><span class="n">mp</span><span class="p">))</span><span class="w"></span>
<a id="ln-7329" name="ln-7329" href="#ln-7329"></a><span class="w">  </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">avg_lr</span><span class="p">(</span><span class="n">mp</span><span class="p">))</span><span class="w"></span>
<a id="ln-7330" name="ln-7330" href="#ln-7330"></a><span class="w">  </span><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">avg_annual_cnpp</span><span class="p">(</span><span class="n">mp</span><span class="p">))</span><span class="w"></span>
<a id="ln-7331" name="ln-7331" href="#ln-7331"></a><span class="w">  </span><span class="n">avg_af</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7332" name="ln-7332" href="#ln-7332"></a><span class="w">  </span><span class="n">avg_aw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7333" name="ln-7333" href="#ln-7333"></a><span class="w">  </span><span class="n">avg_ar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7334" name="ln-7334" href="#ln-7334"></a><span class="w">  </span><span class="n">avg_lf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7335" name="ln-7335" href="#ln-7335"></a><span class="w">  </span><span class="n">avg_lw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7336" name="ln-7336" href="#ln-7336"></a><span class="w">  </span><span class="n">avg_lr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7337" name="ln-7337" href="#ln-7337"></a><span class="w">  </span><span class="n">avg_annual_cnpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7338" name="ln-7338" href="#ln-7338"></a>
<a id="ln-7339" name="ln-7339" href="#ln-7339"></a><span class="w">    </span><span class="n">myearspin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_SPIN_ENDYEAR</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CASA_SPIN_STARTYEAR</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7340" name="ln-7340" href="#ln-7340"></a><span class="w">    </span><span class="c">! compute the mean fluxes and residence time of each carbon pool</span>
<a id="ln-7341" name="ln-7341" href="#ln-7341"></a><span class="w">    </span><span class="n">avg_cleaf2met</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_cleaf2str</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_croot2met</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_croot2str</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_cwood2cwd</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7342" name="ln-7342" href="#ln-7342"></a><span class="w">    </span><span class="n">avg_nleaf2met</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_nleaf2str</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_nroot2met</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_nroot2str</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_nwood2cwd</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7343" name="ln-7343" href="#ln-7343"></a><span class="w">    </span><span class="n">avg_pleaf2met</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_pleaf2str</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_proot2met</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_proot2str</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_pwood2cwd</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7344" name="ln-7344" href="#ln-7344"></a><span class="w">    </span><span class="n">avg_cgpp</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w">      </span><span class="n">avg_cnpp</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w">      </span><span class="n">avg_nuptake</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w">   </span><span class="n">avg_puptake</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7345" name="ln-7345" href="#ln-7345"></a><span class="w">    </span><span class="n">avg_xnplimit</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w">  </span><span class="n">avg_xkNlimiting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_xklitter</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_xksoil</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7346" name="ln-7346" href="#ln-7346"></a><span class="w">    </span><span class="n">avg_nsoilmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w">  </span><span class="n">avg_psoillab</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w">    </span><span class="n">avg_psoilsorb</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="n">avg_psoilocc</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7347" name="ln-7347" href="#ln-7347"></a><span class="w">    </span><span class="n">avg_rationcsoilmic</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="n">avg_rationcsoilslow</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span><span class="n">avg_rationcsoilpass</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7348" name="ln-7348" href="#ln-7348"></a>
<a id="ln-7349" name="ln-7349" href="#ln-7349"></a><span class="w">    </span><span class="k">DO </span><span class="n">nyear</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">myearspin</span><span class="w"></span>
<a id="ln-7350" name="ln-7350" href="#ln-7350"></a>
<a id="ln-7351" name="ln-7351" href="#ln-7351"></a><span class="w">       </span><span class="c">! WRITE(CYEAR,FMT=&quot;(I4)&quot;) CABLE_USER%CASA_SPIN_STARTYEAR + nyear - 1</span>
<a id="ln-7352" name="ln-7352" href="#ln-7352"></a><span class="w">       </span><span class="c">! ncfile = TRIM(casafile%c2cdumppath)//&#39;c2c_&#39;//CYEAR//&#39;_dump.nc&#39;</span>
<a id="ln-7353" name="ln-7353" href="#ln-7353"></a>
<a id="ln-7354" name="ln-7354" href="#ln-7354"></a><span class="w">       </span><span class="c">!call read_casa_dump( ncfile,casamet, casaflux, phen,climate, ktau ,kend,.TRUE. )</span>
<a id="ln-7355" name="ln-7355" href="#ln-7355"></a>
<a id="ln-7356" name="ln-7356" href="#ln-7356"></a>
<a id="ln-7357" name="ln-7357" href="#ln-7357"></a><span class="w">       </span><span class="k">DO </span><span class="n">idoy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mdyear</span><span class="w"></span>
<a id="ln-7358" name="ln-7358" href="#ln-7358"></a><span class="w">          </span><span class="n">ktau</span><span class="o">=</span><span class="p">(</span><span class="n">idoy</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ktauday</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<a id="ln-7359" name="ln-7359" href="#ln-7359"></a><span class="w">          </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_dump_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">idoy</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7360" name="ln-7360" href="#ln-7360"></a><span class="w">          </span><span class="k">CALL </span><span class="n">biogeochem</span><span class="p">(</span><span class="n">ktau</span><span class="p">,</span><span class="n">dels</span><span class="p">,</span><span class="n">idoy</span><span class="p">,</span><span class="n">LALLOC</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7361" name="ln-7361" href="#ln-7361"></a><span class="w">               </span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="n">xnplimit</span><span class="p">,</span><span class="n">xkNlimiting</span><span class="p">,</span><span class="n">xklitter</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7362" name="ln-7362" href="#ln-7362"></a><span class="w">               </span><span class="n">xksoil</span><span class="p">,</span><span class="n">xkleaf</span><span class="p">,</span><span class="n">xkleafcold</span><span class="p">,</span><span class="n">xkleafdry</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-7363" name="ln-7363" href="#ln-7363"></a><span class="w">               </span><span class="n">cleaf2met</span><span class="p">,</span><span class="n">cleaf2str</span><span class="p">,</span><span class="n">croot2met</span><span class="p">,</span><span class="n">croot2str</span><span class="p">,</span><span class="n">cwood2cwd</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7364" name="ln-7364" href="#ln-7364"></a><span class="w">               </span><span class="n">nleaf2met</span><span class="p">,</span><span class="n">nleaf2str</span><span class="p">,</span><span class="n">nroot2met</span><span class="p">,</span><span class="n">nroot2str</span><span class="p">,</span><span class="n">nwood2cwd</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7365" name="ln-7365" href="#ln-7365"></a><span class="w">               </span><span class="n">pleaf2met</span><span class="p">,</span><span class="n">pleaf2str</span><span class="p">,</span><span class="n">proot2met</span><span class="p">,</span><span class="n">proot2str</span><span class="p">,</span><span class="n">pwood2cwd</span><span class="p">)</span><span class="w"></span>
<a id="ln-7366" name="ln-7366" href="#ln-7366"></a>
<a id="ln-7367" name="ln-7367" href="#ln-7367"></a><span class="w">          </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_POP</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">np</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="c">! CALL_POP</span>
<a id="ln-7368" name="ln-7368" href="#ln-7368"></a><span class="c">!!$           ! accumulate annual variables for use in POP</span>
<a id="ln-7369" name="ln-7369" href="#ln-7369"></a><span class="w">             </span><span class="k">IF</span><span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">ktau</span><span class="o">/</span><span class="n">ktauday</span><span class="p">,</span><span class="n">LOY</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7370" name="ln-7370" href="#ln-7370"></a><span class="k">                </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">casaflux</span><span class="p">%</span><span class="n">cnpp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.7</span><span class="w"> </span><span class="c">! (assumes 70% of wood NPP is allocated above ground)</span>
<a id="ln-7371" name="ln-7371" href="#ln-7371"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">LAImax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casamet</span><span class="p">%</span><span class="n">glai</span><span class="w"></span>
<a id="ln-7372" name="ln-7372" href="#ln-7372"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">Cleafmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7373" name="ln-7373" href="#ln-7373"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">Crootmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7374" name="ln-7374" href="#ln-7374"></a><span class="w">             </span><span class="k">ELSE</span>
<a id="ln-7375" name="ln-7375" href="#ln-7375"></a><span class="k">                </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">cnpp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.7</span><span class="w"></span>
<a id="ln-7376" name="ln-7376" href="#ln-7376"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">LAImax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">glai</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">%</span><span class="n">LAImax</span><span class="p">)</span><span class="w"></span>
<a id="ln-7377" name="ln-7377" href="#ln-7377"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">Cleafmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casabal</span><span class="p">%</span><span class="n">Cleafmean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7378" name="ln-7378" href="#ln-7378"></a><span class="w">                </span><span class="n">casabal</span><span class="p">%</span><span class="n">Crootmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casabal</span><span class="p">%</span><span class="n">Crootmean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7379" name="ln-7379" href="#ln-7379"></a><span class="w">             </span><span class="k">ENDIF</span>
<a id="ln-7380" name="ln-7380" href="#ln-7380"></a>
<a id="ln-7381" name="ln-7381" href="#ln-7381"></a><span class="k">             IF</span><span class="p">(</span><span class="n">idoy</span><span class="o">==</span><span class="n">mdyear</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="c">! end of year</span>
<a id="ln-7382" name="ln-7382" href="#ln-7382"></a>
<a id="ln-7383" name="ln-7383" href="#ln-7383"></a>
<a id="ln-7384" name="ln-7384" href="#ln-7384"></a><span class="w">                </span><span class="k">CALL </span><span class="n">POPdriver</span><span class="p">(</span><span class="n">casaflux</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">POP</span><span class="p">)</span><span class="w"></span>
<a id="ln-7385" name="ln-7385" href="#ln-7385"></a>
<a id="ln-7386" name="ln-7386" href="#ln-7386"></a>
<a id="ln-7387" name="ln-7387" href="#ln-7387"></a><span class="w">             </span><span class="k">ENDIF</span><span class="w">  </span><span class="c">! end of year</span>
<a id="ln-7388" name="ln-7388" href="#ln-7388"></a><span class="w">          </span><span class="k">ELSE</span>
<a id="ln-7389" name="ln-7389" href="#ln-7389"></a><span class="k">             </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7390" name="ln-7390" href="#ln-7390"></a><span class="w">          </span><span class="k">ENDIF</span><span class="w"> </span><span class="c">! CALL_POP</span>
<a id="ln-7391" name="ln-7391" href="#ln-7391"></a>
<a id="ln-7392" name="ln-7392" href="#ln-7392"></a>
<a id="ln-7393" name="ln-7393" href="#ln-7393"></a>
<a id="ln-7394" name="ln-7394" href="#ln-7394"></a><span class="w">          </span><span class="c">! WHERE(xkNlimiting .eq. 0)  !Chris Lu 4/June/2012</span>
<a id="ln-7395" name="ln-7395" href="#ln-7395"></a><span class="w">          </span><span class="c">!    xkNlimiting = 0.001</span>
<a id="ln-7396" name="ln-7396" href="#ln-7396"></a><span class="w">          </span><span class="c">! END WHERE</span>
<a id="ln-7397" name="ln-7397" href="#ln-7397"></a>
<a id="ln-7398" name="ln-7398" href="#ln-7398"></a><span class="w">        </span><span class="c">! Calculate average allocation fractions  (-) for the plant pools</span>
<a id="ln-7399" name="ln-7399" href="#ln-7399"></a><span class="w">        </span><span class="n">avg_af</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_af</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">(:,</span><span class="n">leaf</span><span class="p">)</span><span class="w"></span>
<a id="ln-7400" name="ln-7400" href="#ln-7400"></a><span class="w">        </span><span class="n">avg_aw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_aw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">(:,</span><span class="n">wood</span><span class="p">)</span><span class="w"></span>
<a id="ln-7401" name="ln-7401" href="#ln-7401"></a><span class="w">        </span><span class="n">avg_ar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_ar</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">(:,</span><span class="n">froot</span><span class="p">)</span><span class="w"></span>
<a id="ln-7402" name="ln-7402" href="#ln-7402"></a>
<a id="ln-7403" name="ln-7403" href="#ln-7403"></a><span class="w">        </span><span class="c">! Calculate average turnover rates for the plant pools (yr-1)</span>
<a id="ln-7404" name="ln-7404" href="#ln-7404"></a><span class="w">        </span><span class="n">avg_lf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_lf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">kplant</span><span class="p">(:,</span><span class="n">leaf</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">))</span><span class="w"></span>
<a id="ln-7405" name="ln-7405" href="#ln-7405"></a><span class="w">        </span><span class="n">avg_lw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_lw</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">kplant</span><span class="p">(:,</span><span class="n">wood</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">))</span><span class="w"></span>
<a id="ln-7406" name="ln-7406" href="#ln-7406"></a><span class="w">        </span><span class="n">avg_lr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_lr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">casaflux</span><span class="p">%</span><span class="n">kplant</span><span class="p">(:,</span><span class="n">froot</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">))</span><span class="w"></span>
<a id="ln-7407" name="ln-7407" href="#ln-7407"></a>
<a id="ln-7408" name="ln-7408" href="#ln-7408"></a><span class="w">          </span><span class="n">avg_cleaf2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cleaf2met</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cleaf2met</span><span class="w"></span>
<a id="ln-7409" name="ln-7409" href="#ln-7409"></a><span class="w">          </span><span class="n">avg_cleaf2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cleaf2str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cleaf2str</span><span class="w"></span>
<a id="ln-7410" name="ln-7410" href="#ln-7410"></a><span class="w">          </span><span class="n">avg_croot2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_croot2met</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">croot2met</span><span class="w"></span>
<a id="ln-7411" name="ln-7411" href="#ln-7411"></a><span class="w">          </span><span class="n">avg_croot2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_croot2str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">croot2str</span><span class="w"></span>
<a id="ln-7412" name="ln-7412" href="#ln-7412"></a><span class="w">          </span><span class="n">avg_cwood2cwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cwood2cwd</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cwood2cwd</span><span class="w"></span>
<a id="ln-7413" name="ln-7413" href="#ln-7413"></a>
<a id="ln-7414" name="ln-7414" href="#ln-7414"></a><span class="w">          </span><span class="n">avg_nleaf2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nleaf2met</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nleaf2met</span><span class="w"></span>
<a id="ln-7415" name="ln-7415" href="#ln-7415"></a><span class="w">          </span><span class="n">avg_nleaf2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nleaf2str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nleaf2str</span><span class="w"></span>
<a id="ln-7416" name="ln-7416" href="#ln-7416"></a><span class="w">          </span><span class="n">avg_nroot2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nroot2met</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nroot2met</span><span class="w"></span>
<a id="ln-7417" name="ln-7417" href="#ln-7417"></a><span class="w">          </span><span class="n">avg_nroot2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nroot2str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nroot2str</span><span class="w"></span>
<a id="ln-7418" name="ln-7418" href="#ln-7418"></a><span class="w">          </span><span class="n">avg_nwood2cwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nwood2cwd</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nwood2cwd</span><span class="w"></span>
<a id="ln-7419" name="ln-7419" href="#ln-7419"></a>
<a id="ln-7420" name="ln-7420" href="#ln-7420"></a><span class="w">          </span><span class="n">avg_pleaf2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_pleaf2met</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pleaf2met</span><span class="w"></span>
<a id="ln-7421" name="ln-7421" href="#ln-7421"></a><span class="w">          </span><span class="n">avg_pleaf2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_pleaf2str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pleaf2str</span><span class="w"></span>
<a id="ln-7422" name="ln-7422" href="#ln-7422"></a><span class="w">          </span><span class="n">avg_proot2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_proot2met</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">proot2met</span><span class="w"></span>
<a id="ln-7423" name="ln-7423" href="#ln-7423"></a><span class="w">          </span><span class="n">avg_proot2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_proot2str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">proot2str</span><span class="w"></span>
<a id="ln-7424" name="ln-7424" href="#ln-7424"></a><span class="w">          </span><span class="n">avg_pwood2cwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_pwood2cwd</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pwood2cwd</span><span class="w"></span>
<a id="ln-7425" name="ln-7425" href="#ln-7425"></a>
<a id="ln-7426" name="ln-7426" href="#ln-7426"></a><span class="w">          </span><span class="n">avg_cgpp</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cgpp</span><span class="w">      </span><span class="o">+</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">cgpp</span><span class="w"></span>
<a id="ln-7427" name="ln-7427" href="#ln-7427"></a><span class="w">          </span><span class="n">avg_cnpp</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cnpp</span><span class="w">      </span><span class="o">+</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">cnpp</span><span class="w"></span>
<a id="ln-7428" name="ln-7428" href="#ln-7428"></a><span class="w">          </span><span class="n">avg_nuptake</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nuptake</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">Nminuptake</span><span class="w"></span>
<a id="ln-7429" name="ln-7429" href="#ln-7429"></a><span class="w">          </span><span class="n">avg_puptake</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">avg_puptake</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">Plabuptake</span><span class="w"></span>
<a id="ln-7430" name="ln-7430" href="#ln-7430"></a>
<a id="ln-7431" name="ln-7431" href="#ln-7431"></a><span class="w">          </span><span class="n">avg_xnplimit</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">avg_xnplimit</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">xnplimit</span><span class="w"></span>
<a id="ln-7432" name="ln-7432" href="#ln-7432"></a><span class="w">          </span><span class="n">avg_xkNlimiting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_xkNlimiting</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xkNlimiting</span><span class="w"></span>
<a id="ln-7433" name="ln-7433" href="#ln-7433"></a><span class="w">          </span><span class="n">avg_xklitter</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">avg_xklitter</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">xklitter</span><span class="w"></span>
<a id="ln-7434" name="ln-7434" href="#ln-7434"></a><span class="w">          </span><span class="n">avg_xksoil</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">avg_xksoil</span><span class="w">      </span><span class="o">+</span><span class="w"> </span><span class="n">xksoil</span><span class="w"></span>
<a id="ln-7435" name="ln-7435" href="#ln-7435"></a>
<a id="ln-7436" name="ln-7436" href="#ln-7436"></a><span class="w">          </span><span class="n">avg_nsoilmin</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nsoilmin</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">nsoilmin</span><span class="w"></span>
<a id="ln-7437" name="ln-7437" href="#ln-7437"></a><span class="w">          </span><span class="n">avg_psoillab</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">avg_psoillab</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">psoillab</span><span class="w"></span>
<a id="ln-7438" name="ln-7438" href="#ln-7438"></a><span class="w">          </span><span class="n">avg_psoilsorb</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">avg_psoilsorb</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">psoilsorb</span><span class="w"></span>
<a id="ln-7439" name="ln-7439" href="#ln-7439"></a><span class="w">          </span><span class="n">avg_psoilocc</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">avg_psoilocc</span><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">psoilocc</span><span class="w"></span>
<a id="ln-7440" name="ln-7440" href="#ln-7440"></a>
<a id="ln-7441" name="ln-7441" href="#ln-7441"></a><span class="w">          </span><span class="n">avg_rationcsoilmic</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">avg_rationcsoilmic</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNCsoilnew</span><span class="p">(:,</span><span class="n">mic</span><span class="p">)</span><span class="w"></span>
<a id="ln-7442" name="ln-7442" href="#ln-7442"></a><span class="w">          </span><span class="n">avg_rationcsoilslow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_rationcsoilslow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNCsoilnew</span><span class="p">(:,</span><span class="n">slow</span><span class="p">)</span><span class="w"></span>
<a id="ln-7443" name="ln-7443" href="#ln-7443"></a><span class="w">          </span><span class="n">avg_rationcsoilpass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_rationcsoilpass</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">ratioNCsoilnew</span><span class="p">(:,</span><span class="k">pass</span><span class="p">)</span><span class="w"></span>
<a id="ln-7444" name="ln-7444" href="#ln-7444"></a><span class="w">       </span><span class="k">ENDDO</span>
<a id="ln-7445" name="ln-7445" href="#ln-7445"></a><span class="k">    ENDDO</span><span class="w"></span>
<a id="ln-7446" name="ln-7446" href="#ln-7446"></a>
<a id="ln-7447" name="ln-7447" href="#ln-7447"></a><span class="w"> </span><span class="c">! Average the plant allocation fraction</span>
<a id="ln-7448" name="ln-7448" href="#ln-7448"></a><span class="w">  </span><span class="n">avg_af</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_af</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7449" name="ln-7449" href="#ln-7449"></a><span class="w">  </span><span class="n">avg_aw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_aw</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7450" name="ln-7450" href="#ln-7450"></a><span class="w">  </span><span class="n">avg_ar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_ar</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7451" name="ln-7451" href="#ln-7451"></a>
<a id="ln-7452" name="ln-7452" href="#ln-7452"></a><span class="w">  </span><span class="c">! Average the plant turnover fraction</span>
<a id="ln-7453" name="ln-7453" href="#ln-7453"></a><span class="w">  </span><span class="n">avg_lf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_lf</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7454" name="ln-7454" href="#ln-7454"></a><span class="w">  </span><span class="n">avg_lw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_lw</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7455" name="ln-7455" href="#ln-7455"></a><span class="w">  </span><span class="n">avg_lr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_lr</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7456" name="ln-7456" href="#ln-7456"></a>
<a id="ln-7457" name="ln-7457" href="#ln-7457"></a><span class="w">  </span><span class="c">! Need the annual NPP to solve plant pools g C m-2 y-1</span>
<a id="ln-7458" name="ln-7458" href="#ln-7458"></a><span class="w">  </span><span class="n">avg_annual_cnpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cnpp</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kt">REAL</span><span class="p">(</span><span class="n">myearspin</span><span class="p">)</span><span class="w"></span>
<a id="ln-7459" name="ln-7459" href="#ln-7459"></a>
<a id="ln-7460" name="ln-7460" href="#ln-7460"></a><span class="w">  </span><span class="n">avg_cleaf2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cleaf2met</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7461" name="ln-7461" href="#ln-7461"></a><span class="w">  </span><span class="n">avg_cleaf2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cleaf2str</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7462" name="ln-7462" href="#ln-7462"></a><span class="w">  </span><span class="n">avg_croot2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_croot2met</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7463" name="ln-7463" href="#ln-7463"></a><span class="w">  </span><span class="n">avg_croot2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_croot2str</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7464" name="ln-7464" href="#ln-7464"></a><span class="w">  </span><span class="n">avg_cwood2cwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cwood2cwd</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7465" name="ln-7465" href="#ln-7465"></a>
<a id="ln-7466" name="ln-7466" href="#ln-7466"></a><span class="w">  </span><span class="n">avg_nleaf2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nleaf2met</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7467" name="ln-7467" href="#ln-7467"></a><span class="w">  </span><span class="n">avg_nleaf2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nleaf2str</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7468" name="ln-7468" href="#ln-7468"></a><span class="w">  </span><span class="n">avg_nroot2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nroot2met</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7469" name="ln-7469" href="#ln-7469"></a><span class="w">  </span><span class="n">avg_nroot2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nroot2str</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7470" name="ln-7470" href="#ln-7470"></a><span class="w">  </span><span class="n">avg_nwood2cwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nwood2cwd</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7471" name="ln-7471" href="#ln-7471"></a>
<a id="ln-7472" name="ln-7472" href="#ln-7472"></a><span class="w">  </span><span class="n">avg_pleaf2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_pleaf2met</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7473" name="ln-7473" href="#ln-7473"></a><span class="w">  </span><span class="n">avg_pleaf2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_pleaf2str</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7474" name="ln-7474" href="#ln-7474"></a><span class="w">  </span><span class="n">avg_proot2met</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_proot2met</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7475" name="ln-7475" href="#ln-7475"></a><span class="w">  </span><span class="n">avg_proot2str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_proot2str</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7476" name="ln-7476" href="#ln-7476"></a><span class="w">  </span><span class="n">avg_pwood2cwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_pwood2cwd</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7477" name="ln-7477" href="#ln-7477"></a>
<a id="ln-7478" name="ln-7478" href="#ln-7478"></a><span class="w">  </span><span class="n">avg_cgpp</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cgpp</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7479" name="ln-7479" href="#ln-7479"></a><span class="w">  </span><span class="n">avg_cnpp</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">avg_cnpp</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7480" name="ln-7480" href="#ln-7480"></a>
<a id="ln-7481" name="ln-7481" href="#ln-7481"></a><span class="w">  </span><span class="n">avg_nuptake</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nuptake</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7482" name="ln-7482" href="#ln-7482"></a><span class="w">  </span><span class="n">avg_puptake</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">avg_puptake</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7483" name="ln-7483" href="#ln-7483"></a>
<a id="ln-7484" name="ln-7484" href="#ln-7484"></a><span class="w">  </span><span class="n">avg_xnplimit</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">avg_xnplimit</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7485" name="ln-7485" href="#ln-7485"></a><span class="w">  </span><span class="n">avg_xkNlimiting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_xkNlimiting</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7486" name="ln-7486" href="#ln-7486"></a><span class="w">  </span><span class="n">avg_xklitter</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">avg_xklitter</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7487" name="ln-7487" href="#ln-7487"></a>
<a id="ln-7488" name="ln-7488" href="#ln-7488"></a><span class="w">  </span><span class="n">avg_xksoil</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">avg_xksoil</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7489" name="ln-7489" href="#ln-7489"></a>
<a id="ln-7490" name="ln-7490" href="#ln-7490"></a><span class="w">  </span><span class="n">avg_nsoilmin</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">avg_nsoilmin</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7491" name="ln-7491" href="#ln-7491"></a><span class="w">  </span><span class="n">avg_psoillab</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">avg_psoillab</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7492" name="ln-7492" href="#ln-7492"></a><span class="w">  </span><span class="n">avg_psoilsorb</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">avg_psoilsorb</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7493" name="ln-7493" href="#ln-7493"></a><span class="w">  </span><span class="n">avg_psoilocc</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">avg_psoilocc</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7494" name="ln-7494" href="#ln-7494"></a>
<a id="ln-7495" name="ln-7495" href="#ln-7495"></a><span class="w">  </span><span class="n">avg_rationcsoilmic</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">avg_rationcsoilmic</span><span class="w">  </span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7496" name="ln-7496" href="#ln-7496"></a><span class="w">  </span><span class="n">avg_rationcsoilslow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_rationcsoilslow</span><span class="w"> </span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7497" name="ln-7497" href="#ln-7497"></a><span class="w">  </span><span class="n">avg_rationcsoilpass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_rationcsoilpass</span><span class="w"> </span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">nday</span><span class="p">)</span><span class="w"></span>
<a id="ln-7498" name="ln-7498" href="#ln-7498"></a>
<a id="ln-7499" name="ln-7499" href="#ln-7499"></a><span class="w">    </span><span class="k">CALL </span><span class="n">analyticpool</span><span class="p">(</span><span class="n">kend</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="w">                                          </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7500" name="ln-7500" href="#ln-7500"></a><span class="w">         </span><span class="n">casaflux</span><span class="p">,</span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7501" name="ln-7501" href="#ln-7501"></a><span class="w">         </span><span class="n">avg_cleaf2met</span><span class="p">,</span><span class="n">avg_cleaf2str</span><span class="p">,</span><span class="n">avg_croot2met</span><span class="p">,</span><span class="n">avg_croot2str</span><span class="p">,</span><span class="n">avg_cwood2cwd</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7502" name="ln-7502" href="#ln-7502"></a><span class="w">         </span><span class="n">avg_nleaf2met</span><span class="p">,</span><span class="n">avg_nleaf2str</span><span class="p">,</span><span class="n">avg_nroot2met</span><span class="p">,</span><span class="n">avg_nroot2str</span><span class="p">,</span><span class="n">avg_nwood2cwd</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7503" name="ln-7503" href="#ln-7503"></a><span class="w">         </span><span class="n">avg_pleaf2met</span><span class="p">,</span><span class="n">avg_pleaf2str</span><span class="p">,</span><span class="n">avg_proot2met</span><span class="p">,</span><span class="n">avg_proot2str</span><span class="p">,</span><span class="n">avg_pwood2cwd</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7504" name="ln-7504" href="#ln-7504"></a><span class="w">         </span><span class="n">avg_cgpp</span><span class="p">,</span><span class="w"> </span><span class="n">avg_cnpp</span><span class="p">,</span><span class="w"> </span><span class="n">avg_nuptake</span><span class="p">,</span><span class="w"> </span><span class="n">avg_puptake</span><span class="p">,</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7505" name="ln-7505" href="#ln-7505"></a><span class="w">         </span><span class="n">avg_xnplimit</span><span class="p">,</span><span class="n">avg_xkNlimiting</span><span class="p">,</span><span class="n">avg_xklitter</span><span class="p">,</span><span class="n">avg_xksoil</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7506" name="ln-7506" href="#ln-7506"></a><span class="w">         </span><span class="n">avg_ratioNCsoilmic</span><span class="p">,</span><span class="n">avg_ratioNCsoilslow</span><span class="p">,</span><span class="n">avg_ratioNCsoilpass</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7507" name="ln-7507" href="#ln-7507"></a><span class="w">       </span><span class="n">avg_nsoilmin</span><span class="p">,</span><span class="n">avg_psoillab</span><span class="p">,</span><span class="n">avg_psoilsorb</span><span class="p">,</span><span class="n">avg_psoilocc</span><span class="p">,</span><span class="w">                  </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7508" name="ln-7508" href="#ln-7508"></a><span class="w">       </span><span class="n">avg_af</span><span class="p">,</span><span class="w"> </span><span class="n">avg_aw</span><span class="p">,</span><span class="w"> </span><span class="n">avg_ar</span><span class="p">,</span><span class="w"> </span><span class="n">avg_lf</span><span class="p">,</span><span class="w"> </span><span class="n">avg_lw</span><span class="p">,</span><span class="w"> </span><span class="n">avg_lr</span><span class="p">,</span><span class="w"> </span><span class="n">avg_annual_cnpp</span><span class="p">)</span><span class="w"></span>
<a id="ln-7509" name="ln-7509" href="#ln-7509"></a>
<a id="ln-7510" name="ln-7510" href="#ln-7510"></a>
<a id="ln-7511" name="ln-7511" href="#ln-7511"></a><span class="w">    </span><span class="n">nloop1</span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">mloop</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<a id="ln-7512" name="ln-7512" href="#ln-7512"></a>
<a id="ln-7513" name="ln-7513" href="#ln-7513"></a><span class="w">    </span><span class="k">DO </span><span class="n">nloop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mloop</span><span class="w"></span>
<a id="ln-7514" name="ln-7514" href="#ln-7514"></a>
<a id="ln-7515" name="ln-7515" href="#ln-7515"></a><span class="w">       </span><span class="c">!!CLN  OPEN(91,file=fcnpspin)</span>
<a id="ln-7516" name="ln-7516" href="#ln-7516"></a><span class="w">       </span><span class="c">!!CLN  read(91,*)</span>
<a id="ln-7517" name="ln-7517" href="#ln-7517"></a><span class="w">       </span><span class="k">DO </span><span class="n">nyear</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">myearspin</span><span class="w"></span>
<a id="ln-7518" name="ln-7518" href="#ln-7518"></a>
<a id="ln-7519" name="ln-7519" href="#ln-7519"></a><span class="w">          </span><span class="c">! WRITE(CYEAR,FMT=&quot;(I4)&quot;) CABLE_USER%CASA_SPIN_STARTYEAR + nyear - 1</span>
<a id="ln-7520" name="ln-7520" href="#ln-7520"></a><span class="w">          </span><span class="c">! ncfile = TRIM(casafile%c2cdumppath)//&#39;c2c_&#39;//CYEAR//&#39;_dump.nc&#39;</span>
<a id="ln-7521" name="ln-7521" href="#ln-7521"></a><span class="w">          </span><span class="c">! call read_casa_dump( ncfile, casamet, casaflux, phen,climate, ktau, kend, .TRUE. )</span>
<a id="ln-7522" name="ln-7522" href="#ln-7522"></a>
<a id="ln-7523" name="ln-7523" href="#ln-7523"></a><span class="w">          </span><span class="k">DO </span><span class="n">idoy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mdyear</span><span class="w"></span>
<a id="ln-7524" name="ln-7524" href="#ln-7524"></a><span class="w">             </span><span class="n">ktauy</span><span class="o">=</span><span class="n">idoy</span><span class="o">*</span><span class="n">ktauday</span><span class="w"></span>
<a id="ln-7525" name="ln-7525" href="#ln-7525"></a><span class="w">             </span><span class="n">ktau</span><span class="o">=</span><span class="p">(</span><span class="n">idoy</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ktauday</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<a id="ln-7526" name="ln-7526" href="#ln-7526"></a><span class="w">             </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_dump_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">idoy</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7527" name="ln-7527" href="#ln-7527"></a>
<a id="ln-7528" name="ln-7528" href="#ln-7528"></a><span class="w">             </span><span class="k">CALL </span><span class="n">biogeochem</span><span class="p">(</span><span class="n">ktauy</span><span class="p">,</span><span class="n">dels</span><span class="p">,</span><span class="n">idoy</span><span class="p">,</span><span class="n">LALLOC</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7529" name="ln-7529" href="#ln-7529"></a><span class="w">                  </span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="n">xnplimit</span><span class="p">,</span><span class="n">xkNlimiting</span><span class="p">,</span><span class="n">xklitter</span><span class="p">,</span><span class="n">xksoil</span><span class="p">,</span><span class="n">xkleaf</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-7530" name="ln-7530" href="#ln-7530"></a><span class="w">                  </span><span class="n">xkleafcold</span><span class="p">,</span><span class="n">xkleafdry</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-7531" name="ln-7531" href="#ln-7531"></a><span class="w">                  </span><span class="n">cleaf2met</span><span class="p">,</span><span class="n">cleaf2str</span><span class="p">,</span><span class="n">croot2met</span><span class="p">,</span><span class="n">croot2str</span><span class="p">,</span><span class="n">cwood2cwd</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7532" name="ln-7532" href="#ln-7532"></a><span class="w">                  </span><span class="n">nleaf2met</span><span class="p">,</span><span class="n">nleaf2str</span><span class="p">,</span><span class="n">nroot2met</span><span class="p">,</span><span class="n">nroot2str</span><span class="p">,</span><span class="n">nwood2cwd</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7533" name="ln-7533" href="#ln-7533"></a><span class="w">                  </span><span class="n">pleaf2met</span><span class="p">,</span><span class="n">pleaf2str</span><span class="p">,</span><span class="n">proot2met</span><span class="p">,</span><span class="n">proot2str</span><span class="p">,</span><span class="n">pwood2cwd</span><span class="p">)</span><span class="w"></span>
<a id="ln-7534" name="ln-7534" href="#ln-7534"></a>
<a id="ln-7535" name="ln-7535" href="#ln-7535"></a>
<a id="ln-7536" name="ln-7536" href="#ln-7536"></a>
<a id="ln-7537" name="ln-7537" href="#ln-7537"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_POP</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">np</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="c">! CALL_POP</span>
<a id="ln-7538" name="ln-7538" href="#ln-7538"></a>
<a id="ln-7539" name="ln-7539" href="#ln-7539"></a><span class="w">                </span><span class="c">! accumulate annual variables for use in POP</span>
<a id="ln-7540" name="ln-7540" href="#ln-7540"></a><span class="w">                </span><span class="k">IF</span><span class="p">(</span><span class="nb">MOD</span><span class="p">(</span><span class="n">ktau</span><span class="o">/</span><span class="n">ktauday</span><span class="p">,</span><span class="n">LOY</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7541" name="ln-7541" href="#ln-7541"></a><span class="k">                   </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">casaflux</span><span class="p">%</span><span class="n">cnpp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.7</span><span class="w"></span>
<a id="ln-7542" name="ln-7542" href="#ln-7542"></a><span class="w">                   </span><span class="c">! (assumes 70% of wood NPP is allocated above ground)</span>
<a id="ln-7543" name="ln-7543" href="#ln-7543"></a><span class="w">                   </span><span class="n">casabal</span><span class="p">%</span><span class="n">LAImax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casamet</span><span class="p">%</span><span class="n">glai</span><span class="w"></span>
<a id="ln-7544" name="ln-7544" href="#ln-7544"></a><span class="w">                   </span><span class="n">casabal</span><span class="p">%</span><span class="n">Cleafmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7545" name="ln-7545" href="#ln-7545"></a><span class="w">                   </span><span class="n">casabal</span><span class="p">%</span><span class="n">Crootmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7546" name="ln-7546" href="#ln-7546"></a><span class="w">                </span><span class="k">ELSE</span>
<a id="ln-7547" name="ln-7547" href="#ln-7547"></a><span class="k">                   </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">cnpp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7548" name="ln-7548" href="#ln-7548"></a><span class="w">                        </span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.7</span><span class="w"></span>
<a id="ln-7549" name="ln-7549" href="#ln-7549"></a><span class="w">                   </span><span class="n">casabal</span><span class="p">%</span><span class="n">LAImax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">glai</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">%</span><span class="n">LAImax</span><span class="p">)</span><span class="w"></span>
<a id="ln-7550" name="ln-7550" href="#ln-7550"></a><span class="w">                   </span><span class="n">casabal</span><span class="p">%</span><span class="n">Cleafmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casabal</span><span class="p">%</span><span class="n">Cleafmean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7551" name="ln-7551" href="#ln-7551"></a><span class="w">                   </span><span class="n">casabal</span><span class="p">%</span><span class="n">Crootmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casabal</span><span class="p">%</span><span class="n">Crootmean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LOY</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7552" name="ln-7552" href="#ln-7552"></a><span class="w">                </span><span class="k">ENDIF</span>
<a id="ln-7553" name="ln-7553" href="#ln-7553"></a>
<a id="ln-7554" name="ln-7554" href="#ln-7554"></a>
<a id="ln-7555" name="ln-7555" href="#ln-7555"></a><span class="k">                IF</span><span class="p">(</span><span class="n">idoy</span><span class="o">==</span><span class="n">mdyear</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="c">! end of year</span>
<a id="ln-7556" name="ln-7556" href="#ln-7556"></a>
<a id="ln-7557" name="ln-7557" href="#ln-7557"></a><span class="w">                   </span><span class="k">CALL </span><span class="n">POPdriver</span><span class="p">(</span><span class="n">casaflux</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">POP</span><span class="p">)</span><span class="w"></span>
<a id="ln-7558" name="ln-7558" href="#ln-7558"></a>
<a id="ln-7559" name="ln-7559" href="#ln-7559"></a><span class="w">                </span><span class="k">ENDIF</span><span class="w">  </span><span class="c">! end of year</span>
<a id="ln-7560" name="ln-7560" href="#ln-7560"></a><span class="w">             </span><span class="k">ELSE</span>
<a id="ln-7561" name="ln-7561" href="#ln-7561"></a><span class="k">                </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7562" name="ln-7562" href="#ln-7562"></a><span class="w">             </span><span class="k">ENDIF</span><span class="w"> </span><span class="c">! CALL_POP</span>
<a id="ln-7563" name="ln-7563" href="#ln-7563"></a>
<a id="ln-7564" name="ln-7564" href="#ln-7564"></a>
<a id="ln-7565" name="ln-7565" href="#ln-7565"></a><span class="w">          </span><span class="k">ENDDO</span><span class="w">   </span><span class="c">! end of idoy</span>
<a id="ln-7566" name="ln-7566" href="#ln-7566"></a><span class="w">       </span><span class="k">ENDDO</span><span class="w">   </span><span class="c">! end of nyear</span>
<a id="ln-7567" name="ln-7567" href="#ln-7567"></a>
<a id="ln-7568" name="ln-7568" href="#ln-7568"></a><span class="w">    </span><span class="k">ENDDO</span><span class="w">     </span><span class="c">! end of nloop</span>
<a id="ln-7569" name="ln-7569" href="#ln-7569"></a><span class="w">    </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;b4 MPI_SEND&#39;</span><span class="w"></span>
<a id="ln-7570" name="ln-7570" href="#ln-7570"></a><span class="w">    </span><span class="k">CALL </span><span class="n">MPI_Send</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7571" name="ln-7571" href="#ln-7571"></a><span class="w">    </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;after MPI_SEND&#39;</span><span class="w"></span>
<a id="ln-7572" name="ln-7572" href="#ln-7572"></a><span class="w">    </span><span class="k">IF</span><span class="p">(</span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">CALL_POP</span><span class="p">)</span><span class="w"> </span><span class="k">CALL </span><span class="n">worker_send_pop</span><span class="w"> </span><span class="p">(</span><span class="n">POP</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">)</span><span class="w"></span>
<a id="ln-7573" name="ln-7573" href="#ln-7573"></a><span class="w">    </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;cplant&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="w"></span>
<a id="ln-7574" name="ln-7574" href="#ln-7574"></a>
<a id="ln-7575" name="ln-7575" href="#ln-7575"></a><span class="w">  </span><span class="k">END SUBROUTINE </span><span class="n">worker_spincasacnp</span><span class="w"></span>
<a id="ln-7576" name="ln-7576" href="#ln-7576"></a>
<a id="ln-7577" name="ln-7577" href="#ln-7577"></a><span class="w">  </span><span class="c">!*********************************************************************************************</span>
<a id="ln-7578" name="ln-7578" href="#ln-7578"></a>
<a id="ln-7579" name="ln-7579" href="#ln-7579"></a><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">worker_CASAONLY_LUC</span><span class="p">(</span><span class="w"> </span><span class="n">dels</span><span class="p">,</span><span class="n">kstart</span><span class="p">,</span><span class="n">kend</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7580" name="ln-7580" href="#ln-7580"></a><span class="w">       </span><span class="n">casaflux</span><span class="p">,</span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="n">LALLOC</span><span class="p">,</span><span class="w">  </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-7581" name="ln-7581" href="#ln-7581"></a>
<a id="ln-7582" name="ln-7582" href="#ln-7582"></a><span class="w">    </span><span class="c">! USE cable_mpiworker</span>
<a id="ln-7583" name="ln-7583" href="#ln-7583"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_def_types_mod</span><span class="w"></span>
<a id="ln-7584" name="ln-7584" href="#ln-7584"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_carbon_module</span><span class="w"></span>
<a id="ln-7585" name="ln-7585" href="#ln-7585"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_common_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="w"></span>
<a id="ln-7586" name="ln-7586" href="#ln-7586"></a><span class="w">    </span><span class="k">USE </span><span class="n">casadimension</span><span class="w"></span>
<a id="ln-7587" name="ln-7587" href="#ln-7587"></a><span class="w">    </span><span class="k">USE </span><span class="n">casaparm</span><span class="w"></span>
<a id="ln-7588" name="ln-7588" href="#ln-7588"></a><span class="w">    </span><span class="k">USE </span><span class="n">casavariable</span><span class="w"></span>
<a id="ln-7589" name="ln-7589" href="#ln-7589"></a><span class="w">    </span><span class="k">USE </span><span class="n">phenvariable</span><span class="w"></span>
<a id="ln-7590" name="ln-7590" href="#ln-7590"></a><span class="w">    </span><span class="k">USE </span><span class="n">POP_Types</span><span class="p">,</span><span class="w">  </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">POP_TYPE</span><span class="w"></span>
<a id="ln-7591" name="ln-7591" href="#ln-7591"></a><span class="w">    </span><span class="k">USE </span><span class="n">POPMODULE</span><span class="p">,</span><span class="w">            </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">POPStep</span><span class="w"></span>
<a id="ln-7592" name="ln-7592" href="#ln-7592"></a><span class="w">    </span><span class="k">USE </span><span class="n">TypeDef</span><span class="p">,</span><span class="w">              </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">i4b</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="w"></span>
<a id="ln-7593" name="ln-7593" href="#ln-7593"></a><span class="w">    </span><span class="k">USE </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-7594" name="ln-7594" href="#ln-7594"></a>
<a id="ln-7595" name="ln-7595" href="#ln-7595"></a><span class="w">    </span><span class="c">!mrd561 debug</span>
<a id="ln-7596" name="ln-7596" href="#ln-7596"></a><span class="w">    </span><span class="k">USE </span><span class="n">cable_IO_vars_module</span><span class="p">,</span><span class="w"> </span><span class="k">ONLY</span><span class="p">:</span><span class="w"> </span><span class="n">wlogn</span><span class="w"></span>
<a id="ln-7597" name="ln-7597" href="#ln-7597"></a>
<a id="ln-7598" name="ln-7598" href="#ln-7598"></a><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<a id="ln-7599" name="ln-7599" href="#ln-7599"></a><span class="w">    </span><span class="c">!!CLN  CHARACTER(LEN=99), INTENT(IN)  :: fcnpspin</span>
<a id="ln-7600" name="ln-7600" href="#ln-7600"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">    </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">dels</span><span class="w"></span>
<a id="ln-7601" name="ln-7601" href="#ln-7601"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">kstart</span><span class="w"></span>
<a id="ln-7602" name="ln-7602" href="#ln-7602"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">kend</span><span class="w"></span>
<a id="ln-7603" name="ln-7603" href="#ln-7603"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">LALLOC</span><span class="w"></span>
<a id="ln-7604" name="ln-7604" href="#ln-7604"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">veg_parameter_type</span><span class="p">),</span><span class="w">    </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">veg</span><span class="w">  </span><span class="c">! vegetation parameters</span>
<a id="ln-7605" name="ln-7605" href="#ln-7605"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">soil_parameter_type</span><span class="p">),</span><span class="w">   </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">soil</span><span class="w"> </span><span class="c">! soil parameters</span>
<a id="ln-7606" name="ln-7606" href="#ln-7606"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_biome</span><span class="p">),</span><span class="w">            </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casabiome</span><span class="w"></span>
<a id="ln-7607" name="ln-7607" href="#ln-7607"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_pool</span><span class="p">),</span><span class="w">             </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casapool</span><span class="w"></span>
<a id="ln-7608" name="ln-7608" href="#ln-7608"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_flux</span><span class="p">),</span><span class="w">             </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casaflux</span><span class="w"></span>
<a id="ln-7609" name="ln-7609" href="#ln-7609"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_met</span><span class="p">),</span><span class="w">              </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casamet</span><span class="w"></span>
<a id="ln-7610" name="ln-7610" href="#ln-7610"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_balance</span><span class="p">),</span><span class="w">          </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">casabal</span><span class="w"></span>
<a id="ln-7611" name="ln-7611" href="#ln-7611"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">phen_variable</span><span class="p">),</span><span class="w">         </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phen</span><span class="w"></span>
<a id="ln-7612" name="ln-7612" href="#ln-7612"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">POP_TYPE</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">POP</span><span class="w"></span>
<a id="ln-7613" name="ln-7613" href="#ln-7613"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">climate_TYPE</span><span class="p">),</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">climate</span><span class="w"></span>
<a id="ln-7614" name="ln-7614" href="#ln-7614"></a>
<a id="ln-7615" name="ln-7615" href="#ln-7615"></a>
<a id="ln-7616" name="ln-7616" href="#ln-7616"></a>
<a id="ln-7617" name="ln-7617" href="#ln-7617"></a><span class="w">    </span><span class="c">! communicator for error-messages</span>
<a id="ln-7618" name="ln-7618" href="#ln-7618"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="w"></span>
<a id="ln-7619" name="ln-7619" href="#ln-7619"></a><span class="w">    </span><span class="k">TYPE</span><span class="w"> </span><span class="p">(</span><span class="n">casa_met</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">casaspin</span><span class="w"></span>
<a id="ln-7620" name="ln-7620" href="#ln-7620"></a>
<a id="ln-7621" name="ln-7621" href="#ln-7621"></a><span class="w">    </span><span class="c">! local variables</span>
<a id="ln-7622" name="ln-7622" href="#ln-7622"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_cleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_cleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_croot2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_croot2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_cwood2cwd</span><span class="w"></span>
<a id="ln-7623" name="ln-7623" href="#ln-7623"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_nleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_nleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_nroot2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_nroot2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_nwood2cwd</span><span class="w"></span>
<a id="ln-7624" name="ln-7624" href="#ln-7624"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_pleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_pleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_proot2met</span><span class="p">,</span><span class="w"> </span><span class="n">avg_proot2str</span><span class="p">,</span><span class="w"> </span><span class="n">avg_pwood2cwd</span><span class="w"></span>
<a id="ln-7625" name="ln-7625" href="#ln-7625"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_cgpp</span><span class="p">,</span><span class="w">      </span><span class="n">avg_cnpp</span><span class="p">,</span><span class="w">      </span><span class="n">avg_nuptake</span><span class="p">,</span><span class="w">   </span><span class="n">avg_puptake</span><span class="w"></span>
<a id="ln-7626" name="ln-7626" href="#ln-7626"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_nsoilmin</span><span class="p">,</span><span class="w">  </span><span class="n">avg_psoillab</span><span class="p">,</span><span class="w">  </span><span class="n">avg_psoilsorb</span><span class="p">,</span><span class="w"> </span><span class="n">avg_psoilocc</span><span class="w"></span>
<a id="ln-7627" name="ln-7627" href="#ln-7627"></a><span class="w">    </span><span class="c">!chris 12/oct/2012 for spin up casa</span>
<a id="ln-7628" name="ln-7628" href="#ln-7628"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_ratioNCsoilmic</span><span class="p">,</span><span class="w">  </span><span class="n">avg_ratioNCsoilslow</span><span class="p">,</span><span class="w">  </span><span class="n">avg_ratioNCsoilpass</span><span class="w"></span>
<a id="ln-7629" name="ln-7629" href="#ln-7629"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">r_2</span><span class="p">),</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(:),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">avg_xnplimit</span><span class="p">,</span><span class="w">  </span><span class="n">avg_xkNlimiting</span><span class="p">,</span><span class="n">avg_xklitter</span><span class="p">,</span><span class="w"> </span><span class="n">avg_xksoil</span><span class="w"></span>
<a id="ln-7630" name="ln-7630" href="#ln-7630"></a>
<a id="ln-7631" name="ln-7631" href="#ln-7631"></a><span class="w">    </span><span class="c">! local variables</span>
<a id="ln-7632" name="ln-7632" href="#ln-7632"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">myearspin</span><span class="p">,</span><span class="n">nyear</span><span class="p">,</span><span class="w"> </span><span class="n">nloop1</span><span class="w"></span>
<a id="ln-7633" name="ln-7633" href="#ln-7633"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">ncfile</span><span class="w"></span>
<a id="ln-7634" name="ln-7634" href="#ln-7634"></a><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">cyear</span><span class="w"></span>
<a id="ln-7635" name="ln-7635" href="#ln-7635"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w">                  </span><span class="kd">::</span><span class="w"> </span><span class="n">ktau</span><span class="p">,</span><span class="n">ktauday</span><span class="p">,</span><span class="n">nday</span><span class="p">,</span><span class="n">idoy</span><span class="p">,</span><span class="n">ktaux</span><span class="p">,</span><span class="n">ktauy</span><span class="p">,</span><span class="n">nloop</span><span class="w"></span>
<a id="ln-7636" name="ln-7636" href="#ln-7636"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">SAVE</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">ndays</span><span class="w"></span>
<a id="ln-7637" name="ln-7637" href="#ln-7637"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">cleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">cleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">croot2met</span><span class="p">,</span><span class="w"> </span><span class="n">croot2str</span><span class="p">,</span><span class="w"> </span><span class="n">cwood2cwd</span><span class="w"></span>
<a id="ln-7638" name="ln-7638" href="#ln-7638"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">nleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">nleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">nroot2met</span><span class="p">,</span><span class="w"> </span><span class="n">nroot2str</span><span class="p">,</span><span class="w"> </span><span class="n">nwood2cwd</span><span class="w"></span>
<a id="ln-7639" name="ln-7639" href="#ln-7639"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">pleaf2met</span><span class="p">,</span><span class="w"> </span><span class="n">pleaf2str</span><span class="p">,</span><span class="w"> </span><span class="n">proot2met</span><span class="p">,</span><span class="w"> </span><span class="n">proot2str</span><span class="p">,</span><span class="w"> </span><span class="n">pwood2cwd</span><span class="w"></span>
<a id="ln-7640" name="ln-7640" href="#ln-7640"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">xcgpp</span><span class="p">,</span><span class="w">     </span><span class="n">xcnpp</span><span class="p">,</span><span class="w">     </span><span class="n">xnuptake</span><span class="p">,</span><span class="w">  </span><span class="n">xpuptake</span><span class="w"></span>
<a id="ln-7641" name="ln-7641" href="#ln-7641"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">xnsoilmin</span><span class="p">,</span><span class="w"> </span><span class="n">xpsoillab</span><span class="p">,</span><span class="w"> </span><span class="n">xpsoilsorb</span><span class="p">,</span><span class="n">xpsoilocc</span><span class="w"></span>
<a id="ln-7642" name="ln-7642" href="#ln-7642"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">r_2</span><span class="p">),</span><span class="w"> </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">xnplimit</span><span class="p">,</span><span class="w">  </span><span class="n">xkNlimiting</span><span class="p">,</span><span class="w"> </span><span class="n">xklitter</span><span class="p">,</span><span class="w"> </span><span class="n">xksoil</span><span class="p">,</span><span class="n">xkleaf</span><span class="p">,</span><span class="w"> </span><span class="n">xkleafcold</span><span class="p">,</span><span class="w"> </span><span class="n">xkleafdry</span><span class="w"></span>
<a id="ln-7643" name="ln-7643" href="#ln-7643"></a>
<a id="ln-7644" name="ln-7644" href="#ln-7644"></a><span class="w">    </span><span class="c">! more variables to store the spinup pool size over the last 10 loops. Added by Yp Wang 30 Nov 2012</span>
<a id="ln-7645" name="ln-7645" href="#ln-7645"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">mvtype</span><span class="p">,</span><span class="n">mplant</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">bmcplant</span><span class="p">,</span><span class="w">  </span><span class="n">bmnplant</span><span class="p">,</span><span class="w">  </span><span class="n">bmpplant</span><span class="w"></span>
<a id="ln-7646" name="ln-7646" href="#ln-7646"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">mvtype</span><span class="p">,</span><span class="n">mlitter</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bmclitter</span><span class="p">,</span><span class="w"> </span><span class="n">bmnlitter</span><span class="p">,</span><span class="w"> </span><span class="n">bmplitter</span><span class="w"></span>
<a id="ln-7647" name="ln-7647" href="#ln-7647"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">mvtype</span><span class="p">,</span><span class="n">msoil</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">bmcsoil</span><span class="p">,</span><span class="w">   </span><span class="n">bmnsoil</span><span class="p">,</span><span class="w">   </span><span class="n">bmpsoil</span><span class="w"></span>
<a id="ln-7648" name="ln-7648" href="#ln-7648"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">mvtype</span><span class="p">)</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">bmnsoilmin</span><span class="p">,</span><span class="n">bmpsoillab</span><span class="p">,</span><span class="n">bmpsoilsorb</span><span class="p">,</span><span class="w"> </span><span class="n">bmpsoilocc</span><span class="w"></span>
<a id="ln-7649" name="ln-7649" href="#ln-7649"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">,</span><span class="w">      </span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">mvtype</span><span class="p">)</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">bmarea</span><span class="w"></span>
<a id="ln-7650" name="ln-7650" href="#ln-7650"></a><span class="w">    </span><span class="kt">INTEGER </span><span class="n">nptx</span><span class="p">,</span><span class="n">nvt</span><span class="p">,</span><span class="n">kloop</span><span class="w"></span>
<a id="ln-7651" name="ln-7651" href="#ln-7651"></a>
<a id="ln-7652" name="ln-7652" href="#ln-7652"></a><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w">                               </span><span class="kd">::</span><span class="w"> </span><span class="n">StemNPP</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-7653" name="ln-7653" href="#ln-7653"></a>
<a id="ln-7654" name="ln-7654" href="#ln-7654"></a>
<a id="ln-7655" name="ln-7655" href="#ln-7655"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">stat</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">)</span><span class="w"></span>
<a id="ln-7656" name="ln-7656" href="#ln-7656"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="w"></span>
<a id="ln-7657" name="ln-7657" href="#ln-7657"></a><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">yyyy</span><span class="w"></span>
<a id="ln-7658" name="ln-7658" href="#ln-7658"></a>
<a id="ln-7659" name="ln-7659" href="#ln-7659"></a>
<a id="ln-7660" name="ln-7660" href="#ln-7660"></a>
<a id="ln-7661" name="ln-7661" href="#ln-7661"></a><span class="w">    </span><span class="n">ktauday</span><span class="o">=</span><span class="nb">INT</span><span class="p">(</span><span class="mi">2</span><span class="mf">4.0</span><span class="o">*</span><span class="mi">360</span><span class="mf">0.0</span><span class="o">/</span><span class="n">dels</span><span class="p">)</span><span class="w"></span>
<a id="ln-7662" name="ln-7662" href="#ln-7662"></a><span class="w">    </span><span class="n">nday</span><span class="o">=</span><span class="p">(</span><span class="n">kend</span><span class="o">-</span><span class="n">kstart</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">ktauday</span><span class="w"></span>
<a id="ln-7663" name="ln-7663" href="#ln-7663"></a>
<a id="ln-7664" name="ln-7664" href="#ln-7664"></a><span class="w">    </span><span class="n">myearspin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YEAREND</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YEARSTART</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7665" name="ln-7665" href="#ln-7665"></a><span class="w">    </span><span class="n">yyyy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CABLE_USER</span><span class="p">%</span><span class="n">YEARSTART</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-7666" name="ln-7666" href="#ln-7666"></a>
<a id="ln-7667" name="ln-7667" href="#ln-7667"></a><span class="w">    </span><span class="k">DO </span><span class="n">nyear</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">myearspin</span><span class="w"></span>
<a id="ln-7668" name="ln-7668" href="#ln-7668"></a><span class="w">       </span><span class="k">DO </span><span class="n">idoy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mdyear</span><span class="w"></span>
<a id="ln-7669" name="ln-7669" href="#ln-7669"></a><span class="w">          </span><span class="n">ktau</span><span class="o">=</span><span class="p">(</span><span class="n">idoy</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ktauday</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<a id="ln-7670" name="ln-7670" href="#ln-7670"></a><span class="w">          </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_dump_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">idoy</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7671" name="ln-7671" href="#ln-7671"></a>
<a id="ln-7672" name="ln-7672" href="#ln-7672"></a>
<a id="ln-7673" name="ln-7673" href="#ln-7673"></a><span class="w">          </span><span class="k">CALL </span><span class="n">biogeochem</span><span class="p">(</span><span class="n">ktau</span><span class="p">,</span><span class="n">dels</span><span class="p">,</span><span class="n">idoy</span><span class="p">,</span><span class="n">LALLOC</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="n">soil</span><span class="p">,</span><span class="n">casabiome</span><span class="p">,</span><span class="n">casapool</span><span class="p">,</span><span class="n">casaflux</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7674" name="ln-7674" href="#ln-7674"></a><span class="w">               </span><span class="n">casamet</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">phen</span><span class="p">,</span><span class="n">POP</span><span class="p">,</span><span class="n">climate</span><span class="p">,</span><span class="n">xnplimit</span><span class="p">,</span><span class="n">xkNlimiting</span><span class="p">,</span><span class="n">xklitter</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7675" name="ln-7675" href="#ln-7675"></a><span class="w">               </span><span class="n">xksoil</span><span class="p">,</span><span class="n">xkleaf</span><span class="p">,</span><span class="n">xkleafcold</span><span class="p">,</span><span class="n">xkleafdry</span><span class="p">,&amp;</span><span class="w"></span>
<a id="ln-7676" name="ln-7676" href="#ln-7676"></a><span class="w">               </span><span class="n">cleaf2met</span><span class="p">,</span><span class="n">cleaf2str</span><span class="p">,</span><span class="n">croot2met</span><span class="p">,</span><span class="n">croot2str</span><span class="p">,</span><span class="n">cwood2cwd</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7677" name="ln-7677" href="#ln-7677"></a><span class="w">               </span><span class="n">nleaf2met</span><span class="p">,</span><span class="n">nleaf2str</span><span class="p">,</span><span class="n">nroot2met</span><span class="p">,</span><span class="n">nroot2str</span><span class="p">,</span><span class="n">nwood2cwd</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-7678" name="ln-7678" href="#ln-7678"></a><span class="w">               </span><span class="n">pleaf2met</span><span class="p">,</span><span class="n">pleaf2str</span><span class="p">,</span><span class="n">proot2met</span><span class="p">,</span><span class="n">proot2str</span><span class="p">,</span><span class="n">pwood2cwd</span><span class="p">)</span><span class="w"></span>
<a id="ln-7679" name="ln-7679" href="#ln-7679"></a>
<a id="ln-7680" name="ln-7680" href="#ln-7680"></a>
<a id="ln-7681" name="ln-7681" href="#ln-7681"></a><span class="w">          </span><span class="c">! accumulate annual variables for use in POP</span>
<a id="ln-7682" name="ln-7682" href="#ln-7682"></a><span class="w">          </span><span class="k">IF</span><span class="p">(</span><span class="n">idoy</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<a id="ln-7683" name="ln-7683" href="#ln-7683"></a><span class="k">             </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">casaflux</span><span class="p">%</span><span class="n">cnpp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.7</span><span class="w"> </span><span class="c">! (assumes 70% of wood NPP is allocated above ground)</span>
<a id="ln-7684" name="ln-7684" href="#ln-7684"></a><span class="w">             </span><span class="n">casabal</span><span class="p">%</span><span class="n">LAImax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casamet</span><span class="p">%</span><span class="n">glai</span><span class="w"></span>
<a id="ln-7685" name="ln-7685" href="#ln-7685"></a><span class="w">             </span><span class="n">casabal</span><span class="p">%</span><span class="n">Cleafmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">mdyear</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7686" name="ln-7686" href="#ln-7686"></a><span class="w">             </span><span class="n">casabal</span><span class="p">%</span><span class="n">Crootmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">mdyear</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7687" name="ln-7687" href="#ln-7687"></a><span class="w">          </span><span class="k">ELSE</span>
<a id="ln-7688" name="ln-7688" href="#ln-7688"></a><span class="k">             </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">cnpp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">fracCalloc</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.7</span><span class="w"></span>
<a id="ln-7689" name="ln-7689" href="#ln-7689"></a><span class="w">             </span><span class="n">casabal</span><span class="p">%</span><span class="n">LAImax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="n">casamet</span><span class="p">%</span><span class="n">glai</span><span class="p">,</span><span class="w"> </span><span class="n">casabal</span><span class="p">%</span><span class="n">LAImax</span><span class="p">)</span><span class="w"></span>
<a id="ln-7690" name="ln-7690" href="#ln-7690"></a><span class="w">             </span><span class="n">casabal</span><span class="p">%</span><span class="n">Cleafmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casabal</span><span class="p">%</span><span class="n">Cleafmean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">mdyear</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7691" name="ln-7691" href="#ln-7691"></a><span class="w">             </span><span class="n">casabal</span><span class="p">%</span><span class="n">Crootmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casabal</span><span class="p">%</span><span class="n">Crootmean</span><span class="w"> </span><span class="o">+</span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">mdyear</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-7692" name="ln-7692" href="#ln-7692"></a><span class="w">          </span><span class="k">ENDIF</span>
<a id="ln-7693" name="ln-7693" href="#ln-7693"></a>
<a id="ln-7694" name="ln-7694" href="#ln-7694"></a><span class="k">          IF</span><span class="p">(</span><span class="n">idoy</span><span class="o">==</span><span class="n">mdyear</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="c">! end of year</span>
<a id="ln-7695" name="ln-7695" href="#ln-7695"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;b4 MPI_SEND,casa_LUC_t&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-7696" name="ln-7696" href="#ln-7696"></a><span class="w">             </span><span class="k">CALL </span><span class="nb">flush</span><span class="p">(</span><span class="n">wlogn</span><span class="p">)</span><span class="w"></span>
<a id="ln-7697" name="ln-7697" href="#ln-7697"></a><span class="w">             </span><span class="k">CALL </span><span class="n">MPI_Send</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_LUC_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7698" name="ln-7698" href="#ln-7698"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;after MPI_SEND,casa_LUC_t&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">casapool</span><span class="p">%</span><span class="n">cplant</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-7699" name="ln-7699" href="#ln-7699"></a><span class="w">             </span><span class="k">CALL </span><span class="nb">flush</span><span class="p">(</span><span class="n">wlogn</span><span class="p">)</span><span class="w"></span>
<a id="ln-7700" name="ln-7700" href="#ln-7700"></a><span class="w">             </span><span class="n">StemNPP</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">casaflux</span><span class="p">%</span><span class="n">stemnpp</span><span class="w"></span>
<a id="ln-7701" name="ln-7701" href="#ln-7701"></a><span class="w">             </span><span class="n">StemNPP</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-7702" name="ln-7702" href="#ln-7702"></a>
<a id="ln-7703" name="ln-7703" href="#ln-7703"></a><span class="w">             </span><span class="k">CALL </span><span class="n">MPI_Comm_rank</span><span class="w"> </span><span class="p">(</span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7704" name="ln-7704" href="#ln-7704"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<a id="ln-7705" name="ln-7705" href="#ln-7705"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s1">&#39;rank receiving pop_grid from master&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="w"></span>
<a id="ln-7706" name="ln-7706" href="#ln-7706"></a><span class="c">!!$           write(wlogn,*) &#39;b4 MPI_Recv, pop_t cmass: &#39;, POP%pop_grid%cmass_sum</span>
<a id="ln-7707" name="ln-7707" href="#ln-7707"></a><span class="c">!!$           write(wlogn,*) &#39;b4 MPI_Recv, pop_t LU: &#39;, POP%pop_grid%LU</span>
<a id="ln-7708" name="ln-7708" href="#ln-7708"></a><span class="w">             </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="p">(</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">pop_grid</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">np</span><span class="p">,</span><span class="w"> </span><span class="n">pop_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-7709" name="ln-7709" href="#ln-7709"></a><span class="c">!!$           write(wlogn,*)</span>
<a id="ln-7710" name="ln-7710" href="#ln-7710"></a><span class="c">!!$           write(wlogn,*) &#39;after MPI_Recv, pop_t cmass: &#39;, POP%pop_grid%cmass_sum</span>
<a id="ln-7711" name="ln-7711" href="#ln-7711"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;after MPI_Recv, pop_t &#39;</span><span class="w"></span>
<a id="ln-7712" name="ln-7712" href="#ln-7712"></a><span class="w">             </span><span class="k">CALL </span><span class="nb">flush</span><span class="p">(</span><span class="n">wlogn</span><span class="p">)</span><span class="w"></span>
<a id="ln-7713" name="ln-7713" href="#ln-7713"></a><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">cable_user</span><span class="p">%</span><span class="n">CALL_POP</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">np</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="c">! CALL_POP</span>
<a id="ln-7714" name="ln-7714" href="#ln-7714"></a><span class="w">                </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;b4  POPdriver&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">POP</span><span class="p">%</span><span class="n">pop_grid</span><span class="p">%</span><span class="n">cmass_sum</span><span class="w"></span>
<a id="ln-7715" name="ln-7715" href="#ln-7715"></a><span class="w">                </span><span class="k">CALL </span><span class="n">POPdriver</span><span class="p">(</span><span class="n">casaflux</span><span class="p">,</span><span class="n">casabal</span><span class="p">,</span><span class="n">veg</span><span class="p">,</span><span class="w"> </span><span class="n">POP</span><span class="p">)</span><span class="w"></span>
<a id="ln-7716" name="ln-7716" href="#ln-7716"></a>
<a id="ln-7717" name="ln-7717" href="#ln-7717"></a><span class="w">             </span><span class="k">ENDIF</span><span class="w"></span>
<a id="ln-7718" name="ln-7718" href="#ln-7718"></a><span class="c">!!$           write(wlogn,*)</span>
<a id="ln-7719" name="ln-7719" href="#ln-7719"></a><span class="c">!!$           write(wlogn,*) &#39;after POPstep cmass: &#39;, POP%pop_grid%cmass_sum</span>
<a id="ln-7720" name="ln-7720" href="#ln-7720"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;after POPstep &#39;</span><span class="p">,</span><span class="w">  </span><span class="n">POP</span><span class="p">%</span><span class="n">pop_grid</span><span class="p">%</span><span class="n">cmass_sum</span><span class="w"></span>
<a id="ln-7721" name="ln-7721" href="#ln-7721"></a><span class="w">             </span><span class="k">CALL </span><span class="nb">flush</span><span class="p">(</span><span class="n">wlogn</span><span class="p">)</span><span class="w"></span>
<a id="ln-7722" name="ln-7722" href="#ln-7722"></a><span class="w">             </span><span class="k">CALL </span><span class="n">worker_send_pop</span><span class="w"> </span><span class="p">(</span><span class="n">POP</span><span class="p">,</span><span class="w"> </span><span class="n">ocomm</span><span class="p">)</span><span class="w"></span>
<a id="ln-7723" name="ln-7723" href="#ln-7723"></a><span class="w">             </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;after worker_send_pop&#39;</span><span class="w"></span>
<a id="ln-7724" name="ln-7724" href="#ln-7724"></a><span class="w">             </span><span class="k">CALL </span><span class="nb">flush</span><span class="p">(</span><span class="n">wlogn</span><span class="p">)</span><span class="w"></span>
<a id="ln-7725" name="ln-7725" href="#ln-7725"></a><span class="w">          </span><span class="k">ENDIF</span>
<a id="ln-7726" name="ln-7726" href="#ln-7726"></a>
<a id="ln-7727" name="ln-7727" href="#ln-7727"></a>
<a id="ln-7728" name="ln-7728" href="#ln-7728"></a><span class="k">       ENDDO</span><span class="w"></span>
<a id="ln-7729" name="ln-7729" href="#ln-7729"></a><span class="w">       </span><span class="c">! receive updates to CASA pools resulting from LUC</span>
<a id="ln-7730" name="ln-7730" href="#ln-7730"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<a id="ln-7731" name="ln-7731" href="#ln-7731"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;b4 mpi_recv casa_LUC_t &#39;</span><span class="w"></span>
<a id="ln-7732" name="ln-7732" href="#ln-7732"></a><span class="w">       </span><span class="k">CALL </span><span class="n">MPI_Recv</span><span class="w"> </span><span class="p">(</span><span class="n">MPI_BOTTOM</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">casa_LUC_t</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">nyear</span><span class="p">,</span><span class="w"> </span><span class="n">icomm</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-7733" name="ln-7733" href="#ln-7733"></a><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="n">wlogn</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;after mpi_recv casa_LUC_t: &#39;</span><span class="w"></span>
<a id="ln-7734" name="ln-7734" href="#ln-7734"></a><span class="w">    </span><span class="k">ENDDO</span>
<a id="ln-7735" name="ln-7735" href="#ln-7735"></a>
<a id="ln-7736" name="ln-7736" href="#ln-7736"></a><span class="k">  END SUBROUTINE </span><span class="n">WORKER_CASAONLY_LUC</span><span class="w"></span>
<a id="ln-7737" name="ln-7737" href="#ln-7737"></a>
<a id="ln-7738" name="ln-7738" href="#ln-7738"></a>
<a id="ln-7739" name="ln-7739" href="#ln-7739"></a><span class="k">END MODULE </span><span class="n">cable_mpiworker</span><span class="w"></span>
</pre></div>

    </section>
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>CABLE was developed by CABLE community<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>